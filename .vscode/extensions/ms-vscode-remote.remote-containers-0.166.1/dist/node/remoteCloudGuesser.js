var m=Object.create,d=Object.defineProperty,g=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,f=Object.getOwnPropertyNames,p=Object.getOwnPropertyDescriptor;var P=t=>d(t,"__esModule",{value:!0});var v=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of f(e))!l.call(t,i)&&i!=="default"&&d(t,i,{get:()=>e[i],enumerable:!(n=p(e,i))||n.enumerable});return t},w=t=>v(P(d(t!=null?m(g(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var c=w(require("http")),r;(function(t){t.Azure="azure",t.AWS="aws",t.DigitalOcean="digitalocean",t.GCP="gcp"})(r||(r={}));var S=[{id:r.Azure,url:"http://169.254.169.254/metadata/instance?api-version=2019-03-11",headers:{Metadata:"true"},match:/azEnvironment/},{id:r.DigitalOcean,url:"http://169.254.169.254/metadata/v1/id",match:/^\d{9}/},{id:r.AWS,url:"http://169.254.169.254/latest/meta-data/instance-id",match:/^i-[0-9a-f]{8}/},{id:r.GCP,url:"http://metadata.google.internal/computeMetadata/v1/instance/id",headers:{"Metadata-Flavor":"Google"},match:/^\d{10}/}];async function A(){let t,e=new Promise(n=>t=n);return Promise.race([Promise.all(S.map(({id:n,url:i,headers:o,match:s})=>z(i,o,e).then(a=>{s.test(a)&&t(n)},a=>{}))),new Promise(n=>setTimeout(n,7e3).unref())]).then(()=>t()),e}async function z(t,e,n){return new Promise((i,o)=>{let s=c.get(t,{headers:e},a=>{if(a.statusCode<200||a.statusCode>299)return a.destroy(),o(new Error(`Status ${a.statusCode}`));let u=[];a.on("data",h=>u.push(h)),a.on("end",()=>i(Buffer.concat(u).toString("utf8"))),a.on("error",o)});s.on("error",o),n.then(()=>s.abort())})}A().then(t=>console.log(t||""));
//# sourceMappingURL=remoteCloudGuesser.js.map
