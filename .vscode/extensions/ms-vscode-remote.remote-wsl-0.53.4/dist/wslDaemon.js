!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=162)}({0:function(e,t){e.exports=require("path")},12:function(e,t){e.exports=require("crypto")},13:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.create=function(e){return{dispose:e}}}(t.Disposable||(t.Disposable={})),function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class s{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var r=!1,s=0,n=this._callbacks.length;s<n;s++)if(this._callbacks[s]===e){if(this._contexts[s]===t)return this._callbacks.splice(s,1),void this._contexts.splice(s,1);r=!0}if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],r=this._callbacks.slice(0),s=this._contexts.slice(0),n=0,i=r.length;n<i;n++)try{t.push(r[n].apply(s[n],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class n{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{let i;return this._callbacks||(this._callbacks=new s),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),i={dispose:()=>{this._callbacks.remove(e,t),i.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this)}},Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=n,n._noop=function(){}},16:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(13),n=r(5);let i=8192,o=Buffer.from("\r","ascii")[0],a=Buffer.from("\n","ascii")[0],c="\r\n";class l{constructor(e="utf8"){this.encoding=e,this.index=0,this.buffer=Buffer.allocUnsafe(i)}append(e){var t=e;if("string"==typeof e){var r=e,s=Buffer.byteLength(r,this.encoding);(t=Buffer.allocUnsafe(s)).write(r,0,s,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var n=(Math.ceil((this.index+t.length)/i)+1)*i;0===this.index?(this.buffer=Buffer.allocUnsafe(n),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],n)}this.index+=t.length}tryReadHeaders(){let e=void 0,t=0;for(;t+3<this.index&&(this.buffer[t]!==o||this.buffer[t+1]!==a||this.buffer[t+2]!==o||this.buffer[t+3]!==a);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split(c).forEach(t=>{let r=t.indexOf(":");if(-1===r)throw new Error("Message header must separate key and value using :");let s=t.substr(0,r),n=t.substr(r+1).trim();e[s]=n});let r=t+4;return this.buffer=this.buffer.slice(r),this.index=this.index-r,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),r=e;return this.buffer.copy(this.buffer,0,r),this.index=this.index-r,t}get numberOfBytes(){return this.index}}!function(e){e.is=function(e){let t=e;return t&&n.func(t.listen)&&n.func(t.dispose)&&n.func(t.onError)&&n.func(t.onClose)&&n.func(t.onPartialMessage)}}(t.MessageReader||(t.MessageReader={}));class u{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter,this.partialMessageEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${n.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=u;class d extends u{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new l(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",e=>{this.onData(e)}),this.readable.on("error",e=>this.fireError(e)),this.readable.on("close",()=>this.fireClose())}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let r=parseInt(t);if(isNaN(r))throw new Error("Content-Length value must be a number.");this.nextMessageLength=r}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var r=JSON.parse(t);this.callback(r)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=d;t.IPCMessageReader=class extends u{constructor(e){super(),this.process=e;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose())}listen(e){this.process.on("message",e)}};t.SocketMessageReader=class extends d{constructor(e,t="utf-8"){super(e,t)}}},162:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(19),n=r(6),i=r(8),o=r(22),a=r(7),c=r(0),l=r(37),u=process.env.VSCODE_WSL_AGENT_DEBUG_PORT,d=process.env.VSCODE_WSL_PIPE_NAME,f=parseInt(process.env.VSCODE_WSL_EXT_HOST_PID||"0",10),h=process.env.VSCODE_WSL_EXT_LOCATION,p=process.env.VSCODE_WSL_APP_ROOT,g=!!process.env.VSCODE_WSL_ENABLE_TELEMETRY,m=process.env.VSCODE_FILE_WATCHER_POLLING||0,v=process.env.VSCODE_WSL_DISTRO,y=!!process.env.VSCODE_WSL_DEBUG_INFO,S=process.env.VSCODE_WSL_DEFAULT_DISTRO;let _=void 0,w=[];const E=[];async function T(e){for(let t=0;t<w.length;t++)w[t]===e&&w.splice(t,1);0===w.length&&(_?setTimeout(()=>{0===w.length&&b()},3e3):b())}function b(){try{E.forEach(e=>e()),R.close()}catch(e){}finally{process.exit(0)}}!function(){let e=o.createMessageConnection(new o.StreamMessageReader(process.stdin),new o.StreamMessageWriter(process.stdout));e.listen(),e.onRequest((e,...t)=>{throw new Error("Received unexpected request")}),w.push(e);let t=setInterval((function(){try{process.kill(f,0)}catch(r){clearInterval(t),T(e)}}),1e3)}();const R=s.createServer(e=>{const t=o.createMessageConnection(new o.SocketMessageReader(e),new o.SocketMessageWriter(e));t.listen(),w.push(t),void 0!==_&&(t.sendNotification(l.Stdout,`Connecting to daemon started by other Remote-WSL window... ${_.wslVersion}`),t.sendNotification(l.PortResolved,_)),e.on("close",()=>{T(t)})});function C(e){e&&"EADDRINUSE"===e.code||(console.error(e),process.exit(0));let t=e=>{console.error(e)},r=s.createConnection(d,()=>{r.removeListener("error",t);const e=o.createMessageConnection(new o.SocketMessageReader(r),new o.SocketMessageWriter(r));e.listen();const s=w[0];e.onNotification(s.sendNotification),e.onRequest(s.sendRequest),e.onUnhandledProgress(e=>s.sendProgress(new o.ProgressType,e.token,e.value)),s.onNotification(e.sendNotification),s.onRequest(e.sendRequest),s.onUnhandledProgress(t=>e.sendProgress(new o.ProgressType,t.token,t.value)),r.on("close",()=>{process.exit(0)})});r.once("error",t)}function k(e,t){w.forEach(r=>{r.sendNotification(e,t)})}let x=0;function O(e,t,r){let s;if(e){const i=`kill ${r}`;s=a.isExecAndDistroArgumentSupported()?`${e} -d ${t} -e ${i}`:`${e} "${i}"`,k(l.Stdout,s);try{n.execSync(s,a.getExecSyncOptions())}catch(e){}}}R.on("error",C),R.listen(d,async()=>{let e;R.removeListener("error",C);let t="",r=0,s="",o=[],d="";const f=(t,r,s,n=!1,i=!0)=>{clearTimeout(e),k(l.FatalErrorOccured,{message:t,wslVersion:d,checkLog:s,handled:n,modal:i,reason:r}),b()},T=e=>{const t=e.match(/(\d+)%$/);let n=0;if(t){const e=Math.min(parseInt(t[1],10),100);0===e&&(r=0),e>r&&(n=e-r,r=e)}const i=e;(s!==i||n>0)&&(s=i,k(l.Progress,{increment:45*n/100,message:i}))},N=()=>{let r=!1;if(P)P=!1,W=0,$&&(k(l.Progress,{increment:0,message:"Installing WSL components"}),$=!1);else if(++W>300)return void f(`VS Code Server for WSL failed to start. No messages received for ${Math.floor(90)}s`,l.FailureReason.Timeout,!0);return M.length&&(k(l.Stdout,M),r=(r=>{for(let s=0;s<r.length;s++){const n=r.charCodeAt(s);if(10===n){const r=t;t="";let s=r.match(/^WSL2-shell-PID: ([\d]+)/);if(s){const e=s[1];E.push(()=>{O(q,v,e)});continue}if(s=r.match(/^Extension host agent listening on (\d+)/))return clearTimeout(e),_={hostNames:o,port:parseInt(s[1],10),wslVersion:d},k(l.PortResolved,_),!0;if(s=r.match(/^IP Address: ([\d\.]+)/)){o.push(s[1]);continue}if(s=r.match(/^WSL version: (.+)/)){d=s[1];continue}T(r)}else 8===n?t.length>0&&(t=t.substr(0,t.length-1)):t+=r.charAt(s)}return T(t),!1})(M),M=""),L.length&&(k(l.Stderr,L),L=""),r};let M="",L="",P=!1,W=0,$=!0;const q=a.getWSLExecutablePath();if(!q||!i.existsSync(q))return void f(`VS Code Server for WSL failed. '${q}' not found.\n\nMake sure WSL is installed:\nhttps://aka.ms/vscode-remote/wsl/install-wsl`,l.FailureReason.WSLNotFound,!1);if(!a.isExecAndDistroArgumentSupported()&&!a.compareCaseInsensitive(S,v)&&!await function(e,t){return w[0].sendRequest(l.MakeDefaultRequest,{distro:e,current:t})}(v,S))return void f(`To open a non-distro, Remote-WSL requires a newer version of WSL: (${a.WIN10_1903.label}). `,l.FailureReason.WSLUpdateRequired,!1,!0);e=setInterval(N,300);const D=a.getProductConfiguration(p),{commit:A,quality:I,serverDataFolderName:j}=D;if(A&&!I)return void f(`VSCode Client (${p}) does not define a quality.`,l.FailureReason.Undefined,!0);const V=j||".vscode-remote",F=a.isWSLEnvAvailable();let U="";if(A&&F){let e="";try{e=function(e,t,r,s){let i;const o=`[ -d ~/${r}/bin/${s} ] && printf found || ([ -f /etc/alpine-release ] && printf alpine-; uname -m)`;i=a.isExecAndDistroArgumentSupported()?`${e} -d ${t} -e sh -c "${o}"`:"wsl.exe"===c.basename(e).toLowerCase()?`${e} sh -c "${o}"`:`${e} -c "${o}"`;k(l.Stdout,`Probing if server is already installed: ${i}`);try{const e=n.execSync(i,a.getExecSyncOptions()).toString().trim();switch(k(l.Stdout,`Probing result: ${e}`),e){case"found":return"";case"x86_64":return"x64";case"aarch64":return"arm64";case"alpine-x86_64":return"alpine";default:k(l.Stderr,`${e} is an unsupported platform. Please file a feature request.`)}return"unknown"}catch(e){const t=[e.message];try{t.push(e.stdout.toString("utf16le")),t.push(e.stderr.toString("utf16le"))}catch(e){}throw new Error(t.join("\n"))}}(q,v,V,A),k(l.Stdout,e?`No server install found in WSL, needs ${e}`:"Server install found in WSL")}catch(e){if(k(l.Stderr,`Unable to detect if server is already installed: ${e}`),"string"==typeof e.message&&-1!==e.message.indexOf("https://aka.ms/wsl2kernel")){f("WSL 2 requires an update to its kernel component. For instructions visit [here](https://aka.ms/wsl2kernel).",l.FailureReason.WSLUpdateRequired,!1,!1,!1)}const t=a.getWindowsBuildNumber();if(t<=a.WIN10_1803.build)k(l.Stderr,`When using Alpine on ${a.WIN10_1803.label}, make sure that 'bash' is installed. ('apk update && apk add bash')${e}`);else if(19555===t){f("Currently, Remote - WSL does not work for WSL 2 in Build 19555.\nSee [WSL issue 4870](https://github.com/microsoft/WSL/issues/4870) for more information and workarounds.",l.FailureReason.WSLUpdateRequired,!0,!1,!1)}}if(e&&"unknown"!==e){if(U=a.getServerTarCacheLocation(D,e),i.existsSync(U))k(l.Progress,{increment:45,message:""});else{const t=a.getDownloadURL(D,e);k(l.Stdout,`Downloading server on client side to ${U}.`),k(l.Stdout,`${t}`);let r=0;try{await function(e,t,r,s){const n=w[0],i=x++,o=x++,a=n.onProgress(l.DownloadProgress,i,r),c=n.onProgress(l.DownloadLog,o,s);return n.sendRequest(l.DownloadRequest,{url:e,target:t,progressToken:i,logToken:o}).finally(()=>{a.dispose(),c.dispose()})}(t,U,e=>{const t=Math.ceil(45*e.received/e.total);t>r&&(k(l.Progress,{increment:t-r,message:"Downloading server..."}),r=t),W=0},e=>{k(l.Stdout,e)})}catch(e){k(l.Stderr,`Unable to download server on client side: ${e}. Will try to download on WSL side.`),U=""}}k(l.Progress,{increment:0,message:"Unpacking server..."})}else k(l.Progress,{increment:90,message:"Connecting to server..."})}const H=u?`--inspect=0.0.0.0:${u}`:"";let J=A?`"${F?"$VSCODE_WSL_EXT_LOCATION":"."}/scripts/wslServer.sh" ${A} ${I} ${V} ${m} ${H} ${g?"":"--disable-telemetry"}`:`"$VSCODE_WSL_EXT_LOCATION/scripts/wslServer-dev.sh" "$VSCODE_WSL_APP_ROOT" ${m} ${H}`;const B=[];y&&(J="env && VSCODE_WSL_DEBUG_INFO=true "+J),J=`'${J}'`,a.isExecAndDistroArgumentSupported()?B.push("-d",v,"sh","-c",J):"wsl.exe"===c.basename(q).toLowerCase()?B.push("sh","-c",J):B.push("-c",J);const z=a.needsPathLengthWorkaround()?{}:function(){const e={...process.env},t=Object.keys(e);for(const r of t)r.match(/^(ELECTRON_|VSCODE_)/)&&delete e[r];return e}();if(F||!A){const e=[];z.VSCODE_WSL_EXT_LOCATION=h,e.push("VSCODE_WSL_EXT_LOCATION/up"),U&&(z.VSCODE_SERVER_TAR=U,e.push("VSCODE_SERVER_TAR/up")),A||(z.VSCODE_WSL_APP_ROOT=p,e.push("VSCODE_WSL_APP_ROOT/up")),z.WSLENV&&e.push(process.env.WSLENV),z.WSLENV=e.join(":")}let X=F?void 0:h;const G=y?`, cwd: ${X}, env: ${JSON.stringify(z,null,"  ")}`:"";k(l.Stdout,`Launching ${q} ${B.join(" ")}${G}}`);const Y=n.spawn(q,B,{cwd:X,env:z,windowsVerbatimArguments:!0});Y.stdout.on("data",e=>{M+=e.toString(),P=!0}),Y.stderr.on("data",e=>{L+=e.toString(),P=!0}),Y.on("error",e=>{N()||f(`VS Code Server for WSL failed with error:\r\n${e.message}`,l.FailureReason.ServerScriptError,!0)}),Y.on("close",e=>{N()||f("VS Code Server for WSL closed unexpectedly.",l.FailureReason.ServerCloseError,!0)})})},17:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(13),n=r(5);let i="Content-Length: ",o="\r\n";!function(e){e.is=function(e){let t=e;return t&&n.func(t.dispose)&&n.func(t.onClose)&&n.func(t.onError)&&n.func(t.write)}}(t.MessageWriter||(t.MessageWriter={}));class a{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${n.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=a;t.StreamMessageWriter=class extends a{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",e=>this.fireError(e)),this.writable.on("close",()=>this.fireClose())}write(e){let t=JSON.stringify(e),r=Buffer.byteLength(t,this.encoding),s=[i,r.toString(),o,o];try{this.writable.write(s.join(""),"ascii"),this.writable.write(t,this.encoding),this.errorCount=0}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.IPCMessageWriter=class extends a{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose)}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.SocketMessageWriter=class extends a{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",e=>this.fireError(e)),this.socket.on("close",()=>this.fireClose())}dispose(){super.dispose(),this.socket.destroy()}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){let t=JSON.stringify(e),r=Buffer.byteLength(t,this.encoding),s=[i,r.toString(),o,o];try{this.sending=!0,this.socket.write(s.join(""),"ascii",r=>{r&&this.handleError(r,e);try{this.socket.write(t,this.encoding,t=>{this.sending=!1,t?this.handleError(t,e):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})}catch(r){this.handleError(r,e)}})}catch(t){this.handleError(t,e)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}},18:function(e,t){e.exports=require("util")},19:function(e,t){e.exports=require("net")},22:function(e,t,r){"use strict";function s(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});const n=r(5),i=r(26);t.RequestType=i.RequestType,t.RequestType0=i.RequestType0,t.RequestType1=i.RequestType1,t.RequestType2=i.RequestType2,t.RequestType3=i.RequestType3,t.RequestType4=i.RequestType4,t.RequestType5=i.RequestType5,t.RequestType6=i.RequestType6,t.RequestType7=i.RequestType7,t.RequestType8=i.RequestType8,t.RequestType9=i.RequestType9,t.ResponseError=i.ResponseError,t.ErrorCodes=i.ErrorCodes,t.NotificationType=i.NotificationType,t.NotificationType0=i.NotificationType0,t.NotificationType1=i.NotificationType1,t.NotificationType2=i.NotificationType2,t.NotificationType3=i.NotificationType3,t.NotificationType4=i.NotificationType4,t.NotificationType5=i.NotificationType5,t.NotificationType6=i.NotificationType6,t.NotificationType7=i.NotificationType7,t.NotificationType8=i.NotificationType8,t.NotificationType9=i.NotificationType9;const o=r(16);t.MessageReader=o.MessageReader,t.StreamMessageReader=o.StreamMessageReader,t.IPCMessageReader=o.IPCMessageReader,t.SocketMessageReader=o.SocketMessageReader;const a=r(17);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=r(13);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const l=r(27);t.CancellationTokenSource=l.CancellationTokenSource,t.CancellationToken=l.CancellationToken;const u=r(28);var d,f,h,p,g,m,v,y;s(r(29)),s(r(30)),function(e){e.type=new i.NotificationType("$/cancelRequest")}(d||(d={})),function(e){e.type=new i.NotificationType("$/progress")}(f||(f={}));t.ProgressType=class{constructor(){}},t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(h=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!n.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(h=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(p=t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new i.NotificationType("$/setTraceNotification")}(g=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new i.NotificationType("$/logTraceNotification")}(m=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(v=t.ConnectionErrors||(t.ConnectionErrors={}));class S extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,S.prototype)}}function _(e,t,r,s){let o=0,a=0,_=0;const w="2.0";let E,T,b=void 0,R=Object.create(null),C=void 0,k=Object.create(null),x=new Map,O=new u.LinkedMap,N=Object.create(null),M=Object.create(null),L=h.Off,P=p.Text,W=y.New,$=new c.Emitter,q=new c.Emitter,D=new c.Emitter,A=new c.Emitter,I=new c.Emitter;function j(e){return"req-"+e.toString()}function V(e,t){var r;i.isRequestMessage(t)?e.set(j(t.id),t):i.isResponseMessage(t)?e.set(null===(r=t.id)?"res-unknown-"+(++_).toString():"res-"+r.toString(),t):e.set("not-"+(++a).toString(),t)}function F(e){}function U(){return W===y.Listening}function H(){return W===y.Closed}function J(){return W===y.Disposed}function B(){W!==y.New&&W!==y.Listening||(W=y.Closed,q.fire(void 0))}function z(){E||0===O.size||(E=setImmediate(()=>{E=void 0,function(){if(0===O.size)return;let e=O.shift();try{i.isRequestMessage(e)?function(e){if(J())return;function r(r,s,n){let o={jsonrpc:w,id:e.id};r instanceof i.ResponseError?o.error=r.toJson():o.result=void 0===r?null:r,G(o,s,n),t.write(o)}function s(r,s,n){let i={jsonrpc:w,id:e.id,error:r.toJson()};G(i,s,n),t.write(i)}!function(e){if(L===h.Off||!T)return;if(P===p.Text){let t=void 0;L===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),T.log(`Received request '${e.method} - (${e.id})'.`,t)}else Y("receive-request",e)}(e);let o,a,c=R[e.method];c&&(o=c.type,a=c.handler);let u=Date.now();if(a||b){let c=new l.CancellationTokenSource,d=String(e.id);M[d]=c;try{let l,f=l=void 0===e.params||void 0!==o&&0===o.numberOfParams?a?a(c.token):b(e.method,c.token):n.array(e.params)&&(void 0===o||o.numberOfParams>1)?a?a(...e.params,c.token):b(e.method,...e.params,c.token):a?a(e.params,c.token):b(e.method,e.params,c.token);l?f.then?f.then(t=>{delete M[d],r(t,e.method,u)},t=>{delete M[d],t instanceof i.ResponseError?s(t,e.method,u):t&&n.string(t.message)?s(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):s(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}):(delete M[d],r(l,e.method,u)):(delete M[d],function(r,s,n){void 0===r&&(r=null);let i={jsonrpc:w,id:e.id,result:r};G(i,s,n),t.write(i)}(l,e.method,u))}catch(t){delete M[d],t instanceof i.ResponseError?r(t,e.method,u):t&&n.string(t.message)?s(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):s(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else s(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):i.isNotificationMessage(e)?function(e){if(J())return;let t,s=void 0;if(e.method===d.type.method)t=e=>{let t=e.id,r=M[String(t)];r&&r.cancel()};else{let r=k[e.method];r&&(t=r.handler,s=r.type)}if(t||C)try{!function(e){if(L===h.Off||!T||e.method===m.type.method)return;if(P===p.Text){let t=void 0;L===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),T.log(`Received notification '${e.method}'.`,t)}else Y("receive-notification",e)}(e),void 0===e.params||void 0!==s&&0===s.numberOfParams?t?t():C(e.method):n.array(e.params)&&(void 0===s||s.numberOfParams>1)?t?t(...e.params):C(e.method,...e.params):t?t(e.params):C(e.method,e.params)}catch(t){t.message?r.error(`Notification handler '${e.method}' failed with message: ${t.message}`):r.error(`Notification handler '${e.method}' failed unexpectedly.`)}else D.fire(e)}(e):i.isResponseMessage(e)?function(e){if(J())return;if(null===e.id)e.error?r.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):r.error("Received response message without id. No further error information provided.");else{let t=String(e.id),s=N[t];if(function(e,t){if(L===h.Off||!T)return;if(P===p.Text){let r=void 0;if(L===h.Verbose&&(e.error&&e.error.data?r=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?r=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),t){let s=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";T.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${s}`,r)}else T.log(`Received response ${e.id} without active response promise.`,r)}else Y("receive-response",e)}(e,s),s){delete N[t];try{if(e.error){let t=e.error;s.reject(new i.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");s.resolve(e.result)}}catch(e){e.message?r.error(`Response handler '${s.method}' failed with message: ${e.message}`):r.error(`Response handler '${s.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void r.error("Received empty message.");r.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);let t=e;if(n.string(t.id)||n.number(t.id)){let e=String(t.id),r=N[e];r&&r.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{z()}}()}))}e.onClose(B),e.onError((function(e){$.fire([e,void 0,void 0])})),t.onClose(B),t.onError((function(e){$.fire(e)}));let X=e=>{try{if(i.isNotificationMessage(e)&&e.method===d.type.method){let r=j(e.params.id),n=O.get(r);if(i.isRequestMessage(n)){let i=s&&s.cancelUndispatched?s.cancelUndispatched(n,F):void 0;if(i&&(void 0!==i.error||void 0!==i.result))return O.delete(r),i.id=n.id,G(i,e.method,Date.now()),void t.write(i)}}V(O,e)}finally{z()}};function G(e,t,r){if(L!==h.Off&&T)if(P===p.Text){let s=void 0;L===h.Verbose&&(e.error&&e.error.data?s=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?s=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(s="No result returned.\n\n")),T.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-r}ms`,s)}else Y("send-response",e)}function Y(e,t){if(!T||L===h.Off)return;const r={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};T.log(r)}function Q(){if(H())throw new S(v.Closed,"Connection is closed.");if(J())throw new S(v.Disposed,"Connection is disposed.")}function Z(e){return void 0===e?null:e}function K(e,t){let r,s=e.numberOfParams;switch(s){case 0:r=null;break;case 1:r=Z(t[0]);break;default:r=[];for(let e=0;e<t.length&&e<s;e++)r.push(Z(t[e]));if(t.length<s)for(let e=t.length;e<s;e++)r.push(null)}return r}let ee={sendNotification:(e,...r)=>{let s,i;if(Q(),n.string(e))switch(s=e,r.length){case 0:i=null;break;case 1:i=r[0];break;default:i=r}else s=e.method,i=K(e,r);let o={jsonrpc:w,method:s,params:i};!function(e){if(L!==h.Off&&T)if(P===p.Text){let t=void 0;L===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),T.log(`Sending notification '${e.method}'.`,t)}else Y("send-notification",e)}(o),t.write(o)},onNotification:(e,t)=>{Q(),n.func(e)?C=e:t&&(n.string(e)?k[e]={type:void 0,handler:t}:k[e.method]={type:e,handler:t})},onProgress:(e,t,r)=>{if(x.has(t))throw new Error(`Progress handler for token ${t} already registered`);return x.set(t,r),{dispose:()=>{x.delete(t)}}},sendProgress:(e,t,r)=>{ee.sendNotification(f.type,{token:t,value:r})},onUnhandledProgress:A.event,sendRequest:(e,...r)=>{let s,a;Q(),function(){if(!U())throw new Error("Call listen() first.")}();let c=void 0;if(n.string(e))switch(s=e,r.length){case 0:a=null;break;case 1:l.CancellationToken.is(r[0])?(a=null,c=r[0]):a=Z(r[0]);break;default:const e=r.length-1;l.CancellationToken.is(r[e])?(c=r[e],a=2===r.length?Z(r[0]):r.slice(0,e).map(e=>Z(e))):a=r.map(e=>Z(e))}else{s=e.method,a=K(e,r);let t=e.numberOfParams;c=l.CancellationToken.is(r[t])?r[t]:void 0}let u=o++,f=new Promise((e,r)=>{let n={jsonrpc:w,id:u,method:s,params:a},o={method:s,timerStart:Date.now(),resolve:e,reject:r};!function(e){if(L!==h.Off&&T)if(P===p.Text){let t=void 0;L===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),T.log(`Sending request '${e.method} - (${e.id})'.`,t)}else Y("send-request",e)}(n);try{t.write(n)}catch(e){o.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),o=null}o&&(N[String(u)]=o)});return c&&c.onCancellationRequested(()=>{ee.sendNotification(d.type,{id:u})}),f},onRequest:(e,t)=>{Q(),n.func(e)?b=e:t&&(n.string(e)?R[e]={type:void 0,handler:t}:R[e.method]={type:e,handler:t})},trace:(e,t,r)=>{let s=!1,i=p.Text;void 0!==r&&(n.boolean(r)?s=r:(s=r.sendNotification||!1,i=r.traceFormat||p.Text)),P=i,T=(L=e)===h.Off?void 0:t,!s||H()||J()||ee.sendNotification(g.type,{value:h.toString(e)})},onError:$.event,onClose:q.event,onUnhandledNotification:D.event,onDispose:I.event,dispose:()=>{if(J())return;W=y.Disposed,I.fire(void 0);let r=new Error("Connection got disposed.");Object.keys(N).forEach(e=>{N[e].reject(r)}),N=Object.create(null),M=Object.create(null),O=new u.LinkedMap,n.func(t.dispose)&&t.dispose(),n.func(e.dispose)&&e.dispose()},listen:()=>{Q(),function(){if(U())throw new S(v.AlreadyListening,"Connection is already listening")}(),W=y.Listening,e.listen(X)},inspect:()=>{console.log("inspect")}};return ee.onNotification(m.type,e=>{L!==h.Off&&T&&T.log(e.message,L===h.Verbose?e.verbose:void 0)}),ee.onNotification(f.type,e=>{const t=x.get(e.token);t?t(e.value):A.fire(e)}),ee}t.ConnectionError=S,function(e){e.is=function(e){let t=e;return t&&n.func(t.cancelUndispatched)}}(t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(y||(y={})),t.createMessageConnection=function(e,r,s,n){var i;return s||(s=t.NullLogger),_(void 0!==(i=e).listen&&void 0===i.read?e:new o.StreamMessageReader(e),function(e){return void 0!==e.write&&void 0===e.end}(r)?r:new a.StreamMessageWriter(r),s,n)}},26:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5);var n;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.ContentModified=-32801,e.MessageWriteError=1,e.MessageReadError=2}(n=t.ErrorCodes||(t.ErrorCodes={}));class i extends Error{constructor(e,t,r){super(t),this.code=s.number(e)?e:n.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,i.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=i;class o{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=o;t.RequestType0=class extends o{constructor(e){super(e,0)}};t.RequestType=class extends o{constructor(e){super(e,1)}};t.RequestType1=class extends o{constructor(e){super(e,1)}};t.RequestType2=class extends o{constructor(e){super(e,2)}};t.RequestType3=class extends o{constructor(e){super(e,3)}};t.RequestType4=class extends o{constructor(e){super(e,4)}};t.RequestType5=class extends o{constructor(e){super(e,5)}};t.RequestType6=class extends o{constructor(e){super(e,6)}};t.RequestType7=class extends o{constructor(e){super(e,7)}};t.RequestType8=class extends o{constructor(e){super(e,8)}};t.RequestType9=class extends o{constructor(e){super(e,9)}};t.NotificationType=class extends o{constructor(e){super(e,1),this._=void 0}};t.NotificationType0=class extends o{constructor(e){super(e,0)}};t.NotificationType1=class extends o{constructor(e){super(e,1)}};t.NotificationType2=class extends o{constructor(e){super(e,2)}};t.NotificationType3=class extends o{constructor(e){super(e,3)}};t.NotificationType4=class extends o{constructor(e){super(e,4)}};t.NotificationType5=class extends o{constructor(e){super(e,5)}};t.NotificationType6=class extends o{constructor(e){super(e,6)}};t.NotificationType7=class extends o{constructor(e){super(e,7)}};t.NotificationType8=class extends o{constructor(e){super(e,8)}};t.NotificationType9=class extends o{constructor(e){super(e,9)}},t.isRequestMessage=function(e){let t=e;return t&&s.string(t.method)&&(s.string(t.id)||s.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&s.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(s.string(t.id)||s.number(t.id)||null===t.id)}},27:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(13),n=r(5);var i;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:s.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:s.Event.None}),e.is=function(t){let r=t;return r&&(r===e.None||r===e.Cancelled||n.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}}(i=t.CancellationToken||(t.CancellationToken={}));const o=Object.freeze((function(e,t){let r=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(r)}}}));class a{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?o:(this._emitter||(this._emitter=new s.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new a),this._token}cancel(){this._token?this._token.cancel():this._token=i.Cancelled}dispose(){this._token?this._token instanceof a&&this._token.dispose():this._token=i.None}}},28:function(e,t,r){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(s=t.Touch||(t.Touch={}));t.LinkedMap=class{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,r=s.None){let n=this._map.get(e);if(n)n.value=t,r!==s.None&&this.touch(n,r);else{switch(n={key:e,value:t,next:void 0,previous:void 0},r){case s.None:this.addItemLast(n);break;case s.First:this.addItemFirst(n);break;case s.Last:default:this.addItemLast(n)}this._map.set(e,n),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._head;for(;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.next}forEachReverse(e,t){let r=this._tail;for(;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===s.First||t===s.Last)if(t===s.First){if(e===this._head)return;const t=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(t.previous=r,r.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===s.Last){if(e===this._tail)return;const t=e.next,r=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=r,r.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},29:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),n=r(3),i=r(12),o=r(19),a=r(16),c=r(17);t.generateRandomPipeName=function(){const e=i.randomBytes(21).toString("hex");return"win32"===process.platform?`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`:s.join(n.tmpdir(),`vscode-${e}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let r,s=new Promise((e,t)=>{r=e});return new Promise((n,i)=>{let l=o.createServer(e=>{l.close(),r([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])});l.on("error",i),l.listen(e,()=>{l.removeListener("error",i),n({onConnected:()=>s})})})},t.createServerPipeTransport=function(e,t="utf-8"){const r=o.createConnection(e);return[new a.SocketMessageReader(r,t),new c.SocketMessageWriter(r,t)]}},3:function(e,t){e.exports=require("os")},30:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(19),n=r(16),i=r(17);t.createClientSocketTransport=function(e,t="utf-8"){let r,o=new Promise((e,t)=>{r=e});return new Promise((a,c)=>{let l=s.createServer(e=>{l.close(),r([new n.SocketMessageReader(e,t),new i.SocketMessageWriter(e,t)])});l.on("error",c),l.listen(e,"127.0.0.1",()=>{l.removeListener("error",c),a({onConnected:()=>o})})})},t.createServerSocketTransport=function(e,t="utf-8"){const r=s.createConnection(e,"127.0.0.1");return[new n.SocketMessageReader(r,t),new i.SocketMessageWriter(r,t)]}},37:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(22);t.Progress=new s.NotificationType("progressNotification"),t.Stdout=new s.NotificationType("stdoutNotification"),t.Stderr=new s.NotificationType("stderrNotification"),t.PortResolved=new s.NotificationType("portResolvedNotification"),t.FatalErrorOccured=new s.NotificationType("fatalErrorOccuredNotification"),t.DownloadRequest=new s.RequestType("downloadRequest"),t.MakeDefaultRequest=new s.RequestType("makeDefault"),t.DownloadProgress=new s.ProgressType,t.DownloadLog=new s.ProgressType,function(e){e.ServerScriptError="servererror",e.ServerCloseError="serverclose",e.Timeout="timeout",e.WSLNotFound="wslnotfound",e.WSLUpdateRequired="wslupdaterequired",e.Undefined="undefined"}(t.FailureReason||(t.FailureReason={}))},5:function(e,t,r){"use strict";function s(e){return"string"==typeof e||e instanceof String}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=s,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=n,t.stringArray=function(e){return n(e)&&e.every(e=>s(e))}},6:function(e,t){e.exports=require("child_process")},7:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),n=r(3),i=r(8),o=r(6),a=r(9),c=r(12),l=r(18);function u(){return S()>=17666}function d(){return S()>=19555}function f(){return d()?{env:{PATH:""},stdio:[null,null,null]}:{env:{},stdio:[null,null,null]}}function h(e,t,r){const n=p();if(!n)throw new Error("wsl command not found\n\nMake sure WSL is installed:\nhttps://aka.ms/vscode-remote/wsl/install-wsl");const i=f();for(const e in t)i.env[e]=t[e];let a=[];return u()?a.push("-d",r,"sh","-c",e):"wsl.exe"===s.basename(n).toLowerCase()?a.push("sh","-c",e):a.push("-c",e),o.execFileSync(n,a,i).toString()}function p(){let e=S()>=16299;const t=process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432"),r=process.env.SystemRoot;if(r)return s.join(r,t?"Sysnative":"System32",e?"wsl.exe":"bash.exe")}function g(){const e=process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432"),t=process.env.SystemRoot;if(t)return s.join(t,e?"Sysnative":"System32","lxss","LxssManager.dll")}function m(){const e=process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432"),t=process.env.SystemRoot;if(t)return s.join(t,e?"Sysnative":"System32","wslconfig.exe")}let v,y;function S(){if("number"!=typeof v){const e=/(\d+)\.(\d+)\.(\d+)/g.exec(n.release());v=e&&4===e.length?parseInt(e[3]):0}return v}function _(e,t){return e.length===t.length&&(e===t||e.toLowerCase()===t.toLowerCase())}function w(e){return/^wsl\+/.test(e)}async function E(e){return l.promisify(i.exists)(e)}t.WIN10_2004={label:"Windows 10, May 2020 Update, version 2004",build:19041},t.WIN10_1903={label:"Windows 10, May 2019 Update, version 1903",build:18362},t.WIN10_1803={label:"Windows 10, April 2018 Update, version 1803",build:17134},t.isDistroEnvVarAvailable=function(){return S()>=t.WIN10_1903.build},t.isWSLPathAvailable=function(){return S()>=17046},t.isWSLEnvAvailable=function(){return S()>=17063},t.isExecAndDistroArgumentSupported=u,t.isWSLInExplorerAvailable=function(){return S()>=18342},t.needsPathLengthWorkaround=d,t.getExecSyncOptions=f,t.executeWslPath=function(e,t,r){if(t){return h('echo "$VSCODE_WSL_PATH"',{WSLENV:"VSCODE_WSL_PATH/up",VSCODE_WSL_PATH:e},r).trim()}return h('wslpath -w "$VSCODE_WSL_PATH"',{WSLENV:"VSCODE_WSL_PATH/u",VSCODE_WSL_PATH:e},r).trim()},t.executeCommand=h,t.getWSLExecutablePath=p,t.getLxssManagerDllPath=g,t.isWSLInstalled=async function(){const e=g();return!(!e||!await E(e))},t.getWSLConfigExecutablePath=m,t.getWindowsBuildNumber=S,t.getProductConfiguration=function(e){if(!y){const t=i.readFileSync(s.join(e,"product.json")).toString();y=JSON.parse(t)}return y},t.DEFAULT_AUTHORITY="wsl+default",t.ALPINE_AUTHORITY="wsl+Alpine",t.ALPINE_DISTRO="Alpine",t.getAuthorityFromDistro=function(e){return e?"wsl+"+e:t.DEFAULT_AUTHORITY},t.compareCaseInsensitive=_,t.startsWithCaseInsensitive=function(e,t){return e.substr(0,t.length).toLowerCase()===t.toLowerCase()},t.isEqualAuthority=function(e,t){return _(e,t)},t.isAuthorityWsl=w,t.isDockerDesktopDistro=function(e){return/^docker-desktop(-data)?$/.test(e)},t.getDistroFromAuthority=function(e){if(w(e)){const t=e.substr(4);return"default"===t?void 0:t}throw new Error("authority must start with wsl+")},t.indexOfDistro=function(e,t){for(let r=0;r<e.length;r++)if(_(t,e[r]))return r;return-1},t.getDistros=function(){return new Promise((e,t)=>{const r=m();if(!r)return void t(new Error("Unable to find location of wslconfig.exe"));o.execFile(r,["/list"],{windowsVerbatimArguments:!0,encoding:"utf16le"},(r,s,n)=>{if(r)t(r);else{const t=/\r\n/.test(s)?"\r\n":"\n",r=s.split(t);let n=[];for(let e=1;e<r.length;e++){let t=r[e].match(/^[a-zA-Z0-9\.\-_]+/);t&&n.push(t[0])}e(n)}})})},t.toForwardSlashes=function(e){return e.replace(/[\\/]/g,s.posix.sep)},t.escapeQuotes=function(e){return e.replace(/'/g,"'\"'\"'")},t.escapeForDoubleQuotes=function(e){return e.replace(/["$\\]/g,"\\$&")},t.getDownloadURL=function(e,t){return`${e.updateUrl}/commit:${e.commit||"dev"}/server-linux-${t}/${e.quality||"insider"}`},t.donwloadBuild=async function(e,t,r,n){await async function e(t){await E(t)||(await e(s.dirname(t)),await l.promisify(i.mkdir)(t))}(s.dirname(t));const o=`${t}_${Date.now()}`;return function e(t,r,s,n,o=5,l){return new Promise((u,d)=>{const f=e=>{i.unlink(r,()=>{}),d(e)},h=i.createWriteStream(r);a.get(t,a=>{const p=a.headers["x-sha256"];if(l||"string"!=typeof p||(l=p),o>0&&(a.statusCode>=300&&a.statusCode<=303||307===a.statusCode)){const t=a.headers.location;if(t)return void e(t,r,s,n,o-1,l).then(u,d)}if(a.statusCode<200||a.statusCode>299)return void d(`Failed to download VS Code Server from ${t}: HTTP ${a.statusCode} - ${a.statusMessage}`);n(`Download checksum: ${l}`);const g=parseInt(a.headers["content-length"]||"0");if(g){let e=0,t=0;a.on("data",r=>{e+=r.length,t++%8==0&&s({received:e,total:g})})}a.on("error",f),a.pipe(h),a.on("end",e=>{if(l){const e=c.createHash("sha256"),t=i.createReadStream(r);t.on("readable",()=>{const r=t.read();r?e.update(r):l!==e.digest("hex")?f("Download checksum does not match."):(n("Download checksum verified"),u())})}else u()})}).on("error",f)})}(e,o,r,n).then(e=>l.promisify(i.rename)(o,t).then(e=>t))},t.getServerTarCacheLocation=function(e,t){return s.join(n.tmpdir(),"vscode-remote-wsl",e.commit||"dev",`vscode-server-linux-${t}.tar.gz`)},t.fileExists=E,t.isWSL1=function(e){return-1!==e.indexOf("Microsoft")},t.randomPort=function(){return 1025+Math.floor(64510*Math.random())}},8:function(e,t){e.exports=require("fs")},9:function(e,t){e.exports=require("https")}}));
//# sourceMappingURL=wslDaemon.js.map