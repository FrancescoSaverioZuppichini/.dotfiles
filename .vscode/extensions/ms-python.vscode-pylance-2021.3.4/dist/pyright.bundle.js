exports.id=885,exports.ids=[885],exports.modules={27646:e=>{"use strict";e.exports={}},4397:e=>{"use strict";e.exports=JSON.parse('{"Diagnostic":{"annotatedParamCountMismatch":"Parameter annotation count mismatch: expected {expected} but received {received}","annotatedTypeArgMissing":"Expected one type argument and one or more annotations for \\"Annotated\\"","annotationFormatString":"Type annotations cannot use format string literals (f-strings)","annotationNotSupported":"Type annotation not supported for this type of expression","annotationSpansStrings":"Type annotations cannot span multiple string literals","annotationStringEscape":"Type annotations cannot contain escape characters","annotationTripleQuote":"Type annotations cannot use triple quotes","argAssignment":"Argument of type \\"{argType}\\" cannot be assigned to parameter of type \\"{paramType}\\"","argAssignmentFunction":"Argument of type \\"{argType}\\" cannot be assigned to parameter of type \\"{paramType}\\" in function \\"{functionName}\\"","argAssignmentParam":"Argument of type \\"{argType}\\" cannot be assigned to parameter \\"{paramName}\\" of type \\"{paramType}\\"","argAssignmentParamFunction":"Argument of type \\"{argType}\\" cannot be assigned to parameter \\"{paramName}\\" of type \\"{paramType}\\" in function \\"{functionName}\\"","argMissingForParam":"Argument missing for parameter {name}","argMissingForParams":"Arguments missing for parameters {names}","argMorePositionalExpectedCount":"Expected {expected} more positional arguments","argMorePositionalExpectedOne":"Expected 1 more positional argument","argPositional":"Expected positional argument","argPositionalExpectedCount":"Expected {expected} positional arguments","argPositionalExpectedOne":"Expected 1 positional argument","argTypePartiallyUnknown":"Argument type is partially unknown","argTypeUnknown":"Argument type is unknown","assertAlwaysTrue":"Assert expression always evaluates to true","assignmentExprContext":"Assignment expression must be within module, function or lambda","assignmentExprComprehension":"Assignment expression target \\"{name}\\" cannot use same name as comprehension for target","assignmentInProtocol":"Instance or class variables within a Protocol class must be explicitly declared within the class body","assignmentTargetExpr":"Expression cannot be assignment target","awaitIllegal":"Use of \\"await\\" requires Python 3.5 or newer","awaitNotInAsync":"\\"await\\" allowed only within async function","backticksIllegal":"Expressions surrounded by backticks are not supported in Python 3.x; use repr instead","baseClassCircular":"Class cannot derive from itself","baseClassFinal":"Base class \\"{type}\\" is marked final and cannot be subclassed","baseClassInvalid":"Argument to class must be a base class","baseClassUnknown":"Base class type is unknown, obscuring type of derived class","bindTypeMismatch":"Could not bind method \\"{methodName}\\" because \\"{type}\\" is not assignable to parameter \\"{paramName}\\"","breakOutsideLoop":"\\"break\\" can be used only within a loop","callableExtraArgs":"Expected only two type arguments to \\"Callable\\"","callableFirstArg":"Expected parameter type list or \\"...\\"","callableSecondArg":"Expected return type as second type argument for \\"Callable\\"","casePatternIsIrrefutable":"Irrefutable pattern is allowed only for the last case statement","classDecoratorTypeUnknown":"Untyped class decorator obscures type of class; ignoring decorator","classDefinitionCycle":"Class definition for \\"{name}\\" depends on itself","classGetItemClsParam":"__class_getitem__ override should take a \\"cls\\" parameter","classMethodClsParam":"Class methods should take a \\"cls\\" parameter","classNotRuntimeSubscriptable":"Subscript for class \\"{name}\\" will generate runtime exception; enclose type annotation in quotes","classVarFirstArgMissing":"Expected a type argument after \\"ClassVar\\"","classVarTooManyArgs":"Expected only one type argument after \\"ClassVar\\"","clsSelfParamTypeMismatch":"Type of parameter \\"{name}\\" must be a supertype of its class \\"{classType}\\"","comparisonAlwaysFalse":"Condition will always evaluate to False since the types \\"{leftType}\\" and \\"{rightType}\\" have no overlap","comprehensionInDict":"Comprehension cannot be used with other dictionary entries","comprehensionInSet":"Comprehension cannot be used with other set entries","concatenateParamSpecMissing":"Last type argument for \\"Concatenate\\" must be a ParamSpec","concatenateTypeArgsMissing":"\\"Concatenate\\" requires at least two type arguments","constantRedefinition":"\\"{name}\\" is constant and cannot be redefined","continueInFinally":"\\"continue\\" cannot be used within a finally clause","continueOutsideLoop":"\\"continue\\" can be used only within a loop","constructorNoArgs":"Expected no arguments to \\"{type}\\" constructor","dataClassBaseClassNotFrozen":"A frozen dataclass cannot inherit from a dataclass that is not frozen","dataClassFieldWithDefault":"Dataclass fields without default value cannot appear after data fields with default values","declaredReturnTypePartiallyUnknown":"Declared return type, \\"{returnType}\\", is partially unknown","declaredReturnTypeUnknown":"Declared return type is unknown","defaultValueContainsCall":"Function calls within default value initializer are not permitted","defaultValueNotAllowed":"Parameter with \\"*\\" or \\"**\\" cannot have default value","defaultValueNotEllipsis":"Default values in stub files should be specified as \\"...\\"","delTargetExpr":"Expression cannot be deleted","dictExpandIllegalInComprehension":"Dictionary expansion not allowed in comprehension","dictInAnnotation":"Dictionary expression not allowed in type annotation","dictKeyValuePairs":"Dictionary entries must contain key/value pairs","dictUnpackIsNotMapping":"Expected mapping for dictionary unpack operator","duplicateArgsParam":"Only one \\"*\\" parameter allowed","duplicateBaseClass":"Duplicate base class not allowed","duplicateCatchAll":"Only one catch-all except clause allowed","duplicateImport":"\\"{importName}\\" is imported more than once","duplicateKwargsParam":"Only one \\"**\\" parameter allowed","duplicateNameOnly":"Only one \\"*\\" separator allowed","duplicateParam":"Duplicate parameter \\"{name}\\"","duplicateCapturePatternTarget":"Capture target \\"{name}\\" cannot appear more than once within the same pattern","duplicateStarPattern":"Only one \\"*\\" pattern allowed in a pattern sequence","duplicateStarStarPattern":"Only one \\"**\\" entry allowed","duplicatePositionOnly":"Only one \\"/\\" parameter allowed","duplicateUnpack":"Only one unpack operation allowed in list","ellipsisContext":"\\"...\\" not allowed in this context","ellipsisSecondArg":"\\"...\\" allowed only as the second of two arguments","exceptionTypeIncorrect":"\\"{type}\\" does not derive from BaseException","exceptionTypeNotClass":"\\"{type}\\" is not valid exception class","exceptionTypeNotInstantiable":"Constructor for exception type \\"{type}\\" requires one or more arguments","expectedAfterDecorator":"Expected function or class declaration after decorator","expectedArrow":"Expected \\"->\\" followed by return type annotation","expectedAsAfterException":"Expected \\"as\\" after exception type","expectedAssignRightHandExpr":"Expected expression to the right of \\"=\\"","expectedBinaryRightHandExpr":"Expected expression to the right of operator","expectedBoolLiteral":"Expected True or False","expectedCase":"Expected \\"case\\" statement","expectedClassName":"Expected class name","expectedCloseBrace":"Expected \\"}\\"","expectedCloseBracket":"Expected \\"]\\"","expectedCloseParen":"Expected \\")\\"","expectedColon":"Expected \\":\\"","expectedComplexNumberLiteral":"Expected complex number literal for pattern matching","expectedDecoratorExpr":"Expression form not supported for decorator prior to Python 3.9","expectedDecoratorName":"Expected decorator name","expectedDecoratorNewline":"Expected new line at end of decorator","expectedDelExpr":"Expected expression after \\"del\\"","expectedElse":"Expected \\"else\\"","expectedExceptionClass":"Invalid exception class or object","expectedExceptionObj":"Expected exception object or None","expectedExpr":"Expected expression","expectedIdentifier":"Expected identifier","expectedImport":"Expected \\"import\\"","expectedImportAlias":"Expected symbol after \\"as\\"","expectedImportSymbols":"Expected one or more symbol names after import","expectedIndentedBlock":"Expected indented block","expectedInExpr":"Expected expression after \\"in\\"","expectedIn":"Expected \\"in\\"","expectedFunctionAfterAsync":"Expected function definition after \\"async\\"","expectedFunctionName":"Expected function name after \\"def\\"","expectedMemberName":"Expected member name after \\".\\"","expectedModuleName":"Expected module name","expectedNameAfterAs":"Expected symbol name after \\"as\\"","expectedNamedParameter":"Keyword parameter must follow \\"*\\"","expectedNewline":"Expected newline","expectedNewlineOrSemicolon":"Statements must be separated by newlines or semicolons","expectedOpenParen":"Expected \\"(\\"","expectedParamName":"Expected parameter name","expectedPatternExpr":"Expected pattern expression","expectedPatternSubjectExpr":"Expected pattern subject expression","expectedPatternValue":"Expected pattern value expression of the form \\"a.b\\"","expectedReturnExpr":"Expected expression after \\"return\\"","expectedSliceIndex":"Expected index or slice expression","expectedTypeNotString":"Expected type but received a string literal","expectedYieldExpr":"Expected expression in yield statement","finalContext":"\\"Final\\" not allowed in this context","finalMethodOverride":"Method \\"{name}\\" cannot override final method defined in class \\"{className}\\"","finalReassigned":"\\"{name}\\" is declared as Final and cannot be reassigned","finalRedeclaration":"\\"{name}\\" was previously declared as Final","finalRedeclarationBySubclass":"\\"{name}\\" cannot be redeclared because parent class \\"{className}\\" declares it as Final","finalTooManyArgs":"Expected a single type argument after \\"Final\\"","finalUnassigned":"\\"{name}\\" is declared Final, but value is not assigned","formatStringBrace":"Single close brace not allowed within f-string literal; use double close brace","formatStringBytes":"Format string literals (f-strings) cannot be binary","formatStringEscape":"Escape sequence (backslash) not allowed in expression portion of f-string","formatStringInPattern":"Format string not allowed in pattern","formatStringUnicode":"Format string literals (f-strings) cannot be unicode","formatStringIllegal":"Format string literals (f-strings) require Python 3.6 or newer","formatStringUnterminated":"Unterminated expression in f-string; missing close brace","functionDecoratorTypeUnknown":"Untyped function decorator obscures type of function; ignoring decorator","generatorAsyncReturnType":"Return type of async generator function must be \\"AsyncGenerator\\" or \\"AsyncIterable\\"","generatorSyncReturnType":"Return type of generator function must be \\"Generator\\" or \\"Iterable\\"","genericClassAssigned":"Generic class type cannot be assigned","genericClassDeleted":"Generic class type cannot be deleted","genericNotAllowed":"\\"Generic\\" is not valid in this context","genericTypeArgMissing":"\\"Generic\\" requires at least one type argument","genericTypeArgTypeVar":"Type argument for \\"Generic\\" must be a type variable","genericTypeArgUnique":"Type arguments for \\"Generic\\" must be unique","globalReassignment":"\\"{name}\\" is assigned before global declaration","globalRedefinition":"\\"{name}\\" was already declared global","implicitStringConcat":"Implicit string concatenation not allowed","importCycleDetected":"Cycle detected in import chain","importDepthExceeded":"Import chain depth exceeded {depth}","importResolveFailure":"Import \\"{importName}\\" could not be resolved","importSourceResolveFailure":"Import \\"{importName}\\" could not be resolved from source","importSymbolUnknown":"\\"{name}\\" is unknown import symbol","incompatibleMethodOverride":"Method \\"{name}\\" overrides class \\"{className}\\" in an incompatible manner","inconsistentIndent":"Unindent amount does not match previous indent","inconsistentTabs":"Inconsistent use of tabs and spaces in indentation","initSubclassClsParam":"__init_subclass__ override should take a \\"cls\\" parameter","instanceMethodSelfParam":"Instance methods should take a \\"self\\" parameter","internalBindError":"An internal error occurred while binding file \\"{file}\\": {message}","internalParseError":"An internal error occurred while parsing file \\"{file}\\": {message}","internalTypeCheckingError":"An internal error occurred while type checking file \\"{file}\\": {message}","invalidIdentifierChar":"Invalid character in identifier","invalidStubStatement":"Statement is meaningless within a type stub file","invalidTokenChars":"Invalid character in token \\"{text}\\"","isInstanceInvalidType":"Second argument to \\"isinstance\\" must be a class or tuple of classes","isSubclassInvalidType":"Second argument to \\"issubclass\\" must be a class or tuple of classes","keyValueInSet":"Key/value pairs are not allowed within a set","keywordArgInTypeArgument":"Keyword arguments cannot be used in type argument lists","keywordSubscriptIllegal":"Keyword arguments within subscripts requires Python 3.10 or newer","lambdaReturnTypeUnknown":"Return type of lambda is unknown","lambdaReturnTypePartiallyUnknown":"Return type of lambda, \\"{returnType}\\", is partially unknown","listInAnnotation":"List expression not allowed in type annotation","literalUnsupportedType":"Type arguments for \\"Literal\\" must be None, a literal value (int, bool, str, or bytes), or an enum value","literalEmptyArgs":"Expected one or more type arguments after \\"Literal\\"","literalNotCallable":"Literal type cannot be instantiated","matchIncompatible":"Match statements require Python 3.10 or newer","memberAccess":"Cannot access member \\"{name}\\" for type \\"{type}\\"","memberDelete":"Cannot delete member \\"{name}\\" for type \\"{type}\\"","memberSet":"Cannot assign member \\"{name}\\" for type \\"{type}\\"","metaclassConflict":"The metaclass of a derived class must be a subclass of the metaclasses of all its base classes","metaclassDuplicate":"Only one metaclass can be provided","methodNotDefined":"\\"{name}\\" method not defined","methodNotDefinedOnType":"\\"{name}\\" method not defined on type \\"{type}\\"","methodOrdering":"Cannot create consistent method ordering","methodOverridden":"\\"{name}\\" overrides method of same name in class \\"{className}\\" with incompatible type \\"{type}\\"","methodReturnsNonObject":"\\"{name}\\" method does not return an object","moduleContext":"Module not allowed in this context","moduleUnknownMember":"\\"{name}\\" is not a known member of module","namedExceptAfterCatchAll":"A named except clause cannot appear after catch-all except clause","namedParamAfterParamSpecArgs":"Keyword parameter \\"{name}\\" cannot appear in signature after ParamSpec args parameter","namedTupleEmptyName":"Names within a named tuple cannot be empty","namedTupleMultipleInheritance":"Multiple inheritance with NamedTuple is not supported","namedTupleFirstArg":"Expected named tuple class name as first argument","namedTupleNameString":"Expected string literal for tuple entry name","namedTupleNameType":"Expected two-entry tuple specifying entry name and type","namedTupleNameUnique":"Names within a named tuple must be unique","namedTupleNoTypes":"\\"namedtuple\\" provides no types for tuple entries; use \\"NamedTuple\\" instead","namedTupleSecondArg":"Expected named tuple entry list as second argument","newClsParam":"__new__ override should take a \\"cls\\" parameter","newTypeLiteral":"NewType cannot be used with Literal type","newTypeNotAClass":"Expected class as second argument to NewType","newTypeProtocolClass":"NewType cannot be used with protocol class","nonDefaultAfterDefault":"Non-default argument follows default argument","noneNotCallable":"Object of type \\"None\\" cannot be called","noneNotIterable":"Object of type \\"None\\" cannot be used as iterable value","noneOperator":"Operator \\"{operator}\\" not supported for \\"None\\"","noneNotSubscriptable":"Object of type \\"None\\" is not subscriptable","noneNotUsableWith":"Object of type \\"None\\" cannot be used with \\"with\\"","noneUnknownMember":"\\"{name}\\" is not a known member of \\"None\\"","nonLocalNoBinding":"No binding for nonlocal \\"{name}\\" found","nonLocalReassignment":"\\"{name}\\" is assigned before nonlocal declaration","nonLocalRedefinition":"\\"{name}\\" was already declared nonlocal","nonLocalInModule":"Nonlocal declaration not allowed at module level","noOverload":"No overloads for \\"{name}\\" match the provided arguments","noReturnContainsReturn":"Function with declared return type \\"NoReturn\\" cannot include a return statement","noReturnContainsYield":"Function with declared return type \\"NoReturn\\" cannot include a yield statement","noReturnReturnsNone":"Function with declared type of \\"NoReturn\\" cannot return \\"None\\"","notRequiredArgCount":"Expected a single type argument after \\"NotRequired\\"","notRequiredNotInTypedDict":"\\"NotRequired\\" is allowed only within TypedDict","objectNotCallable":"Object of type \\"{type}\\" is not callable","obscuredClassDeclaration":"Class declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredFunctionDeclaration":"Function declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredMethodDeclaration":"Method declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredParameterDeclaration":"Parameter declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredVariableDeclaration":"Declaration \\"{name}\\" is obscured by a declaration of the same name","operatorLessOrGreaterDeprecated":"Operator \\"<>\\" is not supported in Python 3; use \\"!=\\" instead","optionalExtraArgs":"Expected one type argument after \\"Optional\\"","orPatternIrrefutable":"Irrefutable pattern allowed only as the last subpattern in an \\"or\\" pattern","orPatternMissingName":"All subpatterns within an \\"or\\" pattern must target the same names","overlappingOverload":"Overload {obscured} for \\"{name}\\" will never be used because its parameters overlap overload {obscuredBy}","overloadAbstractMismatch":"Overloaded methods must all be abstract or not","overloadImplementationMismatch":"Overloaded function implementation is not consistent with signature of overload {index}","overloadReturnTypeMismatch":"Overload {prevIndex} for \\"{name}\\" overlaps overload {newIndex} and returns an incompatible type","overloadWithoutImplementation":"\\"{name}\\" is marked as overload, but no implementation is provided","paramAfterKwargsParam":"Parameter cannot follow \\"**\\" parameter","paramAlreadyAssigned":"Parameter \\"{name}\\" is already assigned","paramNameMissing":"No parameter named \\"{name}\\"","paramSpecArgsKwargsUsage":"\\"args\\" and \\"kwargs\\" members of ParamSpec must both appear within a function signature","paramSpecArgsUsage":"\\"args\\" member of ParamSpec is valid only when used with *args parameter","paramSpecAssignedName":"ParamSpec must be assigned to a variable named \\"{name}\\"","paramSpecContext":"ParamSpec not allowed in this context","paramSpecFirstArg":"Expected name of ParamSpec as first argument","paramSpecIllegal":"ParamSpec requires Python 3.10 or newer","paramSpecKwargsUsage":"\\"kwargs\\" member of ParamSpec is valid only when used with **kwargs parameter","paramSpecNotBound":"Param spec \\"{type}\\" has no bound value","paramSpecNotUsedByOuterScope":"ParamSpec \\"{name}\\" has no meaning in this context","paramSpecUnknownArg":"ParamSpec does not support more than one argument","paramSpecUnknownMember":"\\"{name}\\" is not a known member of ParamSpec","paramSpecUnknownParam":"\\"{name}\\" is unknown parameter to ParamSpec","paramAssignmentMismatch":"Expression of type \\"{sourceType}\\" cannot be assigned to parameter of type \\"{paramType}\\"","paramTypeCovariant":"Covariant type variable cannot be used in parameter type","paramTypeUnknown":"Type of parameter \\"{paramName}\\" is unknown","paramTypePartiallyUnknown":"Type of parameter \\"{paramName}\\" is partially unknown","parenthesizedContextManagerIllegal":"Parentheses within \\"with\\" statement requires Python 3.10 or newer","positionArgAfterNamedArg":"Positional argument cannot appear after keyword arguments","positionOnlyAfterNameOnly":"\\"/\\" parameter must appear before \\"*\\" parameter","positionOnlyIncompatible":"Position-only argument separator requires Python 3.8 or newer","positionOnlyFirstParam":"Position-only argument separator not allowed as first parameter","privateUsedOutsideOfClass":"\\"{name}\\" is private and used outside of the class in which it is declared","privateUsedOutsideOfModule":"\\"{name}\\" is private and used outside of the module in which it is declared","propertyOverridden":"\\"{name}\\" incorrectly overrides property of same name in class \\"{className}\\"","propertyStaticMethod":"Static methods not allowed for property getter, setter or deleter","protectedUsedOutsideOfClass":"\\"{name}\\" is protected and used outside of the class in which it is declared","protocolBaseClass":"Protocol class \\"{classType}\\" cannot derive from non-protocol class \\"{baseType}\\"","protocolIllegal":"Use of \\"Protocol\\" requires Python 3.7 or newer","protocolVarianceContravariant":"Type variable \\"{variable}\\" used in generic protocol \\"{class}\\" should be contravariant","protocolVarianceCovariant":"Type variable \\"{variable}\\" used in generic protocol \\"{class}\\" should be covariant","protocolVarianceInvariant":"Type variable \\"{variable}\\" used in generic protocol \\"{class}\\" should be invariant","protocolUsedInCall":"Protocol class cannot be used in \\"{name}\\" call","raiseParams":"\\"raise\\" requires one or more parameters when used outside of except clause","relativeImportNotAllowed":"Relative imports cannot be used with \\"import .a\\" form; use \\"from . import a\\" instead","recursiveDefinition":"Type of \\"{name}\\" could not be determined because it refers to itself","requiredArgCount":"Expected a single type argument after \\"Required\\"","requiredNotInTypedDict":"\\"Required\\" is allowed only within TypedDict","returnOutsideFunction":"\\"return\\" can be used only within a function","returnMissing":"Function with declared type of \\"{returnType}\\" must return value","returnTypeContravariant":"Contravariant type variable cannot be used in return type","returnTypeMismatch":"Expression of type \\"{exprType}\\" cannot be assigned to return type \\"{returnType}\\"","returnTypeUnknown":"Return type is unknown","returnTypePartiallyUnknown":"Return type, \\"{returnType}\\", is partially unknown","revealLocalsArgs":"Expected no arguments for \\"reveal_locals\\" call","revealLocalsNone":"No locals in this scope","revealTypeArgs":"Expected a single positional argument for \\"reveal_type\\" call","setterGetterTypeMismatch":"Property setter value type is not assignable to the getter return type","singleOverload":"\\"{name}\\" is marked as overload, but additional overloads are missing","starPatternInAsPattern":"Star pattern cannot be used with \\"as\\" target","starPatternInOrPattern":"Star pattern cannot be ORed within other patterns","starStarWildcardNotAllowed":"** cannot be used with wildcard \\"_\\"","staticClsSelfParam":"Static methods should not take a \\"self\\" or \\"cls\\" parameter","stringNonAsciiBytes":"Non-ASCII character not allowed in bytes string literal","stringNotSubscriptable":"String expression cannot be subscripted in type annotation; enclose entire annotation in quotes","stringUnsupportedEscape":"Unsupported escape sequence in string literal","stringUnterminated":"String literal is unterminated","stubFileMissing":"Stub file not found for \\"{importName}\\"","stubUsesGetAttr":"Type stub file is incomplete; \\"__getattr__\\" obscures type errors for module","sublistParamsIncompatible":"Sublist parameters are not supported in Python 3.x","superCallArgCount":"Expected no more than two arguments to \\"super\\" call","superCallFirstArg":"Expected class type as first argument to \\"super\\" call but received \\"{type}\\"","superCallSecondArg":"Second argument to \\"super\\" call must be object or class that derives from \\"{type}\\"","superCallZeroArgForm":"Zero-argument form of \\"super\\" call is valid only within a class","symbolIsUnbound":"\\"{name}\\" is unbound","symbolIsUndefined":"\\"{name}\\" is not defined","symbolIsPossiblyUnbound":"\\"{name}\\" is possibly unbound","symbolOverridden":"\\"{name}\\" overrides symbol of same name in class \\"{className}\\"","tryWithoutExcept":"Try statement must have at least one except or finally clause","tupleInAnnotation":"Tuple expression not allowed in type annotation","tupleIndexOutOfRange":"Index {index} is out of range for tuple with length {length}","tupleSizeMismatch":"Tuple size mismatch: expected {expected} but received {received}","typeAbstract":"Cannot instantiate abstract class \\"{type}\\"","typeAliasIsRecursive":"Type alias \\"{name}\\" cannot use itself in its definition","typeAliasNotInModule":"A TypeAlias can be defined only within a module scope","typeAliasRedeclared":"\\"{name}\\" is declared as a TypeAlias and can be assigned only once","typeArgListNotAllowed":"List expression not allowed for this type argument","typeAnnotationCall":"Illegal type annotation: call expression not allowed","typeAnnotationVariable":"Illegal type annotation: variable not allowed unless it is a type alias","typeArgsExpectingNone":"Expected no type arguments","typeArgsMismatchOne":"Expected one type argument but received {received}","typeArgsMissingForAlias":"Expected type arguments for generic type alias \\"{name}\\"","typeArgsMissingForClass":"Expected type arguments for generic class \\"{name}\\"","typeArgsTooFew":"Too few type arguments provided for class \\"{name}\\"; expected {expected} but received {received}","typeArgsTooMany":"Too many type arguments provided for class \\"{name}\\"; expected {expected} but received {received}","typeAssignmentMismatch":"Expression of type \\"{sourceType}\\" cannot be assigned to declared type \\"{destType}\\"","typeCallNotAllowed":"type() call should not be used in type annotation","typedDictAccess":"Could not access item in TypedDict","typedDictBadVar":"TypedDict classes can contain only type annotations","typedDictBaseClass":"All base classes for \\"TypedDict\\" classes must also be \\"TypedDict\\" classes","typedDictDelete":"Could not delete item in TypedDict","typedDictEmptyName":"Names within a TypedDict cannot be empty","typedDictEntryName":"Expected string literal for dictionary entry name","typedDictEntryUnique":"Names within a dictionary must be unique","typedDictExtraArgs":"Extra TypedDict arguments not supported","typedDictFieldRedefinition":"Type of TypedDict field \\"{name}\\" cannot be redefined","typedDictFirstArg":"Expected TypedDict class name as first argument","typedDictSecondArgDict":"Expected dict or keyword parameter as second parameter","typedDictSecondArgDictEntry":"Expected simple dictionary entry","typedDictSet":"Could not assign item in TypedDict","typedDictTotalParam":"Expected \\"total\\" parameter to have a value of True or False","typeExpectedClass":"Expected class type but received \\"{type}\\"","typeGuardArgCount":"Expected a single type argument after \\"TypeGuard\\"","typeNotAwaitable":"\\"{type}\\" is not awaitable","typeNotCallable":"\\"{expression}\\" has type \\"{type}\\" and is not callable","typeNotIntantiable":"\\"{type}\\" cannot be instantiated","typeNotIterable":"\\"{type}\\" is not iterable","typeNotSpecializable":"Could not specialize type \\"{type}\\"","typeNotSubscriptable":"Object of type \\"{type}\\" is not subscriptable","typeNotUsableWith":"Object of type \\"{type}\\" cannot be used with \\"with\\" because it does not implement {method}","typeNotSupportBinaryOperator":"Operator \\"{operator}\\" not supported for types \\"{leftType}\\" and \\"{rightType}\\"","typeNotSupportUnaryOperator":"Operator \\"{operator}\\" not supported for type \\"{type}\\"","typePartiallyUnknown":"Type of \\"{name}\\" is partially unknown","typeUnknown":"Type of \\"{name}\\" is unknown","typeVarAssignedName":"TypeVar must be assigned to a variable named \\"{name}\\"","typeVarAssignmentMismatch":"Type \\"{type}\\" cannot be assigned to type variable \\"{name}\\"","typeVarBoundAndConstrained":"TypeVar cannot be both bound and constrained","typeVarFirstArg":"Expected name of TypeVar as first argument","typeVarGeneric":"TypeVar bound type cannot be generic","typeVarNoMember":"TypeVar \\"{type}\\" has no member \\"{name}\\"","typeVarNotSubscriptable":"TypeVar \\"{type}\\" is not subscriptable","typeVarNotUsedByOuterScope":"Type variable \\"{name}\\" has no meaning in this context","typeVarSingleConstraint":"TypeVar cannot have only a single constraint","typeVarTupleContext":"TypeVarTuple not allowed in this context","typeVarUnknownParam":"\\"{name}\\" is unknown parameter to TypeVar","typeVarUsedByOuterScope":"TypeVar \\"{name}\\" is already in use by an outer scope","typeVarUsedOnlyOnce":"TypeVar \\"{name}\\" appears only once in generic function signature","typeVarVariance":"TypeVar cannot be both covariant and contravariant","unaccessedClass":"Class \\"{name}\\" is not accessed","unaccessedFunction":"Function \\"{name}\\" is not accessed","unaccessedImport":"Import \\"{name}\\" is not accessed","unaccessedSymbol":"\\"{name}\\" is not accessed","unaccessedVariable":"Variable \\"{name}\\" is not accessed","unexpectedAsyncToken":"Expected \\"def\\", \\"with\\" or \\"for\\" to follow \\"async\\"","unexpectedExprToken":"Unexpected token at end of expression","unexpectedIndent":"Unexpected indentation","unexpectedUnindent":"Unindent not expected","unionSyntaxIllegal":"Alternative syntax for unions requires Python 3.10 or newer","unnecessaryCast":"Unnecessary \\"cast\\" call; type is already \\"{type}\\"","unnecessaryIsInstanceAlways":"Unnecessary isinstance call; \\"{testType}\\" is always an instance of \\"{classType}\\"","unnecessaryIsInstanceNever":"Unnecessary isinstance call; \\"{testType}\\" is never an instance of \\"{classType}\\"","unnecessaryIsSubclassAlways":"Unnecessary issubclass call; \\"{testType}\\" is always a subclass of \\"{classType}\\"","unnecessaryIsSubclassNever":"Unnecessary issubclass call; \\"{testType}\\" is never a subclass of \\"{classType}\\"","unpackArgCount":"Expected a single type argument after \\"Unpack\\"","unpackedArgInTypeArgument":"Unpacked arguments cannot be used in type argument lists","unpackedArgWithVariadicParam":"Unpacked argument cannot be used for TupleTypeVar parameter","unpackedDictArgumentNotMapping":"Argument expression after ** must be a mapping with a \\"str\\" key type","unpackedSubscriptIllegal":"Unpack operator in subscript requires Python 3.10 or newer","unpackedTypeVarTupleExpected":"Expected unpacked TypeVarTuple; use Unpack[{name1}] or *{name2}","unpackExpectedTypeVarTuple":"Expected TypeVarTuple as type argument for Unpack","unpackIllegalInComprehension":"Unpack operation not allowed in comprehension","unpackInDict":"Unpack operation not allowed in dictionaries","unpackInSet":"Unpack operator not allowed within a set","unpackNotAllowed":"Unpack operation not allowed in this context","unpackTuplesIllegal":"Unpack operation not allowed in tuples prior to Python 3.8","unreachableCode":"Code is unreachable","unsupportedDunderAllOperation":"Operation on \\"__all__\\" is not supported, so exported symbol list may not be incorrect","unusedCallResult":"Result of call expression is of type \\"{type}\\" and is not used; assign to variable \\"_\\" if this is intentional","unusedCoroutine":"Result of async function call is not used; use \\"await\\" or assign result to variable","varAnnotationIllegal":"Type annotations for variables requires Python 3.6 or newer; use type comment for compatibility with previous versions","variadicTypeArgsTooMany":"Type argument list can have at most one unpacked TypeVarTuple","variadicTypeParamTooManyAlias":"Type alias can have at most one TypeVarTuple type parameter but received multiple ({names})","variadicTypeParamTooManyClass":"Generic class can have at most one TypeVarTuple type parameter but received multiple ({names})","walrusIllegal":"Operator \\":=\\" requires Python 3.8 or newer","walrusNotAllowed":"Operator \\":=\\" not allowed in this context","wildcardInFunction":"Wildcard import not allowed within a class or function","wildcardLibraryImport":"Wildcard import from a library not allowed","yieldFromIllegal":"Use of \\"yield from\\" requires Python 3.3 or newer","yieldFromOutsideAsync":"\\"yield from\\" not allowed in an async function","yieldOutsideFunction":"\\"yield\\" not allowed outside of a function or lambda","yieldTypeMismatch":"Expression of type \\"{exprType}\\" cannot be assigned to yield type \\"{yieldType}\\"","yieldWithinListCompr":"\\"yield\\" not allowed inside a list comprehension","zeroCaseStatementsFound":"Match statement must include at least one case statement","zeroLengthTupleNotAllowed":"Zero-length tuple not allowed in this context"},"DiagnosticAddendum":{"argParam":"Argument corresponds to parameter \\"{paramName}\\"","argParamFunction":"Argument corresponds to parameter \\"{paramName}\\" in function \\"{functionName}\\"","argsParamMissing":"Parameter *{paramName} has no corresponding parameter","argsParamWithVariadic":"Parameter *{paramName} is incompatible with TypeVarTuple","argumentType":"Argument type is \\"{type}\\"","argumentTypes":"Argument types: ({types})","assignToNone":"Cannot assign to \\"None\\"","asyncHelp":"Did you mean \\"async with\\"?","dataclassFrozen":"Dataclass \\"{name}\\" is frozen","finalMethod":"Final method","keyNotRequired":"\\"{name}\\" is not a required key in \\"{type}\\", so access may result in runtime exception","keyRequiredDeleted":"\\"{name}\\" is a required key and cannot be deleted","keyUndefined":"\\"{name}\\" is not a defined key in \\"{type}\\"","functionParamName":"Parameter name mismatch: \\"{destName}\\" versus \\"{srcName}\\"","functionReturnTypeMismatch":"Function return type \\"{sourceType}\\" is incompatible with type \\"{destType}\\"","functionTooFewParams":"Function accepts too few positional parameters; expected {expected} but received {received}","functionTooManyParams":"Function accepts too many positional parameters; expected {expected} but received {received}","incompatibleGetter":"Property getter method is incompatible","incompatibleSetter":"Property setter method is incompatible","incompatibleDeleter":"Property deleter method is incompatible","literalAssignmentMismatch":"\\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","memberSetClassVar":"Member \\"{name}\\" cannot be assigned through a class instance because it is a ClassVar","memberAssignment":"Expression of type \\"{type}\\" cannot be assigned to member \\"{name}\\" of class \\"{classType}\\"","memberIsAbstract":"\\"{type}.{name}\\" is abstract","memberIsAbstractMore":"and {count} more...","memberTypeMismatch":"\\"{name}\\" is an incompatible type","memberUnknown":"Member \\"{name}\\" is unknown","missingGetter":"Property getter method is missing","missingSetter":"Property setter method is missing","missingDeleter":"Property deleter method is missing","namedParamMissingInDest":"Keyword parameter \\"{name}\\" is missing in destination","namedParamMissingInSource":"Keyword parameter \\"{name}\\" is missing in source","namedParamTypeMismatch":"Keyword parameter \\"{name}\\" of type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","noOverloadAssignable":"No overloaded function matches type \\"{type}\\"","orPatternMissingName":"Missing names: {name}","overloadMethod":"Overload method is defined here","overloadNotAssignable":"One or more overloads of \\"{name}\\" is not assignable","overriddenMethod":"Overridden method","overriddenSymbol":"Overridden symbol","overrideParamCount":"Parameter count mismatch; base method has {baseCount}, but override has {overrideCount}","overrideParamName":"Parameter {index} name mismatch: base parameter is named \\"{baseName}\\", override parameter is named \\"{overrideName}\\"","overrideParamType":"Parameter {index} type mismatch: base parameter is type \\"{baseType}\\", override parameter is type \\"{overrideType}\\"","overrideReturnType":"Return type mismatch: base method returns type \\"{baseType}\\", override returns type \\"{overrideType}\\"","overrideType":"Base class defines type as \\"{type}\\"","paramAssignment":"Parameter {index}: type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","paramSpecOverload":"ParamSpec cannot be used with overloaded function","paramType":"Parameter type is \\"{paramType}\\"","propertyMethodIncompatible":"Property method \\"{name}\\" is incompatible","propertyMethodMissing":"Property method \\"{name}\\" is missing in override","propertyMissingDeleter":"Property \\"{name}\\" has no defined deleter","propertyMissingSetter":"Property \\"{name}\\" has no defined setter","protocolMemberMissing":"\\"{name}\\" is not present","protocolMemberClassVar":"\\"{name}\\" is not a class variable","seeDeclaration":"See declaration","seeClassDeclaration":"See class declaration","seeFunctionDeclaration":"See function declaration","seeMethodDeclaration":"See method declaration","seeParameterDeclaration":"See parameter declaration","seeVariableDeclaration":"See variable declaration","tupleEntryTypeMismatch":"Tuple entry {entry} is incorrect type","tupleSizeMismatch":"Tuple size mismatch; expected {expected} but received {received}","tupleSizeMismatchIndeterminate":"Tuple size mismatch; expected {expected} but received indeterminate number","typeAssignmentMismatch":"Type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","typeBound":"Type \\"{sourceType}\\" is incompatible with bound type \\"{destType}\\" for type variable \\"{name}\\"","typeConstrainedTypeVar":"Type \\"{type}\\" is incompatible with constrained type variable \\"{name}\\"","typedDictFieldMissing":"\\"{name}\\" is missing from \\"{type}\\"","typedDictFieldNotRequired":"\\"{name}\\" is not required in \\"{type}\\"","typedDictFieldRequired":"\\"{name}\\" is required in \\"{type}\\"","typedDictFieldTypeMismatch":"Type \\"{type}\\" is not assignable to field \\"{name}\\"","typedDictFieldRedefinition":"Type in parent class is \\"{parentType}\\" and type in child class is \\"{childType}\\"","typedDictFieldUndefined":"\\"{name}\\" is an undefined field in type \\"{type}\\"","typeIncompatible":"\\"{sourceType}\\" is incompatible with \\"{destType}\\"","typeNotCallable":"Type \\"{type}\\" is not callable","typeNotClass":"\\"{type}\\" is not a class","typeParamSpec":"Type \\"{type}\\" is incompatible with ParamSpec \\"{name}\\"","typeNotStringLiteral":"\\"{type}\\" is not a string literal","typeOfSymbol":"Type of \\"{name}\\" is \\"{type}\\"","typeUnsupported":"Type \\"{type}\\" is unsupported","typeVarIsContravariant":"TypeVar \\"{name}\\" is contravariant","typeVarIsCovariant":"TypeVar \\"{name}\\" is covariant","typeVarIsInvariant":"TypeVar \\"{name}\\" is invariant","typeVarNotAllowed":"TypeVar or generic type with type arguments not allowed","typeVarTupleRequiresKnownLength":"TypeVarTuple cannot be bound to a tuple of unknown length","useDictInstead":"Use Dict[T1, T2] to indicate a dictionary type","useListInstead":"Use List[T] to indicate a list type or Union[T1, T2] to indicate a union type","useTupleInstead":"Use Tuple[T1, ..., Tn] to indicate a tuple type or Union[T1, T2] to indicate a union type","useTypeInstead":"Use Type[T] instead"},"CodeAction":{"addOptionalToAnnotation":"Add \\"Optional\\" to Type Annotation","createTypeStub":"Create Type Stub","createTypeStubFor":"Create Type Stub For \\"{moduleName}\\"","executingCommand":"Executing command","filesToAnalyzeOne":"1 file to analyze","filesToAnalyzeCount":"{count} files to analyze","findingReferences":"Finding references","organizeImports":"Organize Imports"}}')},3608:e=>{"use strict";e.exports={}},36181:e=>{"use strict";e.exports={}},22811:e=>{"use strict";e.exports={}},66483:e=>{"use strict";e.exports={}},37568:e=>{"use strict";e.exports={}},61162:e=>{"use strict";e.exports={}},82048:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveAliasDeclaration=void 0,t.resolveAliasDeclaration=function e(t,n,i){let s=n;const r=[];for(;;){if(6!==s.type)return s;if(!s.symbolName)return s;if(!i&&s.usesLocalName)return s;let a;s.path&&(a=t(s.path));const o=a?a.symbolTable.get(s.symbolName):void 0;if(!o)return s.submoduleFallback?e(t,s.submoduleFallback,i):void 0;let l=o.getTypedDeclarations();if(0===l.length&&(l=o.getDeclarations(),0===l.length))return;if(s=l[l.length-1],r.find((e=>e===s)))return n;r.push(s)}}},20166:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeProgram=t.nullCallback=void 0;const a=n(38213),o=r(n(20823)),l=n(76962);t.nullCallback=e=>{},t.analyzeProgram=function(e,n,i,s,r,c){let p=!1;s=null!=s?s:t.nullCallback;try{a.throwIfCancellationRequested(c);const t=new l.Duration;p=e.analyze(n,c);const r=e.getFilesToAnalyzeCount();o.assert(0===r||p);const u=e.getDiagnostics(i),d=u.length,h=t.getDurationInSeconds();(d>0||!p)&&s({diagnostics:u,filesInProgram:e.getFileCount(),filesRequiringAnalysis:r,checkingOnlyOpenFiles:e.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:h})}catch(e){if(a.OperationCanceledException.is(e))return!1;const t=o.getErrorString(e);r.error("Error performing analysis: "+t),s({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!0,configParseErrorOccurred:!1,elapsedTime:0,error:o.getSerializableError(e)})}return p}},35696:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCodeUnreachable=t.setDunderAllNames=t.getDunderAllNames=t.setCodeFlowExpressions=t.getCodeFlowExpressions=t.setFileInfo=t.getFileInfo=t.setAfterFlowNode=t.getAfterFlowNode=t.setFlowNode=t.getFlowNode=t.setDeclaration=t.getDeclaration=t.setScope=t.getScope=t.setImportInfo=t.getImportInfo=t.cleanNodeAnalysisInfo=void 0;const i=n(24394);function s(e){return e.flowNode}t.cleanNodeAnalysisInfo=function(e){const t=e;delete t.scope,delete t.declaration,delete t.flowNode,delete t.afterFlowNode,delete t.fileInfo},t.getImportInfo=function(e){return e.importInfo},t.setImportInfo=function(e,t){e.importInfo=t},t.getScope=function(e){return e.scope},t.setScope=function(e,t){e.scope=t},t.getDeclaration=function(e){return e.declaration},t.setDeclaration=function(e,t){e.declaration=t},t.getFlowNode=s,t.setFlowNode=function(e,t){e.flowNode=t},t.getAfterFlowNode=function(e){return e.afterFlowNode},t.setAfterFlowNode=function(e,t){e.afterFlowNode=t},t.getFileInfo=function(e){return e.fileInfo},t.setFileInfo=function(e,t){e.fileInfo=t},t.getCodeFlowExpressions=function(e){return e.codeFlowExpressions},t.setCodeFlowExpressions=function(e,t){e.codeFlowExpressions=t},t.getDunderAllNames=function(e){return e.dunderAllNames},t.setDunderAllNames=function(e,t){e.dunderAllNames=t},t.isCodeUnreachable=function(e){let t=e;for(;t;){const e=s(t);if(e)return!!(e.flags&i.FlowFlags.Unreachable);t=t.parent}return!1}},47041:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundAnalysisProgram=void 0;const s=n(20166),r=n(73054);t.BackgroundAnalysisProgram=class{constructor(e,t,n,i,s,a){this._console=e,this._configOptions=t,this._importResolver=n,this._program=new r.Program(this._importResolver,this._configOptions,this._console,i),this._backgroundAnalysis=s,this._maxAnalysisTime=a}get configOptions(){return this._configOptions}get importResolver(){return this._importResolver}get program(){return this._program}get backgroundAnalysis(){return this._backgroundAnalysis}setConfigOptions(e){var t;this._configOptions=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setConfigOptions(e),this._program.setConfigOptions(e),e.getExecutionEnvironments().forEach((e=>this._ensurePartialStubPackages(e)))}setImportResolver(e){this._importResolver=e,this._program.setImportResolver(e)}setTrackedFiles(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setTrackedFiles(e);const n=this._program.setTrackedFiles(e);this._reportDiagnosticsForRemovedFiles(n)}setAllowedThirdPartyImports(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setAllowedThirdPartyImports(e),this._program.setAllowedThirdPartyImports(e)}setFileOpened(e,t,n){var i;null===(i=this._backgroundAnalysis)||void 0===i||i.setFileOpened(e,t,[{text:n}]),this._program.setFileOpened(e,t,[{text:n}])}updateOpenFileContents(e,t,n){var i;null===(i=this._backgroundAnalysis)||void 0===i||i.setFileOpened(e,t,n),this._program.setFileOpened(e,t,n),this.markFilesDirty([e],!0)}setFileClosed(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setFileClosed(e);const n=this._program.setFileClosed(e);this._reportDiagnosticsForRemovedFiles(n)}markAllFilesDirty(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.markAllFilesDirty(e),this._program.markAllFilesDirty(e)}markFilesDirty(e,t){var n;null===(n=this._backgroundAnalysis)||void 0===n||n.markFilesDirty(e,t),this._program.markFilesDirty(e,t)}setCompletionCallback(e){var t;this._onAnalysisCompletion=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setCompletionCallback(e)}startAnalysis(e){return this._backgroundAnalysis?(this._backgroundAnalysis.startAnalysis(this._indices,e),!1):s.analyzeProgram(this._program,this._maxAnalysisTime,this._configOptions,this._onAnalysisCompletion,this._console,e)}test_setIndexing(e,t){const n=this._getIndices();for(const[t,i]of e)n.setWorkspaceIndex(t,i);for(const[e,i]of t)for(const[t,s]of i)n.setIndex(e,t,s)}startIndexing(){var e;this._configOptions.indexing&&(null===(e=this._backgroundAnalysis)||void 0===e||e.startIndexing(this._configOptions,this._getIndices()))}refreshIndexing(){var e;this._configOptions.indexing&&(null===(e=this._backgroundAnalysis)||void 0===e||e.refreshIndexing(this._configOptions,this._indices))}cancelIndexing(){var e;null===(e=this._backgroundAnalysis)||void 0===e||e.cancelIndexing(this._configOptions)}getIndexing(e){var t;return null===(t=this._indices)||void 0===t?void 0:t.getIndex(this._configOptions.findExecEnvironment(e).root)}getDiagnosticsForRange(e,t,n){return i(this,void 0,void 0,(function*(){return this._backgroundAnalysis?this._backgroundAnalysis.getDiagnosticsForRange(e,t,n):this._program.getDiagnosticsForRange(e,t)}))}writeTypeStub(e,t,n,r){return i(this,void 0,void 0,(function*(){return this._backgroundAnalysis?this._backgroundAnalysis.writeTypeStub(e,t,n,r):(s.analyzeProgram(this._program,void 0,this._configOptions,this._onAnalysisCompletion,this._console,r),this._program.writeTypeStub(e,t,n,r))}))}invalidateAndForceReanalysis(e){var t;e&&this.refreshIndexing(),null===(t=this._backgroundAnalysis)||void 0===t||t.invalidateAndForceReanalysis(),this._importResolver.invalidateCache(),this._program.markAllFilesDirty(!0)}invalidateCache(){this._importResolver.invalidateCache()}restart(){var e;null===(e=this._backgroundAnalysis)||void 0===e||e.restart()}_ensurePartialStubPackages(e){var t;return null===(t=this._backgroundAnalysis)||void 0===t||t.ensurePartialStubPackages(e.root),this._importResolver.ensurePartialStubPackages(e)}_getIndices(){if(!this._indices){const e=this._program,t=new Map;this._indices={setWorkspaceIndex(t,n){var i;null===(i=e.getSourceFile(t))||void 0===i||i.cacheIndexResults(n)},getIndex:e=>t.get(e),setIndex(e,n,i){let s=t.get(e);s||(s=new Map,t.set(e,s)),s.set(n,i)},reset(){t.clear()}}}return this._indices}_reportDiagnosticsForRemovedFiles(e){e.length>0&&!this._backgroundAnalysis&&this._onAnalysisCompletion&&this._onAnalysisCompletion({diagnostics:e,filesInProgram:this._program.getFileCount(),filesRequiringAnalysis:this._program.getFilesToAnalyzeCount(),checkingOnlyOpenFiles:this._program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:0})}}},91242:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReturnFinder=t.YieldFinder=t.Binder=void 0;const a=n(20823),o=n(15741),l=n(94647),c=n(28348),p=n(80957),u=n(80957),d=n(74426),h=r(n(78722)),m=r(n(35696)),y=n(24394),g=r(n(23241)),f=n(22339),T=n(17640),_=r(n(67737)),v=n(97882),b=n(91197);class S extends f.ParseTreeWalker{constructor(e){super(),this._deferredBindingTasks=[],this._nestedExceptDepth=0,this._finallyTargets=[],this._typingImportAliases=[],this._sysImportAliases=[],this._typingSymbolAliases=new Map,this._potentialPrivateSymbols=new Map,this._fileInfo=e}bindModule(e){var t;const n=void 0===this._fileInfo.builtinsScope;this._createNewScope(n?4:3,this._fileInfo.builtinsScope,(()=>{m.setScope(e,this._currentScope),m.setFlowNode(e,this._currentFlowNode),this._addBuiltInSymbolToCurrentScope("__doc__",e,"str"),this._addBuiltInSymbolToCurrentScope("__name__",e,"str"),this._addBuiltInSymbolToCurrentScope("__loader__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__package__",e,"str"),this._addBuiltInSymbolToCurrentScope("__spec__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__path__",e,"Iterable[str]"),this._addBuiltInSymbolToCurrentScope("__file__",e,"str"),this._addBuiltInSymbolToCurrentScope("__cached__",e,"str"),this._addBuiltInSymbolToCurrentScope("__dict__",e,"Dict[str, Any]"),this._currentFlowNode=this._createStartFlowNode(),this._walkStatementsAndReportUnreachable(e.statements),m.setCodeFlowExpressions(e,this._currentExecutionScopeReferenceMap),m.setAfterFlowNode(e,this._currentFlowNode)})),this._bindDeferred(),this._potentialPrivateSymbols.forEach(((e,t)=>{var n;(null===(n=this._dunderAllNames)||void 0===n?void 0:n.some((e=>e===t)))||e.setIsExternallyHidden()})),m.setDunderAllNames(e,this._dunderAllNames);const i=m.getScope(e);if(i&&this._dunderAllNames)for(const e of this._dunderAllNames)null===(t=i.symbolTable.get(e))||void 0===t||t.setIsInDunderAll();return{moduleDocString:g.getDocString(e.statements)}}visitModule(e){return a.fail("We should never get here"),!1}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitModuleName(e){const t=m.getImportInfo(e);if(a.assert(void 0!==t),!t||t.isNativeLib)return!0;if(!t.isImportFound)return this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingImports,o.DiagnosticRule.reportMissingImports,d.Localizer.Diagnostic.importResolveFailure().format({importName:t.importName}),e),!0;if(!t.isStubFile&&1===t.importType&&!t.pyTypedInfo){const n=this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingTypeStubs,o.DiagnosticRule.reportMissingTypeStubs,d.Localizer.Diagnostic.stubFileMissing().format({importName:t.importName}),e);if(n){const e={action:"pyright.createtypestub",moduleName:t.importName};n.addAction(e)}}return t.isStubFile&&0!==t.importType&&t.nonStubImportResult&&!t.nonStubImportResult.isImportFound&&(this._fileInfo.isStubFile||this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingModuleSource,o.DiagnosticRule.reportMissingModuleSource,d.Localizer.Diagnostic.importSourceResolveFailure().format({importName:t.importName}),e)),!0}visitClass(e){this.walkMultiple(e.decorators);const t={type:4,node:e,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.name.start,u.TextRange.getEnd(e.name),this._fileInfo.lines),moduleName:this._fileInfo.moduleName},n=this._bindNameToScope(this._currentScope,e.name.value);n&&n.addDeclaration(t),m.setDeclaration(e,t),this.walkMultiple(e.arguments);let i=this._currentScope;for(;2===i.type;)i=i.parent;return this._createNewScope(2,i,(()=>{m.setScope(e,this._currentScope),this.walk(e.suite)})),this._bindNameToScope(this._currentScope,e.name.value),this._createAssignmentTargetFlowNodes(e.name,!1,!1),!1}visitFunction(e){const t=this._bindNameToScope(this._currentScope,e.name.value),n=g.getEnclosingClass(e,!0),i={type:3,node:e,isMethod:!!n,isGenerator:!1,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.name.start,u.TextRange.getEnd(e.name),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t&&t.addDeclaration(i),m.setDeclaration(e,i),this.walkMultiple(e.decorators),e.parameters.forEach((e=>{e.defaultValue&&this.walk(e.defaultValue),e.typeAnnotation&&this.walk(e.typeAnnotation),e.typeAnnotationComment&&this.walk(e.typeAnnotationComment)})),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&this.walk(e.functionAnnotationComment);let s=e.parent;for(;s&&36!==s.nodeType&&28!==s.nodeType;)s=s.parent;a.assert(void 0!==s);const r=m.getScope(s);return a.assert(void 0!==r),this._createNewScope(1,r,(()=>{m.setScope(e,this._currentScope);g.getEnclosingClass(e)&&this._addBuiltInSymbolToCurrentScope("__class__",e,"class"),this._deferBinding((()=>{this._currentFlowNode=this._createStartFlowNode(),e.parameters.forEach((e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name.value);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.start,u.TextRange.getEnd(e),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t.addDeclaration(n),m.setDeclaration(e.name,n)}this._createFlowAssignment(e.name)}})),this._targetFunctionDeclaration=i,this._currentReturnTarget=this._createBranchLabel(),this.walk(e.suite),m.setAfterFlowNode(e.suite,this._currentFlowNode),this._addAntecedent(this._currentReturnTarget,this._currentFlowNode);const t=this._finishFlowLabel(this._currentReturnTarget);m.setAfterFlowNode(e,t)})),m.setCodeFlowExpressions(e,this._currentExecutionScopeReferenceMap)})),this._createAssignmentTargetFlowNodes(e.name,!1,!1),!1}visitLambda(e){return e.parameters.forEach((e=>{e.defaultValue&&this.walk(e.defaultValue)})),this._createNewScope(1,this._currentScope,(()=>{m.setScope(e,this._currentScope),this._deferBinding((()=>{this._currentFlowNode=this._createStartFlowNode(),e.parameters.forEach((e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name.value);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.start,u.TextRange.getEnd(e),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t.addDeclaration(n),m.setDeclaration(e.name,n)}this._createFlowAssignment(e.name),this.walk(e.name)}})),this.walk(e.expression),m.setCodeFlowExpressions(e,this._currentExecutionScopeReferenceMap)}))})),!1}visitCall(e){var t;if(this.walk(e.leftExpression),this.walkMultiple(e.arguments),this._createCallFlowNode(e),3===this._currentScope.type&&35===e.leftExpression.nodeType&&38===e.leftExpression.leftExpression.nodeType&&"__all__"===e.leftExpression.leftExpression.value){let n=!0;if("extend"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;if(31===t.nodeType)t.entries.forEach((e=>{var t;48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value),n=!1)}));else if(35===t.nodeType&&38===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&e.length>0&&(e.forEach((e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})),n=!1)}}else if("remove"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;48===t.nodeType&&1===t.strings.length&&49===t.strings[0].nodeType&&this._dunderAllNames&&(this._dunderAllNames=this._dunderAllNames.filter((e=>e!==t.strings[0].value)),n=!1)}else if("append"===e.leftExpression.memberName.value&&1===e.arguments.length){const i=e.arguments[0].valueExpression;48===i.nodeType&&1===i.strings.length&&49===i.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(i.strings[0].value),n=!1)}n&&this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,o.DiagnosticRule.reportUnsupportedDunderAll,d.Localizer.Diagnostic.unsupportedDunderAllOperation(),e)}return!1}visitAssignment(e){if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;this._bindPossibleTupleNamedTarget(e.leftExpression),e.typeAnnotationComment&&(this.walk(e.typeAnnotationComment),this._addTypeDeclarationForVariable(e.leftExpression,e.typeAnnotationComment)),this.walk(e.rightExpression);let t=!0;if((g.getEnclosingFunction(e)||9===e.rightExpression.nodeType&&this._fileInfo.isTypingStubFile||g.isWithinLoop(e))&&(t=!1),this._addInferredTypeAssignmentForVariable(e.leftExpression,e.rightExpression,t),this._createAssignmentTargetFlowNodes(e.leftExpression,!0,!1),3===this._currentScope.type&&(38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value||54===e.leftExpression.nodeType&&38===e.leftExpression.valueExpression.nodeType&&"__all__"===e.leftExpression.valueExpression.value)){const t=e.rightExpression;this._dunderAllNames=[];let n=!1;31===t.nodeType?t.entries.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?this._dunderAllNames.push(e.strings[0].value):n=!0})):52===t.nodeType?t.expressions.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?this._dunderAllNames.push(e.strings[0].value):n=!0})):n=!0,n&&this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,o.DiagnosticRule.reportUnsupportedDunderAll,d.Localizer.Diagnostic.unsupportedDunderAllOperation(),e)}return!1}visitAssignmentExpression(e){this._disableTrueFalseTargets((()=>{this.walk(e.rightExpression)}));const t=g.getEvaluationNodeForAssignmentExpression(e);if(t){const n=m.getScope(t);let i=this._currentScope;for(;i&&i!==n;){if(i.lookUpSymbol(e.name.value)){this._addError(d.Localizer.Diagnostic.assignmentExprComprehension().format({name:e.name.value}),e.name);break}i=i.parent}this._bindNameToScope(n,e.name.value),this._addInferredTypeAssignmentForVariable(e.name,e.rightExpression),this._createAssignmentTargetFlowNodes(e.name,!0,!1)}else this._addError(d.Localizer.Diagnostic.assignmentExprContext(),e),this.walk(e.name);return!1}visitAugmentedAssignment(e){if(this.walk(e.leftExpression),this.walk(e.rightExpression),this._addInferredTypeAssignmentForVariable(e.destExpression,e.rightExpression),this._bindPossibleTupleNamedTarget(e.destExpression),this._createAssignmentTargetFlowNodes(e.destExpression,!1,!1),1===e.operator&&3===this._currentScope.type&&38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value){const t=e.rightExpression;let n=!0;if(31===t.nodeType)t.entries.forEach((e=>{var t;48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value))})),n=!1;else if(35===t.nodeType&&38===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&(e.forEach((e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})),n=!1)}n&&this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,o.DiagnosticRule.reportUnsupportedDunderAll,d.Localizer.Diagnostic.unsupportedDunderAllOperation(),e)}return!1}visitDel(e){return e.expressions.forEach((e=>{this._bindPossibleTupleNamedTarget(e),this.walk(e),this._createAssignmentTargetFlowNodes(e,!1,!0)})),!1}visitTypeAnnotation(e){if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;this.walk(e.typeAnnotation),this._createVariableAnnotationFlowNode(),this._bindPossibleTupleNamedTarget(e.valueExpression),this._addTypeDeclarationForVariable(e.valueExpression,e.typeAnnotation);const t=[];return this._isNarrowingExpression(e.valueExpression,t)&&t.forEach((e=>{const t=y.createKeyForReference(e);this._currentExecutionScopeReferenceMap.set(t,t)})),this.walk(e.valueExpression),!1}visitFor(e){this._bindPossibleTupleNamedTarget(e.targetExpression),this._addInferredTypeAssignmentForVariable(e.targetExpression,e),this.walk(e.iterableExpression);const t=this._createLoopLabel(),n=this._createBranchLabel(),i=this._createBranchLabel();return this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=t,this._addAntecedent(n,this._currentFlowNode),this._createAssignmentTargetFlowNodes(e.targetExpression,!0,!1),this._bindLoopStatement(t,i,(()=>{this.walk(e.forSuite),this._addAntecedent(t,this._currentFlowNode)})),this._currentFlowNode=this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),!1}visitContinue(e){return this._currentContinueTarget&&this._addAntecedent(this._currentContinueTarget,this._currentFlowNode),this._currentFlowNode=S._unreachableFlowNode,!1}visitBreak(e){return this._currentBreakTarget&&this._addAntecedent(this._currentBreakTarget,this._currentFlowNode),this._currentFlowNode=S._unreachableFlowNode,!1}visitReturn(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.returnStatements||(this._targetFunctionDeclaration.returnStatements=[]),this._targetFunctionDeclaration.returnStatements.push(e)),e.returnExpression&&this.walk(e.returnExpression),m.setFlowNode(e,this._currentFlowNode),this._currentReturnTarget&&this._addAntecedent(this._currentReturnTarget,this._currentFlowNode),this._finallyTargets.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),this._currentFlowNode=S._unreachableFlowNode,!1}visitYield(e){return this._isInListComprehension(e)&&this._addError(d.Localizer.Diagnostic.yieldWithinListCompr(),e),this._bindYield(e),!1}visitYieldFrom(e){return this._isInListComprehension(e)&&this._addError(d.Localizer.Diagnostic.yieldWithinListCompr(),e),this._bindYield(e),!1}visitMemberAccess(e){return m.setFlowNode(e,this._currentFlowNode),!0}visitName(e){return m.setFlowNode(e,this._currentFlowNode),!1}visitIndex(e){return m.setFlowNode(e,this._currentFlowNode),!0}visitIf(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),i=this._createBranchLabel(),s=_.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment,this._typingImportAliases,this._sysImportAliases);return this._bindConditional(e.testExpression,t,n),this._currentFlowNode=!1===s?S._unreachableFlowNode:this._finishFlowLabel(t),this.walk(e.ifSuite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=!0===s?S._unreachableFlowNode:this._finishFlowLabel(n),e.elseSuite?this.walk(e.elseSuite):this._bindNeverCondition(e.testExpression,i,!1),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),!1}visitWhile(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),i=this._createBranchLabel(),s=_.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment,this._typingImportAliases,this._sysImportAliases),r=this._createLoopLabel();return this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=r,this._bindConditional(e.testExpression,t,n),this._currentFlowNode=!1===s?S._unreachableFlowNode:this._finishFlowLabel(t),this._bindLoopStatement(r,i,(()=>{this.walk(e.whileSuite)})),this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=!0===s?S._unreachableFlowNode:this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),!1}visitAssert(e){const t=this._createBranchLabel(),n=this._createBranchLabel();return this._bindConditional(e.testExpression,t,n),e.exceptionExpression&&(this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.exceptionExpression)),this._currentFlowNode=this._finishFlowLabel(t),!1}visitExcept(e){if(e.typeExpression&&this.walk(e.typeExpression),e.name){this.walk(e.name);const t=this._bindNameToScope(this._currentScope,e.name.value);if(this._createAssignmentTargetFlowNodes(e.name,!0,!1),t){const n={type:1,node:e.name,isConstant:b.isConstantName(e.name.value),inferredTypeSource:e,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.name.start,u.TextRange.getEnd(e.name),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t.addDeclaration(n)}}return this.walk(e.exceptSuite),e.name&&this._createFlowAssignment(e.name,!0),!1}visitRaise(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.raiseStatements||(this._targetFunctionDeclaration.raiseStatements=[]),this._targetFunctionDeclaration.raiseStatements.push(e)),e.typeExpression||0!==this._nestedExceptDepth||this._addError(d.Localizer.Diagnostic.raiseParams(),e),e.typeExpression&&this.walk(e.typeExpression),e.valueExpression&&this.walk(e.valueExpression),e.tracebackExpression&&this.walk(e.tracebackExpression),this._finallyTargets.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),this._currentFlowNode=S._unreachableFlowNode,!1}visitTry(e){const t=e.exceptClauses.map((()=>this._createBranchLabel())),n=this._createBranchLabel(),i=this._createBranchLabel();let s=!1;const r={flags:y.FlowFlags.PreFinallyGate,id:y.getUniqueFlowNodeId(),antecedent:i,isGateClosed:!1};e.finallySuite&&this._addAntecedent(n,r);if(e.exceptClauses.some((e=>!e.typeExpression))||t.push(i),t.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),e.finallySuite&&this._finallyTargets.push(i),this._useExceptTargets(t,(()=>{this.walk(e.trySuite)})),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(n,this._currentFlowNode),this._isCodeUnreachable()||(s=!0),this._nestedExceptDepth++,e.exceptClauses.forEach(((e,i)=>{this._currentFlowNode=this._finishFlowLabel(t[i]),this.walk(e),this._addAntecedent(n,this._currentFlowNode),this._isCodeUnreachable()||(s=!0)})),this._nestedExceptDepth--,e.finallySuite&&this._finallyTargets.pop(),this._currentFlowNode=this._finishFlowLabel(n),e.finallySuite){this.walk(e.finallySuite);const t={flags:y.FlowFlags.PostFinally,id:y.getUniqueFlowNodeId(),finallyNode:e.finallySuite,antecedent:this._currentFlowNode,preFinallyGate:r};this._currentFlowNode=s?t:S._unreachableFlowNode}return!1}visitAwait(e){const t=g.getEnclosingFunction(e);return void 0!==t&&t.isAsync||this._addError(d.Localizer.Diagnostic.awaitNotInAsync(),e),!0}visitStringList(e){for(const t of e.strings)if(t.hasUnescapeErrors){h.getUnescapedString(t.token).unescapeErrors.forEach((e=>{const n={start:t.token.start+t.token.prefixLength+t.token.quoteMarkLength+e.offset,length:e.length};0===e.errorType?this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStringEscapeSequence,o.DiagnosticRule.reportInvalidStringEscapeSequence,d.Localizer.Diagnostic.stringUnsupportedEscape(),n):1===e.errorType?this._addError(d.Localizer.Diagnostic.formatStringEscape(),n):2===e.errorType?this._addError(d.Localizer.Diagnostic.formatStringBrace(),n):3===e.errorType&&this._addError(d.Localizer.Diagnostic.formatStringUnterminated(),n)}))}return!0}visitGlobal(e){const t=this._currentScope.getGlobalScope();return e.nameList.forEach((e=>{const n=e.value;0===this._currentScope.getBindingType(n)&&this._addError(d.Localizer.Diagnostic.nonLocalRedefinition().format({name:n}),e);const i=this._currentScope.lookUpSymbolRecursive(n);i&&i.scope===this._currentScope&&this._addError(d.Localizer.Diagnostic.globalReassignment().format({name:n}),e),this._bindNameToScope(t,n),this._currentScope!==t&&this._currentScope.setBindingType(n,1)})),!0}visitNonlocal(e){const t=this._currentScope.getGlobalScope();return this._currentScope===t?this._addError(d.Localizer.Diagnostic.nonLocalInModule(),e):e.nameList.forEach((e=>{const n=e.value;1===this._currentScope.getBindingType(n)&&this._addError(d.Localizer.Diagnostic.globalRedefinition().format({name:n}),e);const i=this._currentScope.lookUpSymbolRecursive(n);i&&i.scope===this._currentScope?this._addError(d.Localizer.Diagnostic.nonLocalReassignment().format({name:n}),e):i&&i.scope!==t||this._addError(d.Localizer.Diagnostic.nonLocalNoBinding().format({name:n}),e),i&&this._currentScope.setBindingType(n,0)})),!0}visitImportAs(e){var t,n;if(e.module.nameParts.length>0){const i=e.module.nameParts[0].value;let s;s=e.alias?e.alias.value:i;const r=this._bindNameToScope(this._currentScope,s);!r||e.alias&&1===e.module.nameParts.length&&e.module.nameParts[0].value===e.alias.value||(this._fileInfo.isStubFile?r.setIsExternallyHidden():this._fileInfo.isInPyTypedPackage&&3===this._currentScope.type&&this._potentialPrivateSymbols.set(s,r));const o=m.getImportInfo(e.module);a.assert(void 0!==o),r&&this._createAliasDeclarationForMultipartImportName(e,e.alias,o,r),this._createFlowAssignment(e.alias?e.alias:e.module.nameParts[0]),1===e.module.nameParts.length&&("typing"===i||"typing_extensions"===i?this._typingImportAliases.push((null===(t=e.alias)||void 0===t?void 0:t.value)||i):"sys"===i&&this._sysImportAliases.push((null===(n=e.alias)||void 0===n?void 0:n.value)||i))}return!0}visitImportFrom(e){const t=["Final","TypeAlias","ClassVar","Required","NotRequired"],n=m.getImportInfo(e.module);let i="";n&&n.isImportFound&&!n.isNativeLib&&(i=n.resolvedPaths[n.resolvedPaths.length-1]);const s=l.stripFileExtension(l.getFileName(this._fileInfo.filePath)),r="__init__"===s&&1===e.module.leadingDots&&e.module.nameParts.length>0;let a=!1;if(1===e.module.nameParts.length){const t=e.module.nameParts[0].value;"typing"!==t&&"typing_extensions"!==t||(a=!0)}if(e.isWildcardImport){if((g.getEnclosingClass(e)||g.getEnclosingFunction(e))&&this._addError(d.Localizer.Diagnostic.wildcardInFunction(),e),n){const s=[],o=this._fileInfo.importLookup(i);if(o){const t=this._getWildcardImportNames(o);if(r){t.some((t=>t===e.module.nameParts[0].value))||this._addImplicitFromImport(e,n)}t.forEach((t=>{const r=this._bindNameToScope(this._currentScope,t);if(r){if(o.symbolTable.get(t)){const n={type:6,node:e,path:i,range:p.getEmptyRange(),usesLocalName:!1,symbolName:t,moduleName:this._fileInfo.moduleName};r.addDeclaration(n),s.push(t)}else if(n&&n.filteredImplicitImports){const s=n.filteredImplicitImports.find((e=>e.name===t));if(s){const n={type:6,node:e,path:s.path,range:p.getEmptyRange(),usesLocalName:!1,moduleName:this._fileInfo.moduleName},a={type:6,node:e,path:i,usesLocalName:!1,symbolName:t,submoduleFallback:n,range:p.getEmptyRange(),moduleName:this._fileInfo.moduleName};r.addDeclaration(a)}}}}))}this._createFlowWildcardImport(e,s),a&&t.forEach((e=>{this._typingSymbolAliases.set(e,e)}))}}else r&&this._addImplicitFromImport(e,n),e.imports.forEach((r=>{const o=r.name.value,l=r.alias||r.name,c=this._bindNameToScope(this._currentScope,l.value);if(c){let u,d;e.module.nameParts.length>0&&(r.alias&&r.alias.value===r.name.value||(this._fileInfo.isStubFile?c.setIsExternallyHidden():this._fileInfo.isInPyTypedPackage&&3===this._currentScope.type&&this._potentialPrivateSymbols.set(l.value,c))),n&&n.filteredImplicitImports&&(u=n.filteredImplicitImports.find((e=>e.name===o))),u&&(d={type:6,node:r,path:u.path,range:p.getEmptyRange(),usesLocalName:!1,moduleName:this._fileInfo.moduleName},"__init__"===s&&1===e.module.leadingDots&&0===e.module.nameParts.length&&(i=""));const h={type:6,node:r,path:i,usesLocalName:!!r.alias,symbolName:o,submoduleFallback:d,range:p.getEmptyRange(),moduleName:this._fileInfo.moduleName};c.addDeclaration(h),this._createFlowAssignment(r.alias||r.name),a&&t.some((e=>e===r.name.value))&&this._typingSymbolAliases.set(l.value,r.name.value)}}));return!0}visitWith(e){e.withItems.forEach((e=>{this.walk(e.expression),e.target&&(this._bindPossibleTupleNamedTarget(e.target),this._addInferredTypeAssignmentForVariable(e.target,e),this._createAssignmentTargetFlowNodes(e.target,!0,!1))}));const t=this._createContextManagerLabel(e.withItems.map((e=>e.expression)),!!e.isAsync);this._addAntecedent(t,this._currentFlowNode);const n=this._createBranchLabel();return this._addAntecedent(n,t),this._useExceptTargets([t],(()=>{this.walk(e.suite)})),this._addAntecedent(n,this._currentFlowNode),this._currentFlowNode=n,!1}visitTernary(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),i=this._createBranchLabel();return this._bindConditional(e.testExpression,t,n),this._currentFlowNode=this._finishFlowLabel(t),this.walk(e.ifExpression),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.elseExpression),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),!1}visitUnaryOperation(e){return 38===e.operator&&this._currentFalseTarget&&this._currentTrueTarget?this._bindConditional(e.expression,this._currentFalseTarget,this._currentTrueTarget):this._disableTrueFalseTargets((()=>{this.walk(e.expression)})),!1}visitBinaryOperation(e){if(36===e.operator||37===e.operator){let t,n=this._currentTrueTarget,i=this._currentFalseTarget;n&&i||(t=this._createBranchLabel(),n=i=t);const s=this._createBranchLabel();36===e.operator?this._bindConditional(e.leftExpression,s,i):this._bindConditional(e.leftExpression,n,s),this._currentFlowNode=this._finishFlowLabel(s),this._bindConditional(e.rightExpression,n,i),t&&(this._currentFlowNode=this._finishFlowLabel(t))}else this._disableTrueFalseTargets((()=>{this.walk(e.leftExpression),this.walk(e.rightExpression)}));return!1}visitListComprehension(e){return this._createNewScope(0,this._currentScope,(()=>{m.setScope(e,this._currentScope);const t=this._createBranchLabel(),n=[];for(let t=0;t<e.comprehensions.length;t++){const i=e.comprehensions[t],s=new Map;33===i.nodeType&&(this._bindPossibleTupleNamedTarget(i.targetExpression,s),this._addInferredTypeAssignmentForVariable(i.targetExpression,i)),n.push(s)}for(let i=0;i<e.comprehensions.length;i++){const s=e.comprehensions[i];if(33===s.nodeType){const e=n[i];for(const t of e){const e=this._currentScope.parent.lookUpSymbol(t[0]);e&&this._createAssignmentAliasFlowNode(t[1].id,e.id)}this.walk(s.iterableExpression),this._createAssignmentTargetFlowNodes(s.targetExpression,!0,!1)}else{const e=this._createBranchLabel();this._bindConditional(s.testExpression,e,t),this._currentFlowNode=this._finishFlowLabel(e)}}this.walk(e.expression),this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(t)})),!1}visitMatch(e){this.walk(e.subjectExpression);const t=this._createBranchLabel();return e.cases.forEach((e=>{const n=this._createBranchLabel(),i=this._createBranchLabel(),s=this._createBranchLabel();this._addAntecedent(i,this._currentFlowNode);66===e.pattern.nodeType&&1===e.pattern.orPatterns.length&&69===e.pattern.orPatterns[0].nodeType&&e.pattern.orPatterns[0].isWildcard||this._addAntecedent(n,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),this.walk(e.pattern),e.guardExpression?this._bindConditional(e.guardExpression,s,n):this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),this.walk(e.suite),this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(n)})),this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(t),!1}visitPatternAs(e){const t=this._createBranchLabel();if(e.orPatterns.forEach((e=>{this.walk(e),this._addAntecedent(t,this._currentFlowNode)})),this._currentFlowNode=this._finishFlowLabel(t),e.target){this.walk(e.target);const t=this._bindNameToScope(this._currentScope,e.target.value);if(this._createAssignmentTargetFlowNodes(e.target,!1,!1),t){const n={type:1,node:e.target,isConstant:b.isConstantName(e.target.value),inferredTypeSource:e,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.target.start,u.TextRange.getEnd(e.target),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t.addDeclaration(n)}}return!1}visitPatternCapture(e){return e.isWildcard||this._addPatternCaptureTarget(e.target),!0}visitPatternMappingExpandEntry(e){return"_"!==e.target.value&&this._addPatternCaptureTarget(e.target),!0}_isInListComprehension(e){let t=e;for(;t;){if(32===t.nodeType)return!0;t=t.parent}return!1}_addPatternCaptureTarget(e){const t=this._bindNameToScope(this._currentScope,e.value);if(this._createAssignmentTargetFlowNodes(e,!1,!1),t){const n={type:1,node:e,isConstant:b.isConstantName(e.value),inferredTypeSource:e.parent,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.start,u.TextRange.getEnd(e),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t.addDeclaration(n)}}_useExceptTargets(e,t){const n=this._currentExceptTargets;this._currentExceptTargets=e,t(),this._currentExceptTargets=n}_disableTrueFalseTargets(e){const t=this._currentTrueTarget,n=this._currentFalseTarget;this._currentTrueTarget=void 0,this._currentFalseTarget=void 0,e(),this._currentFalseTarget=n,this._currentTrueTarget=t}_getDunderAllNamesFromImport(e){var t;const n=this._currentScope.lookUpSymbol(e);if(!n)return;const i=n.getDeclarations().find((e=>6===e.type)),s=(null==i?void 0:i.path)||(null===(t=null==i?void 0:i.submoduleFallback)||void 0===t?void 0:t.path);if(!s)return;const r=this._fileInfo.importLookup(s);return r?r.dunderAllNames:void 0}_addImplicitFromImport(e,t){const n=e.module.nameParts[0].value,i=this._bindNameToScope(this._currentScope,n);i&&this._createAliasDeclarationForMultipartImportName(e,void 0,t,i),this._createFlowAssignment(e.module.nameParts[0])}_createAliasDeclarationForMultipartImportName(e,t,n,i){const s=e.module.nameParts[0].value;if(n&&n.isImportFound&&!n.isNativeLib&&n.resolvedPaths.length>0){const r=i.getDeclarations().find((e=>6===e.type&&e.firstNamePart===s));let a;if(a=r||{type:6,node:e,path:"",moduleName:n.importName,range:p.getEmptyRange(),firstNamePart:s,usesLocalName:!!t},t||1===e.module.nameParts.length)a.path=n.resolvedPaths[n.resolvedPaths.length-1],this._addImplicitImportsToLoaderActions(n,a);else{let t=a;for(let i=1;i<e.module.nameParts.length&&!(i>=n.resolvedPaths.length);i++){const s=e.module.nameParts[i].value;let r=t.implicitImports?t.implicitImports.get(s):void 0;r||(r={path:"",implicitImports:new Map},t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(s,r)),i===e.module.nameParts.length-1&&(r.path=n.resolvedPaths[i],this._addImplicitImportsToLoaderActions(n,r)),t=r}}r||i.addDeclaration(a)}else{const n={type:6,node:e,path:"*** unresolved ***",range:p.getEmptyRange(),usesLocalName:!!t,moduleName:"",isUnresolved:!0};i.addDeclaration(n)}}_getWildcardImportNames(e){if(e.dunderAllNames)return e.dunderAllNames;const t=[];return e.symbolTable.forEach(((e,n)=>{e.isExternallyHidden()||t.push(n)})),t}_walkStatementsAndReportUnreachable(e){let t=!1;for(const n of e)if(m.setFlowNode(n,this._currentFlowNode),t||(t=this._isCodeUnreachable()),t){if(this._targetFunctionDeclaration&&!this._targetFunctionDeclaration.isGenerator){(new C).checkContainsYield(n)&&(this._targetFunctionDeclaration.isGenerator=!0)}}else this.walk(n);return!1}_createStartFlowNode(){return{flags:y.FlowFlags.Start,id:y.getUniqueFlowNodeId()}}_createBranchLabel(){return{flags:y.FlowFlags.BranchLabel,id:y.getUniqueFlowNodeId(),antecedents:[]}}_createContextManagerLabel(e,t){return{flags:y.FlowFlags.PostContextManager|y.FlowFlags.BranchLabel,id:y.getUniqueFlowNodeId(),antecedents:[],expressions:e,isAsync:t}}_createLoopLabel(){return{flags:y.FlowFlags.LoopLabel,id:y.getUniqueFlowNodeId(),antecedents:[]}}_finishFlowLabel(e){return 0===e.antecedents.length?S._unreachableFlowNode:1===e.antecedents.length&&e.flags===y.FlowFlags.BranchLabel?e.antecedents[0]:e}_bindNeverCondition(e,t,n){const i=[];if(55===e.nodeType&&38===e.operator)this._bindNeverCondition(e.expression,t,!n);else if(7!==e.nodeType||36!==e.operator&&37!==e.operator){if(this._isNarrowingExpression(e,i,!0)){i.filter((e=>38===e.nodeType)).length>0&&(this._currentFlowNode=this._createFlowConditional(n?y.FlowFlags.TrueNeverCondition:y.FlowFlags.FalseNeverCondition,this._currentFlowNode,e))}this._addAntecedent(t,this._currentFlowNode)}else if(36===e.operator){const i=this._currentFlowNode;this._bindNeverCondition(e.leftExpression,t,n),this._currentFlowNode=i,this._bindNeverCondition(e.rightExpression,t,n)}else{const i=this._currentFlowNode,s=this._createBranchLabel();if(this._bindNeverCondition(e.leftExpression,s,n),i!==this._currentFlowNode){this._currentFlowNode=this._finishFlowLabel(s);const r=this._currentFlowNode;this._bindNeverCondition(e.rightExpression,t,n),r===this._currentFlowNode&&(this._currentFlowNode=i)}}}_bindConditional(e,t,n){const i=this._currentTrueTarget,s=this._currentFalseTarget;this._currentTrueTarget=t,this._currentFalseTarget=n,this.walk(e),this._currentTrueTarget=i,this._currentFalseTarget=s,this._isLogicalExpression(e)||(this._addAntecedent(t,this._createFlowConditional(y.FlowFlags.TrueCondition,this._currentFlowNode,e)),this._addAntecedent(n,this._createFlowConditional(y.FlowFlags.FalseCondition,this._currentFlowNode,e)))}_createFlowConditional(e,t,n){if(t.flags&y.FlowFlags.Unreachable)return t;const i=_.evaluateStaticBoolLikeExpression(n,this._fileInfo.executionEnvironment,this._typingImportAliases,this._sysImportAliases);if(!0===i&&e&y.FlowFlags.FalseCondition||!1===i&&e&y.FlowFlags.TrueCondition)return S._unreachableFlowNode;const s=[];if(!this._isNarrowingExpression(n,s))return t;s.forEach((e=>{const t=y.createKeyForReference(e);this._currentExecutionScopeReferenceMap.set(t,t)}));const r=s.filter((e=>38===e.nodeType)),a={flags:e,id:y.getUniqueFlowNodeId(),reference:r.length>0?r[0]:void 0,expression:n,antecedent:t};return this._addExceptTargets(a),a}_isLogicalExpression(e){switch(e.nodeType){case 55:return 38===e.operator;case 7:return 36===e.operator||37===e.operator}return!1}_isNarrowingExpression(e,t,n=!1,i=!1){switch(e.nodeType){case 38:case 35:case 24:if(n){if(38!==e.nodeType)return!1;if(!i)return!1}return!!y.isCodeFlowSupportedForReference(e)&&(t.push(e),!0);case 4:return t.push(e.name),!0;case 7:{const i=39===e.operator||40===e.operator,s=12===e.operator||28===e.operator;if(i||s){if(11===e.rightExpression.nodeType&&26===e.rightExpression.constType)return this._isNarrowingExpression(e.leftExpression,t,n,!0);if(i&&9===e.leftExpression.nodeType&&38===e.leftExpression.leftExpression.nodeType&&"type"===e.leftExpression.leftExpression.value&&1===e.leftExpression.arguments.length&&0===e.leftExpression.arguments[0].argumentCategory)return this._isNarrowingExpression(e.leftExpression.arguments[0].valueExpression,t,n,!0);const r=this._isNarrowingExpression(e.leftExpression,t,n,!0);if(i)return r;if(s){const i=this._isNarrowingExpression(e.rightExpression,t,n,!0);return r||i}}return!(41!==e.operator&&42!==e.operator||!this._isNarrowingExpression(e.rightExpression,t,n,!0))||41===e.operator&&this._isNarrowingExpression(e.leftExpression,t,n,!0)}case 55:return 38===e.operator&&this._isNarrowingExpression(e.expression,t,n,!1);case 5:return this._isNarrowingExpression(e.rightExpression,t,n,!0);case 9:if(38===e.leftExpression.nodeType&&("isinstance"===e.leftExpression.value||"issubclass"===e.leftExpression.value)&&2===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0);if(38===e.leftExpression.nodeType&&"callable"===e.leftExpression.value&&1===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0);if(e.arguments.length>=1)return!n&&this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0)}return!1}_createAssignmentTargetFlowNodes(e,t,n){switch(e.nodeType){case 38:case 35:case 24:this._createFlowAssignment(e,n),t&&this.walk(e);break;case 52:e.expressions.forEach((e=>{this._createAssignmentTargetFlowNodes(e,t,n)}));break;case 54:this._createAssignmentTargetFlowNodes(e.valueExpression,!1,n),t&&this.walk(e);break;case 56:this._createAssignmentTargetFlowNodes(e.expression,!1,n),t&&this.walk(e);break;case 31:e.entries.forEach((e=>{this._createAssignmentTargetFlowNodes(e,t,n)}));break;default:t&&this.walk(e)}}_createCallFlowNode(e){if(!this._isCodeUnreachable()){const t={flags:y.FlowFlags.Call,id:y.getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode};this._currentFlowNode=t}m.setFlowNode(e,this._currentFlowNode),this._isCodeUnreachable()||this._addExceptTargets(this._currentFlowNode)}_createAssignmentAliasFlowNode(e,t){if(!this._isCodeUnreachable()){const n={flags:y.FlowFlags.AssignmentAlias,id:y.getUniqueFlowNodeId(),antecedent:this._currentFlowNode,targetSymbolId:e,aliasSymbolId:t};this._currentFlowNode=n}}_createVariableAnnotationFlowNode(){if(!this._isCodeUnreachable()){const e={flags:y.FlowFlags.VariableAnnotation,id:y.getUniqueFlowNodeId(),antecedent:this._currentFlowNode};this._currentFlowNode=e}}_createFlowAssignment(e,t=!1){let n=v.indeterminateSymbolId;if(38===e.nodeType){const t=this._currentScope.lookUpSymbolRecursive(e.value);a.assert(void 0!==t),n=t.symbol.id}const i=this._currentFlowNode;if(!this._isCodeUnreachable()&&y.isCodeFlowSupportedForReference(e)){const i={flags:y.FlowFlags.Assignment,id:y.getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode,targetSymbolId:n},s=y.createKeyForReference(e);this._currentExecutionScopeReferenceMap.set(s,s),t&&(i.flags|=y.FlowFlags.Unbind),35===e.nodeType&&this._addExceptTargets(i),this._currentFlowNode=i}t&&void 0!==m.getFlowNode(e)||m.setFlowNode(e,t?i:this._currentFlowNode)}_createFlowWildcardImport(e,t){if(!this._isCodeUnreachable()){const n={flags:y.FlowFlags.WildcardImport,id:y.getUniqueFlowNodeId(),node:e,names:t,antecedent:this._currentFlowNode};this._addExceptTargets(n),this._currentFlowNode=n}m.setFlowNode(e,this._currentFlowNode)}_isCodeUnreachable(){return!!(this._currentFlowNode.flags&y.FlowFlags.Unreachable)}_addExceptTargets(e){this._currentExceptTargets&&this._currentExceptTargets.forEach((t=>{this._addAntecedent(t,e)}))}_bindLoopStatement(e,t,n){const i=this._currentContinueTarget,s=this._currentBreakTarget;this._currentContinueTarget=e,this._currentBreakTarget=t,n(),this._currentContinueTarget=i,this._currentBreakTarget=s}_addAntecedent(e,t){this._currentFlowNode.flags&y.FlowFlags.Unreachable||e.antecedents.some((e=>e.id===t.id))||e.antecedents.push(t)}_bindNameToScope(e,t,n){const i=this._currentScope.getBindingType(t);if(void 0===i){let i=e.lookUpSymbol(t);if(!i){if(i=e.addSymbol(t,5),2===e.type){const n=e.parent.lookUpSymbol(t);n&&this._createAssignmentAliasFlowNode(i.id,n.id)}b.isPrivateOrProtectedName(t)&&(this._fileInfo.isStubFile||b.isPrivateName(t)?i.setIsExternallyHidden():this._fileInfo.isInPyTypedPackage&&3===this._currentScope.type&&this._potentialPrivateSymbols.set(t,i)),n&&n.set(t,i)}return i}{const e=(0===i?this._currentScope.parent:this._currentScope.getGlobalScope()).lookUpSymbolRecursive(t);if(e)return e.symbol}}_bindPossibleTupleNamedTarget(e,t){switch(e.nodeType){case 38:this._bindNameToScope(this._currentScope,e.value,t);break;case 52:e.expressions.forEach((e=>{this._bindPossibleTupleNamedTarget(e,t)}));break;case 31:e.entries.forEach((e=>{this._bindPossibleTupleNamedTarget(e,t)}));break;case 54:this._bindPossibleTupleNamedTarget(e.valueExpression,t);break;case 56:this._bindPossibleTupleNamedTarget(e.expression,t)}}_addBuiltInSymbolToCurrentScope(e,t,n){const i=this._addSymbolToCurrentScope(e,!1);i&&(i.addDeclaration({type:0,node:t,intrinsicType:n,path:this._fileInfo.filePath,range:p.getEmptyRange(),moduleName:this._fileInfo.moduleName}),i.setIsIgnoredForProtocolMatch())}_addSymbolToCurrentScope(e,t){let n=this._currentScope.lookUpSymbol(e);if(!n){let i=0;t&&(i|=1),2===this._currentScope.type&&(i|=4),this._fileInfo.isStubFile&&b.isPrivateOrProtectedName(e)&&(i|=2),n=this._currentScope.addSymbol(e,i)}return n}_createNewScope(e,t,n){const i=this._currentScope,s=new T.Scope(e,t);this._currentScope=s;const r=4===e||3===e||1===e,a=this._currentExecutionScopeReferenceMap;return r&&(this._currentExecutionScopeReferenceMap=new Map),n(),this._currentExecutionScopeReferenceMap=a,this._currentScope=i,s}_addInferredTypeAssignmentForVariable(e,t,n=!1){switch(e.nodeType){case 38:{const i=e,s=this._currentScope.lookUpSymbolRecursive(i.value);if(s&&s.symbol){const r={type:1,node:e,isConstant:b.isConstantName(e.value),inferredTypeSource:t,typeAliasName:n?e:void 0,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(i.start,u.TextRange.getEnd(i),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};s.symbol.addDeclaration(r)}break}case 35:{const n=this._getMemberAccessInfo(e);if(n){const i=e.memberName;let s=n.classScope.lookUpSymbol(i.value);if(!s){s=n.classScope.addSymbol(i.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;b.isPrivateOrProtectedName(i.value)&&e&&s.setIsPrivateMember()}n.isInstanceMember?s.isClassMember()&&s.getDeclarations().some((e=>3===e.type&&e.isMethod))||s.setIsInstanceMember():s.setIsClassMember();const r={type:1,node:e.memberName,isConstant:b.isConstantName(i.value),inferredTypeSource:t,isDefinedByMemberAccess:!0,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.memberName.start,e.memberName.start+e.memberName.length,this._fileInfo.lines),moduleName:this._fileInfo.moduleName};s.addDeclaration(r)}break}case 52:e.expressions.forEach((e=>{this._addInferredTypeAssignmentForVariable(e,t)}));break;case 54:this._addInferredTypeAssignmentForVariable(e.valueExpression,t);break;case 56:this._addInferredTypeAssignmentForVariable(e.expression,t);break;case 31:e.entries.forEach((e=>{this._addInferredTypeAssignmentForVariable(e,t)}))}}_addTypeDeclarationForVariable(e,t){let n=!1;switch(e.nodeType){case 38:{const i=e,s=this._currentScope.lookUpSymbolRecursive(i.value);if(s&&s.symbol){const n=this._isAnnotationFinal(t),r=this._isAnnotationTypeAlias(t);let a=t;r?(a=void 0,3!==this._currentScope.type&&this._addError(d.Localizer.Diagnostic.typeAliasNotInModule(),t)):n.isFinal&&(a=n.finalTypeNode);const o={type:1,node:e,isConstant:b.isConstantName(i.value),isFinal:n.isFinal,isRequired:this._isRequiredAnnotation(a),isNotRequired:this._isNotRequiredAnnotation(a),typeAliasAnnotation:r?t:void 0,typeAliasName:r?e:void 0,path:this._fileInfo.filePath,typeAnnotationNode:a,range:c.convertOffsetsToRange(i.start,u.TextRange.getEnd(i),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};s.symbol.addDeclaration(o);24===t.nodeType&&this._isTypingAnnotation(t.baseExpression,"ClassVar")?s.symbol.setIsClassVar():s.symbol.setIsInstanceMember()}n=!0;break}case 35:{const i=this._getMemberAccessInfo(e);if(i){const s=e.memberName;let r=i.classScope.lookUpSymbol(s.value);if(!r){r=i.classScope.addSymbol(s.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;b.isPrivateOrProtectedName(s.value)&&e&&r.setIsPrivateMember()}i.isInstanceMember?r.setIsInstanceMember():r.setIsClassMember();const a=this._isAnnotationFinal(t),o={type:1,node:e.memberName,isConstant:b.isConstantName(s.value),isDefinedByMemberAccess:!0,isFinal:a.isFinal,path:this._fileInfo.filePath,typeAnnotationNode:a.isFinal?a.finalTypeNode:t,range:c.convertOffsetsToRange(e.memberName.start,e.memberName.start+e.memberName.length,this._fileInfo.lines),moduleName:this._fileInfo.moduleName};r.addDeclaration(o),n=!0}break}}n||this._addError(d.Localizer.Diagnostic.annotationNotSupported(),t)}_isTypingAnnotation(e,t){if(38===e.nodeType){if(this._typingSymbolAliases.get(e.value)===t)return!0}else if(35===e.nodeType&&38===e.leftExpression.nodeType&&e.memberName.value===t){const t=e.leftExpression.value;return this._typingImportAliases.some((e=>e===t))}return!1}_isAnnotationFinal(e){let t,n=!1;if(e)if(this._isTypingAnnotation(e,"Final"))n=!0;else if(24===e.nodeType&&1===e.items.length){!this._isAnnotationFinal(e.baseExpression).isFinal||0!==e.items[0].argumentCategory||e.items[0].name||e.trailingComma||(n=!0,t=e.items[0].valueExpression)}return{isFinal:n,finalTypeNode:t}}_isRequiredAnnotation(e){return!(!e||24!==e.nodeType||1!==e.items.length||!this._isTypingAnnotation(e.baseExpression,"Required"))}_isNotRequiredAnnotation(e){return!(!e||24!==e.nodeType||1!==e.items.length||!this._isTypingAnnotation(e.baseExpression,"NotRequired"))}_isAnnotationTypeAlias(e){return!!e&&this._isTypingAnnotation(e,"TypeAlias")}_getMemberAccessInfo(e){if(38!==e.leftExpression.nodeType)return;const t=e.leftExpression.value,n=g.getEnclosingFunction(e);if(!n)return;const i=g.getEnclosingClass(n);if(!i)return;let s=!1;if(n.parameters.length<1||!n.parameters[0].name)return;const r=i.name.value,o=n.parameters[0].name.value;if(t===r)s=!1;else{if(t!==o)return;if("__new__"===n.name.value)s=!1;else{s=!0;for(const e of n.decorators)if(38===e.expression.nodeType){const t=e.expression.value;if("staticmethod"===t)return;if("classmethod"===t){s=!1;break}}}}const l=m.getScope(i);return a.assert(void 0!==l),{classNode:i,methodNode:n,classScope:l,isInstanceMember:s}}_addImplicitImportsToLoaderActions(e,t){e.filteredImplicitImports.forEach((e=>{const n=t.implicitImports?t.implicitImports.get(e.name):void 0;n?n.path=e.path:(t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(e.name,{path:e.path,implicitImports:new Map}))}))}_handleTypingStubAssignmentOrAnnotation(e){if(!this._fileInfo.isTypingStubFile)return!1;let t;if(54===e.nodeType)t=e;else{if(54!==e.leftExpression.nodeType)return!1;t=e.leftExpression}if(38!==t.valueExpression.nodeType)return!1;const n=t.valueExpression.value;if(!{Tuple:!0,Generic:!0,Protocol:!0,Callable:!0,Type:!0,ClassVar:!0,Final:!0,Literal:!0,TypedDict:!0,Union:!0,Optional:!0,Annotated:!0,TypeAlias:!0,OrderedDict:!0,Concatenate:!0,TypeGuard:!0,Unpack:!0}[n])return!1;const i=this._bindNameToScope(this._currentScope,n);return i&&i.addDeclaration({type:5,node:t,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(t.start,u.TextRange.getEnd(t),this._fileInfo.lines),moduleName:this._fileInfo.moduleName}),!0}_deferBinding(e){this._deferredBindingTasks.push({scope:this._currentScope,codeFlowExpressionMap:this._currentExecutionScopeReferenceMap,callback:e})}_bindDeferred(){for(;this._deferredBindingTasks.length>0;){const e=this._deferredBindingTasks.shift();this._currentScope=e.scope,this._nestedExceptDepth=0,this._currentExecutionScopeReferenceMap=e.codeFlowExpressionMap,e.callback()}}_bindYield(e){const t=g.getEnclosingFunction(e);t?t.isAsync&&61===e.nodeType&&this._addError(d.Localizer.Diagnostic.yieldFromOutsideAsync(),e):g.getEnclosingLambda(e)||this._addError(d.Localizer.Diagnostic.yieldOutsideFunction(),e),this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.yieldStatements||(this._targetFunctionDeclaration.yieldStatements=[]),this._targetFunctionDeclaration.yieldStatements.push(e),this._targetFunctionDeclaration.isGenerator=!0),e.expression&&this.walk(e.expression),m.setFlowNode(e,this._currentFlowNode)}_addDiagnostic(e,t,n,i){let s;switch(e){case"error":s=this._addError(n,i);break;case"warning":s=this._addWarning(n,i);break;case"information":s=this._addInformation(n,i);break;case"none":break;default:return a.assertNever(e,`${e} is not expected`)}return s&&s.setRule(t),s}_addError(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("error",e,t)}_addWarning(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("warning",e,t)}_addInformation(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("information",e,t)}}t.Binder=S,S._unreachableFlowNode={flags:y.FlowFlags.Unreachable,id:y.getUniqueFlowNodeId()};class C extends f.ParseTreeWalker{constructor(){super(...arguments),this._containsYield=!1}checkContainsYield(e){return this.walk(e),this._containsYield}visitYield(e){return this._containsYield=!0,!1}visitYieldFrom(e){return this._containsYield=!0,!1}}t.YieldFinder=C;class I extends f.ParseTreeWalker{constructor(){super(...arguments),this._containsReturn=!1}checkContainsReturn(e){return this.walk(e),this._containsReturn}visitReturn(e){return this._containsReturn=!0,!1}}t.ReturnFinder=I},51153:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Checker=void 0;const a=n(20823),o=n(24319),l=n(15741),c=n(80957),p=n(74426),u=n(55390),d=r(n(35696)),h=n(88023),m=n(45214),y=r(n(23241)),g=n(22339),f=n(57203),T=n(67737),_=r(n(91197)),v=n(15020),b=n(59195),S=n(10425),C=n(20670);class I extends g.ParseTreeWalker{constructor(e,t){super(),this._scopedNodes=[],this._moduleNode=e,this._fileInfo=d.getFileInfo(e),this._evaluator=t}check(){this._scopedNodes.push(this._moduleNode),this._walkStatementsAndReportUnreachable(this._moduleNode.statements);const e=d.getDunderAllNames(this._moduleNode);e&&this._evaluator.markNamesAccessed(this._moduleNode,e),this._validateSymbolTables(),this._reportDuplicateImports()}walk(e){d.isCodeUnreachable(e)?this._evaluator.suppressDiagnostics(e,(()=>{super.walk(e)})):super.walk(e)}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitStatementList(e){return e.statements.forEach((e=>{u.isExpressionNode(e)&&this._evaluator.getType(e)})),!0}visitClass(e){const t=this._evaluator.getTypeOfClass(e);return this.walk(e.suite),this.walkMultiple(e.decorators),this.walkMultiple(e.arguments),t&&(b.ClassType.isProtocolClass(t.classType)&&(e.arguments.forEach((e=>{if(!e.name){const n=this._evaluator.getType(e.valueExpression);n&&b.isClass(n)&&!b.ClassType.isBuiltIn(n,"Protocol")&&(b.ClassType.isProtocolClass(n)||this._evaluator.addError(p.Localizer.Diagnostic.protocolBaseClass().format({classType:this._evaluator.printType(t.classType,!1),baseType:this._evaluator.printType(n,!1)}),e.valueExpression))}})),this._validateProtocolTypeParamVariance(e,t.classType)),this._validateClassMethods(t.classType),this._validateFinalMemberOverrides(t.classType),b.ClassType.isTypedDictClass(t.classType)&&this._validateTypedDictClassSuite(e.suite)),this._scopedNodes.push(e),!1}visitFunction(e){var t;const n=this._evaluator.getTypeOfFunction(e),i=y.getEnclosingClass(e,!0);if(n){let s=!1;e.parameters.forEach(((e,t)=>{if(e.name)if(1===e.category){const t=e.typeAnnotation||e.typeAnnotationComment;if(t&&35===t.nodeType&&"args"===t.memberName.value){const e=this._evaluator.getType(t.leftExpression);e&&b.isTypeVar(e)&&e.details.isParamSpec&&(s=!0)}}else 2===e.category&&(s=!1);if(e.name&&0===e.category&&s&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.namedParamAfterParamSpecArgs().format({name:e.name.value}),e.name),e.name&&"_"!==e.name.value){const i=n.functionType.details.parameters[t].type;if(b.isUnknown(i)||b.isTypeVar(i)&&i.details.isSynthesized&&!i.details.isSynthesizedSelfCls)this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name);else if(S.isPartlyUnknown(i)){const t=new o.DiagnosticAddendum;t.addMessage(p.Localizer.DiagnosticAddendum.paramType().format({paramType:this._evaluator.printType(i,!0)})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value})+t.getString(),e.name)}}if(e.defaultValue&&this._fileInfo.isStubFile){const t=this._evaluator.getType(e.defaultValue);t&&S.isEllipsisType(t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,l.DiagnosticRule.reportInvalidStubStatement,p.Localizer.Diagnostic.defaultValueNotEllipsis(),e.defaultValue)}}));const r=e.parameters.filter(((e,t)=>{const i=n.functionType.details.parameters[t];return!!(i.typeAnnotation&&b.isTypeVar(i.type)&&b.isParamSpec(i.type)&&0!==i.category&&35===i.typeAnnotation.nodeType)}));if(1===r.length&&this._evaluator.addError(p.Localizer.Diagnostic.paramSpecArgsKwargsUsage(),r[0].typeAnnotation||r[0].typeAnnotationComment),this._fileInfo.isStubFile){e.returnTypeAnnotation||(null===(t=e.functionAnnotationComment)||void 0===t?void 0:t.returnTypeAnnotation)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.returnTypeUnknown(),e.name)}i&&this._validateMethod(e,n.functionType,i)}if(e.parameters.forEach(((e,t)=>{if(e.defaultValue&&this.walk(e.defaultValue),e.typeAnnotation&&this.walk(e.typeAnnotation),e.typeAnnotationComment&&this.walk(e.typeAnnotationComment),n){const i=e.typeAnnotation||e.typeAnnotationComment;if(i){const e=n.functionType.details.parameters[t].type;b.isTypeVar(e)&&1===e.details.variance&&!e.details.isSynthesized&&"__init__"!==n.functionType.details.name&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.paramTypeCovariant(),i)}}})),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&this.walk(e.functionAnnotationComment),this.walkMultiple(e.decorators),e.parameters.forEach((e=>{e.name&&this.walk(e.name)})),this.walk(e.suite),n&&this._validateFunctionReturn(e,n.functionType),this._fileInfo.isStubFile&&"__getattr__"===e.name.value){const t=f.getScopeForNode(e);3===(null==t?void 0:t.type)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownMemberType,l.DiagnosticRule.reportUnknownMemberType,p.Localizer.Diagnostic.stubUsesGetAttr(),e.name)}if(this._scopedNodes.push(e),this._validateFunctionTypeVarUsage(e),n&&b.isOverloadedFunction(n.decoratedType)){const t=n.decoratedType.overloads;if(t.length>1){const n=100;t.length<n&&this._validateOverloadConsistency(e,t[t.length-1],t.slice(0,t.length-1))}}return!1}visitLambda(e){this._evaluator.getType(e),this.walkMultiple([...e.parameters,e.expression]),e.parameters.forEach((e=>{if(e.name){const t=this._evaluator.getType(e.name);t&&(b.isUnknown(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,l.DiagnosticRule.reportUnknownLambdaType,p.Localizer.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name):S.isPartlyUnknown(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,l.DiagnosticRule.reportUnknownLambdaType,p.Localizer.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value}),e.name))}}));const t=this._evaluator.getType(e.expression);return t&&(b.isUnknown(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,l.DiagnosticRule.reportUnknownLambdaType,p.Localizer.Diagnostic.lambdaReturnTypeUnknown(),e.expression):S.isPartlyUnknown(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,l.DiagnosticRule.reportUnknownLambdaType,p.Localizer.Diagnostic.lambdaReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(t,!0)}),e.expression)),this._scopedNodes.push(e),!1}visitCall(e){var t;if(this._validateIsInstanceCall(e),y.isWithinDefaultParamInitializer(e)&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportCallInDefaultInitializer,l.DiagnosticRule.reportCallInDefaultInitializer,p.Localizer.Diagnostic.defaultValueContainsCall(),e),("none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCallResult||"none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCoroutine)&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)){const t=this._evaluator.getType(e);t&&this._isTypeValidForUnusedValueTest(t)&&(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCallResult,l.DiagnosticRule.reportUnusedCallResult,p.Localizer.Diagnostic.unusedCallResult().format({type:this._evaluator.printType(t,!1)}),e),b.isObject(t)&&b.ClassType.isBuiltIn(t.classType,"Coroutine")&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCoroutine,l.DiagnosticRule.reportUnusedCoroutine,p.Localizer.Diagnostic.unusedCoroutine(),e))}return!0}visitAwait(e){var t;if("none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCallResult&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&9===e.expression.nodeType){const t=this._evaluator.getType(e);t&&this._isTypeValidForUnusedValueTest(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCallResult,l.DiagnosticRule.reportUnusedCallResult,p.Localizer.Diagnostic.unusedCallResult().format({type:this._evaluator.printType(t,!1)}),e)}return!0}visitFor(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitListComprehension(e){return this._scopedNodes.push(e),!0}visitIf(e){if(7===e.testExpression.nodeType&&12===e.testExpression.operator&&void 0===T.evaluateStaticBoolExpression(e.testExpression,this._fileInfo.executionEnvironment)){const t=this._evaluator.getType(e.testExpression.rightExpression);if(t&&S.isLiteralTypeOrUnion(t)){const n=this._evaluator.getType(e.testExpression.leftExpression);if(n&&S.isLiteralTypeOrUnion(n)){let i=!1;S.doForEachSubtype(n,(e=>{this._evaluator.canAssignType(t,e,new o.DiagnosticAddendum)&&(i=!0)})),i||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.comparisonAlwaysFalse().format({leftType:this._evaluator.printType(n,!0),rightType:this._evaluator.printType(t,!0)}),e.testExpression)}}}return this._evaluator.getType(e.testExpression),!0}visitWhile(e){return this._evaluator.getType(e.testExpression),!0}visitWith(e){return e.withItems.forEach((e=>{this._evaluator.evaluateTypesForStatement(e)})),!0}visitReturn(e){let t;const n=y.getEnclosingFunction(e),i=n?this._evaluator.getFunctionDeclaredReturnType(n):void 0;if(t=e.returnExpression?this._evaluator.getType(e.returnExpression)||b.UnknownType.create():b.NoneType.createInstance(),this._evaluator.isNodeReachable(e)&&n){if(i)if(S.isNoReturnType(i))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.noReturnContainsReturn(),e);else{const n=new o.DiagnosticAddendum;this._evaluator.canAssignType(i,t,n,void 0,64)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.returnTypeMismatch().format({exprType:this._evaluator.printType(t,!1),returnType:this._evaluator.printType(i,!1)})+n.getString(),e.returnExpression?e.returnExpression:e)}b.isUnknown(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,l.DiagnosticRule.reportUnknownVariableType,p.Localizer.Diagnostic.returnTypeUnknown(),e.returnExpression):S.isPartlyUnknown(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,l.DiagnosticRule.reportUnknownVariableType,p.Localizer.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(t,!0)}),e.returnExpression)}return!0}visitYield(e){const t=e.expression?this._evaluator.getType(e.expression):b.NoneType.createInstance();return this._validateYieldType(e,t||b.UnknownType.create()),!0}visitYieldFrom(e){const t=this._evaluator.getType(e.expression)||b.UnknownType.create();let n=this._evaluator.getTypeFromIterable(t,!1,e)||b.UnknownType.create();const i=S.getGeneratorTypeArgs(n);return n=i?i.length>=1?i[0]:b.UnknownType.create():this._evaluator.getTypeFromIterator(t,!1,e)||b.UnknownType.create(),this._validateYieldType(e,n),!0}visitRaise(e){if(this._evaluator.verifyRaiseExceptionType(e),e.valueExpression){const t=this._evaluator.getBuiltInType(e,"BaseException"),n=this._evaluator.getType(e.valueExpression);if(n&&t&&b.isClass(t)){const i=new o.DiagnosticAddendum;S.doForEachSubtype(n,(e=>{e=this._evaluator.makeTopLevelTypeVarsConcrete(e),b.isAnyOrUnknown(e)||b.isNone(e)||b.isObject(e)&&S.derivesFromClassRecursive(e.classType,t,!1)||i.addMessage(p.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)}))})),i.isEmpty()||this._evaluator.addError(p.Localizer.Diagnostic.expectedExceptionObj()+i.getString(),e.valueExpression)}}return!0}visitExcept(e){if(e.typeExpression){this._evaluator.evaluateTypesForStatement(e);const t=this._evaluator.getType(e.typeExpression);t&&this._validateExceptionType(t,e.typeExpression)}return!0}visitAssert(e){e.exceptionExpression&&this._evaluator.getType(e.exceptionExpression);const t=this._evaluator.getType(e.testExpression);return t&&b.isObject(t)&&S.isTupleClass(t.classType)&&t.classType.tupleTypeArguments&&t.classType.tupleTypeArguments.length>0&&(S.isOpenEndedTupleClass(t.classType)||this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportAssertAlwaysTrue,l.DiagnosticRule.reportAssertAlwaysTrue,p.Localizer.Diagnostic.assertAlwaysTrue(),e.testExpression)),!0}visitAssignment(e){return this._evaluator.evaluateTypesForStatement(e),e.typeAnnotationComment&&this._evaluator.getType(e.typeAnnotationComment),!0}visitAssignmentExpression(e){return this._evaluator.getType(e),!0}visitAugmentedAssignment(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitIndex(e){this._evaluator.getType(e);const t=this._evaluator.getType(e.baseExpression);if(t&&b.isObject(t)&&t.classType.tupleTypeArguments&&!S.isOpenEndedTupleClass(t.classType)){const n=t.classType.tupleTypeArguments.length;if(1===e.items.length&&!e.trailingComma&&0===e.items[0].argumentCategory&&!e.items[0].name){const t=this._evaluator.getType(e.items[0].valueExpression);if(t&&b.isObject(t)&&b.ClassType.isBuiltIn(t.classType,"int")&&S.isLiteralType(t)){const i=t.classType.literalValue;(i>=0&&i>=n||i<0&&i+n<0)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.tupleIndexOutOfRange().format({length:n,index:i}),e)}}}return!0}visitBinaryOperation(e){return this._evaluator.getType(e),!0}visitSlice(e){return this._evaluator.getType(e),!0}visitUnpack(e){return this._evaluator.getType(e),!0}visitTuple(e){return this._evaluator.getType(e),!0}visitUnaryOperation(e){return this._evaluator.getType(e),!0}visitTernary(e){return this._evaluator.getType(e),!0}visitStringList(e){return e.typeAnnotation&&this._evaluator.getType(e),e.strings.length>1&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportImplicitStringConcatenation,l.DiagnosticRule.reportImplicitStringConcatenation,p.Localizer.Diagnostic.implicitStringConcat(),e),!0}visitFormatString(e){return e.expressions.forEach((e=>{this._evaluator.getType(e)})),!0}visitName(e){return this._conditionallyReportPrivateUsage(e),!0}visitDel(e){return e.expressions.forEach((e=>{this._evaluator.verifyDeleteExpression(e)})),!0}visitMemberAccess(e){return this._evaluator.getType(e),this._conditionallyReportPrivateUsage(e.memberName),this.walk(e.leftExpression),!1}visitImportAs(e){return this._evaluator.evaluateTypesForStatement(e),!1}visitImportFrom(e){if(e.isWildcardImport){const t=d.getImportInfo(e.module);t&&t.isImportFound&&2!==t.importType&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportWildcardImportFromLibrary,l.DiagnosticRule.reportWildcardImportFromLibrary,p.Localizer.Diagnostic.wildcardLibraryImport(),e.wildcardToken||e)}else e.imports.forEach((e=>{this._evaluator.evaluateTypesForStatement(e)}));return!1}visitTypeAnnotation(e){return this._evaluator.getType(e.typeAnnotation),!0}visitMatch(e){return this._evaluator.getType(e.subjectExpression),!0}visitCase(e){return e.guardExpression&&this._evaluator.getType(e.guardExpression),this._evaluator.evaluateTypesForStatement(e.pattern),!0}visitError(e){return e.child&&this._evaluator.getType(e.child),!1}_isTypeValidForUnusedValueTest(e){return!(b.isNone(e)||S.isNoReturnType(e)||b.isNever(e)||b.isAnyOrUnknown(e))}_validateFunctionTypeVarUsage(e){if("none"===this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse)return;const t=new Map,n=new y.NameNodeWalker(((n,i,s)=>{const r=this._evaluator.getType(n);if(r&&b.isTypeVar(r)&&r.scopeId===this._evaluator.getScopeIdForNode(e)){let e=r.details.constraints.length>0||void 0!==r.details.boundType&&void 0!==i||b.isParamSpec(r);if(!e&&s&&void 0!==i){const t=this._evaluator.getType(s);(null==t?void 0:t.typeAliasInfo)&&t.typeAliasInfo.typeParameters&&i<t.typeAliasInfo.typeParameters.length&&(e=!0)}t.has(r.details.name)?t.get(r.details.name).nodes.push(n):t.set(r.details.name,{nodes:[n],isExempt:e})}}));e.parameters.forEach((e=>{const t=e.typeAnnotation||e.typeAnnotationComment;t&&n.walk(t)})),e.returnTypeAnnotation&&n.walk(e.returnTypeAnnotation),t.forEach((e=>{1!==e.nodes.length||e.isExempt||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,l.DiagnosticRule.reportInvalidTypeVarUse,p.Localizer.Diagnostic.typeVarUsedOnlyOnce().format({name:e.nodes[0].value}),e.nodes[0])}))}_validateOverloadConsistency(e,t,n){for(let i=0;i<n.length;i++){const s=n[i];if(b.FunctionType.isOverloaded(t)&&b.FunctionType.isOverloaded(s)&&this._isOverlappingOverload(t,s)){this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportOverlappingOverload,l.DiagnosticRule.reportOverlappingOverload,p.Localizer.Diagnostic.overlappingOverload().format({name:e.name.value,obscured:n.length+1,obscuredBy:i+1}),e.name);break}}for(let i=0;i<n.length;i++){const s=n[i];if(b.FunctionType.isOverloaded(t)&&b.FunctionType.isOverloaded(s)&&this._isOverlappingOverload(s,t)){const r=b.FunctionType.getSpecializedReturnType(s),a=b.FunctionType.getSpecializedReturnType(t);if(r&&a&&!this._evaluator.canAssignType(a,r,new o.DiagnosticAddendum,new C.TypeVarMap,8)){const t=this._findNodeForOverload(e,s);this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportOverlappingOverload,l.DiagnosticRule.reportOverlappingOverload,p.Localizer.Diagnostic.overloadReturnTypeMismatch().format({name:e.name.value,newIndex:n.length+1,prevIndex:i+1}),(t||e).name);break}}}}_findNodeForOverload(e,t){const n=this._evaluator.getDeclarationsForNameNode(e.name);if(n)for(const e of n)if(3===e.type){const n=this._evaluator.getTypeOfFunction(e.node);if((null==n?void 0:n.functionType)===t)return e.node}}_isOverlappingOverload(e,t){return this._evaluator.canAssignType(e,t,new o.DiagnosticAddendum,void 0,56)}_isLegalOverloadImplementation(e,t,n){let i=this._evaluator.canAssignType(e,t,n,void 0,56);const s=e.details.declaredReturnType||this._evaluator.getFunctionInferredReturnType(e),r=t.details.declaredReturnType||this._evaluator.getFunctionInferredReturnType(t),a=new o.DiagnosticAddendum;return this._evaluator.canAssignType(r,s,a.createAddendum(),void 0,8)||(a.addMessage(p.Localizer.DiagnosticAddendum.functionReturnTypeMismatch().format({sourceType:this._evaluator.printType(s,!1),destType:this._evaluator.printType(r,!1)})),n.addAddendum(a),i=!1),i}_walkStatementsAndReportUnreachable(e){let t=!1;for(const n of e){if(!t&&!this._evaluator.isNodeReachable(n)){const i=n.start,s=e[e.length-1],r=c.TextRange.getEnd(s);this._evaluator.addUnusedCode(n,{start:i,length:r-i}),t=!0}!t&&this._fileInfo.isStubFile&&this._validateStubStatement(n),this.walk(n)}}_validateStubStatement(e){switch(e.nodeType){case 19:case 28:case 10:case 0:break;case 57:case 26:case 53:case 58:this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,l.DiagnosticRule.reportInvalidStubStatement,p.Localizer.Diagnostic.invalidStubStatement(),e);break;case 47:for(const t of e.statements)switch(t.nodeType){case 2:case 4:case 5:case 6:case 7:case 9:case 11:case 14:case 15:case 24:case 26:case 27:case 29:case 30:case 31:case 35:case 38:case 39:case 40:case 43:case 44:case 45:case 46:case 51:case 52:case 53:case 55:case 56:case 57:case 58:case 59:case 60:case 61:this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,l.DiagnosticRule.reportInvalidStubStatement,p.Localizer.Diagnostic.invalidStubStatement(),t)}}}_validateExceptionType(e,t){const n=this._evaluator.getBuiltInType(t,"BaseException"),i=e=>!n||!b.isClass(n)||S.derivesFromClassRecursive(e,n,!1),s=new o.DiagnosticAddendum;let r;if(b.isAnyOrUnknown(e))r=e;else if(b.isObject(e)&&(e=S.transformTypeObjectToClass(e)),b.isClass(e))i(e)||s.addMessage(p.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),r=b.ObjectType.create(e);else if(b.isObject(e)){const n=this._evaluator.getTypeFromIterator(e,!1,t)||b.UnknownType.create();r=S.mapSubtypes(n,(t=>{if(b.isAnyOrUnknown(t))return t;const n=S.transformTypeObjectToClass(t);return b.isClass(n)?(i(n)||s.addMessage(p.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),b.ObjectType.create(n)):(s.addMessage(p.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),b.UnknownType.create())}))}return s.isEmpty()||this._evaluator.addError(p.Localizer.Diagnostic.exceptionTypeNotClass().format({type:this._evaluator.printType(e,!1)}),t),r||b.UnknownType.create()}_validateSymbolTables(){for(const e of this._scopedNodes){const t=d.getScope(e);t&&t.symbolTable.forEach(((e,n)=>{this._conditionallyReportUnusedSymbol(n,e,t.type),this._reportIncompatibleDeclarations(n,e),this._reportMultipleFinalDeclarations(n,e),this._reportMultipleTypeAliasDeclarations(n,e),this._reportInvalidOverload(n,e)}))}}_reportInvalidOverload(e,t){const n=t.getTypedDeclarations();if(n.length>=1){const i=n[0];if(3===i.type){const n=this._evaluator.getEffectiveTypeOfSymbol(t),s=(b.isOverloadedFunction(n)?n.overloads:b.isFunction(n)?[n]:[]).filter((e=>b.FunctionType.isOverloaded(e)));if(1===s.length&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.singleOverload().format({name:e}),i.node.name),!this._fileInfo.isStubFile&&s.length>0){let t;b.isOverloadedFunction(n)&&!b.FunctionType.isOverloaded(n.overloads[n.overloads.length-1])?t=n.overloads[n.overloads.length-1]:b.isFunction(n)&&!b.FunctionType.isOverloaded(n)&&(t=n),t?b.isOverloadedFunction(n)&&n.overloads.forEach(((n,s)=>{if(n===t||!b.FunctionType.isOverloaded(n))return;const r=new o.DiagnosticAddendum;if(!this._isLegalOverloadImplementation(n,t,r)&&t.details.declaration){const a=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.overloadImplementationMismatch().format({name:e,index:s+1})+r.getString(),t.details.declaration.node.name);a&&n.details.declaration&&a.addRelatedInfo(p.Localizer.DiagnosticAddendum.overloadMethod(),i.path,i.range)}})):this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.overloadWithoutImplementation().format({name:i.node.name.value}),i.node.name)}}}}_reportMultipleFinalDeclarations(e,t){if(!v.isFinalVariable(t))return;const n=t.getDeclarations();let i=!1,s=!1;if(n.forEach((t=>{h.isFinalVariableDeclaration(t)&&(i&&this._evaluator.addError(p.Localizer.Diagnostic.finalRedeclaration().format({name:e}),t.node),i=!0),1===t.type&&t.inferredTypeSource&&(s&&this._evaluator.addError(p.Localizer.Diagnostic.finalReassigned().format({name:e}),t.node),s=!0)})),!s&&!this._fileInfo.isStubFile){const t=n.find((e=>1===e.type&&e.isFinal));t&&this._evaluator.addError(p.Localizer.Diagnostic.finalUnassigned().format({name:e}),t.node)}}_reportMultipleTypeAliasDeclarations(e,t){const n=t.getDeclarations(),i=n.find((e=>h.isExplicitTypeAliasDeclaration(e)));i&&n.length>1&&n.forEach((t=>{t!==i&&this._evaluator.addError(p.Localizer.Diagnostic.typeAliasRedeclared().format({name:e}),t.node)}))}_reportIncompatibleDeclarations(e,t){const n=v.getLastTypedDeclaredForSymbol(t);if(!n)return;let i,s=t.getDeclarations().filter((e=>e!==n));if(3===n.type){const e=this._evaluator.getTypeOfFunction(n.node);s=s.filter((t=>{if(3!==t.type)return!0;const n=this._evaluator.getTypeOfFunction(t.node);return!n||(e&&b.isObject(e.decoratedType)&&b.ClassType.isPropertyClass(e.decoratedType.classType)&&b.isObject(n.decoratedType)&&b.ClassType.isPropertyClass(n.decoratedType.classType)?n.decoratedType.classType.details.typeSourceId!==e.decoratedType.classType.details.typeSourceId:!b.FunctionType.isOverloaded(n.functionType))}))}if(0===s.length)return;i=3===n.type?n.isMethod?p.Localizer.DiagnosticAddendum.seeMethodDeclaration():p.Localizer.DiagnosticAddendum.seeFunctionDeclaration():4===n.type?p.Localizer.DiagnosticAddendum.seeClassDeclaration():2===n.type?p.Localizer.DiagnosticAddendum.seeParameterDeclaration():1===n.type?p.Localizer.DiagnosticAddendum.seeVariableDeclaration():p.Localizer.DiagnosticAddendum.seeDeclaration();const r=e=>{if(e){let t;3===n.type||4===n.type?t=n.node.name:1===n.type?38===n.node.nodeType&&(t=n.node):2===n.type&&n.node.name&&(t=n.node.name),t&&e.addRelatedInfo(i,n.path,n.range)}};for(const t of s)if(4===t.type){r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.obscuredClassDeclaration().format({name:e}),t.node.name))}else if(3===t.type){r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,t.isMethod?p.Localizer.Diagnostic.obscuredMethodDeclaration().format({name:e}):p.Localizer.Diagnostic.obscuredFunctionDeclaration().format({name:e}),t.node.name))}else if(2===t.type){if(t.node.name){r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.obscuredParameterDeclaration().format({name:e}),t.node.name))}}else if(1===t.type){const i=this._evaluator.getTypeForDeclaration(n);if(t.typeAnnotationNode){if(38===t.node.nodeType){let s=!1;if(1===n.type){const e=this._evaluator.getTypeForDeclaration(t);i&&e&&b.isTypeSame(i,e)&&(s=!0)}if(!s){r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.obscuredVariableDeclaration().format({name:e}),t.node))}}}else if(i&&!S.isProperty(i)&&(3===n.type||4===n.type)){r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.obscuredVariableDeclaration().format({name:e}),t.node))}}}_conditionallyReportUnusedSymbol(e,t,n){const i=this._fileInfo.accessedSymbolMap;if(t.isIgnoredForProtocolMatch()||i.has(t.id))return;if("_"===e)return;if(_.isDunderName(e))return;t.getDeclarations().forEach((t=>{this._conditionallyReportUnusedDeclaration(t,this._isSymbolPrivate(e,n))}))}_conditionallyReportUnusedDeclaration(e,t){let n,i,s,r;switch(e.type){case 6:if(n=this._fileInfo.diagnosticRuleSet.reportUnusedImport,r=l.DiagnosticRule.reportUnusedImport,21===e.node.nodeType)if(e.node.alias)this._fileInfo.isStubFile||(i=e.node.alias);else{const t=e.node.module.nameParts;if(t.length>0){const e=t.map((e=>e.value)).join("."),n={start:t[0].start,length:t[0].length};return c.TextRange.extend(n,t[t.length-1]),this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(p.Localizer.Diagnostic.unaccessedSymbol().format({name:e}),n,{action:"pyright.unusedImport"}),void this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportUnusedImport,l.DiagnosticRule.reportUnusedImport,p.Localizer.Diagnostic.unaccessedImport().format({name:e}),n)}}else if(23===e.node.nodeType){const t=e.node.parent,n=this._fileInfo.isStubFile&&void 0!==e.node.alias,s=1===t.module.nameParts.length&&"__future__"===t.module.nameParts[0].value;n||s||(i=e.node.alias||e.node.name)}i&&(s=p.Localizer.Diagnostic.unaccessedImport().format({name:i.value}));break;case 1:case 2:if(!t)return;if(this._fileInfo.isStubFile)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedVariable,38===e.node.nodeType?i=e.node:41===e.node.nodeType&&(i=e.node.name,n="none"),i&&(r=l.DiagnosticRule.reportUnusedVariable,s=p.Localizer.Diagnostic.unaccessedVariable().format({name:i.value}));break;case 4:if(!t)return;if(this._fileInfo.isStubFile)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedClass,i=e.node.name,r=l.DiagnosticRule.reportUnusedClass,s=p.Localizer.Diagnostic.unaccessedClass().format({name:i.value});break;case 3:if(!t)return;if(this._fileInfo.isStubFile)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedFunction,i=e.node.name,r=l.DiagnosticRule.reportUnusedFunction,s=p.Localizer.Diagnostic.unaccessedFunction().format({name:i.value});break;default:return}if(i&&void 0!==r&&s){const e=r===l.DiagnosticRule.reportUnusedImport?{action:"pyright.unusedImport"}:void 0;this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(p.Localizer.Diagnostic.unaccessedSymbol().format({name:i.value}),i,e),this._evaluator.addDiagnostic(n,r,s,i)}}_validateIsInstanceCall(e){if(38!==e.leftExpression.nodeType||"isinstance"!==e.leftExpression.value&&"issubclass"!==e.leftExpression.value||2!==e.arguments.length)return;const t=e.leftExpression.value,n="isinstance"===t;let i=this._evaluator.getType(e.arguments[0].valueExpression);if(!i)return;if(i=S.mapSubtypes(i,(e=>S.transformPossibleRecursiveTypeAlias(S.transformTypeObjectToClass(e)))),S.derivesFromAnyOrUnknown(i))return;const s=this._evaluator.getType(e.arguments[1].valueExpression);if(!s)return;const r=e=>{let t=!0;return S.doForEachSubtype(e,(e=>{switch((e=this._evaluator.makeTopLevelTypeVarsConcrete(e)).category){case 2:case 1:case 0:break;case 8:t=b.ClassType.isBuiltIn(e.classType,"type");break;case 7:e.isTypeArgumentExplicit&&(t=!1);break;case 5:t=b.TypeBase.isInstantiable(e);break;default:t=!1}})),t};let a=!0;if(a=b.isObject(s)&&b.ClassType.isTupleClass(s.classType)&&s.classType.tupleTypeArguments?!s.classType.tupleTypeArguments.some((e=>!r(e))):r(s),!a){const t=new o.DiagnosticAddendum;t.addMessage(p.Localizer.DiagnosticAddendum.typeVarNotAllowed()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,n?p.Localizer.Diagnostic.isInstanceInvalidType().format({type:this._evaluator.printType(s,!1)})+t.getString():p.Localizer.Diagnostic.isSubclassInvalidType().format({type:this._evaluator.printType(s,!1)})+t.getString(),e.arguments[1])}let c=e;for(;c;){if(2===c.nodeType)return;c=c.parent}const u=["FunctionType","LambdaType","BuiltinFunctionType","BuiltinMethodType","type","Type"],d=[];if(b.isClass(s)){if(d.push(s),b.ClassType.isBuiltIn(s)&&u.some((e=>e===s.details.name)))return}else{if(!b.isObject(s))return;{const e=s.classType;if(S.isTupleClass(e)&&e.tupleTypeArguments&&e.tupleTypeArguments.forEach((e=>{b.isClass(e)&&d.push(e)})),b.ClassType.isBuiltIn(e)&&u.some((t=>t===e.details.name)))return}}d.some((e=>b.ClassType.isProtocolClass(e)&&!b.ClassType.isRuntimeCheckable(e)))&&this._evaluator.addError(p.Localizer.Diagnostic.protocolUsedInCall().format({name:t}),e.arguments[1].valueExpression);const h=e=>b.combineTypes(e),m=e=>{const t=[];for(const n of d){const i=b.ClassType.isDerivedFrom(e,n)||b.ClassType.isBuiltIn(n,"dict")&&b.ClassType.isTypedDictClass(e),s=b.ClassType.isDerivedFrom(n,e);s&&s&&!b.ClassType.isSameGenericClass(e,n)?t.push(b.UnknownType.create()):i?t.push(e):s&&t.push(n)}return n?t.map((e=>b.isClass(e)?b.ObjectType.create(e):e)):t};let y;if(n&&b.isObject(i)){y=h(m(i.classType))}else if(!n&&b.isClass(i)){y=h(m(i))}else{if(!b.isUnion(i))return;{let e=[],t=!1;if(S.doForEachSubtype(i,(i=>{b.isAnyOrUnknown(i)&&(t=!0),n&&b.isObject(i)?e=e.concat(m(i.classType)):!n&&b.isClass(i)&&(e=e.concat(m(i)))})),y=h(e),t)return}}const g=()=>{const e=d.map((e=>b.ObjectType.create(e)));return b.combineTypes(e)};b.isNever(y)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryIsInstance,l.DiagnosticRule.reportUnnecessaryIsInstance,n?p.Localizer.Diagnostic.unnecessaryIsInstanceNever().format({testType:this._evaluator.printType(i,!1),classType:this._evaluator.printType(g(),!1)}):p.Localizer.Diagnostic.unnecessaryIsSubclassNever().format({testType:this._evaluator.printType(i,!1),classType:this._evaluator.printType(g(),!1)}),e):b.isTypeSame(y,i)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryIsInstance,l.DiagnosticRule.reportUnnecessaryIsInstance,n?p.Localizer.Diagnostic.unnecessaryIsInstanceAlways().format({testType:this._evaluator.printType(i,!1),classType:this._evaluator.printType(g(),!1)}):p.Localizer.Diagnostic.unnecessaryIsSubclassAlways().format({testType:this._evaluator.printType(i,!1),classType:this._evaluator.printType(g(),!1)}),e)}_isSymbolPrivate(e,t){if(1===t||0===t)return!0;if(_.isPrivateName(e))return!0;if(_.isProtectedName(e)){return!(2===t)}return!1}_conditionallyReportPrivateUsage(e){var t;if("none"===this._fileInfo.diagnosticRuleSet.reportPrivateUsage)return;if(this._fileInfo.isStubFile)return;if(1===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.name===e)return;const n=e.value,i=_.isPrivateName(n),s=_.isProtectedName(n);if(!i&&!s)return;const r=this._evaluator.getDeclarationsForNameNode(e);let a,o=r&&r.length>0?r[r.length-1]:void 0;if(!o||o.node===e)return;if(6===o.type&&o.usesLocalName)return;if(o=this._evaluator.resolveAliasDeclaration(o,!0),!o||o.node===e)return;o.node&&(a=y.getEnclosingClassOrModule(o.node)),o.node&&o.node.parent&&o.node.parent===a&&10===a.nodeType&&(a=y.getEnclosingClassOrModule(a));let c=!1;if(a&&10===a.nodeType&&s){const t=this._evaluator.getTypeOfClass(a);if(t&&b.isClass(t.decoratedType)){c=!0;const n=y.getEnclosingClass(e);if(n){c=!0;const e=this._evaluator.getTypeOfClass(n);if(e&&b.isClass(e.decoratedType)&&S.derivesFromClassRecursive(e.decoratedType,t.decoratedType,!0))return}}}a&&!y.isNodeContainedWithin(e,a)&&(c?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,l.DiagnosticRule.reportPrivateUsage,p.Localizer.Diagnostic.protectedUsedOutsideOfClass().format({name:n}),e):this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,l.DiagnosticRule.reportPrivateUsage,10===a.nodeType?p.Localizer.Diagnostic.privateUsedOutsideOfClass().format({name:n}):p.Localizer.Diagnostic.privateUsedOutsideOfModule().format({name:n}),e))}_validateTypedDictClassSuite(e){const t=e=>{this._evaluator.addError(p.Localizer.Diagnostic.typedDictBadVar(),e)};e.statements.forEach((e=>{if(!d.isCodeUnreachable(e))if(47===e.nodeType)for(const n of e.statements)54!==n.nodeType&&18!==n.nodeType&&48!==n.nodeType&&42!==n.nodeType&&t(n);else t(e)}))}_validateFunctionReturn(e,t){var n;if(this._fileInfo.isStubFile)return;const i=e.returnTypeAnnotation||(null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation);if(i){const n=!this._evaluator.isAfterNodeReachable(e),s=this._evaluator.isAfterNodeReachable(e.suite);let r=t.details.declaredReturnType;if(r){b.isUnknown(r)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,l.DiagnosticRule.reportUnknownVariableType,p.Localizer.Diagnostic.declaredReturnTypeUnknown(),i):S.isPartlyUnknown(r)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,l.DiagnosticRule.reportUnknownVariableType,p.Localizer.Diagnostic.declaredReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(r,!0)}),i);const t=new o.DiagnosticAddendum,n=this._evaluator.getScopeIdForNode(e);this._containsContravariantTypeVar(r,n,t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.returnTypeContravariant()+t.getString(),i)}if(b.FunctionType.isGenerator(t)&&(r=S.getDeclaredGeneratorReturnType(t)),r&&!n&&s)if(S.isNoReturnType(r))y.isSuiteEmpty(e.suite)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.noReturnReturnsNone(),i);else if(!b.FunctionType.isAbstractMethod(t)){const t=new o.DiagnosticAddendum;this._evaluator.canAssignType(r,b.NoneType.createInstance(),t)||y.isSuiteEmpty(e.suite)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.returnMissing().format({returnType:this._evaluator.printType(r,!1)})+t.getString(),i)}}else{const n=this._evaluator.getFunctionInferredReturnType(t);b.isUnknown(n)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.returnTypeUnknown(),e.name):S.isPartlyUnknown(n)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(n,!0)}),e.name)}}_containsContravariantTypeVar(e,t,n){let i=!0;return S.doForEachSubtype(e,(e=>{b.isTypeVar(e)&&2===e.details.variance&&e.scopeId!==t&&(n.addMessage(p.Localizer.DiagnosticAddendum.typeVarIsContravariant().format({name:b.TypeVarType.getReadableName(e)})),i=!1)})),!i}_validateFinalMemberOverrides(e){e.details.fields.forEach(((t,n)=>{const i=S.lookUpClassMember(e,n,1);if(i&&b.isClass(i.classType)&&v.isFinalVariable(i.symbol)&&!_.isPrivateName(n)){const e=t.getDeclarations()[0];this._evaluator.addError(p.Localizer.Diagnostic.finalRedeclarationBySubclass().format({name:n,className:i.classType.details.name}),e.node)}}))}_validateProtocolTypeParamVariance(e,t){const n=t.details.typeParameters;if(0===n.length)return;const i=this._evaluator.getBuiltInType(e,"object");if(!b.isClass(i))return;const s=n.map((e=>b.TypeVarType.cloneAsInvariant(e))),r=b.ClassType.cloneWithNewTypeParameters(t,s),a=b.ObjectType.create(i);s.forEach(((i,o)=>{const c=s.map(((e,t)=>t===o?a:b.AnyType.create())),u=s.map(((e,t)=>t===o?e:b.AnyType.create())),d=b.ClassType.cloneForSpecialization(r,c,!0),h=b.ClassType.cloneForSpecialization(r,u,!0);let m;if(this._evaluator.canAssignProtocolClassToSelf(d,h))m=1;else{m=this._evaluator.canAssignProtocolClassToSelf(h,d)?2:0}if(m!==n[o].details.variance){let n;n=1===m?p.Localizer.Diagnostic.protocolVarianceCovariant().format({variable:i.details.name,class:t.details.name}):2===m?p.Localizer.Diagnostic.protocolVarianceContravariant().format({variable:i.details.name,class:t.details.name}):p.Localizer.Diagnostic.protocolVarianceInvariant().format({variable:i.details.name,class:t.details.name}),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,l.DiagnosticRule.reportInvalidTypeVarUse,n,e.name)}}))}_validateClassMethods(e){this._fileInfo.isStubFile||this._validateBaseClassOverrides(e)}_validateBaseClassOverrides(e){e.details.fields.forEach(((t,n)=>{if(!t.isClassMember())return;if(_.isPrivateName(n))return;const i=this._evaluator.getEffectiveTypeOfSymbol(t);if(b.isAnyOrUnknown(i))return;const s=S.lookUpClassMember(e,n,1);if(!s||!b.isClass(s.classType))return;if(!s.symbol.hasTypedDeclarations())return;const r=S.partiallySpecializeType(this._evaluator.getEffectiveTypeOfSymbol(s.symbol),s.classType);if(b.isFunction(r)||b.isOverloadedFunction(r)){const e=new o.DiagnosticAddendum;let a;if(b.isFunction(i)?a=i:b.isOverloadedFunction(i)&&(a=i.overloads[i.overloads.length-1]),a){if(!_.isDunderName(n)&&!_.isPrivateName(n)&&!this._evaluator.canOverrideMethod(r,a,e)){const t=a.details.declaration;if(t&&3===t.type){const i=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,l.DiagnosticRule.reportIncompatibleMethodOverride,p.Localizer.Diagnostic.incompatibleMethodOverride().format({name:n,className:s.classType.details.name})+e.getString(),t.node.name),r=v.getLastTypedDeclaredForSymbol(s.symbol);i&&r&&i.addRelatedInfo(p.Localizer.DiagnosticAddendum.overriddenMethod(),r.path,r.range)}}if(b.isFunction(r)&&!_.isPrivateName(n)&&b.FunctionType.isFinal(r)){const e=v.getLastTypedDeclaredForSymbol(t);if(e&&3===e.type){const t=this._evaluator.addError(p.Localizer.Diagnostic.finalMethodOverride().format({name:n,className:s.classType.details.name}),e.node.name),i=v.getLastTypedDeclaredForSymbol(s.symbol);t&&i&&t.addRelatedInfo(p.Localizer.DiagnosticAddendum.finalMethod(),i.path,i.range)}}}else if(!b.isAnyOrUnknown(i)){const e=t.getDeclarations();if(e.length>0){const t=e[e.length-1],r=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,l.DiagnosticRule.reportIncompatibleMethodOverride,p.Localizer.Diagnostic.methodOverridden().format({name:n,className:s.classType.details.name,type:this._evaluator.printType(i,!1)}),t.node),a=v.getLastTypedDeclaredForSymbol(s.symbol);r&&a&&r.addRelatedInfo(p.Localizer.DiagnosticAddendum.overriddenMethod(),a.path,a.range)}}}else if(S.isProperty(r))if(S.isProperty(i)){const a=r.classType.details.fields,c=i.classType.details.fields,u=s.classType;["fget","fset","fdel"].forEach((i=>{const s=new o.DiagnosticAddendum,r=a.get(i),d=c.get(i);if(r){const a=S.partiallySpecializeType(this._evaluator.getEffectiveTypeOfSymbol(r),u);if(b.isFunction(a))if(d){const t=S.partiallySpecializeType(this._evaluator.getEffectiveTypeOfSymbol(d),e);if(b.isFunction(t)&&!this._evaluator.canOverrideMethod(a,t,s.createAddendum())){s.addMessage(p.Localizer.DiagnosticAddendum.propertyMethodIncompatible().format({name:i}));const e=t.details.declaration;if(e&&3===e.type){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,l.DiagnosticRule.reportIncompatibleMethodOverride,p.Localizer.Diagnostic.propertyOverridden().format({name:n,className:u.details.name})+s.getString(),e.node.name),i=a.details.declaration;t&&i&&t.addRelatedInfo(p.Localizer.DiagnosticAddendum.overriddenMethod(),i.path,i.range)}}}else{s.addMessage(p.Localizer.DiagnosticAddendum.propertyMethodMissing().format({name:i}));const e=t.getDeclarations();if(e.length>0){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,l.DiagnosticRule.reportIncompatibleMethodOverride,p.Localizer.Diagnostic.propertyOverridden().format({name:n,className:u.details.name})+s.getString(),e[e.length-1].node),i=a.details.declaration;t&&i&&t.addRelatedInfo(p.Localizer.DiagnosticAddendum.overriddenMethod(),i.path,i.range)}}}}))}else{const e=t.getDeclarations();e.length>0&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,l.DiagnosticRule.reportIncompatibleMethodOverride,p.Localizer.Diagnostic.propertyOverridden().format({name:n,className:s.classType.details.name}),e[e.length-1].node)}else if("none"!==this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride){const e=new o.DiagnosticAddendum;if(!this._evaluator.canAssignType(r,i,e)){const i=t.getDeclarations();if(i.length>0){const t=i[i.length-1];if(t){const i=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,l.DiagnosticRule.reportIncompatibleVariableOverride,p.Localizer.Diagnostic.symbolOverridden().format({name:n,className:s.classType.details.name})+e.getString(),t.node),r=v.getLastTypedDeclaredForSymbol(s.symbol);i&&r&&i.addRelatedInfo(p.Localizer.DiagnosticAddendum.overriddenSymbol(),r.path,r.range)}}}}}))}_validateMethod(e,t,n){const i=this._evaluator.getTypeOfClass(n),s=null==i?void 0:i.classType;if(e.name&&"__new__"===e.name.value)0!==e.parameters.length&&e.parameters[0].name&&["cls","_cls","__cls","__mcls"].some((t=>e.parameters[0].name.value===t))||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.newClsParam(),e.parameters.length>0?e.parameters[0]:e.name),s&&this._validateClsSelfParameterType(t,s,!0);else if(e.name&&"__init_subclass__"===e.name.value)0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.initSubclassClsParam(),e.parameters.length>0?e.parameters[0]:e.name),s&&this._validateClsSelfParameterType(t,s,!0);else if(e.name&&"__class_getitem__"===e.name.value)0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.classGetItemClsParam(),e.parameters.length>0?e.parameters[0]:e.name),s&&this._validateClsSelfParameterType(t,s,!0);else if(b.FunctionType.isStaticMethod(t)){if(e.parameters.length>0&&e.parameters[0].name){const t=e.parameters[0].name.value;"self"!==t&&"cls"!==t||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.staticClsSelfParam(),e.parameters[0].name)}}else if(b.FunctionType.isClassMethod(t)){let n="";e.parameters.length>0&&e.parameters[0].name&&(n=e.parameters[0].name.value),"cls"!==n&&(this._fileInfo.isStubFile&&(n.startsWith("_")||"metacls"===n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.classMethodClsParam(),e.parameters.length>0?e.parameters[0]:e.name)),s&&this._validateClsSelfParameterType(t,s,!0)}else{if(0===e.decorators.length){let t="",i=!0;if(e.parameters.length>0&&(e.parameters[0].name&&(t=e.parameters[0].name.value),0!==e.parameters[0].category&&(i=!1)),i&&"self"!==t){let i=!1;if("cls"===t){const e=this._evaluator.getTypeOfClass(n),t=this._evaluator.getBuiltInType(n,"type");t&&b.isClass(t)&&e&&b.isClass(e.classType)&&S.derivesFromClassRecursive(e.classType,t,!0)&&(i=!0)}const s=_.isPrivateOrProtectedName(t);i||s||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.instanceMethodSelfParam(),e.parameters.length>0?e.parameters[0]:e.name)}}s&&this._validateClsSelfParameterType(t,s,!1)}}_validateClsSelfParameterType(e,t,n){if(e.details.parameters.length<1)return;const i=e.details.parameters[0];if(!i.typeAnnotation||!i.name)return;if(b.ClassType.isProtocolClass(t))return;const s=this._evaluator.makeTopLevelTypeVarsConcrete(S.transformTypeObjectToClass(i.type)),r=n?t:S.convertToInstance(t),a=new o.DiagnosticAddendum;b.isClass(s)&&b.ClassType.isProtocolClass(s)||b.isObject(s)&&b.ClassType.isProtocolClass(s.classType)||this._evaluator.canAssignType(s,r,a)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.clsSelfParamTypeMismatch().format({name:i.name,classType:this._evaluator.printType(r,!1)}),i.typeAnnotation)}_validateYieldType(e,t){let n,i;const s=y.getEnclosingFunction(e);if(s){const e=this._evaluator.getTypeOfFunction(s);e&&(a.assert(b.isFunction(e.functionType)),n=b.FunctionType.getSpecializedReturnType(e.functionType),n&&(i=this._evaluator.getTypeFromIterator(n,!!s.isAsync,void 0)),i&&!i&&s.returnTypeAnnotation&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,s.isAsync?p.Localizer.Diagnostic.generatorAsyncReturnType():p.Localizer.Diagnostic.generatorSyncReturnType(),s.returnTypeAnnotation))}if(this._evaluator.isNodeReachable(e))if(n&&S.isNoReturnType(n))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.noReturnContainsYield(),e);else if(i){const n=new o.DiagnosticAddendum;this._evaluator.canAssignType(i,t,n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.yieldTypeMismatch().format({exprType:this._evaluator.printType(t,!1),yieldType:this._evaluator.printType(i,!1)})+n.getString(),e.expression||e)}}_reportDuplicateImports(){const e=m.getTopLevelImports(this._moduleNode),t=new Map;e.orderedImports.forEach((e=>{if(22===e.node.nodeType){const t=new Map;e.node.imports.forEach((e=>{if(!e.alias){t.get(e.name.value)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,l.DiagnosticRule.reportDuplicateImport,p.Localizer.Diagnostic.duplicateImport().format({importName:e.name.value}),e.name):t.set(e.name.value,e)}}))}else if(e.subnode&&!e.subnode.alias){t.get(e.moduleName)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,l.DiagnosticRule.reportDuplicateImport,p.Localizer.Diagnostic.duplicateImport().format({importName:e.moduleName}),e.subnode):t.set(e.moduleName,e.subnode)}}))}}t.Checker=I},41563:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircularDependency=void 0;t.CircularDependency=class{constructor(){this._paths=[]}appendPath(e){this._paths.push(e)}getPaths(){return this._paths}normalizeOrder(){let e=0;this._paths.forEach(((t,n)=>{t<this._paths[e]&&(e=n)})),0!==e&&(this._paths=this._paths.slice(e).concat(this._paths.slice(0,e)))}isEqual(e){if(e._paths.length!==this._paths.length)return!1;for(let t=0;t<this._paths.length;t++)if(this._paths[t]!==e._paths[t])return!1;return!0}}},24394:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createKeyForReference=t.isCodeFlowSupportedForReference=t.getUniqueFlowNodeId=t.FlowFlags=void 0;const i=n(20823);!function(e){e[e.Unreachable=1]="Unreachable",e[e.Start=2]="Start",e[e.BranchLabel=4]="BranchLabel",e[e.LoopLabel=8]="LoopLabel",e[e.Assignment=16]="Assignment",e[e.Unbind=32]="Unbind",e[e.WildcardImport=64]="WildcardImport",e[e.TrueCondition=128]="TrueCondition",e[e.FalseCondition=512]="FalseCondition",e[e.Call=1024]="Call",e[e.PreFinallyGate=2048]="PreFinallyGate",e[e.PostFinally=4096]="PostFinally",e[e.AssignmentAlias=8192]="AssignmentAlias",e[e.VariableAnnotation=16384]="VariableAnnotation",e[e.PostContextManager=32768]="PostContextManager",e[e.TrueNeverCondition=65536]="TrueNeverCondition",e[e.FalseNeverCondition=131072]="FalseNeverCondition"}(t.FlowFlags||(t.FlowFlags={}));let s=1;t.getUniqueFlowNodeId=function(){return s++},t.isCodeFlowSupportedForReference=function e(t){if(38===t.nodeType)return!0;if(35===t.nodeType)return e(t.leftExpression);if(24===t.nodeType){if(1!==t.items.length||t.trailingComma||void 0!==t.items[0].name||0!==t.items[0].argumentCategory)return!1;const n=t.items[0].valueExpression;return!(40!==n.nodeType||n.isImaginary||!n.isInteger)&&e(t.baseExpression)}return!1},t.createKeyForReference=function e(t){let n;if(38===t.nodeType)n=t.value;else if(35===t.nodeType){n=`${e(t.leftExpression)}.${t.memberName.value}`}else{const s=e(t.baseExpression);i.assert(1===t.items.length&&40===t.items[0].valueExpression.nodeType),n=`${s}[${t.items[0].valueExpression.value.toString()}]`}return n}},81044:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileLevelDirectives=void 0;const i=n(14943);function s(e){const t=i.getStrictDiagnosticRuleSet(),n=i.getBooleanDiagnosticRules(),s=i.getDiagLevelDiagnosticRules(),r=i.getStrictModeNotOverriddenRules();for(const i of n)r.find((e=>e===i))||t[i]&&(e[i]=!0);for(const n of s){if(r.find((e=>e===n)))continue;const i=t[n],s=e[n];("error"===i||"warning"===i&&"error"!==s||"information"===i&&"error"!==s&&"warning"!==s)&&(e[n]=i)}}function r(e,t){const n=["pyright:","mspython:"].find((t=>e.startsWith(t)));if(n){const i=e.substr(n.length).trim().split(",").map((e=>e.trim()));i.some((e=>"strict"===e))&&s(t);for(const e of i)t=a(e,t)}return t}function a(e,t){const n=e.split("=").map((e=>e.trim()));if(2!==n.length)return t;const s=n[0],r=i.getBooleanDiagnosticRules();if(i.getDiagLevelDiagnosticRules().find((e=>e===s))){const e=function(e){switch(e){case"false":case"none":return"none";case"true":case"error":return"error";case"warning":return"warning";case"information":return"information";default:return}}(n[1]);void 0!==e&&(t[s]=e)}else if(r.find((e=>e===s))){const e=function(e){if("false"===e)return!1;if("true"===e)return!0;return}(n[1]);void 0!==e&&(t[s]=e)}return t}t.getFileLevelDirectives=function(e,t,n){let a=i.cloneDiagnosticRuleSet(t);n&&s(a);for(let t=0;t<e.count;t++){const n=e.getItemAt(t);if(n.comments)for(const e of n.comments){a=r(e.value.trim(),a)}}return a}},16800:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSpecialBuiltInClassDeclarations=t.isAliasDeclaration=t.isVariableDeclaration=t.isParameterDeclaration=t.isClassDeclaration=t.isFunctionDeclaration=void 0,t.isFunctionDeclaration=function(e){return 3===e.type},t.isClassDeclaration=function(e){return 4===e.type},t.isParameterDeclaration=function(e){return 2===e.type},t.isVariableDeclaration=function(e){return 1===e.type},t.isAliasDeclaration=function(e){return 6===e.type},t.isSpecialBuiltInClassDeclarations=function(e){return 5===e.type}},88023:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNameFromDeclaration=t.isPossibleTypeAliasDeclaration=t.isExplicitTypeAliasDeclaration=t.isFinalVariableDeclaration=t.areDeclarationsSame=t.hasTypeForDeclaration=void 0,t.hasTypeForDeclaration=function(e){switch(e.type){case 0:case 4:case 5:case 3:return!0;case 2:{if(e.node.typeAnnotation||e.node.typeAnnotationComment)return!0;const t=e.node.parent;if(28===(null==t?void 0:t.nodeType)&&t.functionAnnotationComment&&!t.functionAnnotationComment.isParamListEllipsis){const n=t.functionAnnotationComment.paramTypeAnnotations;return!(t.parameters.length>n.length&&e.node===t.parameters[0])}return!1}case 1:return!!e.typeAnnotationNode;case 6:return!1}},t.areDeclarationsSame=function(e,t){return e.type===t.type&&(e.path===t.path&&(e.range.start.line===t.range.start.line&&e.range.start.character===t.range.start.character&&(6!==e.type||6!==t.type||e.symbolName===t.symbolName&&e.firstNamePart===t.firstNamePart&&e.usesLocalName===t.usesLocalName)))},t.isFinalVariableDeclaration=function(e){return 1===e.type&&!!e.isFinal},t.isExplicitTypeAliasDeclaration=function(e){return 1===e.type&&!!e.typeAliasAnnotation},t.isPossibleTypeAliasDeclaration=function(e){return 1===e.type&&!!e.typeAliasName&&!e.typeAnnotationNode},t.getNameFromDeclaration=function(e){var t;switch(e.type){case 6:return e.symbolName;case 4:case 3:return e.node.name.value;case 2:return null===(t=e.node.name)||void 0===t?void 0:t.value;case 1:return 38===e.node.nodeType?e.node.value:void 0;case 0:case 5:return}throw new Error("Shouldn't reach here")}},21736:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDocStringToPlainText=t.convertDocStringToMarkdown=void 0,t.convertDocStringToMarkdown=function(e){return new k(e).convert()},t.convertDocStringToPlainText=function(e){const t=F(e),n=[];for(const e of t){const t=n.length>0?n[n.length-1]:void 0;A(e)&&A(t)||n.push(e)}return n.join("\n").trimEnd()};const n=/\S|$/,i=/\r?\n/,s=/\S/,r=/^\s*~~~+$/,a=/^\s*\+\+\++$/,o=/^(\s*)-\s/,l=/^(\s*)\*\s/,c=/^(\s*)\d+\.\s/,p=/^(\s+\* )(.*)$/,u=/^\s*\.\. /,d=/^\s*\.\.\s+(\w+)::\s*(.*)$/,h=/ *>>> /,m=/^\s*:(param|arg|type|return|rtype|raise|except|var|ivar|cvar|copyright|license)/,y=/^[.\s\t]+(@\w+)/,g=/^(\.\s{3})|^(\.)/,f=[{exp:/^\s*=+(\s+=+)+$/,replacement:"="},{exp:/^\s*-+(\s+-+)+$/,replacement:"-"},{exp:/^\s*~+(\s+-+)+$/,replacement:"~"},{exp:/^\s*\++(\s+\++)+$/,replacement:"+"}],T=/\s/g,_=/``/g,v=/\t/g,b=/~/g,S=/\+/g,C=/(?<!\\)([_*~[\]])/g,I=[{exp:/</g,replacement:"&lt;"},{exp:/>/g,replacement:"&gt;"}],D=/^\s*::$/,x=[{exp:/\s+::$/g,replacement:""},{exp:/(\S)\s*::$/g,replacement:"$1:"},{exp:/:[\w_\-+:.]+:`/g,replacement:"`"},{exp:/`:[\w_\-+:.]+:/g,replacement:"`"}];class k{constructor(e){this._builder="",this._skipAppendEmptyLine=!0,this._insideInlineCode=!1,this._appendDirectiveBlock=!1,this._stateStack=[],this._lineNum=0,this._blockIndent=0,this._state=this._parseText,this._lines=F(e)}convert(){for(this._lines.some((e=>y.exec(e)))&&(this._lines=this._lines.map((e=>e.replace(g,""))));void 0!==this._currentLineOrUndefined();){const e=this._state,t=this._lineNum;if(this._state(),this._state===e&&this._lineNum===t)break}return this._state===this._parseBacktickBlock||this._state===this._parseDocTest||this._state===this._parseLiteralBlock?this._trimOutputAndAppendLine("```"):this._insideInlineCode&&this._trimOutputAndAppendLine("`",!0),this._builder.trim()}_eatLine(){this._lineNum++}_currentLineOrUndefined(){return this._lineNum<this._lines.length?this._lines[this._lineNum]:void 0}_currentLine(){return this._currentLineOrUndefined()||""}_currentIndent(){return P(this._currentLine())}_prevIndent(){var e;return P(null!==(e=this._lineAt(this._lineNum-1))&&void 0!==e?e:"")}_lineAt(e){return e<this._lines.length?this._lines[e]:void 0}_nextBlockIndent(){return P(this._lines.slice(this._lineNum+1).find((e=>!A(e)))||"")}_currentLineIsOutsideBlock(){return this._currentIndent()<this._blockIndent}_currentLineWithinBlock(){return this._currentLine().substr(this._blockIndent)}_pushAndSetState(e){this._state===this._parseText&&(this._insideInlineCode=!1),this._stateStack.push(this._state),this._state=e}_popState(){this._state=this._stateStack.splice(0,1)[0],this._state===this._parseText&&(this._insideInlineCode=!1)}_parseText(){if(A(this._currentLineOrUndefined()))return void(this._state=this._parseEmpty);if(this._beginBacktickBlock())return;if(this._beginLiteralBlock())return;if(this._beginDocTest())return;if(this._beginDirective())return;if(this._beginList())return;if(this._beginFieldList())return;const e=this.formatPlainTextIndent(this._currentLine());this._appendTextLine(e),this._eatLine()}formatPlainTextIndent(e){const t=this._lineAt(this._lineNum-1),n=this._prevIndent(),i=this._currentIndent();return!(i>n)||A(t)||this._builder.endsWith("\\\n")||this._builder.endsWith("\n\n")||E(t)||(this._builder=this._builder.slice(0,-1)+"\\\n"),n>i&&!A(t)&&!this._builder.endsWith("\\\n")&&!this._builder.endsWith("\n\n")&&(this._builder=this._builder.slice(0,-1)+"\\\n"),e=0===n||this._builder.endsWith("\\\n")||this._builder.endsWith("\n\n")?this._convertIndent(e):e.trimStart()}_convertIndent(e){return e=e.replace(/^([ \t]+)(.+)$/g,((e,t,n)=>"&nbsp;".repeat(t.length)+n))}_escapeHtml(e){return I.forEach((t=>{e=e.replace(t.exp,t.replacement)})),e}_appendTextLine(e){const t=(e=this._preprocessTextLine(e)).split("`");for(let e=0;e<t.length;e++){let n=t[e];if(e>0&&(this._insideInlineCode=!this._insideInlineCode,this._append("`")),this._insideInlineCode)this._append(n);else{if(n=this._escapeHtml(n),0===e){if(1===t.length){for(const e of f)if(e.exp.test(n)){n=n.replace(T,e.replacement);break}if(r.test(n)){this._append(n.replace(b,"-"));continue}if(a.test(n)){this._append(n.replace(S,"-"));continue}}const e=p.exec(n);null!==e&&3===e.length&&(this._append(e[1]),n=e[2])}n=n.replace(C,"\\$1"),this._append(n)}}this._builder+="\n"}_preprocessTextLine(e){return D.test(e)?"":(x.forEach((t=>e=e.replace(t.exp,t.replacement))),e=e.replace(_,"`"))}_parseEmpty(){if(A(this._currentLineOrUndefined()))return this._appendLine(),void this._eatLine();this._state=this._parseText}_beginMinIndentCodeBlock(e){this._appendLine("```"),this._pushAndSetState(e),this._blockIndent=this._currentIndent()}_beginBacktickBlock(){return!!this._currentLine().startsWith("```")&&(this._appendLine(this._currentLine()),this._pushAndSetState(this._parseBacktickBlock),this._eatLine(),!0)}_parseBacktickBlock(){this._currentLine().startsWith("```")?(this._appendLine("```"),this._appendLine(),this._popState()):this._appendLine(this._currentLine()),this._eatLine()}_beginDocTest(){return!!h.test(this._currentLine())&&(this._beginMinIndentCodeBlock(this._parseDocTest),this._appendLine(this._currentLineWithinBlock()),this._eatLine(),!0)}_parseDocTest(){if(this._currentLineIsOutsideBlock()||A(this._currentLine()))return this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState();this._appendLine(this._currentLineWithinBlock()),this._eatLine()}_beginLiteralBlock(){const e=this._lineAt(this._lineNum-1);if(void 0===e)return!1;if(!A(e))return!1;let t=this._lineNum-2;for(;t>=0;t--){const e=this._lineAt(t);if(!A(e)){if(e.endsWith("::"))break;return!1}}return!(t<0)&&(0===this._currentIndent()?(this._appendLine("```"),this._pushAndSetState(this._parseLiteralBlockSingleLine),!0):(this._beginMinIndentCodeBlock(this._parseLiteralBlock),!0))}_parseLiteralBlock(){return A(this._currentLineOrUndefined())?(this._appendLine(),void this._eatLine()):this._currentLineIsOutsideBlock()?(this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState()):(this._appendLine(this._currentLineWithinBlock()),void this._eatLine())}_parseLiteralBlockSingleLine(){this._appendLine(this._currentLine()),this._appendLine("```"),this._appendLine(),this._popState(),this._eatLine()}_beginDirective(){return!!u.test(this._currentLine())&&(this._pushAndSetState(this._parseDirective),this._blockIndent=this._nextBlockIndent(),this._appendDirectiveBlock=!1,!0)}_beginFieldList(){var e,t;if(this._insideInlineCode)return!1;let n=this._currentLine();if(n.startsWith("@"))return this._appendLine(),this._appendTextLine(n),this._eatLine(),!0;const i=!(null==n?void 0:n.endsWith(":"))&&!(null==n?void 0:n.endsWith("::"))&&(null!==(t=null===(e=n.match(/:/g))||void 0===e?void 0:e.length)&&void 0!==t?t:0)%2==1,s=m.test(n);if(i||s){const e=this._lineAt(this._lineNum-1);return this._builder.endsWith("\\\n")||this._builder.endsWith("\n\n")||E(e)||(this._builder=this._builder.slice(0,-1)+"\\\n"),n=this._convertIndent(n),this._appendTextLine(n),this._eatLine(),!0}return!1}_beginList(){if(this._insideInlineCode)return!1;let e=this._currentLine();const t=o.exec(e);if(2===(null==t?void 0:t.length))return t[1].length>=4&&(e=" ".repeat(t[1].length/2)+e.trimLeft()),this._appendTextLine(e),this._eatLine(),this._state!==this._parseList&&this._pushAndSetState(this._parseList),!0;const n=l.exec(e);if(2===(null==n?void 0:n.length))return 0===n[1].length?e=e=" "+e:n[1].length>=4&&(e=" ".repeat(n[1].length/2)+e.trimLeft()),this._appendTextLine(e),this._eatLine(),this._state!==this._parseList&&this._pushAndSetState(this._parseList),!0;const i=c.exec(e);return 2===(null==i?void 0:i.length)&&(this._appendTextLine(e),this._eatLine(),!0)}_parseList(){if(A(this._currentLineOrUndefined())||this._currentLineIsOutsideBlock())return void this._popState();if(!this._beginList()){const e=this._currentLine().trimStart();this._appendTextLine(e),this._eatLine()}}_parseDirective(){const e=d.exec(this._currentLine());if(null!==e&&3===e.length){const t=e[1],n=e[2];"class"===t&&(this._appendDirectiveBlock=!0,this._appendLine(),this._appendLine("```"),this._appendLine(n),this._appendLine("```"),this._appendLine())}0===this._blockIndent?this._popState():this._state=this._parseDirectiveBlock,this._eatLine()}_parseDirectiveBlock(){A(this._currentLineOrUndefined())||!this._currentLineIsOutsideBlock()?(this._appendDirectiveBlock&&this._appendTextLine(this._currentLine().trimLeft()),this._eatLine()):this._popState()}_appendLine(e){A(e)?this._skipAppendEmptyLine||(this._builder+="\n",this._skipAppendEmptyLine=!0):(this._builder+=e+"\n",this._skipAppendEmptyLine=!1)}_append(e){this._builder+=e,this._skipAppendEmptyLine=!1}_trimOutputAndAppendLine(e,t=!1){this._builder=this._builder.trimRight(),this._skipAppendEmptyLine=!1,t||this._appendLine(),this._appendLine(e)}}function F(e){let t=(e=e.replace(v," ".repeat(8))).split(i).map((e=>e.trimRight()));if(t.length>0){let e=t[0].trimLeft();""===e?e=void 0:t.splice(0,1),t=function(e,t){const n=void 0===t?function(e){const t=e.filter((e=>!A(e))).map(P);return t.length>0?Math.min(...t):0}(e):t;return e.map((e=>n>e.length?"":e.substr(n)))}(t),void 0!==e&&t.splice(0,0,e)}return t}function P(e){return e.search(n)}function A(e){return void 0===e||!s.test(e)}function E(e){var t,n;return void 0!==e&&(null!==(n=null===(t=e.match(/^\s*[#`~=-]{3,}/))||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0}},20822:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractParameterDocumentation=t.decodeDocString=void 0,t.decodeDocString=function(e){const t=e.replace(/\r/g,"").replace(/\t/g,"        ").split("\n");let n=Number.MAX_VALUE;t.forEach(((e,i)=>{if(t.length<=1||i>0){const t=e.trimLeft();t&&(n=Math.min(n,e.length-t.length))}})),n>=Number.MAX_VALUE&&(n=0);const i=[];for(t.forEach(((e,t)=>{0===t?i.push(e.trimRight()):i.push(e.substr(n).trimRight())}));i.length>0&&0===i[0].length;)i.shift();for(;i.length>0&&0===i[i.length-1].length;)i.pop();return i.join("\n")},t.extractParameterDocumentation=function(e,t){if(!e||!t)return;const n=e.split("\n");for(const e of n){const n=e.trim();let i=n.indexOf("@param "+t);if(i>=0)return n.substr(i+7);if(i=n.indexOf(":param "+t),i>=0)return n.substr(i+7);if(i=n.indexOf(t+": "),i>=0)return n.substr(i);if(i=n.indexOf(t+" ("),i>=0)return n.substr(i)}}},67145:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ImportResolver=void 0;const a=n(9133),o=n(97956),l=n(94647),c=n(14551),p=r(n(14551)),u=n(49900),d=n(37633),h=r(n(96453)),m=n(26477),y=n(91197),g=[".pyd",".so",".dylib"],f=[".py",".pyi",...g];t.ImportResolver=class{constructor(e,t){this._cachedPythonSearchPaths=new Map,this._cachedImportResults=new Map,this._cachedModuleNameResults=new Map,this._cachedEntriesForPath=new Map,this.fileSystem=e,this._configOptions=t}invalidateCache(){this._cachedPythonSearchPaths=new Map,this._cachedImportResults=new Map,this._cachedModuleNameResults=new Map,this._invalidateFileSystemCache(),this.fileSystem instanceof d.PyrightFileSystem&&this.fileSystem.clearPartialStubs()}resolveImport(e,t,n){const i=this.formatImportName(n),s=[],r={importName:i,isRelative:!1,isImportFound:!1,isPartlyResolved:!1,isNamespacePackage:!1,isStubPackage:!1,importFailureInfo:s,resolvedPaths:[],importType:2,isStubFile:!1,isNativeLib:!1,implicitImports:[],filteredImplicitImports:[],nonStubImportResult:void 0};if(this.ensurePartialStubPackages(t),n.leadingDots>0){const r=this._resolveRelativeImport(e,t,n,i,s);if(r)return r.isRelative=!0,r}else{const s=this._lookUpResultsInCache(t,i,n.importedSymbols);if(s){if(!(s.isImportFound&&s.isNamespacePackage&&!this._isNamespacePackageResolved(n,s.implicitImports)))return s}const a=this._resolveBestAbsoluteImport(e,t,n,!0);if(a)return a.isStubFile&&(a.nonStubImportResult=this._resolveBestAbsoluteImport(e,t,n,!1)||r),this.addResultsToCache(t,i,a,n.importedSymbols)}return this.addResultsToCache(t,i,r,void 0)}getCompletionSuggestions(e,t,n,i){const s=[],r=new Set;if(n.leadingDots>0)this._getCompletionSuggestionsRelative(e,n,r,i);else{n.nameParts.length>0&&this._getCompletionSuggestionsTypeshedPath(t,n,!0,r,i),this.getCompletionSuggestionsAbsolute(t.root,n,r,i);for(const e of t.extraPaths)this.getCompletionSuggestionsAbsolute(e,n,r,i);this._configOptions.stubPath&&this.getCompletionSuggestionsAbsolute(this._configOptions.stubPath,n,r,i),this._getCompletionSuggestionsTypeshedPath(t,n,!1,r,i);const e=this._getPythonSearchPaths(t,s);for(const t of e)this.getCompletionSuggestionsAbsolute(t,n,r,i)}return r}getSourceFilesFromStub(e,t,n){const i=[];if(this._cachedImportResults.forEach((t=>{t.forEach((t=>{if(t.isStubFile&&t.isImportFound&&t.nonStubImportResult&&t.resolvedPaths[t.resolvedPaths.length-1]===e&&t.nonStubImportResult.isImportFound){const e=t.nonStubImportResult.resolvedPaths[t.nonStubImportResult.resolvedPaths.length-1];e.endsWith(".py")&&i.push(e)}}))})),0===i.length){const t=l.changeAnyExtension(e,".py");this.dirExistsCached(t)&&i.push(t)}if(0===i.length){const n=this.getImportRoots(t),s=[];for(const t of n)if(l.containsPath(t,e,!0)){const n=l.getRelativePathComponentsFromDirectory(t,e,!0);if(n.length>1){n[1].endsWith(o.stubsSuffix)&&(n[1]=n[1].substr(0,n[1].length-o.stubsSuffix.length));const e=l.combinePathComponents(n);e&&s.push(e)}}for(const e of s)for(const t of n){const n=l.resolvePaths(t,e);let s=l.changeAnyExtension(n,".py");if(this.fileExistsCached(s))i.push(s);else{const e=l.stripFileExtension(s);e.endsWith("__init__")?(s=e.substr(0,e.length-9)+".py",this.fileExistsCached(s)&&i.push(s)):(s=l.combinePaths(e,"__init__.py"),this.fileExistsCached(s)&&i.push(s))}}}return i}getModuleNameForImport(e,t){const n=a.getOrAdd(this._cachedModuleNameResults,t.root,(()=>new Map));return a.getOrAdd(n,e,(()=>this._getModuleNameForImport(e,t)))}_getModuleNameForImport(e,t){let n,i=0,s=!1;const r=[],a=this._getStdlibTypeshedPath(t,r);if(a&&(n=this._getModuleNameFromPath(a,e),n))return{moduleName:n,importType:i,isLocalTypingsFile:s};n=this._getModuleNameFromPath(t.root,e);for(const s of t.extraPaths){const t=this._getModuleNameFromPath(s,e);(!n||t&&t.length<n.length)&&(n=t,i=2)}if(this._configOptions.stubPath){const t=this._getModuleNameFromPath(this._configOptions.stubPath,e);(!n||t&&t.length<n.length)&&(n=t,i=2,s=!0)}const o=this._getThirdPartyTypeshedPath(t,r);if(o){const t=this._getModuleNameFromPath(o,e,!0);(!n||t&&t.length<n.length)&&(n=t,i=1)}const l=this.getTypeshedPathEx(t,r);if(l){const t=this._getModuleNameFromPath(l,e);(!n||t&&t.length<n.length)&&(n=t,i=1)}const c=this._getPythonSearchPaths(t,r);for(const t of c){const s=this._getModuleNameFromPath(t,e);(!n||s&&s.length<n.length)&&(n=s,i=1)}return n?{moduleName:n,importType:i,isLocalTypingsFile:s}:{moduleName:"",importType:2,isLocalTypingsFile:s}}getTypeshedStdLibPath(e){return this._getStdlibTypeshedPath(e,[])}getImportRoots(e){const t=[],n=[],i=this._getStdlibTypeshedPath(e,t);i&&n.push(i),n.push(e.root),n.push(...e.extraPaths),this._configOptions.stubPath&&n.push(this._configOptions.stubPath);const s=this._getThirdPartyTypeshedPackagePaths(e,t);n.push(...s);const r=this.getTypeshedPathEx(e,t);r&&n.push(r);const a=this._getPythonSearchPaths(e,t);return a.length>0&&n.push(...a),n}readdirEntriesCached(e){const t=this._cachedEntriesForPath.get(e);if(t)return t;let n;try{n=this.fileSystem.readdirEntriesSync(e)}catch(e){n=[]}return this._cachedEntriesForPath.set(e,n),n}fileExistsCached(e){var t,n;const i=this._splitPath(e);if(!i[0]||!i[1])return!!this.fileSystem.existsSync(e)&&(null!==(n=null===(t=l.tryStat(this.fileSystem,e))||void 0===t?void 0:t.isFile())&&void 0!==n&&n);const s=this.readdirEntriesCached(i[0]).find((e=>e.name===i[1]));if(null==s?void 0:s.isFile())return!0;if(null==s?void 0:s.isSymbolicLink()){const t=l.tryRealpath(this.fileSystem,e);if(t&&this.fileSystem.existsSync(t)&&l.isFile(this.fileSystem,t))return!0}return!1}dirExistsCached(e){var t,n;const i=this._splitPath(e);if(!i[0]||!i[1])return!!this.fileSystem.existsSync(e)&&(null!==(n=null===(t=l.tryStat(this.fileSystem,e))||void 0===t?void 0:t.isDirectory())&&void 0!==n&&n);const s=this.readdirEntriesCached(i[0]).find((e=>e.name===i[1]));if(null==s?void 0:s.isDirectory())return!0;if(null==s?void 0:s.isSymbolicLink()){const t=l.tryRealpath(this.fileSystem,e);if(t&&this.fileSystem.existsSync(t)&&l.isDirectory(this.fileSystem,t))return!0}return!1}ensurePartialStubPackages(e){if(!(this.fileSystem instanceof d.PyrightFileSystem))return!1;if(this.fileSystem.isPartialStubPackagesScanned(e))return!1;const t=this.fileSystem,n=[],i=[];return s(this._configOptions.stubPath),s(e.root),e.extraPaths.forEach((e=>s(e))),s(this.getTypeshedPathEx(e,n)),this._getPythonSearchPaths(e,n).forEach((e=>s(e))),this.fileSystem.processPartialStubPackages(i,this.getImportRoots(e)),this._invalidateFileSystemCache(),!0;function s(e){e&&!t.isPathScanned(e)&&i.push(e)}}addResultsToCache(e,t,n,i){return a.getOrAdd(this._cachedImportResults,e.root,(()=>new Map)).set(t,n),this.filterImplicitImports(n,i)}resolveAbsoluteImport(e,t,n,i,s,r=!1,a=!1,o=!1,l=!0,c=!1){if(l&&o){const a=this._resolveAbsoluteImport(e,t,n,i,s,r,!1,!0,!0,!0);if(a.packageDirectory)return a}return this._resolveAbsoluteImport(e,t,n,i,s,r,a,!1,l,c)}_invalidateFileSystemCache(){this._cachedEntriesForPath.clear()}_splitPath(e){const t=l.getPathComponents(e);if(t.length<=1)return[e,""];return[l.combinePathComponents(t.slice(0,-1)),t[t.length-1]]}_resolveAbsoluteImport(e,t,n,i,s,r,a,c,p,u){s.push(`Attempting to resolve using root path '${e}'`);const d=[];let h,y,g,f=e,T=!1,_=!1,v=!1,b=!1,S=[];if(0===n.nameParts.length){const e="__init__",t=l.combinePaths(f,e+".py"),n=l.combinePaths(f,e+".pyi");p&&this.fileExistsCached(n)?(s.push(`Resolved import with file '${n}'`),d.push(n),v=!0):this.fileExistsCached(t)?(s.push(`Resolved import with file '${t}'`),d.push(t)):(s.push(`Partially resolved import with directory '${f}'`),d.push(""),T=!0),S=this._findImplicitImports(i,f,[t,n])}else for(let e=0;e<n.nameParts.length;e++){const r=0===e,g=e===n.nameParts.length-1;f=l.combinePaths(f,n.nameParts[e]),c&&r&&(f+=o.stubsSuffix,_=!0);const C=this.dirExistsCached(f);if(C){r&&(h=f);const e="__init__",t=l.combinePaths(f,e+".py"),i=l.combinePaths(f,e+".pyi");let a=!1;if(p&&this.fileExistsCached(i)?(s.push(`Resolved import with file '${i}'`),d.push(i),g&&(v=!0),a=!0):this.fileExistsCached(t)&&(s.push(`Resolved import with file '${t}'`),d.push(t),a=!0),a&&!y&&u&&this.fileExistsCached(l.combinePaths(f,"py.typed"))&&(y=m.getPyTypedInfo(this.fileSystem,f)),!g){a||(d.push(""),T=!0,y=void 0);continue}if(a){S=this._findImplicitImports(n.nameParts.join("."),f,[t,i]);break}}let I=l.stripTrailingDirectorySeparator(f);const D=l.getFileName(I);I=l.getDirectoryPath(I);const x=l.combinePaths(I,D+".py"),k=l.combinePaths(I,D+".pyi");if(p&&this.fileExistsCached(k))s.push(`Resolved import with file '${k}'`),d.push(k),g&&(v=!0);else if(this.fileExistsCached(x))s.push(`Resolved import with file '${x}'`),d.push(x);else{if(a&&this.dirExistsCached(I)){const e=this._getFilesInDirectory(I).find((e=>this._isNativeModuleFileName(D,e)));if(e){const r=l.combinePaths(I,e);b=this._resolveNativeModuleStub(r,t,i,n,s,d)}}!b&&C?(s.push(`Partially resolved import with directory '${f}'`),d.push(""),g&&(S=this._findImplicitImports(i,f,[x,k]),T=!0)):b&&s.push(`Did not find file '${k}' or '${x}'`)}break}const C=d.length>0&&d.length<n.nameParts.length;return g=r?d.length>0:d.length>=n.nameParts.length,{importName:i,isRelative:!1,isNamespacePackage:T,isStubPackage:_,isImportFound:g,isPartlyResolved:C,importFailureInfo:s,importType:2,resolvedPaths:d,searchPath:e,isStubFile:v,isNativeLib:b,implicitImports:S,pyTypedInfo:y,filteredImplicitImports:S,packageDirectory:h}}getTypeshedPathEx(e,t){}resolveImportEx(e,t,n,i,s=[],r=!0){}resolveNativeImportEx(e,t,n=[]){}getNativeModuleName(e){const t=l.getFileExtension(e,!1).toLowerCase();if(this._isNativeModuleFileExtension(t))return l.stripFileExtension(l.stripFileExtension(e))}_lookUpResultsInCache(e,t,n){const i=this._cachedImportResults.get(e.root);if(!i)return;const s=i.get(t);return s?this.filterImplicitImports(s,n):void 0}_isNamespacePackageResolved(e,t){if(e.importedSymbols){if(!e.importedSymbols.some((e=>t.some((t=>t.name===e)))))return!1}else if(0===t.length)return!1;return!0}_getModuleNameFromPath(e,t,n=!1){e=l.ensureTrailingDirectorySeparator(e);let i=l.stripFileExtension(t);if(this._isNativeModuleFileExtension(l.getFileExtension(t))&&(i=l.stripFileExtension(i)),!i.startsWith(e))return;i.endsWith("__init__")&&(i=i.substr(0,i.length-9));const s=i.substr(e.length),r=l.getPathComponents(s);if(r.shift(),n){if(0===r.length)return;r.shift()}return 0===r.length||(r[0].endsWith(o.stubsSuffix)&&(r[0]=r[0].substr(0,r[0].length-o.stubsSuffix.length)),r.some((e=>!this._isIdentifier(e))))?void 0:r.join(".")}_resolveBestAbsoluteImport(e,t,n,i){const s=this.formatImportName(n),r=[];if(i&&n.nameParts.length>0){const e=this._findTypeshedPath(t,n,s,!0,r);if(e)return e.isTypeshedFile=!0,e}if(i&&this._configOptions.stubPath){r.push(`Looking in stubPath '${this._configOptions.stubPath}'`);const e=this.resolveAbsoluteImport(this._configOptions.stubPath,t,n,s,r,void 0,!1,!0,i,!1);if(e.isImportFound)return e.importType=2,e.isLocalTypingsFile=!0,e}let a;r.push(`Looking in root directory of execution environment '${t.root}'`);let o=this.resolveAbsoluteImport(t.root,t,n,s,r,void 0,!0,!0,i,!1);a=o;for(const e of t.extraPaths)r.push(`Looking in extraPath '${e}'`),o=this.resolveAbsoluteImport(e,t,n,s,r,void 0,!0,!0,i,!1),a=this._pickBestImport(a,o);const l=this._getPythonSearchPaths(t,r);if(l.length>0)for(const e of l){r.push(`Looking in python search path '${e}'`);const o=this.resolveAbsoluteImport(e,t,n,s,r,false,!0,!0,i,!0);if(o){if(o.importType=1,o.isImportFound&&o.isStubFile)return o;a=this._pickBestImport(a,o)}}else r.push("No python interpreter search path");const c=this.resolveImportEx(e,t,n,s,r,i);if(void 0!==c)return c;if(i){r.push("Looking for typeshed path");const e=this._findTypeshedPath(t,n,s,!1,r);if(e)return e.isTypeshedFile=!0,e}return a}_pickBestImport(e,t){if(!e)return t;if(!t)return e;if(t.isImportFound){if(!e.isImportFound)return t;if(e.isNamespacePackage&&!t.isNamespacePackage)return t;if(e.resolvedPaths.length>t.resolvedPaths.length)return t}else if(t.isPartlyResolved&&e.isNamespacePackage&&!t.isNamespacePackage)return t;return e}_isIdentifier(e){for(let t=0;t<e.length;t++)if(0===t?!u.isIdentifierStartChar(e.charCodeAt(t)):!u.isIdentifierChar(e.charCodeAt(t)))return!1;return!0}_getPythonSearchPaths(e,t){const n="<default>";if(!this._cachedPythonSearchPaths.has(n)){let e=h.findPythonSearchPaths(this.fileSystem,this._configOptions,t)||[];e=[...new Set(e)],this._cachedPythonSearchPaths.set(n,e)}return this._cachedPythonSearchPaths.get(n)}_findTypeshedPath(e,t,n,i,s){s.push(`Looking for typeshed ${i?h.stdLibFolderName:h.thirdPartyFolderName} path`);const r=i?this._getStdlibTypeshedPath(e,s):this._getThirdPartyTypeshedPackagePath(t,e,s);if(r&&this.dirExistsCached(r)){const a=this.resolveAbsoluteImport(r,e,t,n,s);if(a.isImportFound)return a.importType=i?0:1,a}s.push("Typeshed path not found")}_buildTypeshedThirdPartyPackageMap(e){this._cachedTypeshedThirdPartyPackagePaths=new Map,e&&this.readdirEntriesCached(e).forEach((t=>{if(t.isDirectory()){const n=l.combinePaths(e,t.name);this.readdirEntriesCached(n).forEach((e=>{"@python2"!==e.name&&(e.isDirectory()?this._cachedTypeshedThirdPartyPackagePaths.set(e.name,n):e.isFile()&&e.name.endsWith(".pyi")&&this._cachedTypeshedThirdPartyPackagePaths.set(l.stripFileExtension(e.name),n))}))}})),this._cachedTypeshedThirdPartyPackageRoots=[...new Set(this._cachedTypeshedThirdPartyPackagePaths.values())].sort()}_getCompletionSuggestionsTypeshedPath(e,t,n,i,s){const r=[],a=n?this._getStdlibTypeshedPath(e,r):this._getThirdPartyTypeshedPackagePath(t,e,r);a&&this.dirExistsCached(a)&&this.getCompletionSuggestionsAbsolute(a,t,i,s)}_getStdlibTypeshedPath(e,t){return this._getTypeshedSubdirectory(!0,e,t)}_getThirdPartyTypeshedPath(e,t){return this._getTypeshedSubdirectory(!1,e,t)}_getThirdPartyTypeshedPackagePath(e,t,n){const i=this._getThirdPartyTypeshedPath(t,n);this._cachedTypeshedThirdPartyPackagePaths||this._buildTypeshedThirdPartyPackageMap(i);const s=e.nameParts.length>0?e.nameParts[0]:"";return this._cachedTypeshedThirdPartyPackagePaths.get(s)}_getThirdPartyTypeshedPackagePaths(e,t){const n=this._getThirdPartyTypeshedPath(e,t);return this._cachedTypeshedThirdPartyPackagePaths||this._buildTypeshedThirdPartyPackageMap(n),this._cachedTypeshedThirdPartyPackageRoots}_getTypeshedSubdirectory(e,t,n){if(e){if(void 0!==this._cachedTypeshedStdLibPath)return this._cachedTypeshedStdLibPath}else if(void 0!==this._cachedTypeshedThirdPartyPath)return this._cachedTypeshedThirdPartyPath;let i="";if(this._configOptions.typeshedPath){const e=this._configOptions.typeshedPath;this.dirExistsCached(e)&&(i=e)}else{const e=this._getPythonSearchPaths(t,n);for(const t of e){const e=l.combinePaths(t,"typeshed");if(this.dirExistsCached(e)){i=e;break}}}if(i||(i=h.getTypeShedFallbackPath(this.fileSystem)||""),i=h.getTypeshedSubdirectory(i,e),this.dirExistsCached(i))return e?this._cachedTypeshedStdLibPath=i:this._cachedTypeshedThirdPartyPath=i,i}_resolveRelativeImport(e,t,n,i,s){s.push("Attempting to resolve relative import");let r=l.getDirectoryPath(e);for(let e=1;e<n.leadingDots;e++){if(""===r)return void s.push(`Invalid relative path '${i}'`);r=l.getDirectoryPath(r)}const a=this.resolveAbsoluteImport(r,t,n,i,s,!1,!0);return this.filterImplicitImports(a,n.importedSymbols)}_getCompletionSuggestionsRelative(e,t,n,i){let s=l.getDirectoryPath(e);for(let e=1;e<t.leadingDots;e++){if(""===s)return;s=l.getDirectoryPath(s)}this.getCompletionSuggestionsAbsolute(s,t,n,i)}_getFilesInDirectory(e){const t=this.readdirEntriesCached(e),n=t.filter((e=>e.isFile())).map((e=>e.name));return t.forEach((t=>{var i;const s=l.combinePaths(e,t.name);t.isSymbolicLink()&&(null===(i=l.tryStat(this.fileSystem,s))||void 0===i?void 0:i.isFile())&&n.push(t.name)})),n}getCompletionSuggestionsAbsolute(e,t,n,i){let s=e;const r=t.nameParts.map((e=>e));if(t.hasTrailingDot&&r.push(""),0===r.length)this._addFilteredSuggestions(s,"",n,i);else for(let e=0;e<r.length&&(e===r.length-1&&this._addFilteredSuggestions(s,r[e],n,i),s=l.combinePaths(s,r[e]),this.dirExistsCached(s));e++);}_addFilteredSuggestions(e,t,n,i){const s=l.getFileSystemEntriesFromDirEntries(this.readdirEntriesCached(e),this.fileSystem,e);s.files.forEach((e=>{const i=l.getFileExtension(e,!1).toLowerCase(),s=l.stripFileExtension(e,!0);f.some((e=>e===i))&&"__init__"!==s&&(t&&!p.isPatternInSymbol(t,s)||this._addUniqueSuggestion(s,n))})),s.directories.forEach((e=>{t&&!e.startsWith(t)||this._addUniqueSuggestion(e,n)}))}_addUniqueSuggestion(e,t){t.has(e)||/[.-]/.test(e)||y.isDunderName(e)&&"__future__"!==e||t.add(e)}filterImplicitImports(e,t){if(void 0===t){const t=Object.assign({},e);return t.filteredImplicitImports=[],t}if(0===t.length)return e;if(0===e.implicitImports.length)return e;const n=e.implicitImports.filter((e=>t.some((t=>t===e.name))));if(n.length===e.implicitImports.length)return e;const i=Object.assign({},e);return i.filteredImplicitImports=n,i}_findImplicitImports(e,t,n){const i=new Map,s=l.getFileSystemEntriesFromDirEntries(this.readdirEntriesCached(t),this.fileSystem,t);for(const r of s.files){const s=l.getFileExtension(r);let a,o=!1;if(".py"===s||".pyi"===s)a=l.stripFileExtension(r);else{if(!this._isNativeModuleFileExtension(s)||this.fileExistsCached(`${r}.py`)||this.fileExistsCached(`${r}.pyi`))continue;a=r.substr(0,r.indexOf(".")),o=!0}const c=l.combinePaths(t,r);if(!n.find((e=>e===c))){const n={isStubFile:r.endsWith(".pyi"),isNativeLib:o,name:a,path:c},s=i.get(n.name);if(!s||!s.isStubFile){if(o){const i=l.combinePaths(t,r),s=this.resolveNativeImportEx(i,`${e}.${a}`,[]);s&&(n.path=s)}i.set(n.name,n)}}}for(const e of s.directories){const s=l.combinePaths(t,e,"__init__.py"),r=s+"i";let a=!1,o="";if(this.fileExistsCached(r)?(a=!0,o=r):this.fileExistsCached(s)&&(o=s),o&&!n.find((e=>e===o))){const t={isStubFile:a,isNativeLib:!1,name:e,path:o};i.set(t.name,t)}}return[...i.values()]}formatImportName(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+e.nameParts.map((e=>e)).join(".")}_resolveNativeModuleStub(e,t,n,i,s,r){let a=n;if(i.leadingDots>0){const n=this.getModuleNameForImport(e,t);a=n.moduleName.length>0?n.moduleName:a}const o=this.resolveNativeImportEx(e,a,s);return o?(s.push(`Resolved native import ${n} with stub '${o}'`),r.push(o),!1):(s.push(`Resolved import with file '${e}'`),r.push(e),!0)}_isNativeModuleFileName(e,t){const n=l.getFileExtension(t,!1).toLowerCase(),i=l.stripFileExtension(t,!0);return this._isNativeModuleFileExtension(n)&&c.equateStringsCaseInsensitive(e,i)}_isNativeModuleFileExtension(e){return g.some((t=>t===e))}}},45214:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getAllImportNames=t.getContainingImportStatement=t.getTextEditsForAutoImportInsertion=t.getTextEditsForAutoImportSymbolAddition=t.getTopLevelImports=t.compareImportStatements=t.getImportGroup=void 0;const a=n(38213),o=n(28348),l=n(80957),c=r(n(35696)),p=r(n(91197));function u(e){return e.importResult?0===e.importResult.importType?0:1===e.importResult.importType||e.importResult.isLocalTypingsFile?1:e.importResult.isRelative?3:2:2}function d(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map((e=>e.value)).join("."),t}t.getImportGroup=u,t.compareImportStatements=function(e,t){const n=u(e),i=u(t);return n<i?-1:n>i?1:e.moduleName<t.moduleName?-1:1},t.getTopLevelImports=function(e,t=!1){const n={orderedImports:[],mapByFilePath:new Map};let i=!1,s=!1;return e.statements.forEach((e=>{47===e.nodeType?e.statements.forEach((e=>{20===e.nodeType?(s=!0,function(e,t,n){e.list.forEach((i=>{const s=c.getImportInfo(i.module);let r;s&&s.isImportFound&&(r=s.resolvedPaths[s.resolvedPaths.length-1]);const a={node:e,subnode:i,importResult:s,resolvedPath:r,moduleName:d(i.module),followsNonImportStatement:n};t.orderedImports.push(a),r&&(t.mapByFilePath.has(r)||t.mapByFilePath.set(r,a))}))}(e,n,i),i=!1):22===e.nodeType?(s=!0,function(e,t,n,i){var s;const r=c.getImportInfo(e.module);let a;r&&r.isImportFound&&(a=r.resolvedPaths[r.resolvedPaths.length-1]);if(i&&r){t.implicitImports=null!==(s=t.implicitImports)&&void 0!==s?s:new Map;for(const n of r.implicitImports){const i=e.imports.find((e=>e.name.value===n.name));i&&t.implicitImports.set(n.path,i)}}const o={node:e,importResult:r,resolvedPath:a,moduleName:d(e.module),followsNonImportStatement:n};if(t.orderedImports.push(o),a){const e=t.mapByFilePath.get(a);(!e||20===e.node.nodeType||e.moduleName.length>o.moduleName.length)&&t.mapByFilePath.set(a,o)}}(e,n,i,t),i=!1):i=s})):i=s})),n},t.getTextEditsForAutoImportSymbolAddition=function(e,t,n,i){const s=[];let r;if(t.node&&22===t.node.nodeType&&!t.node.imports.some((t=>t.name.value===e))){for(const n of t.node.imports){if(n.name.value>e)break;r=n}let a=!1,c="";if(t.node.imports.length>0){const e=o.convertOffsetToPosition(t.node.start,n.tokenizerOutput.lines),i=o.convertOffsetToPosition(t.node.imports[0].start,n.tokenizerOutput.lines),s=t.node.imports.length>1?o.convertOffsetToPosition(t.node.imports[1].start,n.tokenizerOutput.lines):void 0;if(i.line>e.line&&(void 0===s||s.line>i.line)){const e=n.tokenizerOutput.lines.getItemAt(i.line);c=n.text.substr(e.start,i.character),/^\s*$/.test(c)&&(a=!0)}}const p=r?l.TextRange.getEnd(r):t.node.imports.length>0?t.node.imports[0].start:t.node.start+t.node.length,u=o.convertOffsetToPosition(p,n.tokenizerOutput.lines),d=i?`${e} as ${i}`:`${e}`;let h;if(a){const e=n.tokenizerOutput.predominantEndOfLineSequence;h=r?`,${e}${c}${d}`:`${d},${e}${c}`}else h=r?`, ${d}`:`${d}, `;s.push({range:{start:u,end:u},replacementText:h})}return s},t.getTextEditsForAutoImportInsertion=function(e,t,n,i,s,r,a){const c=[],d=e||n,h=a?`${d} as ${a}`:d;let m,y=e?`from ${n} import ${h}`:`import ${h}`;const g=o.convertPositionToOffset(r,s.tokenizerOutput.lines);if(t.orderedImports.length>0&&g>=t.orderedImports[0].node.start){let e=!0,r=t.orderedImports[0],a=0;for(const o of t.orderedImports){const l=o.importResult?u(o):a;if(i<l){!e&&a<i&&(y=s.tokenizerOutput.predominantEndOfLineSequence+y);break}if(i===l&&o.moduleName>n)break;if(o.followsNonImportStatement){i>a&&(y=s.tokenizerOutput.predominantEndOfLineSequence+y);break}o===t.orderedImports[t.orderedImports.length-1]&&i>l&&(y=s.tokenizerOutput.predominantEndOfLineSequence+y),e=!e&&i<a&&i===l,a=l,r=o}r?(e?y+=s.tokenizerOutput.predominantEndOfLineSequence:y=s.tokenizerOutput.predominantEndOfLineSequence+y,m=o.convertOffsetToPosition(e?r.node.start:l.TextRange.getEnd(r.node),s.tokenizerOutput.lines)):m={line:0,character:0}}else{m={line:0,character:0};let e=!1;for(const t of s.parseTree.statements){let n=!0;if(47===t.nodeType&&1===t.statements.length){const e=t.statements[0];(48===e.nodeType||3===e.nodeType&&38===e.leftExpression.nodeType&&p.isDunderName(e.leftExpression.value))&&(n=!1)}if(n){m=o.convertOffsetToPosition(t.start,s.tokenizerOutput.lines),e=!1;break}m=o.convertOffsetToPosition(t.start+t.length,s.tokenizerOutput.lines),e=!0}y+=s.tokenizerOutput.predominantEndOfLineSequence+s.tokenizerOutput.predominantEndOfLineSequence,e?y=s.tokenizerOutput.predominantEndOfLineSequence+y:y+=s.tokenizerOutput.predominantEndOfLineSequence}return c.push({range:{start:m,end:m},replacementText:y}),c},t.getContainingImportStatement=function(e,t){for(;e&&(a.throwIfCancellationRequested(t),20!==e.nodeType&&22!==e.nodeType);)e=e.parent;return e},t.getAllImportNames=function(e){if(20===e.nodeType){return e.list}return e.imports}},15297:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ParseTreeCleanerWalker=void 0;const a=r(n(35696)),o=n(22339);class l extends o.ParseTreeWalker{constructor(e){super(),this._parseTree=e}clean(){this.walk(this._parseTree)}visitNode(e){return a.cleanNodeAnalysisInfo(e),super.visitNode(e)}}t.ParseTreeCleanerWalker=l},23241:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printParseNodeType=t.getCallNodeAndActiveParameterIndex=t.NameNodeWalker=t.isAssignmentToDefaultsFollowingNamedTuple=t.getDocString=t.isWithinLoop=t.isWithinAnnotationComment=t.isWithinTypeAnnotation=t.isWithinDefaultParamInitializer=t.isPartialMatchingExpression=t.isMatchingExpression=t.isSuiteEmpty=t.isNodeContainedWithin=t.isFinalAllowedForAssignmentTarget=t.getTypeAnnotationNode=t.getExecutionScopeNode=t.getTypeVarScopeNode=t.getEvaluationScopeNode=t.getEvaluationNodeForAssignmentExpression=t.getEnclosingSuiteOrModule=t.getEnclosingClassOrFunction=t.getEnclosingLambda=t.getEnclosingFunction=t.getEnclosingClassOrModule=t.getEnclosingModule=t.getEnclosingClass=t.printOperator=t.printExpression=t.printArgument=t.findNodeByOffset=t.findNodeByPosition=t.getNodeDepth=void 0;const i=n(20823),s=n(28348),r=n(80957),a=n(55390),o=n(35696),l=n(20822),c=n(22339);function p(e,t){if(t<e.start||t>r.TextRange.getEnd(e))return;const n=(new c.ParseTreeWalker).visitNode(e);for(const e of n)if(e){const n=p(e,t);if(n)return n}return e}function u(e,t){let n="";return 1===e.argumentCategory?n="*":2===e.argumentCategory&&(n="**"),e.name&&(n+=e.name.value+"="),n+=d(e.valueExpression,t),n}function d(e,t=0){switch(e.nodeType){case 38:return e.value;case 35:return d(e.leftExpression,t)+"."+e.memberName.value;case 9:return d(e.leftExpression,t)+"("+e.arguments.map((e=>u(e,t))).join(", ")+")";case 24:return d(e.baseExpression,t)+"["+e.items.map((e=>u(e,t))).join(", ")+"]"+(e.trailingComma?",":"");case 55:return h(e.operator)+" "+d(e.expression,t);case 7:return d(e.leftExpression,t)+" "+h(e.operator)+" "+d(e.rightExpression,t);case 40:{let t=e.value.toString();return e.isImaginary&&(t+="j"),t}case 48:return 1&t&&e.typeAnnotation?d(e.typeAnnotation,t):e.strings.map((e=>d(e,t))).join(" ");case 49:{let t="";return 8&e.token.flags&&(t+="r"),16&e.token.flags&&(t+="u"),32&e.token.flags&&(t+="b"),64&e.token.flags&&(t+="f"),4&e.token.flags?1&e.token.flags?t+=`'''${e.token.escapedValue}'''`:t+=`"""${e.token.escapedValue}"""`:1&e.token.flags?t+=`'${e.token.escapedValue}'`:t+=`"${e.token.escapedValue}"`,t}case 3:return d(e.leftExpression,t)+" = "+d(e.rightExpression,t);case 4:return d(e.name,t)+" := "+d(e.rightExpression,t);case 54:return d(e.valueExpression,t)+": "+d(e.typeAnnotation,t);case 5:return d(e.leftExpression,t)+" "+h(e.operator)+" "+d(e.rightExpression,t);case 6:return"await "+d(e.expression,t);case 51:return d(e.ifExpression,t)+" if "+d(e.testExpression,t)+" else "+d(e.elseExpression,t);case 31:return`[${e.entries.map((e=>d(e,t))).join(", ")}]`;case 56:return"*"+d(e.expression,t);case 52:{const n=e.expressions.map((e=>d(e,t)));return 1===n.length?`(${n[0]}, )`:`(${n.join(", ")})`}case 60:return e.expression?"yield "+d(e.expression,t):"yield";case 61:return"yield from "+d(e.expression,t);case 18:return"...";case 32:{let n="<ListExpression>";if(a.isExpressionNode(e.expression))n=d(e.expression,t);else if(17===e.expression.nodeType){n=`${d(e.expression.keyExpression,t)}: ${d(e.expression.valueExpression,t)}`}return n+" "+e.comprehensions.map((e=>33===e.nodeType?(e.isAsync?"async ":"")+"for "+d(e.targetExpression,t)+` in ${d(e.iterableExpression,t)}`:`if ${d(e.testExpression,t)}`)).join(" ")}case 46:{let n="";return e.startValue&&(n+=d(e.startValue,t)),e.endValue&&(n+=": "+d(e.endValue,t)),e.stepValue&&(n+=": "+d(e.stepValue,t)),n}case 30:return"lambda "+e.parameters.map((e=>{let n="";return 1===e.category?n+="*":2===e.category&&(n+="**"),e.name&&(n+=e.name.value),e.defaultValue&&(n+=" = "+d(e.defaultValue,t)),n})).join(", ")+": "+d(e.expression,t);case 11:if(33===e.constType)return"True";if(15===e.constType)return"False";if(9===e.constType)return"__debug__";if(26===e.constType)return"None";break;case 15:return`{ ${e.entries.map((e=>17===e.nodeType?`${d(e.keyExpression,t)}: ${d(e.valueExpression,t)}`:d(e,t)))} }`;case 16:return`**${d(e.expandExpression,t)}`;case 45:return e.entries.map((e=>d(e,t))).join(", ")}return"<Expression>"}function h(e){const t={0:"+",1:"+=",2:"=",3:"&",4:"&=",5:"~",6:"|",7:"|=",8:"^",9:"^=",10:"/",11:"/=",12:"==",13:"//",14:"//=",15:">",16:">=",17:"<<",18:"<<=",19:"<>",20:"<",21:"<=",22:"@",23:"@=",24:"%",25:"%=",26:"*",27:"*=",28:"!=",29:"**",30:"**=",31:">>",32:">>=",33:"-",34:"-=",36:"and",37:"or",38:"not",39:"is",40:"is not",41:"in",42:"not in"};return t[e]?t[e]:"unknown"}function m(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(36===n.nodeType)return;if(28===n.nodeType&&t)return;n=n.parent}}function y(e){let t=e.parent;for(;t;){if(28===t.nodeType)return t;if(10===t.nodeType)return;t=t.parent}}function g(e){let t,n=e,s=!1;for(;n;){switch(41===n.nodeType&&t===n.name&&(s=!0),n.nodeType){case 28:if(n.parameters.some((e=>e===t))){if(s&&void 0!==o.getScope(n))return n}else if(t===n.suite&&void 0!==o.getScope(n))return n;break;case 30:if(n.parameters.some((e=>e===t))){if(s&&void 0!==o.getScope(n))return n}else if((!t||t===n.expression)&&void 0!==o.getScope(n))return n;break;case 10:if(t===n.suite&&void 0!==o.getScope(n))return n;break;case 32:case 36:if(void 0!==o.getScope(n))return n}t=n,n=n.parent}i.fail("Did not find evaluation scope")}function f(e,t){if(38===e.nodeType&&38===t.nodeType)return e.value===t.value;if(35===e.nodeType&&35===t.nodeType)return f(e.leftExpression,t.leftExpression)&&e.memberName.value===t.memberName.value;if(24===e.nodeType&&24===t.nodeType){if(!f(e.baseExpression,t.baseExpression))return!1;if(1!==t.items.length||t.trailingComma||t.items[0].name||0!==t.items[0].argumentCategory)return!1;const n=e.items[0].valueExpression,i=t.items[0].valueExpression;return!(40!==i.nodeType||i.isImaginary||!i.isInteger)&&n.value===i.value}return!1}t.getNodeDepth=function(e){let t=0,n=e;for(;n;)t++,n=n.parent;return t},t.findNodeByPosition=function(e,t,n){const i=s.convertPositionToOffset(t,n);if(void 0!==i)return p(e,i)},t.findNodeByOffset=p,t.printArgument=u,t.printExpression=d,t.printOperator=h,t.getEnclosingClass=m,t.getEnclosingModule=function(e){let t=e.parent;for(;t;){if(36===t.nodeType)return t;t=t.parent}i.fail("Module node not found")},t.getEnclosingClassOrModule=function(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(36===n.nodeType)return n;if(28===n.nodeType&&t)return;n=n.parent}},t.getEnclosingFunction=y,t.getEnclosingLambda=function(e){let t=e.parent;for(;t;){if(30===t.nodeType)return t;if(50===t.nodeType)return;t=t.parent}},t.getEnclosingClassOrFunction=function(e){let t=e.parent;for(;t;){if(28===t.nodeType)return t;if(10===t.nodeType)return t;t=t.parent}},t.getEnclosingSuiteOrModule=function(e,t=!1,n=!0){let i=e.parent;for(;i;){if(50===i.nodeType)return i;if(36===i.nodeType)return i;if(30===i.nodeType&&n)return;if(28===i.nodeType&&t)return;i=i.parent}},t.getEvaluationNodeForAssignmentExpression=function(e){let t=g(e);for(;void 0!==t;){switch(t.nodeType){case 28:case 30:case 36:return t;case 10:return}t=t.parent}},t.getEvaluationScopeNode=g,t.getTypeVarScopeNode=function(e,t=!1){let n,i=e;for(;i;){switch(i.nodeType){case 28:if(n===i.suite||t)return i;break;case 10:if(n===i.suite)return i}n=i,i=i.parent}},t.getExecutionScopeNode=function(e){let t=g(e);for(;10===t.nodeType||32===t.nodeType;)t=g(t.parent);return t},t.getTypeAnnotationNode=function(e){let t=e,n=e.parent;for(;n;){if(54===n.nodeType){if(n.typeAnnotation===t)return n;break}t=n,n=n.parent}},t.isFinalAllowedForAssignmentTarget=function(e){if(38===e.nodeType)return!0;if(35===e.nodeType){if(38!==e.leftExpression.nodeType)return!1;if(!m(e))return!1;const t=y(e);return!!t&&"__init__"===t.name.value}return!1},t.isNodeContainedWithin=function(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parent}return!1},t.isSuiteEmpty=function(e){for(const t of e.statements){if(47!==t.nodeType)return!1;for(const e of t.statements)if(18===e.nodeType);else if(48!==e.nodeType)return!1}return!0},t.isMatchingExpression=f,t.isPartialMatchingExpression=function e(t,n){return 35===t.nodeType?f(t.leftExpression,n)||e(t.leftExpression,n):24===t.nodeType&&(f(t.baseExpression,n)||e(t.baseExpression,n))},t.isWithinDefaultParamInitializer=function(e){let t,n=e;for(;n;){if(41===n.nodeType&&t===n.defaultValue)return!0;if(30===n.nodeType||28===n.nodeType||10===n.nodeType||36===n.nodeType)return!1;t=n,n=n.parent}return!1},t.isWithinTypeAnnotation=function(e,t){let n,i=e,s=!1;for(;i;){if(41===i.nodeType&&(n===i.typeAnnotation||n===i.typeAnnotationComment))return s||!t;if(28===i.nodeType&&n===i.returnTypeAnnotation)return s||!t;if(28===i.nodeType&&n===i.functionAnnotationComment)return!0;if(54===i.nodeType&&n===i.typeAnnotation)return s||!t;if(3===i.nodeType&&n===i.typeAnnotationComment)return!0;if(48===i.nodeType&&n===i.typeAnnotation&&(s=!0),30===i.nodeType||28===i.nodeType||10===i.nodeType||36===i.nodeType)return!1;n=i,i=i.parent}return!1},t.isWithinAnnotationComment=function(e){let t,n=e;for(;n;){if(28===n.nodeType&&t===n.functionAnnotationComment)return!0;if(3===n.nodeType&&t===n.typeAnnotationComment)return!0;if(30===n.nodeType||28===n.nodeType||10===n.nodeType||36===n.nodeType)return!1;t=n,n=n.parent}return!1},t.isWithinLoop=function(e){let t=e;for(;t;){switch(t.nodeType){case 26:case 57:return!0}t=t.parent}return!1},t.getDocString=function(e){if(0===e.length)return;if(47!==e[0].nodeType)return;const t=e[0];if(0===t.statements.length||48!==t.statements[0].nodeType)return;const n=t.statements[0];return 0==(64&n.strings[0].token.flags)?l.decodeDocString(n.strings[0].value):void 0},t.isAssignmentToDefaultsFollowingNamedTuple=function(e){if(9!==e.nodeType||!e.parent||3!==e.parent.nodeType||38!==e.parent.leftExpression.nodeType||!e.parent.parent||47!==e.parent.parent.nodeType)return!1;const t=e.parent.leftExpression.value,n=e.parent.parent;if(n.statements[0]!==e.parent||!n.parent||36!==n.parent.nodeType&&50!==n.parent.nodeType)return!1;const i=n.parent;let s=i.statements.findIndex((e=>e===n));if(s<0)return!1;for(s++;s<i.statements.length;){const e=i.statements[s];if(47!==e.nodeType)break;if(48!==e.statements[0].nodeType){if(3===e.statements[0].nodeType){const n=e.statements[0];if(35===n.leftExpression.nodeType&&"__defaults__"===n.leftExpression.memberName.value){const e=n.leftExpression.leftExpression;if(35===e.nodeType&&"__new__"===e.memberName.value&&38===e.leftExpression.nodeType&&e.leftExpression.value===t)return!0}}break}s++}return!1};class T extends c.ParseTreeWalker{constructor(e){super(),this._callback=e}visitName(e){return this._callback(e,this._subscriptIndex,this._baseExpression),!0}visitIndex(e){this.walk(e.baseExpression);const t=this._subscriptIndex,n=this._baseExpression;return this._baseExpression=e.baseExpression,e.items.forEach(((e,t)=>{this._subscriptIndex=t,this.walk(e)})),this._subscriptIndex=t,this._baseExpression=n,!1}}t.NameNodeWalker=T,t.getCallNodeAndActiveParameterIndex=function(e,t,n){let i,s=e;for(;void 0!==s;){if(9===s.nodeType){i=s;break}s=s.parent}if(!i||!i.arguments)return;const a=n.getItemAtPosition(i.leftExpression.start);if(a>=0&&a+1<n.count){const e=n.getItemAt(a+1);if(13===e.type&&t<r.TextRange.getEnd(e))return}const o=r.TextRange.getEnd(i);if(t>o)return;const l=function(e,t){const n=e.getItemAtPosition(t);if(n<0)return;return e.getItemAt(n)}(n,o-1);if(t===o&&14===(null==l?void 0:l.type))return;let c=!1,p=-1,u=!1;return i.arguments.forEach(((e,i)=>{if(c)return;let s=e.start;const a=n.getItemAtPosition(s);a>=0&&(s=r.TextRange.getEnd(n.getItemAt(a-1)));let o=r.TextRange.getEnd(e);const l=n.getItemAtPosition(o);if(l>=0)for(let e=l;e<n.count;e++){const t=n.getItemAt(e);switch(t.type){case 12:case 14:break;default:continue}o=r.TextRange.getEnd(t);break}t<o&&(p=i,u=t>=s,c=!0)})),c||(p=i.arguments.length+1),{callNode:i,activeIndex:p,activeOrFake:u}},t.printParseNodeType=function(e){switch(e){case 0:return"Error";case 1:return"Argument";case 2:return"Assert";case 3:return"Assignment";case 4:return"AssignmentExpression";case 5:return"AugmentedAssignment";case 6:return"Await";case 7:return"BinaryOperation";case 8:return"Break";case 9:return"Call";case 10:return"Class";case 11:return"Constant";case 12:return"Continue";case 13:return"Decorator";case 14:return"Del";case 15:return"Dictionary";case 16:return"DictionaryExpandEntry";case 17:return"DictionaryKeyEntry";case 18:return"Ellipsis";case 19:return"If";case 20:return"Import";case 21:return"ImportAs";case 22:return"ImportFrom";case 23:return"ImportFromAs";case 24:return"Index";case 25:return"Except";case 26:return"For";case 27:return"FormatString";case 28:return"Function";case 29:return"Global";case 30:return"Lambda";case 31:return"List";case 32:return"ListComprehension";case 33:return"ListComprehensionFor";case 34:return"ListComprehensionIf";case 35:return"MemberAccess";case 36:return"Module";case 37:return"ModuleName";case 38:return"Name";case 39:return"Nonlocal";case 40:return"Number";case 41:return"Parameter";case 42:return"Pass";case 43:return"Raise";case 44:return"Return";case 45:return"Set";case 46:return"Slice";case 47:return"StatementList";case 48:return"StringList";case 49:return"String";case 50:return"Suite";case 51:return"Ternary";case 52:return"Tuple";case 53:return"Try";case 54:return"TypeAnnotation";case 55:return"UnaryOperation";case 56:return"Unpack";case 57:return"While";case 58:return"With";case 59:return"WithItem";case 60:return"Yield";case 61:return"YieldFrom";case 62:return"FunctionAnnotation";case 63:return"Match";case 64:return"Case";case 65:return"PatternSequence";case 66:return"PatternAs";case 67:return"PatternLiteral";case 68:return"PatternClass";case 69:return"PatternCapture";case 70:return"PatternMapping";case 71:return"PatternMappingKeyEntry";case 72:return"PatternMappingExpandEntry";case 73:return"PatternValue";case 74:return"PatternClassArgument"}i.assertNever(e)}},22339:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParseTreeWalker=void 0;const i=n(20823);t.ParseTreeWalker=class{walk(e){const t=this.visitNode(e);t.length>0&&this.walkMultiple(t)}walkMultiple(e){e.forEach((e=>{e&&this.walk(e)}))}visitNode(e){var t;switch(e.nodeType){case 1:if(this.visitArgument(e))return[e.name,e.valueExpression];break;case 2:if(this.visitAssert(e))return[e.testExpression,e.exceptionExpression];break;case 3:if(this.visitAssignment(e))return[e.leftExpression,e.rightExpression,e.typeAnnotationComment];break;case 4:if(this.visitAssignmentExpression(e))return[e.name,e.rightExpression];break;case 5:if(this.visitAugmentedAssignment(e))return[e.leftExpression,e.rightExpression];break;case 6:if(this.visitAwait(e))return[e.expression];break;case 7:if(this.visitBinaryOperation(e))return[e.leftExpression,e.rightExpression];break;case 8:if(this.visitBreak(e))return[];break;case 9:if(this.visitCall(e))return[e.leftExpression,...e.arguments];break;case 64:if(this.visitCase(e))return[e.pattern,e.guardExpression,e.suite];break;case 10:if(this.visitClass(e))return[...e.decorators,e.name,...e.arguments,e.suite];break;case 51:if(this.visitTernary(e))return[e.ifExpression,e.testExpression,e.elseExpression];break;case 11:if(this.visitConstant(e))return[];break;case 12:if(this.visitContinue(e))return[];break;case 13:if(this.visitDecorator(e))return[e.expression];break;case 14:if(this.visitDel(e))return e.expressions;break;case 15:if(this.visitDictionary(e))return e.entries;break;case 17:if(this.visitDictionaryKeyEntry(e))return[e.keyExpression,e.valueExpression];break;case 16:if(this.visitDictionaryExpandEntry(e))return[e.expandExpression];break;case 0:if(this.visitError(e))return[e.child,...null!==(t=e.decorators)&&void 0!==t?t:[]];break;case 19:if(this.visitIf(e))return[e.testExpression,e.ifSuite,e.elseSuite];break;case 20:if(this.visitImport(e))return e.list;break;case 21:if(this.visitImportAs(e))return[e.module,e.alias];break;case 22:if(this.visitImportFrom(e))return[e.module,...e.imports];break;case 23:if(this.visitImportFromAs(e))return[e.name,e.alias];break;case 24:if(this.visitIndex(e))return[e.baseExpression,...e.items];break;case 18:if(this.visitEllipsis(e))return[];break;case 25:if(this.visitExcept(e))return[e.typeExpression,e.name,e.exceptSuite];break;case 26:if(this.visitFor(e))return[e.targetExpression,e.iterableExpression,e.forSuite,e.elseSuite];break;case 27:if(this.visitFormatString(e))return e.expressions;break;case 28:if(this.visitFunction(e))return[...e.decorators,e.name,...e.parameters,e.returnTypeAnnotation,e.functionAnnotationComment,e.suite];break;case 62:if(this.visitFunctionAnnotation(e))return[...e.paramTypeAnnotations,e.returnTypeAnnotation];break;case 29:if(this.visitGlobal(e))return e.nameList;break;case 30:if(this.visitLambda(e))return[...e.parameters,e.expression];break;case 31:if(this.visitList(e))return e.entries;break;case 32:if(this.visitListComprehension(e))return[e.expression,...e.comprehensions];break;case 33:if(this.visitListComprehensionFor(e))return[e.targetExpression,e.iterableExpression];break;case 34:if(this.visitListComprehensionIf(e))return[e.testExpression];break;case 63:if(this.visitMatch(e))return[e.subjectExpression,...e.cases];break;case 35:if(this.visitMemberAccess(e))return[e.leftExpression,e.memberName];break;case 36:if(this.visitModule(e))return[...e.statements];break;case 37:if(this.visitModuleName(e))return e.nameParts;break;case 38:if(this.visitName(e))return[];break;case 39:if(this.visitNonlocal(e))return e.nameList;break;case 40:if(this.visitNumber(e))return[];break;case 41:if(this.visitParameter(e))return[e.name,e.typeAnnotation,e.typeAnnotationComment,e.defaultValue];break;case 42:if(this.visitPass(e))return[];break;case 69:if(this.visitPatternCapture(e))return[e.target];break;case 68:if(this.visitPatternClass(e))return[e.className,...e.arguments];break;case 74:if(this.visitPatternClassArgument(e))return[e.name,e.pattern];break;case 66:if(this.visitPatternAs(e))return[...e.orPatterns,e.target];break;case 67:if(this.visitPatternLiteral(e))return[e.expression];break;case 70:if(this.visitPatternMapping(e))return[...e.entries];break;case 71:if(this.visitPatternMappingKeyEntry(e))return[e.keyPattern,e.valuePattern];break;case 72:if(this.visitPatternMappingExpandEntry(e))return[e.target];break;case 65:if(this.visitPatternSequence(e))return[...e.entries];break;case 73:if(this.visitPatternValue(e))return[e.expression];break;case 43:if(this.visitRaise(e))return[e.typeExpression,e.valueExpression,e.tracebackExpression];break;case 44:if(this.visitReturn(e))return[e.returnExpression];break;case 45:if(this.visitSet(e))return e.entries;break;case 46:if(this.visitSlice(e))return[e.startValue,e.endValue,e.stepValue];break;case 47:if(this.visitStatementList(e))return e.statements;break;case 49:if(this.visitString(e))return[];break;case 48:if(this.visitStringList(e))return[e.typeAnnotation,...e.strings];break;case 50:if(this.visitSuite(e))return[...e.statements];break;case 52:if(this.visitTuple(e))return e.expressions;break;case 53:if(this.visitTry(e))return[e.trySuite,...e.exceptClauses,e.elseSuite,e.finallySuite];break;case 54:if(this.visitTypeAnnotation(e))return[e.valueExpression,e.typeAnnotation];break;case 55:if(this.visitUnaryOperation(e))return[e.expression];break;case 56:if(this.visitUnpack(e))return[e.expression];break;case 57:if(this.visitWhile(e))return[e.testExpression,e.whileSuite,e.elseSuite];break;case 58:if(this.visitWith(e))return[...e.withItems,e.suite];break;case 59:if(this.visitWithItem(e))return[e.expression,e.target];break;case 60:if(this.visitYield(e))return[e.expression];break;case 61:if(this.visitYieldFrom(e))return[e.expression];break;default:i.fail("Unexpected node type")}return[]}visitArgument(e){return!0}visitAssert(e){return!0}visitAssignment(e){return!0}visitAssignmentExpression(e){return!0}visitAugmentedAssignment(e){return!0}visitAwait(e){return!0}visitBinaryOperation(e){return!0}visitBreak(e){return!0}visitCall(e){return!0}visitCase(e){return!0}visitClass(e){return!0}visitTernary(e){return!0}visitContinue(e){return!0}visitConstant(e){return!0}visitDecorator(e){return!0}visitDel(e){return!0}visitDictionary(e){return!0}visitDictionaryKeyEntry(e){return!0}visitDictionaryExpandEntry(e){return!0}visitError(e){return!0}visitEllipsis(e){return!0}visitIf(e){return!0}visitImport(e){return!0}visitImportAs(e){return!0}visitImportFrom(e){return!0}visitImportFromAs(e){return!0}visitIndex(e){return!0}visitExcept(e){return!0}visitFor(e){return!0}visitFormatString(e){return!0}visitFunction(e){return!0}visitFunctionAnnotation(e){return!0}visitGlobal(e){return!0}visitLambda(e){return!0}visitList(e){return!0}visitListComprehension(e){return!0}visitListComprehensionFor(e){return!0}visitListComprehensionIf(e){return!0}visitMatch(e){return!0}visitMemberAccess(e){return!0}visitModule(e){return!0}visitModuleName(e){return!0}visitName(e){return!0}visitNonlocal(e){return!0}visitNumber(e){return!0}visitParameter(e){return!0}visitPass(e){return!0}visitPatternCapture(e){return!0}visitPatternClass(e){return!0}visitPatternClassArgument(e){return!0}visitPatternAs(e){return!0}visitPatternLiteral(e){return!0}visitPatternMappingExpandEntry(e){return!0}visitPatternSequence(e){return!0}visitPatternValue(e){return!0}visitPatternMappingKeyEntry(e){return!0}visitPatternMapping(e){return!0}visitRaise(e){return!0}visitReturn(e){return!0}visitSet(e){return!0}visitSlice(e){return!0}visitStatementList(e){return!0}visitString(e){return!0}visitStringList(e){return!0}visitSuite(e){return!0}visitTuple(e){return!0}visitTry(e){return!0}visitTypeAnnotation(e){return!0}visitUnaryOperation(e){return!0}visitUnpack(e){return!0}visitWhile(e){return!0}visitWith(e){return!0}visitWithItem(e){return!0}visitYield(e){return!0}visitYieldFrom(e){return!0}}},73054:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const o=n(29335),l=n(38213),c=n(11043),p=n(98173),u=n(20823),d=n(77134),h=n(94647),m=n(28348),y=n(14551),g=n(80957),f=n(76962),T=n(82615),_=n(30424),v=n(5165),b=r(n(35696)),S=n(41563),C=n(23241),I=n(57203),D=n(54549),x=n(93989),k=n(91197),F=n(25997),P=n(96938),A=n(96786);class E{constructor(e,t,n,i,s){this._extension=i,this._sourceFileList=[],this._sourceFileMap=new Map,this._parsedFileCount=0,this._lookUpImport=e=>{const t=this._getSourceFileInfoFromPath(e);if(!t)return;t.sourceFile.isBindingRequired()&&f.timingStats.typeCheckerTime.subtractFromTime((()=>{this._bindFile(t)}));const n=t.sourceFile.getModuleSymbolTable();if(!n)return;const i=t.sourceFile.getModuleDocString(),s=t.sourceFile.getParseResults();return{symbolTable:n,dunderAllNames:b.getDunderAllNames(s.parseTree),docString:i}},this._console=n||new c.StandardConsole,this._logTracker=null!=s?s:new d.LogTracker(n,"FG"),this._importResolver=e,this._configOptions=t,this._createNewEvaluator()}get evaluator(){return this._evaluator}setConfigOptions(e){this._configOptions=e,this._createNewEvaluator()}setImportResolver(e){this._importResolver=e,this._createNewEvaluator()}setTrackedFiles(e){if(this._sourceFileList.length>0){const t=new Map;e.forEach((e=>{t.set(h.normalizePathCase(this._fs,e),e)})),this._sourceFileList.forEach((e=>{const n=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());t.has(n)||(e.isTracked=!1)}))}return this.addTrackedFiles(e),this._removeUnneededFiles()}setAllowedThirdPartyImports(e){this._allowedThirdPartyImports=e}addTrackedFiles(e,t=!1,n=!1){e.forEach((e=>{this.addTrackedFile(e,t,n)}))}addTrackedFile(e,t=!1,n=!1){let i=this._getSourceFileInfoFromPath(e);if(i)return i.isTracked=!0,i.sourceFile;const s=this._getImportNameForFile(e),r=new D.SourceFile(this._fs,e,s,t,n,this._console,this._logTracker);return i={sourceFile:r,isTracked:!0,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:t,isThirdPartyPyTypedPresent:n,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(i),r}setFileOpened(e,t,n){let i=this._getSourceFileInfoFromPath(e);if(i)i.isOpenByClient=!0,i.diagnosticsVersion=void 0;else{const t=this._getImportNameForFile(e);i={sourceFile:new D.SourceFile(this._fs,e,t,!1,!1,this._console,this._logTracker),isTracked:!1,isOpenByClient:!0,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(i)}i.sourceFile.setClientVersion(t,n)}setFileClosed(e){const t=this._getSourceFileInfoFromPath(e);return t&&(t.isOpenByClient=!1,t.sourceFile.setClientVersion(null,[])),this._removeUnneededFiles()}markAllFilesDirty(e){const t=new Map;this._sourceFileList.forEach((n=>{e?n.sourceFile.markDirty():n.sourceFile.didContentsChangeOnDisk()&&(n.sourceFile.markDirty(),this._markFileDirtyRecursive(n,t))})),t.size>0&&this._createNewEvaluator()}markFilesDirty(e,t){const n=new Map;e.forEach((e=>{const i=this._getSourceFileInfoFromPath(e);i&&(t||!i.isOpenByClient&&i.sourceFile.didContentsChangeOnDisk())&&(i.sourceFile.markDirty(),this._markFileDirtyRecursive(i,n))})),n.size>0&&this._createNewEvaluator()}getFileCount(){return this._sourceFileList.length}getFilesToAnalyzeCount(){let e=0;return this._sourceFileList.forEach((t=>{t.sourceFile.isCheckingRequired()&&this._shouldCheckFile(t)&&e++})),e}isCheckingOnlyOpenFiles(){return this._configOptions.checkOnlyOpenFiles||!1}getSourceFile(e){const t=this._getSourceFileInfoFromPath(e);if(t)return t.sourceFile}getBoundSourceFile(e){const t=this._getSourceFileInfoFromPath(e);if(t)return this._bindFile(t),this.getSourceFile(e)}analyze(e,t=o.CancellationToken.None){return this._runEvaluatorWithCancellationToken(t,(()=>{const t=new f.Duration,n=this._sourceFileList.filter((e=>e.isOpenByClient&&e.sourceFile.isCheckingRequired()));if(n.length>0){const i=e?e.openFilesTimeInMs:Number.MAX_VALUE;for(const e of n)if(this._checkTypes(e)&&t.getDurationInMilliseconds()>i)return!0;if(void 0!==e)return!0}if(!this._configOptions.checkOnlyOpenFiles){const n=e?e.noOpenFilesTimeInMs:Number.MAX_VALUE;for(const e of this._sourceFileList)if(this._isUserCode(e)&&this._checkTypes(e)&&t.getDurationInMilliseconds()>n)return!0}return!1}))}indexWorkspace(e,t){return this._configOptions.indexing?this._runEvaluatorWithCancellationToken(t,(()=>{let n=0;for(const i of this._sourceFileList){if(!this._isUserCode(i))continue;this._bindFile(i);const s=i.sourceFile.index({indexingForAutoImportMode:!1},t);if(s){if(++n>2e3)return this._console.warn("Workspace indexing has hit its upper limit: 2000 files"),n;e(i.sourceFile.getFilePath(),s)}this._handleMemoryHighUsage()}return n})):0}printDependencies(e,t){const n=this._sourceFileList.filter((e=>!e.isTypeshedFile)).sort(((e,t)=>e.sourceFile.getFilePath()<t.sourceFile.getFilePath()?1:-1)),i=[];n.forEach((n=>{this._console.info("");let s=n.sourceFile.getFilePath();const r=h.getRelativePath(s,e);r&&(s=r),this._console.info(`${s}`),this._console.info(` Imports     ${n.imports.length} file`+(1===n.imports.length?"":"s")),t&&n.imports.forEach((e=>{this._console.info(`    ${e.sourceFile.getFilePath()}`)})),this._console.info(` Imported by ${n.importedBy.length} file`+(1===n.importedBy.length?"":"s")),t&&n.importedBy.forEach((e=>{this._console.info(`    ${e.sourceFile.getFilePath()}`)})),0===n.importedBy.length&&i.push(n.sourceFile)})),i.length>0&&(this._console.info(""),this._console.info(`${i.length} file${1===i.length?"":"s"} not explicitly imported`),i.forEach((e=>{this._console.info(`    ${e.getFilePath()}`)})))}writeTypeStub(e,t,n,i){for(const s of this._sourceFileList){l.throwIfCancellationRequested(i);const r=s.sourceFile.getFilePath(),a=h.getRelativePath(r,e);if(void 0!==a){let e=h.normalizePath(h.combinePaths(n,a));e=t?h.combinePaths(h.getDirectoryPath(e),"__init__.pyi"):h.stripFileExtension(e)+".pyi";const r=h.getDirectoryPath(e);try{h.makeDirectories(this._fs,r,n)}catch(e){throw new Error(`Could not create directory for '${r}'`)}this._bindFile(s),this._runEvaluatorWithCancellationToken(i,(()=>{new A.TypeStubWriter(e,s.sourceFile,this._evaluator).write()})),this._handleMemoryHighUsage()}}}getTypeForSymbol(e){this._handleMemoryHighUsage();return(this._evaluator||this._createNewEvaluator()).getEffectiveTypeOfSymbol(e)}printType(e,t){this._handleMemoryHighUsage();return(this._evaluator||this._createNewEvaluator()).printType(e,t)}static _getPrintTypeFlags(e){let t=0;return e.diagnosticRuleSet.printUnknownAsAny&&(t|=1),e.diagnosticRuleSet.omitTypeArgsIfAny&&(t|=2),e.diagnosticRuleSet.omitUnannotatedParamType&&(t|=4),e.diagnosticRuleSet.pep604Printing&&(t|=8),t}get _fs(){return this._importResolver.fileSystem}_getImportNameForFile(e){return this._importResolver.getModuleNameForImport(e,this._configOptions.getDefaultExecEnvironment()).moduleName}_addShadowedFile(e,t){let n=this._getSourceFileInfoFromPath(t);if(!n){const e=this._getImportNameForFile(t);n={sourceFile:new D.SourceFile(this._fs,t,e,!1,!1,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(n)}return n.shadows.includes(e)||n.shadows.push(e),e.shadowedBy.includes(n)||e.shadowedBy.push(n),n.sourceFile}_createNewEvaluator(){return this._evaluator=P.createTypeEvaluatorWithTracker(this._lookUpImport,{disableInferenceForPyTypedSources:this._configOptions.disableInferenceForPyTypedSources,printTypeFlags:E._getPrintTypeFlags(this._configOptions),logCalls:this._configOptions.logTypeEvaluationTime,minimumLoggingThreshold:this._configOptions.typeEvaluationTimeThreshold},this._logTracker,this._configOptions.logTypeEvaluationTime?F.createTracePrinter(this._importResolver.getImportRoots(this._configOptions.findExecEnvironment(this._configOptions.projectRoot))):void 0),this._evaluator}_parseFile(e,t){if(this._isFileNeeded(e)&&e.sourceFile.isParseRequired()&&(e.sourceFile.parse(this._configOptions,this._importResolver,t)&&(this._parsedFileCount++,this._updateSourceFileImports(e,this._configOptions)),e.sourceFile.isFileDeleted())){e.isTracked=!1;const t=new Map;this._markFileDirtyRecursive(e,t),this._importResolver.invalidateCache()}}_bindFile(e,t){if(!this._isFileNeeded(e)||!e.sourceFile.isBindingRequired())return;let n;if(this._parseFile(e,t),e.builtinsImport){this._bindFile(e.builtinsImport);const t=e.builtinsImport.sourceFile.getParseResults();t&&(n=b.getScope(t.parseTree),u.assert(void 0!==n))}e.sourceFile.bind(this._configOptions,this._lookUpImport,n)}_buildModuleSymbolsMap(e,t,n,i){return T.buildModuleSymbolsMap(this._sourceFileList.filter((n=>n!==e&&(!t||this._isUserCode(n)))),n,i)}_shouldCheckFile(e){return!!e.isOpenByClient||!(this._configOptions.checkOnlyOpenFiles||!e.isTracked)}_checkTypes(e){return this._logTracker.log(`analyzing: ${e.sourceFile.getFilePath()}`,(t=>{if(!this._isFileNeeded(e))return t.suppress(),!1;if(!e.sourceFile.isCheckingRequired())return t.suppress(),!1;if(!this._shouldCheckFile(e))return t.suppress(),!1;if(this._bindFile(e),e.sourceFile.check(this._evaluator),this._handleMemoryHighUsage(),"none"!==this._configOptions.diagnosticRuleSet.reportImportCycles&&!this._allowedThirdPartyImports){const t=new Map;this._getImportsRecursive(e,t,0),t.forEach((e=>{f.timingStats.cycleDetectionTime.timeOperation((()=>{this._detectAndReportImportCycles(e)}))}))}return!0}))}_getImportsRecursive(e,t,n){const i=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());if(!t.has(i))if(n>256)e.sourceFile.setHitMaxImportDepth(256);else{t.set(i,e);for(const i of e.imports)this._getImportsRecursive(i,t,n+1)}}_detectAndReportImportCycles(e,t=[],n=new Map){if(e.sourceFile.isStubFile()||e.isThirdPartyImport)return;const i=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());if(n.has(i))t.length>1&&e===t[0]&&this._logImportCycle(t);else{if(n.has(i))return;n.set(i,!0),t.push(e);for(const i of e.imports)this._detectAndReportImportCycles(i,t,n);n.set(i,!1),t.pop()}}_logImportCycle(e){const t=new S.CircularDependency;e.forEach((e=>{t.appendPath(e.sourceFile.getFilePath())})),t.normalizeOrder();const n=t.getPaths()[0],i=this._getSourceFileInfoFromPath(n);u.assert(void 0!==i),i.sourceFile.addCircularDependency(t)}_markFileDirtyRecursive(e,t){const n=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());t.has(n)||(e.sourceFile.markReanalysisRequired(),t.set(n,!0),e.importedBy.forEach((e=>{this._markFileDirtyRecursive(e,t)})))}getTextOnRange(e,t,n){const i=this._sourceFileMap.get(e);if(!i)return;const s=i.sourceFile,r=s.getFileContents();return void 0!==r?this._runEvaluatorWithCancellationToken(n,(()=>{this._parseFile(i);const e=s.getParseResults(),n=m.convertRangeToTextRange(t,e.tokenizerOutput.lines);if(n)return r.substr(n.start,n.length)})):void 0}getAutoImports(e,t,n,i,s,r,a,o){const l=this._getSourceFileInfoFromPath(e);if(!l)return[];const c=l.sourceFile,p=c.getFileContents();return void 0===p?[]:this._runEvaluatorWithCancellationToken(o,(()=>{this._bindFile(l);const u=c.getParseResults(),d=m.convertRangeToTextRange(t,u.tokenizerOutput.lines);if(!d)return[];const h=C.findNodeByOffset(u.parseTree,d.start);if(!h)return[];const g=p.substr(d.start,d.length),f=this._buildModuleSymbolsMap(l,!!s,!0,o),_=new T.AutoImporter(this._configOptions.findExecEnvironment(e),this._importResolver,u,t.start,new Set,f,{lazyEdit:r,allowVariableInAll:a,libraryMap:s,patternMatcher:(e,t)=>y.computeCompletionSimilarity(e,t)>n}),v=[],b=I.getScopeForNode(h);if(b){const e=null==i?void 0:i.get(g);e&&v.push(..._.getAutoImportCandidatesForAbbr(g,e,o)),v.push(..._.getAutoImportCandidates(g,n,void 0,o).filter((e=>!b.lookUpSymbolRecursive(e.name))))}return v}))}getDiagnostics(e){const t=this._removeUnneededFiles();return this._sourceFileList.forEach((n=>{if(this._shouldCheckFile(n)){const i=n.sourceFile.getDiagnostics(e,n.diagnosticsVersion);void 0!==i&&(t.push({filePath:n.sourceFile.getFilePath(),diagnostics:i}),n.diagnosticsVersion=n.sourceFile.getDiagnosticVersion())}else!n.isOpenByClient&&e.checkOnlyOpenFiles&&void 0!==n.diagnosticsVersion&&(t.push({filePath:n.sourceFile.getFilePath(),diagnostics:[]}),n.diagnosticsVersion=void 0)})),t}getDiagnosticsForRange(e,t){const n=this.getSourceFile(e);if(!n)return[];const i=n.getDiagnostics(this._configOptions);return i?i.filter((e=>g.doRangesIntersect(e.range,t))):[]}getDefinitionsForPosition(e,t,n,i){return this._runEvaluatorWithCancellationToken(i,(()=>{const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const r=this._configOptions.findExecEnvironment(e);return s.sourceFile.getDefinitionsForPosition(this._createSourceMapper(r),t,n,this._evaluator,i)}))}reportReferencesForPosition(e,t,n,i,s){this._runEvaluatorWithCancellationToken(s,(()=>{const r=this._getSourceFileInfoFromPath(e);if(!r)return;const a=this._isUserCode(r);this._bindFile(r);const o=this._configOptions.findExecEnvironment(e),c=r.sourceFile.getDeclarationForPosition(this._createSourceMapper(o),t,this._evaluator,i,s);if(c)if(c.requiresGlobalSearch){for(const e of this._sourceFileList)l.throwIfCancellationRequested(s),(e.isOpenByClient||!a||this._isUserCode(e))&&(this._bindFile(e),e.sourceFile.addReferences(c,n,this._evaluator,s)),this._handleMemoryHighUsage();if(n)for(const e of c.declarations){if(l.throwIfCancellationRequested(s),c.locations.some((t=>t.path===e.path)))continue;const t=this._getSourceFileInfoFromPath(e.path);if(!t)continue;const i=new v.ReferencesResult(c.requiresGlobalSearch,c.nodeAtOffset,c.symbolName,c.declarations);t.sourceFile.addReferences(i,n,this._evaluator,s);for(const t of i.locations)t.path===e.path&&g.doesRangeContain(e.range,t.range)&&c.addLocations(t)}}else r.sourceFile.addReferences(c,n,this._evaluator,s)}))}getFileIndex(e,t,n){if(t.indexingForAutoImportMode){const t=h.stripFileExtension(h.getFileName(e));if(k.isPrivateOrProtectedName(t))return}return this._handleMemoryHighUsage(),this._runEvaluatorWithCancellationToken(n,(()=>{const i=this._getSourceFileInfoFromPath(e);if(!i)return;let s;if(t.indexingForAutoImportMode&&!i.sourceFile.isStubFile()&&void 0===i.sourceFile.getClientVersion())try{if(s=this._fs.readFileSync(e,"utf8"),s.indexOf("__all__")<0)return}catch(e){s=void 0}return this._bindFile(i,s),i.sourceFile.index(t,n)}))}addSymbolsForDocument(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{const i=this._getSourceFileInfoFromPath(e);i&&(i.sourceFile.getCachedIndexResults()||this._bindFile(i),i.sourceFile.addHierarchicalSymbolsForDocument(t,n))}))}reportSymbolsForWorkspace(e,t,n){this._runEvaluatorWithCancellationToken(n,(()=>{if(e)for(const i of this._sourceFileList){if(!this._isUserCode(i))continue;i.sourceFile.getCachedIndexResults()||this._bindFile(i);const s=i.sourceFile.getSymbolsForDocument(e,n);s.length>0&&t(s),this._handleMemoryHighUsage()}}))}getHoverForPosition(e,t,n,i){return this._runEvaluatorWithCancellationToken(i,(()=>{const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const r=this._configOptions.findExecEnvironment(e);return s.sourceFile.getHoverForPosition(this._createSourceMapper(r,!0),t,n,this._evaluator,i)}))}getDocumentHighlight(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const s=this._configOptions.findExecEnvironment(e);return i.sourceFile.getDocumentHighlight(this._createSourceMapper(s),t,this._evaluator,n)}))}getSignatureHelpForPosition(e,t,n,i){return this._runEvaluatorWithCancellationToken(i,(()=>{const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const r=this._configOptions.findExecEnvironment(e);return s.sourceFile.getSignatureHelpForPosition(t,this._createSourceMapper(r,!0),this._evaluator,n,i)}))}getCompletionsForPosition(e,t,n,i,s,r,o){var l;return a(this,void 0,void 0,(function*(){const a=this._getSourceFileInfoFromPath(e);if(!a)return;const c=this._logTracker.log(`completion at ${e}:${t.line}:${t.character}`,(l=>{var c,p;const u=this._runEvaluatorWithCancellationToken(o,(()=>{this._bindFile(a);const l=this._configOptions.findExecEnvironment(e);return a.sourceFile.getCompletionsForPosition(t,n,this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,i,this._createSourceMapper(l,!0),s,r,(()=>this._buildModuleSymbolsMap(a,!!r,!1,o)),o)}));return l.add(`found ${null!==(p=null===(c=null==u?void 0:u.completionList)||void 0===c?void 0:c.items.length)&&void 0!==p?p:"null"} items`),u}));if(!(null==c?void 0:c.completionList)||!(null===(l=this._extension)||void 0===l?void 0:l.completionListExtension))return c;const p=a.sourceFile.getParseResults();if((null==p?void 0:p.parseTree)&&(null==p?void 0:p.text)){const e=m.convertPositionToOffset(t,p.tokenizerOutput.lines);void 0!==e&&(yield this._extension.completionListExtension.updateCompletionResults(c,p,e,o))}return c}))}resolveCompletionItem(e,t,n,i,s,r){return this._runEvaluatorWithCancellationToken(r,(()=>{const a=this._getSourceFileInfoFromPath(e);if(!a)return;this._bindFile(a);const o=this._configOptions.findExecEnvironment(e);a.sourceFile.resolveCompletionItem(this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,n,this._createSourceMapper(o,!0),i,s,(()=>this._buildModuleSymbolsMap(a,!!s,!1,r)),t,r)}))}renameSymbolAtPosition(e,t,n,i){return this._runEvaluatorWithCancellationToken(i,(()=>{const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const r=this._configOptions.findExecEnvironment(e),a=s.sourceFile.getDeclarationForPosition(this._createSourceMapper(r),t,this._evaluator,void 0,i);if(!a)return;if(a.declarations.some((e=>!this._isUserCode(this._getSourceFileInfoFromPath(e.path)))))return;if(0===a.declarations.length)return;if(a.requiresGlobalSearch)for(const e of this._sourceFileList)this._isUserCode(e)&&(this._bindFile(e),e.sourceFile.addReferences(a,!0,this._evaluator,i)),this._handleMemoryHighUsage();else this._isUserCode(s)&&s.sourceFile.addReferences(a,!0,this._evaluator,i);const o=[];return a.locations.forEach((e=>{o.push({filePath:e.path,range:e.range,replacementText:n})})),o}))}getCallForPosition(e,t,n){const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const s=this._configOptions.findExecEnvironment(e),r=i.sourceFile.getDeclarationForPosition(this._createSourceMapper(s),t,this._evaluator,void 0,n);if(!r||0===r.declarations.length)return;const a=_.CallHierarchyProvider.getTargetDeclaration(r.declarations,r.nodeAtOffset);return _.CallHierarchyProvider.getCallForDeclaration(r.symbolName,a,this._evaluator,n)}getIncomingCallsForPosition(e,t,n){const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const s=this._configOptions.findExecEnvironment(e),r=i.sourceFile.getDeclarationForPosition(this._createSourceMapper(s),t,this._evaluator,void 0,n);if(!r||0===r.declarations.length)return;const a=_.CallHierarchyProvider.getTargetDeclaration(r.declarations,r.nodeAtOffset);let o=[];for(const e of this._sourceFileList)if(this._isUserCode(e)||e.isOpenByClient){this._bindFile(e);const t=_.CallHierarchyProvider.getIncomingCallsForDeclaration(e.sourceFile.getFilePath(),r.symbolName,a,e.sourceFile.getParseResults(),this._evaluator,n);t&&(o=o.concat(...t)),this._handleMemoryHighUsage()}return o}getOutgoingCallsForPosition(e,t,n){const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const s=this._configOptions.findExecEnvironment(e),r=i.sourceFile.getDeclarationForPosition(this._createSourceMapper(s),t,this._evaluator,void 0,n);if(!r||0===r.declarations.length)return;const a=_.CallHierarchyProvider.getTargetDeclaration(r.declarations,r.nodeAtOffset);return _.CallHierarchyProvider.getOutgoingCallsForDeclaration(a,i.sourceFile.getParseResults(),this._evaluator,n)}performQuickAction(e,t,n,i){const s=this._getSourceFileInfoFromPath(e);if(s)return this._bindFile(s),s.sourceFile.performQuickAction(t,n,i)}_handleMemoryHighUsage(){if(this._evaluator.getTypeCacheSize()>75e4||this._parsedFileCount>1e3){const e=Math.round(process.memoryUsage().heapUsed/1048576);e>1536&&(this._console.info(`Emptying type cache to avoid heap overflow. Heap size used: ${e}MB`),this._createNewEvaluator(),this._discardCachedParseResults(),this._parsedFileCount=0)}}_discardCachedParseResults(){for(const e of this._sourceFileList)e.sourceFile.dropParseAndBindInfo()}_isUserCode(e){return e&&e.isTracked&&!e.isThirdPartyImport&&!e.isTypeshedFile}_runEvaluatorWithCancellationToken(e,t){try{return e&&!p.isDebugMode()?this._evaluator.runWithCancellationToken(e,t):t()}catch(e){throw e instanceof l.OperationCanceledException||this._createNewEvaluator(),e}}_removeUnneededFiles(){const e=[];for(let t=0;t<this._sourceFileList.length;){const n=this._sourceFileList[t];this._isFileNeeded(n)?(this._shouldCheckFile(n)||void 0===n.diagnosticsVersion||(e.push({filePath:n.sourceFile.getFilePath(),diagnostics:[]}),n.diagnosticsVersion=void 0),t++):(e.push({filePath:n.sourceFile.getFilePath(),diagnostics:[]}),n.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(n.sourceFile.getFilePath(),t),n.imports.forEach((i=>{const s=i.importedBy.findIndex((e=>e===n));if(u.assert(s>=0),i.importedBy.splice(s,1),!this._isFileNeeded(i)){const n=this._sourceFileList.findIndex((e=>e===i));n>=0&&n<t&&(e.push({filePath:i.sourceFile.getFilePath(),diagnostics:[]}),i.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(i.sourceFile.getFilePath(),n),t--)}})),n.shadowedBy.forEach((e=>{e.shadows=e.shadows.filter((e=>e!==n))})),n.shadowedBy=[])}return e}_isFileNeeded(e){return!e.sourceFile.isFileDeleted()&&(!(!e.isTracked&&!e.isOpenByClient)||(e.shadows.length>0||0!==e.importedBy.length&&this._isImportNeededRecursive(e,new Map)))}_isImportNeededRecursive(e,t){if(e.isTracked||e.isOpenByClient||e.shadows.length>0)return!0;const n=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());if(t.has(n))return!1;t.set(n,!0);for(const n of e.importedBy)if(this._isImportNeededRecursive(n,t))return!0;return!1}_createSourceMapper(e,t){return new x.SourceMapper(this._importResolver,e,this._evaluator,((e,t)=>{const n=this._getSourceFileInfoFromPath(e);if(n)return this._addShadowedFile(n,t),this.getBoundSourceFile(t)}),(e=>this.getBoundSourceFile(e)),null!=t&&t)}_isImportAllowed(e,t,n){if(t.isNativeLib)return!1;let i=this._configOptions.useLibraryCodeForTypes||1===t.importType&&!!t.pyTypedInfo||2===t.importType&&e.isThirdPartyPyTypedPresent;return!((1===t.importType||e.isThirdPartyImport&&2===t.importType)&&(this._allowedThirdPartyImports&&(t.isRelative||this._allowedThirdPartyImports.some((e=>t.importName===e||!!t.importName.startsWith(e+"."))))&&(i=!0),!n))||i}_updateSourceFileImports(e,t){const n=[],i=e.sourceFile.getImports(),s=t=>{let n=!1,i=!1;return 1===t.importType?(n=!0,t.pyTypedInfo&&(i=!0)):e.isThirdPartyImport&&2===t.importType&&(n=!0,e.isThirdPartyPyTypedPresent&&(i=!0)),{isThirdPartyImport:n,isPyTypedPresent:i}},r=new Map;i.forEach((n=>{if(n.isImportFound){if(this._isImportAllowed(e,n,n.isStubFile)&&n.resolvedPaths.length>0){const e=n.resolvedPaths[n.resolvedPaths.length-1];if(e){const t=s(n);r.set(h.normalizePathCase(this._fs,e),{path:e,isTypeshedFile:!!n.isTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isPyTypedPresent:t.isPyTypedPresent})}}n.filteredImplicitImports.forEach((t=>{if(this._isImportAllowed(e,n,t.isStubFile)&&!t.isNativeLib){const e=s(n);r.set(h.normalizePathCase(this._fs,t.path),{path:t.path,isTypeshedFile:!!n.isTypeshedFile,isThirdPartyImport:e.isThirdPartyImport,isPyTypedPresent:e.isPyTypedPresent})}}))}else t.verboseOutput&&(this._console.info(`Could not import '${n.importName}' in file '${e.sourceFile.getFilePath()}'`),n.importFailureInfo&&n.importFailureInfo.forEach((e=>{this._console.info(`  ${e}`)})))}));const a=new Map;e.imports.forEach((t=>{const n=h.normalizePathCase(this._fs,t.sourceFile.getFilePath());r.has(n)?a.set(n,t):t.importedBy=t.importedBy.filter((t=>h.normalizePathCase(this._fs,t.sourceFile.getFilePath())!==h.normalizePathCase(this._fs,e.sourceFile.getFilePath())))})),r.forEach(((t,i)=>{if(!a.has(i)){let s;if(this._getSourceFileInfoFromPath(t.path))s=this._getSourceFileInfoFromPath(t.path);else{const e=this._getImportNameForFile(t.path);s={sourceFile:new D.SourceFile(this._fs,t.path,e,t.isThirdPartyImport,t.isPyTypedPresent,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:t.isTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isThirdPartyPyTypedPresent:t.isPyTypedPresent,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(s),n.push(s)}s.importedBy.push(e),a.set(i,s)}})),e.imports=[],r.forEach(((t,n)=>{this._getSourceFileInfoFromPath(n)&&e.imports.push(this._getSourceFileInfoFromPath(n))})),e.builtinsImport=void 0;const o=e.sourceFile.getBuiltinsImport();if(o&&o.isImportFound){const t=o.resolvedPaths[o.resolvedPaths.length-1];e.builtinsImport=this._getSourceFileInfoFromPath(t)}return n}_getSourceFileInfoFromPath(e){return this._sourceFileMap.get(h.normalizePathCase(this._fs,e))}_removeSourceFileFromListAndMap(e,t){this._sourceFileMap.delete(h.normalizePathCase(this._fs,e)),this._sourceFileList.splice(t,1)}_addToSourceFileListAndMap(e){const t=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());u.assert(!this._sourceFileMap.has(t)),this._sourceFileList.push(e),this._sourceFileMap.set(t,e)}}t.Program=E},26477:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPyTypedInfo=void 0;const i=n(94647);t.getPyTypedInfo=function(e,t){if(!e.existsSync(t)||!i.isDirectory(e,t))return;let n=!1;const s=i.combinePaths(t,"py.typed");if(!e.existsSync(t)||!i.isFile(e,s))return;const r=e.statSync(s);if(r.size>0&&r.size<65536){const t=e.readFileSync(s,"utf8");(t.match(/partial\n/)||t.match(/partial\r\n/))&&(n=!0)}return{pyTypedPath:s,isPartiallyTyped:n}}},96453:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isPythonBinary=t.getPythonPathFromPythonInterpreter=t.findPythonSearchPaths=t.getTypeshedSubdirectory=t.getTypeShedFallbackPath=t.thirdPartyFolderName=t.stdLibFolderName=void 0;const a=r(n(63129)),o=n(98173),l=r(n(97956)),c=n(94647),p=["import os, os.path, sys","normalize = lambda p: os.path.normcase(os.path.normpath(p))","cwd = normalize(os.getcwd())",'sys.path[:] = (p for p in sys.path if p != "" and normalize(p) != cwd)',"import json","json.dump(dict(path=sys.path, prefix=sys.prefix), sys.stdout)"].join("; ");function u(e,t,n){let i;return t?i=d(e,t,n):("win32"!==process.platform&&(i=d(e,"python3",n)),i||(i=d(e,"python",n))),i||(i={paths:[],prefix:""}),n.push(`Received ${i.paths.length} paths from interpreter`),i.paths.forEach((e=>{n.push(`  ${e}`)})),i}function d(e,t,n){const i={paths:[],prefix:""};try{const s=["-c",p];n.push(`Executing interpreter: '${t}'`);const r=a.execFileSync(t,s,{encoding:"utf8"});try{const t=JSON.parse(r);for(let s of t.path)if(s=s.trim(),s){const t=c.normalizePath(s);e.existsSync(t)&&c.isDirectory(e,t)?i.paths.push(t):n.push(`Skipping '${t}' because it is not a valid directory`)}i.prefix=t.prefix,0===i.paths.length&&n.push("Found no valid directories")}catch(e){throw n.push(`Could not parse output: '${r}'`),e}}catch(e){return}return i}function h(e,t){return!e.some((e=>e===t))&&(e.push(t),!0)}t.stdLibFolderName="stdlib",t.thirdPartyFolderName="stubs",t.getTypeShedFallbackPath=function(e){let t=e.getModulePath();if(!t)return;t=c.getDirectoryPath(c.ensureTrailingDirectorySeparator(c.normalizePath(t)));const n=c.combinePaths(t,l.typeshedFallback);if(e.existsSync(n))return n;const i=c.combinePaths(c.getDirectoryPath(t),l.typeshedFallback);return e.existsSync(i)?i:void 0},t.getTypeshedSubdirectory=function(e,n){return c.combinePaths(e,n?t.stdLibFolderName:t.thirdPartyFolderName)},t.findPythonSearchPaths=function(e,t,n,i,s){if(n.push("Finding python search paths"),void 0!==t.venvPath&&t.venv){const i=t.venv,s=c.combinePaths(t.venvPath,i),r=[],a=[];if([l.lib,l.lib64,l.libAlternate].forEach((t=>{const i=function(e,t,n){if(!e.existsSync(t))return void n.push(`Did not find '${t}'`);n.push(`Found path '${t}'; looking for ${l.sitePackages}`);const i=c.combinePaths(t,l.sitePackages);if(e.existsSync(i))return n.push(`Found path '${i}'`),i;n.push(`Did not find '${i}', so looking for python subdirectory`);const s=c.getFileSystemEntries(e,t);for(let i=0;i<s.directories.length;i++){const r=s.directories[i];if(r.startsWith("python")){const i=c.combinePaths(t,r,l.sitePackages);if(e.existsSync(i))return n.push(`Found path '${i}'`),i;n.push(`Path '${i}' is not a valid directory`)}}}(e,c.combinePaths(s,t),n);i&&(h(r,i),a.push(i))})),a.forEach((t=>{(function(e,t){const n=[];return e.readdirEntriesSync(t).filter((e=>(e.isFile()||e.isSymbolicLink())&&e.name.endsWith(".pth"))).sort(((e,t)=>o.compareComparableValues(e.name,t.name))).forEach((i=>{const s=c.combinePaths(t,i.name),r=c.tryStat(e,s);if((null==r?void 0:r.isFile())&&r.size>0&&r.size<65536){e.readFileSync(s,"utf8").split(/\r?\n/).forEach((i=>{const s=i.trim();if(s.length>0&&!s.startsWith("#")&&!s.match(/^import\s/)){const i=c.combinePaths(t,s);e.existsSync(i)&&c.isDirectory(e,i)&&n.push(i)}}))}})),n})(e,t).forEach((e=>{h(r,e)}))})),r.length>0)return n.push(`Found the following '${l.sitePackages}' dirs`),r.forEach((e=>{n.push(`  ${e}`)})),r;n.push(`Did not find any '${l.sitePackages}' dirs. Falling back on python interpreter.`)}const r=u(e,t.pythonPath,n);if(i&&s){return r.paths.filter((e=>!c.containsPath(s,e,!0)||c.containsPath(r.prefix,e,!0)))}return r.paths},t.getPythonPathFromPythonInterpreter=u,t.isPythonBinary=function(e){return"python"===(e=e.trim())||"python3"===e}},17640:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scope=void 0;const i=n(20823),s=n(97882);t.Scope=class{constructor(e,t){this.symbolTable=new Map,this.notLocalBindings=new Map,this.type=e,this.parent=t}getGlobalScope(){let e=this;for(;e;){if(3===e.type||4===e.type)return e;e=e.parent}return i.fail("failed to find scope"),this}isIndependentlyExecutable(){return 3===this.type||1===this.type}lookUpSymbol(e){return this.symbolTable.get(e)}lookUpSymbolRecursive(e,t=!1,n=!1){const i=this.symbolTable.get(e);if(i){if(t&&i.isExternallyHidden())return;const e=i.getDeclarations();if(0===e.length||e.some((e=>1!==e.type||!e.isDefinedByMemberAccess)))return{symbol:i,isOutsideCallerModule:t,isBeyondExecutionScope:n,scope:this}}let s;if(s=1===this.notLocalBindings.get(e)?this.getGlobalScope():this.parent,s)return s.lookUpSymbolRecursive(e,t||3===this.type,n||this.isIndependentlyExecutable())}addSymbol(e,t){const n=new s.Symbol(t);return this.symbolTable.set(e,n),n}getBindingType(e){return this.notLocalBindings.get(e)}setBindingType(e,t){return this.notLocalBindings.set(e,t)}}},57203:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getScopeForNode=t.getBuiltInScope=void 0;const i=n(35696),s=n(23241);t.getBuiltInScope=function(e){let t=e;for(;4!==t.type;)t=t.parent;return t},t.getScopeForNode=function(e){const t=s.getEvaluationScopeNode(e);return i.getScope(t)}},44314:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerService=t.configFileNames=void 0;const a=r(n(83352)),o=n(38213),l=n(14943),c=n(11043),p=n(6021),u=n(94647),d=n(76962),h=n(47041),m=n(67145),y=n(96453);t.configFileNames=["pyrightconfig.json","mspythonconfig.json"];class g{constructor(e,t,n,i,s,r,a,o,p){this._typeStubTargetIsSingleFile=!1,this._requireTrackedFileUpdate=!0,this._lastUserInteractionTime=Date.now(),this._disposed=!1,this._instanceName=e,this._console=n||new c.StandardConsole,this._executionRootPath="",this._extension=r,this._importResolverFactory=i||g.createImportResolver,this._maxAnalysisTimeInForeground=o,this._backgroundAnalysisProgramFactory=p,s=null!=s?s:new l.ConfigOptions(process.cwd());const u=this._importResolverFactory(t,s);this._backgroundAnalysisProgram=void 0!==p?p(this._console,s,u,this._extension,a,this._maxAnalysisTimeInForeground):new h.BackgroundAnalysisProgram(this._console,s,u,this._extension,a,this._maxAnalysisTimeInForeground)}clone(e,t){return new g(e,this._fs,this._console,this._importResolverFactory,this._backgroundAnalysisProgram.configOptions,this._extension,t,this._maxAnalysisTimeInForeground,this._backgroundAnalysisProgramFactory)}dispose(){this._disposed=!0,this._removeSourceFileWatchers(),this._removeConfigFileWatcher(),this._removeLibraryFileWatcher(),this._clearReloadConfigTimer(),this._clearReanalysisTimer(),this._clearLibraryReanalysisTimer()}get backgroundAnalysisProgram(){return this._backgroundAnalysisProgram}static createImportResolver(e,t){return new m.ImportResolver(e,t)}setCompletionCallback(e){this._onCompletionCallback=e,this._backgroundAnalysisProgram.setCompletionCallback(e)}setOptions(e,t=!0){this._commandLineOptions=e;const n=this._getConfigOptions(e);n.pythonPath&&n.ensureDefaultPythonVersion(n.pythonPath,this._console),n.ensureDefaultPythonPlatform(this._console),this._backgroundAnalysisProgram.setConfigOptions(n),this._executionRootPath=u.normalizePath(u.combinePaths(e.executionRoot,n.projectRoot)),this._applyConfigOptions(t)}setFileOpened(e,t,n){this._backgroundAnalysisProgram.setFileOpened(e,t,n),this._scheduleReanalysis(!1)}updateOpenFileContents(e,t,n){this._backgroundAnalysisProgram.updateOpenFileContents(e,t,n),this._scheduleReanalysis(!1)}test_setIndexing(e,t){this._backgroundAnalysisProgram.test_setIndexing(e,t)}startIndexing(){this._backgroundAnalysisProgram.startIndexing()}setFileClosed(e){this._backgroundAnalysisProgram.setFileClosed(e),this._scheduleReanalysis(!1)}getParseResult(e){var t;return null===(t=this._program.getBoundSourceFile(e))||void 0===t?void 0:t.getParseResults()}getTextOnRange(e,t,n){return this._program.getTextOnRange(e,t,n)}getAutoImports(e,t,n,i,s,r,a){return this._program.getAutoImports(e,t,n,i,this._backgroundAnalysisProgram.getIndexing(e),s,r,a)}getDefinitionForPosition(e,t,n,i){return this._program.getDefinitionsForPosition(e,t,n,i)}reportReferencesForPosition(e,t,n,i,s){this._program.reportReferencesForPosition(e,t,n,i,s)}addSymbolsForDocument(e,t,n){this._program.addSymbolsForDocument(e,t,n)}reportSymbolsForWorkspace(e,t,n){this._program.reportSymbolsForWorkspace(e,t,n)}getHoverForPosition(e,t,n,i){return this._program.getHoverForPosition(e,t,n,i)}getDocumentHighlight(e,t,n){return this._program.getDocumentHighlight(e,t,n)}getSignatureHelpForPosition(e,t,n,i){return this._program.getSignatureHelpForPosition(e,t,n,i)}getCompletionsForPosition(e,t,n,i,s,r){return this._program.getCompletionsForPosition(e,t,n,i,s,this._backgroundAnalysisProgram.getIndexing(e),r)}getEvaluator(){return this._program.evaluator}resolveCompletionItem(e,t,n,i,s){this._program.resolveCompletionItem(e,t,n,i,this._backgroundAnalysisProgram.getIndexing(e),s)}performQuickAction(e,t,n,i){return this._program.performQuickAction(e,t,n,i)}renameSymbolAtPosition(e,t,n,i){return this._program.renameSymbolAtPosition(e,t,n,i)}getCallForPosition(e,t,n){return this._program.getCallForPosition(e,t,n)}getIncomingCallsForPosition(e,t,n){return this._program.getIncomingCallsForPosition(e,t,n)}getOutgoingCallsForPosition(e,t,n){return this._program.getOutgoingCallsForPosition(e,t,n)}printStats(){this._console.info(""),this._console.info("Analysis stats");const e=this._program.getFileCount();this._console.info("Total files analyzed: "+e.toString())}printDependencies(e){this._program.printDependencies(this._executionRootPath,e)}getDiagnosticsForRange(e,t,n){return this._backgroundAnalysisProgram.getDiagnosticsForRange(e,t,n)}getConfigOptions(){return this._configOptions}getImportResolver(){return this._backgroundAnalysisProgram.importResolver}recordUserInteractionTime(){this._lastUserInteractionTime=Date.now(),this._analyzeTimer&&this._scheduleReanalysis(!1)}get test_program(){return this._program}test_getConfigOptions(e){return this._getConfigOptions(e)}test_getFileNamesFromFileSpecs(){return this._getFileNamesFromFileSpecs()}_getConfigOptions(e){var t,n;let i,s=e.executionRoot;e.configFilePath?(i=u.combinePaths(e.executionRoot,u.normalizePath(e.configFilePath)),this._fs.existsSync(i)?i.toLowerCase().endsWith(".json")?s=u.getDirectoryPath(i):(s=i,i=this._findConfigFile(i),i||this._console.info(`Configuration file not found at ${s}.`)):(this._console.info(`Configuration file not found at ${i}.`),i=e.executionRoot)):s&&(i=this._findConfigFileHereOrUp(s),i?s=u.getDirectoryPath(i):(this._console.info("No configuration file found."),i=void 0));const r=new l.ConfigOptions(s,this._typeCheckingMode),a=["**/node_modules","**/__pycache__",".git"];if(r.defaultPythonPlatform=e.pythonPlatform,r.defaultPythonVersion=e.pythonVersion,r.ensureDefaultExtraPaths(this._fs,e.autoSearchPaths||!1,e.extraPaths),e.fileSpecs.length>0?e.fileSpecs.forEach((e=>{r.include.push(u.getFileSpec(s,e))})):i||e.executionRoot&&(r.include.push(u.getFileSpec(e.executionRoot,".")),a.forEach((t=>{r.exclude.push(u.getFileSpec(e.executionRoot,t))}))),this._configFilePath=i,i){this._console.info(`Loading configuration file at ${i}`);const t=this._parseConfigFile(i);if(t){r.initializeFromJson(t,this._typeCheckingMode,this._console,e.diagnosticSeverityOverrides,e.pythonPath,e.fileSpecs.length>0);const n=u.getDirectoryPath(i);0===r.include.length&&(this._console.info(`No include entries specified; assuming ${n}`),r.include.push(u.getFileSpec(n,"."))),0===r.exclude.length&&(a.forEach((e=>{this._console.info(`Auto-excluding ${e}`),r.exclude.push(u.getFileSpec(n,e))})),void 0===r.autoExcludeVenv&&(r.autoExcludeVenv=!0))}}else r.autoExcludeVenv=!0,r.applyDiagnosticOverrides(e.diagnosticSeverityOverrides);const o=(t,n)=>{const i=e.fromVsCodeExtension?"the client settings":"a command-line option";this._console.warn(`The ${t} has been specified in both the config file and ${i}. The value in the config file (${n}) will take precedence`)};if(e.venvPath&&(r.venvPath?o("venvPath",r.venvPath):r.venvPath=e.venvPath),e.pythonPath&&(this._console.info(`Setting pythonPath for service "${this._instanceName}": "${e.pythonPath}"`),r.pythonPath=e.pythonPath),e.typeshedPath&&(r.typeshedPath?o("typeshedPath",r.typeshedPath):r.typeshedPath=e.typeshedPath),r.verboseOutput=null!==(t=e.verboseOutput)&&void 0!==t?t:r.verboseOutput,r.checkOnlyOpenFiles=!!e.checkOnlyOpenFiles,r.autoImportCompletions=!!e.autoImportCompletions,r.indexing=!!e.indexing,r.logTypeEvaluationTime=!!e.logTypeEvaluationTime,r.typeEvaluationTimeThreshold=e.typeEvaluationTimeThreshold,void 0===r.useLibraryCodeForTypes?r.useLibraryCodeForTypes=!!e.useLibraryCodeForTypes:void 0!==e.useLibraryCodeForTypes&&o("useLibraryCodeForTypes",r.useLibraryCodeForTypes),e.stubPath?r.stubPath?o("stubPath",r.stubPath):r.stubPath=e.stubPath:r.stubPath||(r.stubPath=u.normalizePath(u.combinePaths(r.projectRoot,"typings"))),r.venvPath){if(this._fs.existsSync(r.venvPath)&&u.isDirectory(this._fs,r.venvPath)||this._console.error(`venvPath ${r.venvPath} is not a valid directory.`),r.venv=null!==(n=r.venv)&&void 0!==n?n:this._configOptions.venv,r.venv){const e=u.combinePaths(r.venvPath,r.venv);if(this._fs.existsSync(e)&&u.isDirectory(this._fs,e)){const e=[];void 0===y.findPythonSearchPaths(this._fs,r,e)&&(this._console.error(`site-packages directory cannot be located for venvPath ${r.venvPath} and venv ${r.venv}.`),r.verboseOutput&&e.forEach((e=>{this._console.error(`  ${e}`)})))}else this._console.error(`venv ${r.venv} subdirectory not found in venv path ${r.venvPath}.`)}}else{const t=[],n=y.getPythonPathFromPythonInterpreter(this._fs,r.pythonPath,t).paths;if(0===n.length){const t=r.verboseOutput?c.LogLevel.Error:c.LogLevel.Log;(e.fromVsCodeExtension||r.verboseOutput)&&c.log(this._console,t,"No search paths found for configured python interpreter.")}else if(e.fromVsCodeExtension||r.verboseOutput){const e=r.verboseOutput?c.LogLevel.Info:c.LogLevel.Log;c.log(this._console,e,"Search paths found for configured python interpreter:"),n.forEach((t=>{c.log(this._console,e,`  ${t}`)}))}r.verboseOutput&&t.length>0&&(this._console.info("When attempting to get search paths from python interpreter:"),t.forEach((e=>{this._console.info(`  ${e}`)})))}return r.venv&&(r.venvPath||this._console.warn("venvPath not specified, so venv settings will be ignored.")),r.typeshedPath&&(this._fs.existsSync(r.typeshedPath)&&u.isDirectory(this._fs,r.typeshedPath)||this._console.error(`typeshedPath ${r.typeshedPath} is not a valid directory.`)),r.stubPath&&(this._fs.existsSync(r.stubPath)&&u.isDirectory(this._fs,r.stubPath)||this._console.warn(`stubPath ${r.stubPath} is not a valid directory.`)),r}writeTypeStub(e){const t=this._getTypeStubFolder();this._program.writeTypeStub(this._typeStubTargetPath,this._typeStubTargetIsSingleFile,t,e)}writeTypeStubInBackground(e){const t=this._getTypeStubFolder();return this._backgroundAnalysisProgram.writeTypeStub(this._typeStubTargetPath,this._typeStubTargetIsSingleFile,t,e)}invalidateAndForceReanalysis(e=!0){this._backgroundAnalysisProgram.invalidateAndForceReanalysis(e)}restart(){this._applyConfigOptions(),this._backgroundAnalysisProgram.restart()}get _fs(){return this._backgroundAnalysisProgram.importResolver.fileSystem}get _program(){return this._backgroundAnalysisProgram.program}get _configOptions(){return this._backgroundAnalysisProgram.configOptions}get _watchForSourceChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForSourceChanges)}get _watchForLibraryChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForLibraryChanges)}get _typeCheckingMode(){var e;return null===(e=this._commandLineOptions)||void 0===e?void 0:e.typeCheckingMode}get _verboseOutput(){return!!this._configOptions.verboseOutput}get _typeStubTargetImportName(){var e;return null===(e=this._commandLineOptions)||void 0===e?void 0:e.typeStubTargetImportName}_getTypeStubFolder(){const e=this._configOptions.stubPath;if(!this._typeStubTargetPath||!this._typeStubTargetImportName){const e=`Import '${this._typeStubTargetImportName}' could not be resolved`;throw this._console.error(e),new Error(e)}if(!e){const e="No typings path was specified";throw this._console.info(e),new Error(e)}const t=this._typeStubTargetImportName.split(".");if(0===t[0].length){const e=`Import '${this._typeStubTargetImportName}' could not be resolved`;throw this._console.error(e),new Error(e)}try{this._fs.existsSync(e)||this._fs.mkdirSync(e)}catch(t){const n=`Could not create typings directory '${e}'`;throw this._console.error(n),new Error(n)}const n=u.combinePaths(e,t[0]);try{this._fs.existsSync(n)||this._fs.mkdirSync(n)}catch(e){const t=`Could not create typings subdirectory '${n}'`;throw this._console.error(t),new Error(t)}return n}_findConfigFileHereOrUp(e){return u.forEachAncestorDirectory(e,(e=>this._findConfigFile(e)))}_findConfigFile(e){for(const n of t.configFileNames){const t=u.combinePaths(e,n);if(this._fs.existsSync(t))return t}}_parseConfigFile(e){let t="",n=0;for(;;){try{t=this._fs.readFileSync(e,"utf8")}catch(t){return this._console.error(`Config file "${e}" could not be read.`),void this._reportConfigParseError()}let i,s=!1;try{return i=a.parse(t),i}catch(e){s=!0}if(!s)break;if(n++>=5)return this._console.error(`Config file "${e}" could not be parsed. Verify that JSON is correct.`),void this._reportConfigParseError()}}_getFileNamesFromFileSpecs(){const e=new Map;return d.timingStats.findFilesTime.timeOperation((()=>{const t=this._matchFiles(this._configOptions.include,this._configOptions.exclude);for(const n of t)e.set(n,n)})),[...e.values()]}_updateTrackedFileList(e){if(this._typeStubTargetImportName){const e=this._configOptions.findExecEnvironment(this._executionRootPath),t={leadingDots:0,nameParts:this._typeStubTargetImportName.split("."),importedSymbols:[]},n=this._backgroundAnalysisProgram.importResolver.resolveImport("",e,t);if(n.isImportFound){const e=[],t=n.resolvedPaths[n.resolvedPaths.length-1];let i=u.getDirectoryPath(t),s=t;for(let e=n.resolvedPaths.length-2;e>=0;e--){const t=n.resolvedPaths[e];t?(i=u.getDirectoryPath(t),s=t):(i=u.getDirectoryPath(s),s=i)}u.isDirectory(this._fs,i)&&(this._typeStubTargetPath=i),t?(e.push(t),this._typeStubTargetIsSingleFile=1===n.resolvedPaths.length&&"__init__"!==u.stripFileExtension(u.getFileName(n.resolvedPaths[0]))):this._typeStubTargetIsSingleFile=!1,n.filteredImplicitImports.forEach((t=>{e.push(t.path)})),this._backgroundAnalysisProgram.setAllowedThirdPartyImports([this._typeStubTargetImportName]),this._backgroundAnalysisProgram.setTrackedFiles(e)}else this._console.error(`Import '${this._typeStubTargetImportName}' not found`)}else{let t=[];this._console.info("Searching for source files"),t=this._getFileNamesFromFileSpecs(),this._backgroundAnalysisProgram.setTrackedFiles(t),this._backgroundAnalysisProgram.markAllFilesDirty(e),0===t.length?this._console.info("No source files found."):this._console.info(`Found ${t.length} source `+(1===t.length?"file":"files"))}this._requireTrackedFileUpdate=!1}_isInExcludePath(e,t){return!!t.find((t=>t.regExp.test(e)))}_matchFiles(e,t){const n=/\.pyi?$/,i=[["bin","activate"],["Scripts","activate"],["pyvenv.cfg"]],s=[],r=(e,r)=>{if(this._configOptions.autoExcludeVenv&&i.some((t=>this._fs.existsSync(u.combinePaths(e,...t)))))return void this._console.info(`Auto-excluding ${e}`);const{files:a,directories:l}=u.getFileSystemEntries(this._fs,e);for(const i of a){const a=u.combinePaths(e,i);r.test(a)&&!this._isInExcludePath(a,t)&&n.test(a)&&s.push(a)}for(const n of l){const i=u.combinePaths(e,n);r.test(i)&&(this._isInExcludePath(i,t)||o(i,r))}},a=new Set,o=(e,t)=>{const n=u.tryRealpath(this._fs,e);if(n)if(a.has(n))this._console.warn(`Skipping recursive symlink "${e}" -> "${n}"`);else{a.add(n);try{r(e,t)}finally{a.delete(n)}}else this._console.warn(`Skipping broken link "${e}"`)};return e.forEach((e=>{let i=!1;if(!this._isInExcludePath(e.wildcardRoot,t)){const t=u.tryStat(this._fs,e.wildcardRoot);(null==t?void 0:t.isFile())?n.test(e.wildcardRoot)&&(s.push(e.wildcardRoot),i=!0):(null==t?void 0:t.isDirectory())&&(o(e.wildcardRoot,e.regExp),i=!0)}i||this._console.error(`File or directory "${e.wildcardRoot}" does not exist.`)})),s}_removeSourceFileWatchers(){this._sourceFileWatcher&&(this._sourceFileWatcher.close(),this._sourceFileWatcher=void 0)}_updateSourceFileWatchers(){if(this._removeSourceFileWatchers(),this._backgroundAnalysisProgram.invalidateCache(),this._watchForSourceChanges&&this._configOptions.include.length>0){const e=this._configOptions.include.map((e=>u.combinePaths(this._executionRootPath,e.wildcardRoot)));try{this._verboseOutput&&this._console.info(`Adding fs watcher for directories:\n ${e.join("\n")}`);const t=p.ignoredWatchEventFunction(e);this._sourceFileWatcher=this._fs.createFileSystemWatcher(e,((e,n)=>{if(this._verboseOutput&&this._console.info(`SourceFile: Received fs event '${e}' for path '${n}'`),t(n))return;if(n.endsWith(".tmp")||n.endsWith(".git"))return;const i=u.tryStat(this._fs,n);if(!i||!i.isFile()||n.endsWith(".py")||n.endsWith(".pyi"))if("change"===e&&i)this._backgroundAnalysisProgram.markFilesDirty([n],!1),this._scheduleReanalysis(!1);else{const e=u.getFileName(n).split(".");let t=!1;4===e.length&&e[3]===e[1]&&32===e[2].length&&(t=!0),t||(this.invalidateAndForceReanalysis(!1),this._scheduleReanalysis(!0))}}))}catch(t){this._console.error(`Exception caught when installing fs watcher for:\n ${e.join("\n")}`)}}}_removeLibraryFileWatcher(){this._libraryFileWatcher&&(this._libraryFileWatcher.close(),this._libraryFileWatcher=void 0)}_updateLibraryFileWatcher(){if(this._removeLibraryFileWatcher(),this._backgroundAnalysisProgram.invalidateCache(),!this._watchForLibraryChanges)return;const e=y.findPythonSearchPaths(this._fs,this._backgroundAnalysisProgram.configOptions,[],!0,this._executionRootPath);if(e&&e.length>0)try{this._verboseOutput&&this._console.info(`Adding fs watcher for library directories:\n ${e.join("\n")}`);const t=p.ignoredWatchEventFunction(e);this._libraryFileWatcher=this._fs.createFileSystemWatcher(e,((e,n)=>{this._verboseOutput&&this._console.info(`LibraryFile: Received fs event '${e}' for path '${n}'}'`),t(n)||this._scheduleLibraryAnalysis()}))}catch(t){this._console.error(`Exception caught when installing fs watcher for:\n ${e.join("\n")}`)}}_clearLibraryReanalysisTimer(){var e;this._libraryReanalysisTimer&&(clearTimeout(this._libraryReanalysisTimer),this._libraryReanalysisTimer=void 0,null===(e=this._backgroundAnalysisProgram)||void 0===e||e.cancelIndexing())}_scheduleLibraryAnalysis(){this._disposed||(this._clearLibraryReanalysisTimer(),this._libraryReanalysisTimer=setTimeout((()=>{this._clearLibraryReanalysisTimer(),this.invalidateAndForceReanalysis(),this._scheduleReanalysis(!1)}),1e3))}_removeConfigFileWatcher(){this._configFileWatcher&&(this._configFileWatcher.close(),this._configFileWatcher=void 0)}_updateConfigFileWatcher(){this._removeConfigFileWatcher(),this._configFilePath?this._configFileWatcher=this._fs.createFileSystemWatcher([this._configFilePath],(e=>{this._verboseOutput&&this._console.info(`Received fs event '${e}' for config file`),this._scheduleReloadConfigFile()})):this._executionRootPath&&(this._configFileWatcher=this._fs.createFileSystemWatcher([this._executionRootPath],((e,n)=>{if("add"===e||"change"===e){const i=u.getFileName(n);i&&t.configFileNames.some((e=>e===i))&&(this._verboseOutput&&this._console.info(`Received fs event '${e}' for config file`),this._commandLineOptions&&this.setOptions(this._commandLineOptions))}})))}_clearReloadConfigTimer(){this._reloadConfigTimer&&(clearTimeout(this._reloadConfigTimer),this._reloadConfigTimer=void 0)}_scheduleReloadConfigFile(){this._clearReloadConfigTimer(),this._reloadConfigTimer=setTimeout((()=>{this._clearReloadConfigTimer(),this._reloadConfigFile()}),100)}_reloadConfigFile(){if(this._updateConfigFileWatcher(),this._configFilePath){this._console.info(`Reloading configuration file at ${this._configFilePath}`);const e=this._getConfigOptions(this._commandLineOptions);this._backgroundAnalysisProgram.setConfigOptions(e),this._applyConfigOptions()}}_applyConfigOptions(e=!0){const t=this._importResolverFactory(this._fs,this._backgroundAnalysisProgram.configOptions);this._backgroundAnalysisProgram.setImportResolver(t),this._updateLibraryFileWatcher(),this._updateConfigFileWatcher(),this._updateSourceFileWatchers(),this._updateTrackedFileList(!0),e&&this._scheduleReanalysis(!1)}_clearReanalysisTimer(){this._analyzeTimer&&(clearTimeout(this._analyzeTimer),this._analyzeTimer=void 0)}_scheduleReanalysis(e){var t;if(this._disposed)return;e&&(this._requireTrackedFileUpdate=!0),null===(t=this._backgroundAnalysisCancellationSource)||void 0===t||t.cancel(),this._clearReanalysisTimer();const n=Date.now()-this._lastUserInteractionTime,i=Math.max(250-n,20);this._analyzeTimer=setTimeout((()=>{this._analyzeTimer=void 0,this._requireTrackedFileUpdate&&this._updateTrackedFileList(!1),this._backgroundAnalysisCancellationSource=o.createBackgroundThreadCancellationTokenSource();this._backgroundAnalysisProgram.startAnalysis(this._backgroundAnalysisCancellationSource.token)&&this._scheduleReanalysis(!1)}),i)}_reportConfigParseError(){this._onCompletionCallback&&this._onCompletionCallback({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!1,configParseErrorOccurred:!0,elapsedTime:0})}}t.AnalyzerService=g},54549:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SourceFile=void 0;const a=n(80327),o=n(65013),l=r(n(91197)),c=n(38213),p=n(14943),u=n(11043),d=n(20823),h=n(24319),m=n(85036),y=n(77134),g=n(94647),f=r(n(14551)),T=n(80957),_=n(979),v=n(76962),b=n(80088),S=n(27888),C=n(70234),I=n(54989),D=n(8871),x=n(47458),k=n(5165),F=n(75659),P=n(74426),A=n(55390),E=n(14014),w=n(37633),N=r(n(35696)),O=n(91242),R=n(51153),M=r(n(81044)),L=n(15297),U=n(51660);t.SourceFile=class{constructor(e,t,n,i,s,r,a){this._isFileDeleted=!1,this._diagnosticVersion=0,this._fileContentsVersion=0,this._lastFileContentLength=void 0,this._lastFileContentHash=void 0,this._analyzedFileContentsVersion=-1,this._parseTreeNeedsCleaning=!1,this._isBindingInProgress=!1,this._parseDiagnostics=[],this._bindDiagnostics=[],this._checkerDiagnostics=[],this._diagnosticRuleSet=p.getBasicDiagnosticRuleSet(),this._circularDependencies=[],this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this._indexingNeeded=!0,this.fileSystem=e,this._console=r||new u.StandardConsole,this._filePath=t,this._moduleName=n,this._isStubFile=t.endsWith(".pyi"),this._isThirdPartyImport=i,this._isThirdPartyPyTypedPresent=s;const l=g.getFileName(t);this._isTypingStubFile=this._isStubFile&&(this._filePath.endsWith(g.normalizeSlashes("stdlib/typing.pyi"))||"typing_extensions.pyi"===l),this._isTypingExtensionsStubFile=this._isStubFile&&"typing_extensions.pyi"===l,this._isBuiltInStubFile=!1,this._isStubFile&&(this._filePath.endsWith(g.normalizeSlashes("stdlib/collections/__init__.pyi"))||this._filePath.endsWith(g.normalizeSlashes("stdlib/asyncio/futures.pyi"))||this._filePath.endsWith(g.normalizeSlashes("stdlib/builtins.pyi"))||this._filePath.endsWith(g.normalizeSlashes("stdlib/_importlib_modulespec.pyi"))||this._filePath.endsWith(g.normalizeSlashes("stdlib/dataclasses.pyi"))||this._filePath.endsWith(g.normalizeSlashes("stdlib/abc.pyi"))||this._filePath.endsWith(g.normalizeSlashes("stdlib/enum.pyi"))||this._filePath.endsWith(g.normalizeSlashes("stdlib/queue.pyi"))||this._filePath.endsWith(g.normalizeSlashes("stdlib/types.pyi")))&&(this._isBuiltInStubFile=!0),this._logTracker=null!=a?a:new y.LogTracker(r,o.isMainThread?"FG":"BG")}getFilePath(){return this._filePath}getDiagnosticVersion(){return this._diagnosticVersion}isStubFile(){return this._isStubFile}getDiagnostics(e,t){if(this._diagnosticVersion===t)return;let n=!0;this._isThirdPartyImport&&(n=!1);let i=[];if(i=i.concat(this._parseDiagnostics,this._bindDiagnostics,this._checkerDiagnostics),e.diagnosticRuleSet.enableTypeIgnoreComments){const e=this._parseResults?this._parseResults.tokenizerOutput.typeIgnoreLines:{};Object.keys(e).length>0&&(i=i.filter((t=>{if(3!==t.category)for(let n=t.range.start.line;n<=t.range.end.line;n++)if(e[n])return!1;return!0})))}if("none"!==e.diagnosticRuleSet.reportImportCycles&&this._circularDependencies.length>0){const t=h.convertLevelToCategory(e.diagnosticRuleSet.reportImportCycles);this._circularDependencies.forEach((e=>{i.push(new h.Diagnostic(t,P.Localizer.Diagnostic.importCycleDetected()+"\n"+e.getPaths().map((e=>"  "+e)).join("\n"),T.getEmptyRange()))}))}return void 0!==this._hitMaxImportDepth&&i.push(new h.Diagnostic(0,P.Localizer.Diagnostic.importDepthExceeded().format({depth:this._hitMaxImportDepth}),T.getEmptyRange())),e.ignore.find((e=>e.regExp.test(this._filePath)))&&(i=[]),e.diagnosticRuleSet.enableTypeIgnoreComments&&this._parseResults&&this._parseResults.tokenizerOutput.typeIgnoreAll&&(i=[]),n||(i=i.filter((e=>3===e.category))),i}getImports(){return this._imports||[]}getBuiltinsImport(){return this._builtinsImport}getModuleSymbolTable(){return this._moduleSymbolTable}getModuleDocString(){return this._binderResults?this._binderResults.moduleDocString:void 0}didContentsChangeOnDisk(){if(this._clientDocument)return!1;if(void 0===this._lastFileContentLength)return!1;try{const e=this.fileSystem.readFileSync(this._filePath,"utf8");if(e.length!==this._lastFileContentLength)return!0;if(f.hashString(e)!==this._lastFileContentHash)return!0}catch(e){return!0}return!1}dropParseAndBindInfo(){this._parseResults=void 0,this._moduleSymbolTable=void 0,this._isBindingNeeded=!0,this._binderResults=void 0}markDirty(){this._fileContentsVersion++,this._isCheckingNeeded=!0,this._isBindingNeeded=!0,this._indexingNeeded=!0,this._moduleSymbolTable=void 0,this._binderResults=void 0,this._cachedIndexResults=void 0}markReanalysisRequired(){this._isCheckingNeeded=!0,this._parseResults&&(this._parseResults.containsWildcardImport||N.getDunderAllNames(this._parseResults.parseTree))&&(this._parseTreeNeedsCleaning=!0,this._isBindingNeeded=!0,this._indexingNeeded=!0,this._moduleSymbolTable=void 0,this._binderResults=void 0,this._cachedIndexResults=void 0)}getClientVersion(){var e;return null===(e=this._clientDocument)||void 0===e?void 0:e.version}getFileContents(){var e;return null===(e=this._clientDocument)||void 0===e?void 0:e.getText()}setClientVersion(e,t){null===e?this._clientDocument=void 0:(this._clientDocument||(this._clientDocument=a.TextDocument.create(this._filePath,"python",e,"")),this._clientDocument=a.TextDocument.update(this._clientDocument,t,e),this.markDirty())}prepareForClose(){}isFileDeleted(){return this._isFileDeleted}isParseRequired(){return!this._parseResults||this._analyzedFileContentsVersion!==this._fileContentsVersion}isBindingRequired(){return!this._isBindingInProgress&&(!!this.isParseRequired()||this._isBindingNeeded)}isIndexingRequired(){return this._indexingNeeded}isCheckingRequired(){return this._isCheckingNeeded}getParseResults(){if(!this.isParseRequired())return this._parseResults}getCachedIndexResults(){return this._cachedIndexResults}cacheIndexResults(e){this._cachedIndexResults=e}addCircularDependency(e){let t=!1;this._circularDependencies.length<4&&(this._circularDependencies.some((t=>t.isEqual(e)))||(this._circularDependencies.push(e),t=!0)),t&&this._diagnosticVersion++}setHitMaxImportDepth(e){this._hitMaxImportDepth=e}parse(e,t,n){return this._logTracker.log(`parsing: ${this._getPathForLogging(this._filePath)}`,(i=>{if(!this.isParseRequired())return i.suppress(),!1;const s=new m.DiagnosticSink;let r=this.getFileContents();if(void 0===r)try{const e=v.timingStats.readFileTime.totalTime;v.timingStats.readFileTime.timeOperation((()=>{r=null!=n?n:this.fileSystem.readFileSync(this._filePath,"utf8"),this._lastFileContentLength=r.length,this._lastFileContentHash=f.hashString(r)})),i.add(`fs read ${v.timingStats.readFileTime.totalTime-e}ms`)}catch(e){s.addError("Source file could not be read",T.getEmptyRange()),r="",this.fileSystem.existsSync(this._filePath)||(this._isFileDeleted=!0)}const a=e.findExecEnvironment(this._filePath),o=new E.ParseOptions;this._filePath.endsWith("pyi")&&(o.isStubFile=!0),o.pythonVersion=a.pythonVersion;try{const n=(new E.Parser).parseSourceFile(r,o,s);d.assert(void 0!==n&&void 0!==n.tokenizerOutput),this._parseResults=n,v.timingStats.resolveImportsTime.timeOperation((()=>{const e=this._resolveImports(t,n.importedModules,a);this._imports=e.imports,this._builtinsImport=e.builtinsImportResult,this._typingModulePath=e.typingModulePath,this._typeshedModulePath=e.typeshedModulePath,this._collectionsModulePath=e.collectionsModulePath,this._parseDiagnostics=s.fetchAndClear()}));const i=void 0!==e.strict.find((e=>e.regExp.test(this._filePath)));this._diagnosticRuleSet=M.getFileLevelDirectives(this._parseResults.tokenizerOutput.tokens,e.diagnosticRuleSet,i)}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(P.Localizer.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t})),this._parseResults={text:"",parseTree:A.ModuleNode.create({start:0,length:0}),importedModules:[],futureImports:new Map,tokenizerOutput:{tokens:new _.TextRangeCollection([]),lines:new _.TextRangeCollection([]),typeIgnoreAll:!1,typeIgnoreLines:{},predominantEndOfLineSequence:"\n",predominantTabSequence:"    ",predominantSingleQuoteCharacter:"'"},containsWildcardImport:!1},this._imports=void 0,this._builtinsImport=void 0;const n=new m.DiagnosticSink;n.addError(P.Localizer.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t}),T.getEmptyRange()),this._parseDiagnostics=n.fetchAndClear()}return this._analyzedFileContentsVersion=this._fileContentsVersion,this._indexingNeeded=!0,this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this._parseTreeNeedsCleaning=!1,this._hitMaxImportDepth=void 0,this._diagnosticVersion++,!0}))}index(e,t){return this._logTracker.log(`indexing: ${this._getPathForLogging(this._filePath)}`,(n=>{if(!this._parseResults||!this.isIndexingRequired())return void n.suppress();this._indexingNeeded=!1;const i=I.DocumentSymbolProvider.indexSymbols(N.getFileInfo(this._parseResults.parseTree),this._parseResults,e,t);n.add(`found ${i.length}`);const s=g.stripFileExtension(g.getFileName(this._filePath));return{privateOrProtected:l.isPrivateOrProtectedName(s),symbols:i}}))}getDefinitionsForPosition(e,t,n,i,s){if(this._parseResults)return S.DefinitionProvider.getDefinitionsForPosition(e,this._parseResults,t,n,i,s)}getDeclarationForPosition(e,t,n,i,s){if(this._parseResults)return k.ReferencesProvider.getDeclarationForPosition(e,this._parseResults,this._filePath,t,n,i,s)}addReferences(e,t,n,i){this._parseResults&&k.ReferencesProvider.addReferences(this._parseResults,this._filePath,e,t,n,i)}addHierarchicalSymbolsForDocument(e,t){(this._parseResults||this._cachedIndexResults)&&I.DocumentSymbolProvider.addHierarchicalSymbolsForDocument(this._parseResults?N.getFileInfo(this._parseResults.parseTree):void 0,this.getCachedIndexResults(),this._parseResults,e,t)}getSymbolsForDocument(e,t){return this._parseResults||this._cachedIndexResults?I.DocumentSymbolProvider.getSymbolsForDocument(this._parseResults?N.getFileInfo(this._parseResults.parseTree):void 0,this.getCachedIndexResults(),this._parseResults,this._filePath,e,t):[]}getHoverForPosition(e,t,n,i,s){if(!this._isBindingNeeded&&this._parseResults)return D.HoverProvider.getHoverForPosition(e,this._parseResults,t,n,i,s)}getDocumentHighlight(e,t,n,i){if(!this._isBindingNeeded&&this._parseResults)return C.DocumentHighlightProvider.getDocumentHighlight(this._parseResults,t,n,i)}getSignatureHelpForPosition(e,t,n,i,s){if(this._parseResults)return F.SignatureHelpProvider.getSignatureHelpForPosition(this._parseResults,e,t,n,i,s)}getCompletionsForPosition(e,t,n,i,s,r,a,o,l,c,p,u){if(!this._parseResults)return;const d=this.getFileContents();if(void 0===d)return;return new b.CompletionProvider(t,this._parseResults,d,i,e,this._filePath,n,s,r,a,o,{nameMap:l,libraryMap:c,getModuleSymbolsMap:p},u).getCompletionsForPosition()}resolveCompletionItem(e,t,n,i,s,r,a,o,l,c,p){const u=this.getFileContents();if(!this._parseResults||void 0===u)return;const d=c.data;new b.CompletionProvider(d.workspacePath,this._parseResults,u,t,d.position,this._filePath,e,n,i,s,r,{nameMap:a,libraryMap:o,getModuleSymbolsMap:l},p).resolveCompletionItem(c)}performQuickAction(e,t,n){if(this._parseResults&&void 0!==this.getClientVersion())return x.performQuickAction(e,t,this._parseResults,n)}bind(e,t,n){return d.assert(!this.isParseRequired()),d.assert(this.isBindingRequired()),d.assert(!this._isBindingInProgress),d.assert(void 0!==this._parseResults),this._logTracker.log(`binding: ${this._getPathForLogging(this._filePath)}`,(()=>{try{v.timingStats.bindTime.timeOperation((()=>{this._cleanParseTreeIfRequired();const i=this._buildFileInfo(e,this._parseResults.text,t,n);N.setFileInfo(this._parseResults.parseTree,i);const s=new O.Binder(i);if(this._isBindingInProgress=!0,this._binderResults=s.bindModule(this._parseResults.parseTree),e.internalTestMode){(new U.TestWalker).walk(this._parseResults.parseTree)}this._bindDiagnostics=i.diagnosticSink.fetchAndClear();const r=N.getScope(this._parseResults.parseTree);d.assert(void 0!==r),this._moduleSymbolTable=r.symbolTable}))}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(P.Localizer.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}));const n=new m.DiagnosticSink;n.addError(P.Localizer.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}),T.getEmptyRange()),this._bindDiagnostics=n.fetchAndClear()}finally{this._isBindingInProgress=!1}this._diagnosticVersion++,this._isCheckingNeeded=!0,this._indexingNeeded=!0,this._isBindingNeeded=!1}))}check(e){return d.assert(!this.isParseRequired()),d.assert(!this.isBindingRequired()),d.assert(!this._isBindingInProgress),d.assert(this.isCheckingRequired()),d.assert(void 0!==this._parseResults),this._logTracker.log(`checking: ${this._getPathForLogging(this._filePath)}`,(()=>{try{v.timingStats.typeCheckerTime.timeOperation((()=>{new R.Checker(this._parseResults.parseTree,e).check(),this._isCheckingNeeded=!1;const t=N.getFileInfo(this._parseResults.parseTree);this._checkerDiagnostics=t.diagnosticSink.fetchAndClear()}))}catch(e){if(!c.OperationCanceledException.is(e)){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(P.Localizer.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}));const n=new m.DiagnosticSink;n.addError(P.Localizer.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}),T.getEmptyRange()),this._checkerDiagnostics=n.fetchAndClear(),this._isCheckingNeeded=!1}throw e}finally{this._circularDependencies=[],this._diagnosticVersion++}}))}_buildFileInfo(e,t,n,i){d.assert(void 0!==this._parseResults);const s=new m.TextRangeDiagnosticSink(this._parseResults.tokenizerOutput.lines);return{importLookup:n,futureImports:this._parseResults.futureImports,builtinsScope:i,typingModulePath:this._typingModulePath,typeshedModulePath:this._typeshedModulePath,collectionsModulePath:this._collectionsModulePath,diagnosticSink:s,executionEnvironment:e.findExecEnvironment(this._filePath),diagnosticRuleSet:this._diagnosticRuleSet,fileContents:t,lines:this._parseResults.tokenizerOutput.lines,filePath:this._filePath,moduleName:this._moduleName,isStubFile:this._isStubFile,isTypingStubFile:this._isTypingStubFile,isTypingExtensionsStubFile:this._isTypingExtensionsStubFile,isBuiltInStubFile:this._isBuiltInStubFile,isInPyTypedPackage:this._isThirdPartyPyTypedPresent,accessedSymbolMap:new Map}}_cleanParseTreeIfRequired(){if(this._parseResults&&this._parseTreeNeedsCleaning){new L.ParseTreeCleanerWalker(this._parseResults.parseTree).clean(),this._parseTreeNeedsCleaning=!1}}_resolveImports(e,t,n){const i=[];let s=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:["builtins"],importedSymbols:void 0});0===s.resolvedPaths.length||s.resolvedPaths[0]!==this.getFilePath()?i.push(s):s=void 0;const r=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:["typing"],importedSymbols:void 0});let a;0!==r.resolvedPaths.length&&r.resolvedPaths[0]===this.getFilePath()||(i.push(r),a=r.resolvedPaths[0]);const o=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:["_typeshed"],importedSymbols:void 0});let l,c;0!==o.resolvedPaths.length&&o.resolvedPaths[0]===this.getFilePath()||(i.push(o),l=o.resolvedPaths[0]);for(const s of t){const t=e.resolveImport(this._filePath,n,{leadingDots:s.leadingDots,nameParts:s.nameParts,importedSymbols:s.importedSymbols});t.isImportFound&&t.isTypeshedFile&&s.nameParts.length>=1&&"collections"===s.nameParts[0]&&(c=t.resolvedPaths[t.resolvedPaths.length-1]),i.push(t),N.setImportInfo(s.nameNode,t)}return{imports:i,builtinsImportResult:s,typingModulePath:a,typeshedModulePath:l,collectionsModulePath:c}}_getPathForLogging(e){return this.fileSystem instanceof w.PyrightFileSystem&&this.fileSystem.isMappedFilePath(e)?"[virtual] "+e:e}}},93989:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isStubFile=t.SourceMapper=void 0;const a=r(n(35696)),o=r(n(23241)),l=n(98173),c=n(94647),p=n(16800),u=n(59195),d=n(10425);function h(e){return".pyi"===c.getAnyExtensionFromPath(e,[".pyi"],!1)}t.SourceMapper=class{constructor(e,t,n,i,s,r){this._importResolver=e,this._execEnv=t,this._evaluator=n,this._fileBinder=i,this._boundSourceGetter=s,this._mapCompiled=r}findModules(e){return this._getBoundSourceFilesFromStubFile(e).map((e=>{var t;return null===(t=e.getParseResults())||void 0===t?void 0:t.parseTree})).filter(l.isDefined)}findDeclarations(e){return p.isClassDeclaration(e)?this._findClassOrTypeAliasDeclarations(e):p.isFunctionDeclaration(e)?this._findFunctionOrTypeAliasDeclarations(e):p.isVariableDeclaration(e)?this._findVariableDeclarations(e):p.isParameterDeclaration(e)?this._findParameterDeclarations(e):p.isSpecialBuiltInClassDeclarations(e)?this._findSpecialBuiltInClassDeclarations(e):[]}findClassDeclarations(e){return this._findClassOrTypeAliasDeclarations(e).filter((e=>p.isClassDeclaration(e))).map((e=>e))}findClassDeclarationsByType(e,t){const n=[];return this._addClassTypeDeclarations(e,t,n,new Set),n.filter((e=>p.isClassDeclaration(e))).map((e=>e))}findFunctionDeclarations(e){return this._findFunctionOrTypeAliasDeclarations(e).filter((e=>p.isFunctionDeclaration(e))).map((e=>e))}_findSpecialBuiltInClassDeclarations(e,t=new Set){if(38===e.node.valueExpression.nodeType){const n=e.node.valueExpression.value;return this._getBoundSourceFilesFromStubFile(e.path).flatMap((e=>this._findClassDeclarationsByName(e,n,t)))}return[]}_findClassOrTypeAliasDeclarations(e,t=new Set){const n=this._getFullClassName(e.node);return this._getBoundSourceFilesFromStubFile(e.path).flatMap((e=>this._findClassDeclarationsByName(e,n,t)))}_findFunctionOrTypeAliasDeclarations(e,t=new Set){const n=e.node.name.value,i=this._getBoundSourceFilesFromStubFile(e.path);if(e.isMethod){const s=o.getEnclosingClass(e.node);if(void 0===s)return[];const r=this._getFullClassName(s);return i.flatMap((e=>this._findMethodDeclarationsByName(e,r,n,t)))}return i.flatMap((e=>this._findFunctionDeclarationsByName(e,n,t)))}_findVariableDeclarations(e,t=new Set){if(38!==e.node.nodeType)return[];const n=e.node.value,i=this._getBoundSourceFilesFromStubFile(e.path),s=o.getEnclosingClass(e.node);if(s){const e=this._getFullClassName(s);return i.flatMap((i=>this._findFieldDeclarationsByName(i,e,n,t)))}return i.flatMap((e=>this._findVariableDeclarationsByName(e,n,t)))}_findParameterDeclarations(e){const t=[];if(!e.node.name)return t;const n=o.getEnclosingFunction(e.node);if(!n)return t;const i=this._evaluator.getDeclarationsForNameNode(n.name);if(!i)return t;const s=new Set;for(const n of i)for(const i of this._findFunctionOrTypeAliasDeclarations(n,s))t.push(...this._lookUpSymbolDeclarations(i.node,e.node.name.value).filter((e=>p.isParameterDeclaration(e))).map((e=>e)));return t}_findMemberDeclarationsByName(e,t,n,i,s){const r=[],a=this._findClassDeclarationsByName(e,t,s);for(const e of a.filter((e=>p.isClassDeclaration(e))).map((e=>e))){const t=this._evaluator.getTypeOfClass(e.node);if(!t)continue;const a=d.lookUpClassMember(t.classType,n);if(a)for(const e of a.symbol.getDeclarations())i(e,s,r)}return r}_findFieldDeclarationsByName(e,t,n,i){let s=[];const r=`@${e.getFilePath()}/c/${t}/v/${n}`;return i.has(r)||(s=this._findMemberDeclarationsByName(e,t,n,((e,t,n)=>{p.isVariableDeclaration(e)&&(h(e.path)?n.push(...this._findVariableDeclarations(e,t)):n.push(e))}),i),i.delete(r)),s}_findMethodDeclarationsByName(e,t,n,i){let s=[];const r=`@${e.getFilePath()}/c/${t}/f/${n}`;return i.has(r)||(i.add(r),s=this._findMemberDeclarationsByName(e,t,n,((e,t,n)=>{p.isFunctionDeclaration(e)&&(h(e.path)?n.push(...this._findFunctionOrTypeAliasDeclarations(e,t)):n.push(e))}),i),i.delete(r)),s}_findVariableDeclarationsByName(e,t,n){var i;const s=[],r=`@${e.getFilePath()}/v/${t}`;if(n.has(r))return s;n.add(r);const a=this._lookUpSymbolDeclarations(null===(i=e.getParseResults())||void 0===i?void 0:i.parseTree,t);for(const e of a)this._addVariableDeclarations(e,s,n);return n.delete(r),s}_findFunctionDeclarationsByName(e,t,n){var i;const s=[],r=`@${e.getFilePath()}/f/${t}`;if(n.has(r))return s;n.add(r);const a=this._lookUpSymbolDeclarations(null===(i=e.getParseResults())||void 0===i?void 0:i.parseTree,t);for(const e of a)this._addClassOrFunctionDeclarations(e,s,n);return n.delete(r),s}_findClassDeclarationsByName(e,t,n){var i;let s=[];const r=null===(i=e.getParseResults())||void 0===i?void 0:i.parseTree;if(r){let i=t.split(".");i.length>0&&(s=this._findClassDeclarations(e,i[0],r,n),i=i.slice(1));for(const t of i)s=s.flatMap((i=>this._findClassDeclarations(e,t,i.node,n)))}return s}_findClassDeclarations(e,t,n,i){const s=[],r=`@${e.getFilePath()}[${n.start}]${t}`;if(i.has(r))return s;i.add(r);const a=this._lookUpSymbolDeclarations(n,t);for(const e of a)this._addClassOrFunctionDeclarations(e,s,i);return i.delete(r),s}_addVariableDeclarations(e,t,n){if(p.isVariableDeclaration(e))h(e.path)?t.push(...this._findVariableDeclarations(e,n)):t.push(e);else if(p.isAliasDeclaration(e)){const i=this._evaluator.resolveAliasDeclaration(e,!0);i&&this._addVariableDeclarations(i,t,n)}}_addClassOrFunctionDeclarations(e,t,n){var i;if(p.isClassDeclaration(e))h(e.path)?t.push(...this._findClassOrTypeAliasDeclarations(e,n)):t.push(e);else if(p.isFunctionDeclaration(e))h(e.path)?t.push(...this._findFunctionOrTypeAliasDeclarations(e,n)):t.push(e);else if(p.isAliasDeclaration(e)){const i=this._evaluator.resolveAliasDeclaration(e,!0);i&&this._addClassOrFunctionDeclarations(i,t,n)}else if(p.isVariableDeclaration(e)){this._addVariableDeclarations(e,t,n);const s=null!==(i=e.typeAliasName)&&void 0!==i?i:e.node,r=this._evaluator.getType(s);if(!r)return;if(u.isFunction(r)&&r.details.declaration)this._addClassOrFunctionDeclarations(r.details.declaration,t,n);else if(u.isOverloadedFunction(r))for(const e of r.overloads.map((e=>e.details.declaration)).filter(l.isDefined))this._addClassOrFunctionDeclarations(e,t,n);else u.isClass(r)&&this._addClassTypeDeclarations(e.path,r,t,n)}}_addClassTypeDeclarations(e,t,n,i){const s=this._importResolver.resolveImport(e,this._execEnv,{leadingDots:0,nameParts:t.details.moduleName.split("."),importedSymbols:[]});if(s.isImportFound&&s.resolvedPaths.length>0){const e=s.resolvedPaths[s.resolvedPaths.length-1],r=[];if(h(e))r.push(...this._getBoundSourceFilesFromStubFile(e));else{const t=this._boundSourceGetter(e);t&&r.push(t)}const a=t.details.fullName.substring(t.details.moduleName.length+1);for(const e of r)n.push(...this._findClassDeclarationsByName(e,a,i))}}_lookUpSymbolDeclarations(e,t){if(void 0===e)return[];const n=a.getScope(e),i=null==n?void 0:n.lookUpSymbol(t),s=null==i?void 0:i.getDeclarations();return null!=s?s:[]}_getFullClassName(e){const t=[];let n=e;for(;void 0!==n;)t.push(n.name.value),n=o.getEnclosingClass(n);return t.reverse().join(".")}_getBoundSourceFilesFromStubFile(e){return this._importResolver.getSourceFilesFromStub(e,this._execEnv,this._mapCompiled).map((t=>this._fileBinder(e,t))).filter(l.isDefined)}},t.isStubFile=h},67737:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateStaticBoolLikeExpression=t.evaluateStaticBoolExpression=void 0;const i=n(14943);function s(e,t,n,c){if(55===e.nodeType){if(37===e.operator||36===e.operator){const i=r(e.expression,t,n,c);if(void 0!==i)return!i}}else if(7===e.nodeType){if(37===e.operator||36===e.operator){const i=s(e.leftExpression,t,n,c),r=s(e.rightExpression,t,n,c);if(void 0===i||void 0===r)return;return 37===e.operator?i||r:i&&r}if(l(e.leftExpression,c)&&52===e.rightExpression.nodeType){const n=function(e){let t;if(e.expressions.length>=2){if(40===e.expressions[0].nodeType&&!e.expressions[0].isImaginary&&40===e.expressions[1].nodeType&&!e.expressions[1].isImaginary){const n=e.expressions[0],i=e.expressions[1];t=256*n.value+i.value}}else if(1===e.expressions.length){t=256*e.expressions[0].value}return t}(e.rightExpression);return a(e.operator,t.pythonVersion,n)}if(24===e.leftExpression.nodeType&&l(e.leftExpression.baseExpression,c)&&1===e.leftExpression.items.length&&!e.leftExpression.trailingComma&&!e.leftExpression.items[0].name&&0===e.leftExpression.items[0].argumentCategory&&40===e.leftExpression.items[0].valueExpression.nodeType&&!e.leftExpression.items[0].valueExpression.isImaginary&&0===e.leftExpression.items[0].valueExpression.value&&40===e.rightExpression.nodeType)return a(e.operator,Math.floor(t.pythonVersion/256),e.rightExpression.value);if(function(e,t=["sys"]){if(35===e.nodeType&&38===e.leftExpression.nodeType&&"platform"===e.memberName.value&&t.some((t=>t===e.leftExpression.value)))return!0;return!1}(e.leftExpression,c)&&48===e.rightExpression.nodeType){const n=e.rightExpression.strings.map((e=>e.value)).join(""),s=function(e){if(e.pythonPlatform===i.PythonPlatform.Darwin)return"darwin";if(e.pythonPlatform===i.PythonPlatform.Windows)return"win32";if(e.pythonPlatform===i.PythonPlatform.Linux)return"linux";return}(t);return o(e.operator,s,n)}if(function(e){if(35===e.nodeType&&38===e.leftExpression.nodeType&&"os"===e.leftExpression.value&&"name"===e.memberName.value)return!0;return!1}(e.leftExpression)&&48===e.rightExpression.nodeType){const n=e.rightExpression.strings.map((e=>e.value)).join(""),s=function(e){if(e.pythonPlatform===i.PythonPlatform.Darwin)return"posix";if(e.pythonPlatform===i.PythonPlatform.Windows)return"nt";if(e.pythonPlatform===i.PythonPlatform.Linux)return"posix";return}(t);if(void 0!==s)return o(e.operator,s,n)}}else if(11===e.nodeType){if(33===e.constType)return!0;if(15===e.constType)return!1}else if(38===e.nodeType){if("TYPE_CHECKING"===e.value)return!0}else if(n&&35===e.nodeType&&"TYPE_CHECKING"===e.memberName.value&&38===e.leftExpression.nodeType&&n.some((t=>t===e.leftExpression.value)))return!0}function r(e,t,n,i){return(11!==e.nodeType||26!==e.constType)&&s(e,t,n,i)}function a(e,t,n){if(void 0!==t&&void 0!==n){if(20===e)return t<n;if(21===e)return t<=n;if(15===e)return t>n;if(16===e)return t>=n;if(12===e)return t===n;if(28===e)return t!==n}}function o(e,t,n){if(void 0!==t&&void 0!==n){if(12===e)return t===n;if(28===e)return t!==n}}function l(e,t=["sys"]){return!(35!==e.nodeType||38!==e.leftExpression.nodeType||"version_info"!==e.memberName.value||!t.some((t=>t===e.leftExpression.value)))}t.evaluateStaticBoolExpression=s,t.evaluateStaticBoolLikeExpression=r},97882:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Symbol=t.indeterminateSymbolId=void 0;const i=n(88023);let s=1;t.indeterminateSymbolId=0;class r{constructor(e=4){this.id=s++,this._flags=e}static createWithType(e,t){const n=new r(e);return n._synthesizedType=t,n}isInitiallyUnbound(){return!!(1&this._flags)}setIsExternallyHidden(){this._flags|=2}isExternallyHidden(){return!!(2&this._flags)}setIsIgnoredForProtocolMatch(){this._flags|=64}isIgnoredForProtocolMatch(){return!!(64&this._flags)}setIsClassMember(){this._flags|=4}isClassMember(){return!!(4&this._flags)}setIsInstanceMember(){this._flags|=8}isInstanceMember(){return!!(8&this._flags)}setIsClassVar(){this._flags|=128}isClassVar(){return!!(128&this._flags)}setIsInDunderAll(){this._flags|=256}isInDunderAll(){return!!(256&this._flags)}setIsPrivateMember(){this._flags|=32}isPrivateMember(){return!!(32&this._flags)}addDeclaration(e){if(this._declarations){const t=this._declarations.findIndex((t=>i.areDeclarationsSame(t,e)));if(t<0)this._declarations.push(e),this._declarations.forEach((e=>{1===e.type&&e.typeAliasName&&delete e.typeAliasName}));else{const n=this._declarations[t];i.hasTypeForDeclaration(e)?(this._declarations[t]=e,1===n.type&&1===e.type&&!e.inferredTypeSource&&n.inferredTypeSource&&(e.inferredTypeSource=n.inferredTypeSource)):1===e.type&&1===n.type&&(e.isFinal&&(n.isFinal=!0),e.typeAliasAnnotation&&(n.typeAliasAnnotation=e.typeAliasAnnotation),!n.inferredTypeSource&&e.inferredTypeSource&&(n.inferredTypeSource=e.inferredTypeSource))}}else this._declarations=[e]}hasDeclarations(){return!!this._declarations&&this._declarations.length>0}getDeclarations(){return this._declarations?this._declarations:[]}hasTypedDeclarations(){return!!this._synthesizedType||this.getDeclarations().some((e=>i.hasTypeForDeclaration(e)))}getTypedDeclarations(){return this.getDeclarations().filter((e=>i.hasTypeForDeclaration(e)))}getSynthesizedType(){return this._synthesizedType}}t.Symbol=r},91197:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPublicConstantOrTypeAlias=t.isTypeAliasName=t.isConstantName=t.isSingleDunderName=t.isDunderName=t.isPrivateOrProtectedName=t.isProtectedName=t.isPrivateName=void 0;const n=/^[A-Z0-9_]+$/,i=/^[_]+$/,s=/^_{0,2}[A-Z][A-Za-z0-9_]+$/;function r(e){return e.length>2&&e.startsWith("__")&&!e.endsWith("__")}function a(e){return e.length>1&&e.startsWith("_")&&!e.startsWith("__")}function o(e){return r(e)||a(e)}function l(e){return!!e.match(n)&&!e.match(i)}function c(e){return!!e.match(s)}t.isPrivateName=r,t.isProtectedName=a,t.isPrivateOrProtectedName=o,t.isDunderName=function(e){return e.length>4&&e.startsWith("__")&&e.endsWith("__")},t.isSingleDunderName=function(e){return e.length>2&&e.startsWith("_")&&e.endsWith("_")},t.isConstantName=l,t.isTypeAliasName=c,t.isPublicConstantOrTypeAlias=function(e){return!o(e)&&(l(e)||c(e))}},15020:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNotRequiredTypedDictVariable=t.isRequiredTypedDictVariable=t.isFinalVariable=t.isTypedDictMemberAccessedThroughIndex=t.getLastTypedDeclaredForSymbol=void 0;const i=n(88023);t.getLastTypedDeclaredForSymbol=function(e){const t=e.getTypedDeclarations();if(t.length>0)return t[t.length-1]},t.isTypedDictMemberAccessedThroughIndex=function(e){const t=e.getTypedDeclarations();if(t.length>0){if(1===t[t.length-1].type)return!0}return!1},t.isFinalVariable=function(e){return e.getDeclarations().some((e=>i.isFinalVariableDeclaration(e)))},t.isRequiredTypedDictVariable=function(e){return e.getDeclarations().some((e=>1===e.type&&!!e.isRequired))},t.isNotRequiredTypedDictVariable=function(e){return e.getDeclarations().some((e=>1===e.type&&!!e.isNotRequired))}},51660:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestWalker=void 0;const i=n(22339),s=n(20823),r=n(80957);class a extends i.ParseTreeWalker{constructor(){super()}visitNode(e){const t=super.visitNode(e);return this._verifyParentChildLinks(e,t),this._verifyChildRanges(e,t),t}_verifyParentChildLinks(e,t){t.forEach((t=>{t&&t.parent!==e&&s.fail(`Child node ${t.nodeType} does not contain a reference to its parent ${e.nodeType}`)}))}_verifyChildRanges(e,t){let n;t.forEach((t=>{if(t){let i=!1;3===e.nodeType&&t===e.typeAnnotationComment&&(i=!0),48===e.nodeType&&t===e.typeAnnotation&&(i=!0),i||((t.start<e.start||r.TextRange.getEnd(t)>r.TextRange.getEnd(e))&&s.fail(`Child node ${t.nodeType} is not contained within its parent ${e.nodeType}`),n&&t.start<r.TextRange.getEnd(n)&&62!==n.nodeType&&s.fail("Child node is not after previous child node"),n=t)}}))}}t.TestWalker=a},25997:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createTracePrinter=void 0;const a=n(98173),o=n(20823),l=n(94647),c=n(55390),p=r(n(35696)),u=r(n(23241)),d=n(97882);t.createTracePrinter=function(e){function t(e,t="'"){return e?`${t}${e}${t}`:""}e=e.map((e=>l.ensureTrailingDirectorySeparator(e))).sort(((e,t)=>e.localeCompare(t))).reverse();const n=/[\\/]/g;function i(t){if(t){for(const i of e)if(t.startsWith(i)){const e=t.substring(i.length);return l.stripFileExtension(e).replace(n,".")}return t}return""}function s(e){var n,i,r,a,l,c;if(e)switch(e.category){case 2:return`Any ${t(null===(n=e.typeAliasInfo)||void 0===n?void 0:n.fullName)}`;case 7:return`Class '${e.details.name}' (${e.details.moduleName})`;case 5:return`Function '${e.details.name}' (${e.details.moduleName})`;case 9:return`Module '${e.moduleName}' (${e.moduleName})`;case 4:return`Never ${t(null===(i=e.typeAliasInfo)||void 0===i?void 0:i.fullName)}`;case 3:return`None ${t(null===(r=e.typeAliasInfo)||void 0===r?void 0:r.fullName)}`;case 8:return`Object [${s(e.classType)}]`;case 6:return`OverloadedFunction [${e.overloads.map((e=>t(s(e),'"'))).join(",")}]`;case 11:return`TypeVar '${e.details.name}' ${t(null===(a=e.typeAliasInfo)||void 0===a?void 0:a.fullName)}`;case 0:return`Unbound ${t(null===(l=e.typeAliasInfo)||void 0===l?void 0:l.fullName)}`;case 10:return`Union [${e.subtypes.map((e=>t(s(e),'"'))).join(",")}]`;case 1:return`Unknown ${t(null===(c=e.typeAliasInfo)||void 0===c?void 0:c.fullName)}`;default:o.assertNever(e)}return""}function r(e){if(e)switch(e.type){case 6:return`Alias, ${h(e.node)} (${i(e.path)})`;case 4:return`Class, ${h(e.node)} (${i(e.path)})`;case 3:return`Function, ${h(e.node)} (${i(e.path)})`;case 0:return`Intrinsic, ${h(e.node)} ${e.intrinsicType} (${i(e.path)})`;case 2:return`Parameter, ${h(e.node)} (${i(e.path)})`;case 5:return`SpecialBuiltInClass, ${h(e.node)} (${i(e.path)})`;case 1:return`Variable, ${h(e.node)} (${i(e.path)})`;default:o.assertNever(e)}return""}function h(e,n=!1){var s;if(!e)return"";const r=n?`(${i(null===(s=function(e){for(;36!==e.nodeType&&e.parent;)e=e.parent;return 36===e.nodeType?p.getFileInfo(e):void 0}(e))||void 0===s?void 0:s.filePath)})`:"";if(c.isExpressionNode(e))return t(function(e,t=30){return e.length<t?e:e.substring(0,t)+" <shortened> "}(u.printExpression(e)),'"')+` ${r}`;switch(e.nodeType){case 21:return`importAs '${h(e.module)}' ${t(e.alias?h(e.alias):"")} ${r}`;case 22:return`importFrom [${e.imports.map((e=>t(h(e),'"'))).join(",")}]`;case 23:return`ImportFromAs '${h(e.name)}' ${t(e.alias?h(e.alias):"")} ${r}`;case 36:return`module ${r}`;case 10:return`class '${h(e.name)}' ${r}`;case 28:return`function '${h(e.name)}' ${r}`;case 37:return`moduleName '${e.nameParts.map((e=>h(e))).join(".")}' ${r}`;case 1:return`argument '${e.name?h(e.name):"N/A"}' ${r}`;case 41:return`parameter '${e.name?h(e.name):"N/A"}' ${r}`;default:return`${u.printParseNodeType(e.nodeType)} ${r}`}}return{print:function(e){return e?function(e){const t=e;return t&&a.isNumber(t.nodeType)}(e)?h(e,!0):function(e){const t=e;return t&&a.isNumber(t.type)&&a.isString(t.path)&&a.isString(t.moduleName)}(e)?r(e):e instanceof d.Symbol?(t=e)?t.hasDeclarations()?`symbol ${r(t.getDeclarations()[0])}`:"<symbol>":"":function(e){const t=e;return t&&a.isNumber(t.category)&&a.isNumber(t.flags)}(e)?s(e):void o.assertNever(e):"";var t},printFileOrModuleName:i}}},57065:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.IncompleteTypeTracker=t.SpeculativeTypeTracker=t.isIncompleteType=void 0;const a=n(20823),o=r(n(23241)),l=n(59195);t.isIncompleteType=function(e){return!!e.isIncompleteType};t.SpeculativeTypeTracker=class{constructor(){this._speculativeContextStack=[],this._speculativeTypeCache=new Map}enterSpeculativeContext(e,t){this._speculativeContextStack.push({speculativeRootNode:e,entriesToUndo:[],allowCacheRetention:t})}leaveSpeculativeContext(){a.assert(this._speculativeContextStack.length>0);this._speculativeContextStack.pop().entriesToUndo.forEach((e=>{e.cache.delete(e.id)}))}isSpeculative(e){if(0===this._speculativeContextStack.length)return!1;if(!e)return!0;for(let t=this._speculativeContextStack.length-1;t>=0;t--)if(o.isNodeContainedWithin(e,this._speculativeContextStack[t].speculativeRootNode))return!0;return!1}trackEntry(e,t){const n=this._speculativeContextStack.length;n>0&&this._speculativeContextStack[n-1].entriesToUndo.push({cache:e,id:t})}disableSpeculativeMode(){const e=this._speculativeContextStack;return this._speculativeContextStack=[],e}enableSpeculativeMode(e){a.assert(0===this._speculativeContextStack.length),this._speculativeContextStack=e}addSpeculativeType(e,t,n){if(a.assert(this._speculativeContextStack.length>0),this._speculativeContextStack.some((e=>!e.allowCacheRetention)))return;let i=this._speculativeTypeCache.get(e.id);i||(i=[],this._speculativeTypeCache.set(e.id,i)),i.push({type:t,expectedType:n})}getSpeculativeType(e,t){if(this._speculativeContextStack.some((t=>o.isNodeContainedWithin(e,t.speculativeRootNode)))){const n=this._speculativeTypeCache.get(e.id);if(n)for(const e of n)if(t){if(e.expectedType&&l.isTypeSame(t,e.expectedType))return e.type}else if(!e.expectedType)return e.type}}};t.IncompleteTypeTracker=class{constructor(){this._trackerStack=[],this._isUndoTrackingEnabled=!1}trackEntry(e,t){if(this._isUndoTrackingEnabled){this._trackerStack[this._trackerStack.length-1].push({cache:e,id:t})}}enterTrackingScope(){this._trackerStack.push([])}exitTrackingScope(){this._trackerStack.pop().forEach((e=>{e.cache.delete(e.id)})),0===this._trackerStack.length&&(this._isUndoTrackingEnabled=!1)}enableUndoTracking(){this._trackerStack.length>0&&(this._isUndoTrackingEnabled=!0)}isUndoTrackingEnabled(){return this._isUndoTrackingEnabled}}},58333:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getClassDocString=t.getModuleDocString=t.getOverloadedFunctionDocStringsInherited=t.getFunctionDocStringInherited=t.getPropertyDocStringInherited=void 0;const a=n(16800),o=r(n(23241)),l=n(93989),c=n(59195),p=n(10425);t.getPropertyDocStringInherited=function(e,t,n,i){if(!e||!a.isFunctionDeclaration(e))return;const s=n.getTypeForDeclaration(e);if(!s||!p.isProperty(s))return;const r=28===e.node.nodeType?e.node.name.value:void 0;if(!r)return;const o=p.getClassIterator(i,0);for(const[e]of o){if(!c.isClass(e))continue;const i=e.details.fields.get(r),s=null==i?void 0:i.getDeclarations();if(s)for(const e of s)if(a.isFunctionDeclaration(e)){const i=n.getTypeForDeclaration(e);if(i&&p.isProperty(i)){const n=d(e,t);if(n)return n}}}};function u(e,t,n){if(!c.isOverloadedFunction(e))return;const i=[];if(e.overloads.some((e=>e.details.docString)))e.overloads.forEach((e=>{e.details.docString&&i.push(e.details.docString)}));else if(t&&l.isStubFile(t.path)&&a.isFunctionDeclaration(t)){const e=h(n.findFunctionDeclarations(t));e&&i.push(e)}return i}function d(e,t){let n=h([e]);if(!n&&l.isStubFile(e.path)){n=h(t.findFunctionDeclarations(e))}return n}function h(e){var t,n,i;for(const s of e){const e=o.getDocString(null!==(i=null===(n=null===(t=s.node)||void 0===t?void 0:t.suite)||void 0===n?void 0:n.statements)&&void 0!==i?i:[]);if(e)return e}}t.getFunctionDocStringInherited=function(e,t,n,i){let s;if(t&&a.isFunctionDeclaration(t)&&(s=function(e,t,n){if(!c.isFunction(e))return;let i=e.details.docString;!i&&t&&(i=d(t,n));!i&&e.details.declaration&&(i=d(e.details.declaration,n));return i}(e,t,n)),!s&&i){const t=e.details.name,r=p.getClassMemberIterator(i,t,25);for(const e of r){if(e.symbol.getDeclarations().length>0){const t=e.symbol.getDeclarations().slice(-1)[0];if(a.isFunctionDeclaration(t)&&(s=d(t,n),s))break}}}return s},t.getOverloadedFunctionDocStringsInherited=function(e,t,n,i,s){let r=u(e,t,n);if(r&&r.length>0)return r;if(s&&e.overloads.length>0){const t=e.overloads[0].details.name,a=p.getClassMemberIterator(s,t,25);for(const e of a){const t=e.symbol.getDeclarations().slice(-1)[0],s=i.getTypeForDeclaration(t);if(s&&(r=u(s,t,n),r&&r.length>0))break}}return null!=r?r:[]},t.getModuleDocString=function(e,t,n){let i=e.docString;if(!i&&t&&l.isStubFile(t.path)){i=function(e){for(const t of e)if(t.statements){const e=o.getDocString(t.statements);if(e)return e}return}(n.findModules(t.path))}return i},t.getClassDocString=function(e,t,n){let i=e.details.docString;if(!i&&t&&a.isClassDeclaration(t)&&(i=h([t]),!i&&t&&l.isStubFile(t.path)&&4===t.type)){i=h(n.findClassDeclarations(t))}if(!i&&t){const s=n.findClassDeclarationsByType(t.path,e);if(s){i=h(s.filter((e=>a.isClassDeclaration(e))).map((e=>e)))}}return i}},68755:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createTypeEvaluator=void 0;const a=n(38213),o=n(20823),l=n(24319),c=n(15741),p=n(28348),u=n(57485),d=n(80957),h=n(74426),m=n(55390),y=n(14014),g=r(n(82048)),f=r(n(35696)),T=n(24394),_=n(88023),v=r(n(23241)),b=r(n(57203)),S=n(67737),C=n(97882),I=n(91197),D=n(15020),x=n(57065),k=r(n(22105)),F=n(59195),P=n(10425),A=n(20670),E={0:["__add__","__radd__",!1],33:["__sub__","__rsub__",!1],26:["__mul__","__rmul__",!1],13:["__floordiv__","__rfloordiv__",!1],10:["__truediv__","__rtruediv__",!1],24:["__mod__","__rmod__",!1],29:["__pow__","__rpow__",!1],22:["__matmul__","__rmatmul__",!1],3:["__and__","__rand__",!1],6:["__or__","__ror__",!1],8:["__xor__","__rxor__",!1],17:["__lshift__","__rlshift__",!1],31:["__rshift__","__rrshift__",!1],12:["__eq__","__ne__",!0],28:["__ne__","__eq__",!0],20:["__lt__","__gt__",!0],21:["__le__","__ge__",!0],15:["__gt__","__lt__",!0],16:["__ge__","__le__",!0]},w={36:!1,37:!1,39:!0,40:!0,41:!0,42:!0},N={"asyncio.futures.Future":u.PythonVersion.V3_9,"builtins.dict":u.PythonVersion.V3_9,"builtins.frozenset":u.PythonVersion.V3_9,"builtins.list":u.PythonVersion.V3_9,"builtins._PathLike":u.PythonVersion.V3_9,"builtins.set":u.PythonVersion.V3_9,"builtins.tuple":u.PythonVersion.V3_9,"collections.ChainMap":u.PythonVersion.V3_9,"collections.Counter":u.PythonVersion.V3_9,"collections.defaultdict":u.PythonVersion.V3_9,"collections.DefaultDict":u.PythonVersion.V3_9,"collections.deque":u.PythonVersion.V3_9,"collections.OrderedDict":u.PythonVersion.V3_9,"queue.Queue":u.PythonVersion.V3_9},O={"builtins.float":["builtins.int"],"builtins.complex":["builtins.float","builtins.int"],"builtins.bytes":["builtins.bytearray","builtins.memoryview"]},R=64;t.createTypeEvaluator=function(e,t,n,i){const s=[],r=new Map,M=new Map,L=new Map,U=new Map,V=new Map,z=new Map,j=new x.SpeculativeTypeTracker,B=new Map,W=[],$=new x.IncompleteTypeTracker;let q,G,K,H,Y,Q,J=1,Z=!1;const X=[];let ee;function te(e,s,r){return n.log(e,(e=>(e.add(null==i?void 0:i.print(r)),s())),t.minimumLoggingThreshold)}function ne(){q&&a.throwIfCancellationRequested(q)}function ie(e){let t;if(t=ee&&ae(e)?ee.get(e.id):z.get(e.id),void 0!==t)return o.assert(!x.isIncompleteType(t)),t}function se(e,t,n,i,s=!1){if(n)return void(Q&&Q.set(e.id,t));const r=ee&&ae(e)?ee:z;r.set(e.id,t),j.isSpeculative(e)&&(j.trackEntry(r,e.id),s&&j.addSpeculativeType(e,t,i)),$.trackEntry(r,e.id)}function re(e){(ee&&ae(e)?ee:z).delete(e.id)}function ae(e){const t=X.length;if(0===t)return!1;const n=X[t-1];let i=e;for(;i;){if(i===n.functionNode)return!0;i=i.parent}return!1}function oe(e,t){return s.findIndex((n=>n.symbolId===e.id&&n.declaration===t))}function le(e,t){const n=oe(e,t);if(n>=0){for(let e=n+1;e<s.length;e++)s[e].isResultValid=!1;return!1}return s.push({symbolId:e.id,declaration:t,isResultValid:!0}),!0}function ce(e){const t=s.pop();return o.assert(t.symbolId===e.id),t.isResultValid}function pe(e,t,n){const i=oe(e,t);i>=0&&(s[i].partialType=n)}function ue(e,t){const n=oe(e,t);if(n>=0)return s[n].partialType}function de(e){var t;return null===(t=gn(e,(()=>{un(e)})))||void 0===t?void 0:t.type}const he=t.logCalls?(e,t,n=0)=>te("getTypeOfExpression",(()=>me(e,t,n)),e):me;function me(e,t,n=0){var i;const s=ie(e);if(s)return{type:s,node:e};{const n=j.getSpeculativeType(e,t);if(n)return{type:n,node:e}}ne();const r=P.transformPossibleRecursiveTypeAlias(t);let a;Z||(G=function(e,t){const n=Rn(e);return Ae(t,n.typeshedModulePath)}(e,"NoneType")||F.AnyType.create(),K=En(e,"object")||F.AnyType.create(),H=An(e,"type")||F.AnyType.create(),Y=An(e,"tuple")||F.AnyType.create(),Z=!0);let p=0!=(64&n);switch(e.nodeType){case 38:a=function(e,t){var n;const i=Rn(e),s=e.value;let r,a=!1;const l=0!=(4&t)||i.isStubFile,p=wn(e,s,!l);if(p){let n=!l;4===p.scope.type&&(n=!1);const o=p.symbol,u=jn(o,n?e:void 0),d=u.type;u.isIncomplete&&(a=!0),u.isRecursiveDefinition&&Ee(e)&&Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.recursiveDefinition().format({name:s}),e);const m=!!d&&F.isClass(d)&&F.ClassType.isSpecialBuiltIn(d);if(r=d,n&&!m){const t=p.isBeyondExecutionScope||!o.isInitiallyUnbound()?d:F.UnboundType.create(),n=vn(e,o.id,t);n.type&&(r=n.type),n.isIncomplete&&(a=!0)}0==(2&t)&&(F.isClass(r)?(0!=(64&t)&&P.requiresTypeArguments(r)&&!r.typeArguments&&Ue(i.diagnosticRuleSet.reportMissingTypeArgument,c.DiagnosticRule.reportMissingTypeArgument,h.Localizer.Diagnostic.typeArgsMissingForClass().format({name:r.aliasName||r.details.name}),e),r.typeArguments||(r=xn(r,void 0,t,e))):F.isObject(r)&&(r=P.transformTypeObjectToClass(r)),0!=(64&t)&&r.typeAliasInfo&&r.typeAliasInfo.typeParameters&&r.typeAliasInfo.typeParameters.length>0&&!r.typeAliasInfo.typeArguments&&Ue(i.diagnosticRuleSet.reportMissingTypeArgument,c.DiagnosticRule.reportMissingTypeArgument,h.Localizer.Diagnostic.typeArgsMissingForAlias().format({name:r.typeAliasInfo.name}),e)),a||f.isCodeUnreachable(e)||0==(16384&t)&&(F.isUnbound(r)?Ue(i.diagnosticRuleSet.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,h.Localizer.Diagnostic.symbolIsUnbound().format({name:s}),e):F.isPossiblyUnbound(r)&&Ue(i.diagnosticRuleSet.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,h.Localizer.Diagnostic.symbolIsPossiblyUnbound().format({name:s}),e)),qe(i,o,e),0!=(1024&t)&&u.includesVariableDecl&&!r.typeAliasInfo&&(P.isTypeAliasPlaceholder(r)||F.isTypeVar(r)||F.isUnknown(r)||i.isTypingStubFile||Ue(i.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeAnnotationVariable(),e))}else"reveal_type"!==s&&"reveal_locals"!==s&&Ue(i.diagnosticRuleSet.reportUndefinedVariable,c.DiagnosticRule.reportUndefinedVariable,h.Localizer.Diagnostic.symbolIsUndefined().format({name:s}),e),r=F.UnknownType.create();F.isParamSpec(r)&&32&t&&(Re(h.Localizer.Diagnostic.paramSpecContext(),e),r=F.UnknownType.create());if(F.isTypeVar(r)&&0==(64&t)&&r.details.name===s){const t=r.details.isVariadic?Pe(e,"TypeVarTuple"):Pe(e,"TypeVar");r=t&&F.isClass(t)?F.ObjectType.create(t):F.UnknownType.create()}0!=(64&t)&&0==(512&t)&&F.isClass(r)&&F.ClassType.isBuiltIn(r,"Generic")&&Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.genericNotAllowed(),e);if(F.isTypeVar(r)){if(F.TypeBase.isInstantiable(r)&&!P.isTypeAliasPlaceholder(r)){const i=function(e,t){var n;let i=e,s=0;o.assert(F.TypeBase.isInstantiable(t));for(;i&&(i=v.getTypeVarScopeNode(i,35===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)),i);){let e;if(10===i.nodeType){const t=Vt(i);t&&(e=t.classType.details.typeParameters),s++}else if(28===i.nodeType){const t=jt(i);t&&(e=[],t.functionType.details.parameters.forEach((t=>{t.hasDeclaredType&&P.addTypeVarsToListIfUnique(e,P.getTypeVarArgumentsRecursive(t.type))})))}else if(36===i.nodeType)break;if(e){const n=e.find((e=>e.details.name===t.details.name));if(n&&n.scopeId)return{type:s>1?t:P.convertToInstantiable(n),foundInterveningClass:s>1}}i=i.parent}i=e;for(;i;){if(3===i.nodeType){const e=ie(i.leftExpression);if(e&&F.isTypeVar(e)&&e.details.recursiveTypeAliasScopeId&&e.details.recursiveTypeAliasName)return{type:F.TypeVarType.cloneForScopeId(t,e.details.recursiveTypeAliasScopeId,e.details.recursiveTypeAliasName),foundInterveningClass:!1}}i=i.parent}return{type:t,foundInterveningClass:!1}}(e,r);if(r=i.type,0!=(2048&t)&&void 0!==r.scopeId)r.details.isSynthesized||r.details.isParamSpec||Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarUsedByOuterScope().format({name:r.details.name}),e);else if(0!=(8192&t)){if(void 0===r.scopeId)if(i.foundInterveningClass)Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarUsedByOuterScope().format({name:r.details.name}),e);else{let t=v.getEnclosingClassOrFunction(e);if(t&&35===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&e.parent.leftExpression===e){const n=e.parent.memberName.value;if("args"===n||"kwargs"===n){const n=v.getEnclosingClassOrFunction(t);28===(null==n?void 0:n.nodeType)?t=n:i.type.scopeId||Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramSpecNotUsedByOuterScope().format({name:r.details.name}),e)}}t?r=F.TypeVarType.cloneForScopeId(r,He(t),t.name.value):o.fail("AssociateTypeVarsWithCurrentScope flag was set but enclosing scope not found")}}else if(0!=(4096&t)&&(void 0===r.scopeId||i.foundInterveningClass)&&!r.details.isSynthesized){const t=F.isParamSpec(r)?h.Localizer.Diagnostic.paramSpecNotUsedByOuterScope():h.Localizer.Diagnostic.typeVarNotUsedByOuterScope();Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,t.format({name:r.details.name}),e)}}r.isVariadicUnpacked&&(r=F.TypeVarType.cloneForPacked(r))}return{type:r,node:e,isIncomplete:a}}(e,n);break;case 35:a=function(e,t){const n=2|15428&t,i=he(e.leftExpression,void 0,n);if(P.isTypeAliasPlaceholder(i.type))return{node:e,type:F.UnknownType.create(),isIncomplete:!0};const s=Qe(e,i,{method:"get"},t);if(T.isCodeFlowSupportedForReference(e)){se(e,s.type,!1),se(e.memberName,s.type,!1);let t=s.type;if(F.isUnbound(t)){const n=Be(i.type);let s;F.isClass(n)?s=P.lookUpClassMember(n,e.memberName.value,1):F.isObject(n)&&(s=P.lookUpObjectMember(n,e.memberName.value,1)),s&&(t=Hn(s))}const n=vn(e,C.indeterminateSymbolId,t);n.type&&(s.type=n.type),n.isIncomplete&&(s.isIncomplete=!0),re(e),re(e.memberName)}i.isIncomplete&&(s.isIncomplete=!0);return s}(e,n),P.isTypeAliasPlaceholder(a.type)||se(e.memberName,a.type,!!a.isIncomplete);break;case 24:a=function(e,t=0){const n=he(e.baseExpression,void 0,2|t);if(64&t&&48===e.baseExpression.nodeType){const t=Rn(e);!t.isStubFile&&t.executionEnvironment.pythonVersion<u.PythonVersion.V3_10&&Re(h.Localizer.Diagnostic.stringNotSubscriptable(),e.baseExpression)}if(0==(4&t)){const t=Rn(e);if(F.isClass(n.type)&&F.ClassType.isBuiltIn(n.type)&&!n.type.aliasName){const i=N[n.type.details.fullName];void 0!==i&&t.executionEnvironment.pythonVersion<i&&!t.isStubFile&&Re(h.Localizer.Diagnostic.classNotRuntimeSubscriptable().format({name:n.type.aliasName||n.type.details.name}),e.baseExpression)}}const i=tt(e,n.type,{method:"get"},t);if(T.isCodeFlowSupportedForReference(e)){se(e,i.type,!1);const t=vn(e,C.indeterminateSymbolId,i.type);t.type&&(i.type=t.type),t.isIncomplete&&(i.isIncomplete=!0),re(e)}n.isIncomplete&&(i.isIncomplete=!0);return i}(e,n);break;case 9:0!=(1024&n)?(Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeAnnotationCall(),e),a={node:e,type:F.UnknownType.create()}):a=function(e,t){const n=he(e.leftExpression,void 0,2),i=e.arguments.map((e=>({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,node:e,name:e.name})));let s={node:e,type:F.UnknownType.create()};if(P.isTypeAliasPlaceholder(n.type))s.isIncomplete=!0;else{if(38===e.leftExpression.nodeType&&"super"===e.leftExpression.value)s=function(e){e.arguments.length>2&&Re(h.Localizer.Diagnostic.superCallArgCount(),e.arguments[2]);let t,n;if(e.arguments.length>0)t=he(e.arguments[0].valueExpression).type,F.isAnyOrUnknown(t)||F.isClass(t)||Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.superCallFirstArg().format({type:yi(t)}),e.arguments[0].valueExpression);else{const n=v.getEnclosingClass(e);if(n){const e=Vt(n);t=e?e.classType:F.UnknownType.create()}else Re(h.Localizer.Diagnostic.superCallZeroArgForm(),e.leftExpression),t=F.UnknownType.create()}if(e.arguments.length>1){const i=Be(he(e.arguments[1].valueExpression).type);let s=!1;if(F.isAnyOrUnknown(i)||(F.isObject(i)?(F.isClass(t)&&(P.derivesFromClassRecursive(i.classType,t,!0)||(s=!0)),n=i):F.isClass(i)?(F.isClass(t)&&(P.derivesFromClassRecursive(i,t,!0)||(s=!0)),n=i):s=!0),s){Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.superCallSecondArg().format({type:yi(t)}),e.arguments[1].valueExpression)}}const i=e.parent;if(35===i.nodeType){const s=i.memberName.value,r=P.lookUpClassMember(t,s,1);if(r&&F.isClass(r.classType))return{type:F.ObjectType.create(r.classType),node:e,bindToType:n}}if(F.isClass(t)){if(t.details.mro.some((e=>F.isAnyOrUnknown(e))))return{type:F.UnknownType.create(),node:e};const n=t.details.baseClasses;if(n.length>0){const t=n[0];if(F.isClass(t))return{type:F.ObjectType.create(t),node:e}}}return{type:F.UnknownType.create(),node:e}}(e);else if(F.isAnyOrUnknown(n.type)&&38===e.leftExpression.nodeType&&"reveal_type"===e.leftExpression.value)1===e.arguments.length&&0===e.arguments[0].argumentCategory&&void 0===e.arguments[0].name?s.type=function(e){const t=he(e.arguments[0].valueExpression).type,n=v.printExpression(e.arguments[0].valueExpression),i=yi(t);Oe(h.Localizer.DiagnosticAddendum.typeOfSymbol().format({name:n,type:i}),e.arguments[0]);const s=An(e,"str");if(F.isClass(s))return F.ObjectType.create(F.ClassType.cloneWithLiteral(s,i));return F.AnyType.create()}(e):Re(h.Localizer.Diagnostic.revealTypeArgs(),e);else if(F.isAnyOrUnknown(n.type)&&38===e.leftExpression.nodeType&&"reveal_locals"===e.leftExpression.value)0===e.arguments.length?s.type=function(e){let t,n=e;for(;n&&(t=b.getScopeForNode(n),!t||0===t.type);)n=n.parent;const i=[];t&&t.symbolTable.forEach(((e,t)=>{if(!e.isIgnoredForProtocolMatch()){const n=zn(e);i.push(h.Localizer.DiagnosticAddendum.typeOfSymbol().format({name:t,type:yi(n)}))}}));i.length>0?Oe(i.join("\n"),e):Oe(h.Localizer.Diagnostic.revealLocalsNone(),e);return F.NoneType.createInstance()}(e):Re(h.Localizer.Diagnostic.revealLocalsArgs(),e);else{const r=dt(e,i,n.type,void 0,!1,t);s.type=r.returnType||F.UnknownType.create(),r.argumentErrors&&(s.typeErrors=!0)}n.isIncomplete&&(s.isIncomplete=!0)}F.isClass(n.type)&&F.ClassType.isBuiltIn(n.type,"TypeVar")&&Rn(e).isTypingStubFile||i.forEach(((e,t)=>{48!==e.node.valueExpression.nodeType&&kn(e)}));return s}(e,r);break;case 52:a=function(e,t,n){if(0!=(64&n)&&0===e.expressions.length&&!t)return{type:nt([]),node:e,isEmptyTupleShorthand:!0};let i=t;if(t&&F.isUnion(t)){let n;P.doForEachSubtype(t,(t=>{if(!n){On(e,(()=>st(e,t)))&&(n=t)}})),i=n}if(i){const t=st(e,i);if(t)return t}return function(e,t){const n=e.expressions.map((e=>he(e,t?F.AnyType.create():void 0)));if(!Y||!F.isClass(Y))return{type:F.UnknownType.create(),node:e};return{type:P.convertToInstance(P.specializeTupleClass(Y,rt(n))),node:e}}(e,!!t)}(e,r,n);break;case 11:a=function(e,t){let n;26===e.constType?n=0!=(64&t)?F.NoneType.createType():F.NoneType.createInstance():33!==e.constType&&15!==e.constType&&9!==e.constType||(n=En(e,"bool"),n&&F.isObject(n)&&(33===e.constType?n=F.ObjectType.create(F.ClassType.cloneWithLiteral(n.classType,!0)):15===e.constType&&(n=F.ObjectType.create(F.ClassType.cloneWithLiteral(n.classType,!1)))));if(!n)return;return{type:n,node:e}}(e,n);break;case 48:if(0!=(8&n)&&!function(e){if(e.parent&&24===e.parent.nodeType){const t=he(e.parent.baseExpression).type;if(t&&F.isClass(t)&&F.ClassType.isSpecialBuiltIn(t,"Literal"))return!0}return!1}(e)){if(e.typeAnnotation)a=he(e.typeAnnotation,void 0,68|n);else if(!e.typeAnnotation&&1===e.strings.length){const t=function(e){const t=Rn(e),n=new y.Parser,i=e.strings[0].value,s=e.strings[0].start+e.strings[0].token.prefixLength+e.strings[0].token.quoteMarkLength,r=new y.ParseOptions;r.isStubFile=t.isStubFile,r.pythonVersion=t.executionEnvironment.pythonVersion;const a=n.parseTextExpression(t.fileContents,s,i.length,r);if(a.parseTree)return a.diagnostics.forEach((t=>{Re(t.message,e)})),a.parseTree.parent=e,a.parseTree;return}(e);t&&(a=he(t,void 0,68|n))}if(!a){Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.expectedTypeNotString(),e),a={node:e,type:F.UnknownType.create()}}p=!1}else{e.strings.forEach((e=>{27===e.nodeType&&e.expressions.forEach((e=>{he(e)}))}));const t=0!=(32&e.strings[0].token.flags);a=e.strings.some((e=>27===e.nodeType))?{node:e,type:En(e,t?"bytes":"str")}:{node:e,type:Et(e,t?"bytes":"str",e.strings.map((e=>e.value)).join(""))}}break;case 40:a=e.isImaginary?{node:e,type:En(e,"complex")}:e.isInteger?{node:e,type:Et(e,"int",e.value)}:{node:e,type:En(e,"float")};break;case 18:if(0!=(1&n))a={type:F.AnyType.create(!0),node:e};else if(0!=(256&n))a={type:F.UnknownType.create(),node:e};else{a={type:En(e,"ellipsis")||F.AnyType.create(),node:e}}break;case 55:a=function(e,t){let n=Be(he(e.expression).type);const i={0:"__pos__",33:"__neg__",5:"__invert__"};let s;38!==e.operator&&P.isOptionalType(n)&&(Ue(Rn(e).diagnosticRuleSet.reportOptionalOperand,c.DiagnosticRule.reportOptionalOperand,h.Localizer.Diagnostic.noneOperator().format({operator:v.printOperator(e.operator)}),e.expression),n=F.removeNoneFromUnion(n));if(38===e.operator)s=En(e,"bool"),s||(s=F.UnknownType.create());else{if(F.isAnyOrUnknown(n))s=n;else{s=Ct(n,[],i[e.operator],e,t)}if(!s){Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotSupportUnaryOperator().format({operator:v.printOperator(e.operator),type:yi(n)}),e),s=F.UnknownType.create()}}if((0===e.operator||33===e.operator)&&F.isObject(s)&&F.ClassType.isBuiltIn(s.classType,"int")&&F.isObject(n)&&F.ClassType.isBuiltIn(n.classType,"int")&&"number"==typeof n.classType.literalValue){const t=0===e.operator?n.classType.literalValue:-n.classType.literalValue;s=F.ObjectType.create(F.ClassType.cloneWithLiteral(s.classType,t))}return{type:s,node:e}}(e,r);break;case 7:a=_t(e,r,n);break;case 5:a=bt(e,r),$e(e.destExpression,a.type,!!a.isIncomplete,e.rightExpression);break;case 31:a=function(e,t){let n=t;if(t&&F.isUnion(t)){let i;P.doForEachSubtype(t,(t=>{if(!i){On(e,(()=>xt(e,t)))&&(i=t)}})),n=i}if(n){const t=xt(e,n);if(t)return t}return function(e,t){let n,i=!1;t&&(F.isAny(t)?n=t:F.isObject(t)&&F.ClassType.isBuiltIn(t.classType,"object")&&(n=F.AnyType.create()));let s=[];e.entries.forEach(((e,t)=>{let i;i=32===e.nodeType?Pt(e,n):he(e,n).type,t<R&&s.push(i)})),s=s.map((e=>P.stripLiteralValue(e)));let r=t?F.AnyType.create():F.UnknownType.create();s.length>0?r=Rn(e).diagnosticRuleSet.strictListInference||t?F.combineTypes(s,64):P.areTypesSame(s)?s[0]:r:i=!0;const a=An(e,"list");return{type:F.isClass(a)?F.ObjectType.create(F.ClassType.cloneForSpecialization(a,[r],!0,!1,void 0,i)):F.UnknownType.create(),node:e}}(e,t)}(e,r);break;case 46:a=function(e){e.startValue&&he(e.startValue);e.endValue&&he(e.endValue);e.stepValue&&he(e.stepValue);return{type:En(e,"slice"),node:e}}(e);break;case 6:a=he(e.expression,void 0,n),a={type:Ie(a.type,e.expression),node:e};break;case 51:a=function(e,t,n){he(e.testExpression);const i=he(e.ifExpression,n,t),s=he(e.elseExpression,n,t);return{type:F.combineTypes([i.type,s.type]),node:e}}(e,n,r);break;case 32:a=function(e){const t=Pt(e),n=e.comprehensions.some((e=>33===e.nodeType&&e.isAsync));let i=F.UnknownType.create();const s=Pe(e,n?"AsyncGenerator":"Generator");s&&F.isClass(s)&&(i=F.ObjectType.create(F.ClassType.cloneForSpecialization(s,n?[t,F.NoneType.createInstance()]:[t,F.NoneType.createInstance(),F.NoneType.createInstance()],!0)));return{type:i,node:e}}(e);break;case 15:a=function(e,t){if(t&&F.isUnion(t)){let n;P.doForEachSubtype(t,(t=>{if(!n){On(e,(()=>It(e,t,new l.DiagnosticAddendum)))&&(n=t)}})),t=n}let n;if(t){n=new l.DiagnosticAddendum;const i=It(e,t,n);if(i)return i}const i=function(e,t){let n=t?F.AnyType.create():F.UnknownType.create(),i=t?F.AnyType.create():F.UnknownType.create(),s=[],r=[],a=!1;Dt(e,s,r,!t,t?F.AnyType.create():void 0,t?F.AnyType.create():void 0),s=s.map((e=>P.stripLiteralValue(e))),r=r.map((e=>P.stripLiteralValue(e))),n=s.length>0?F.combineTypes(s):t?F.AnyType.create():F.UnknownType.create(),r.length>0?i=Rn(e).diagnosticRuleSet.strictDictionaryInference||t?F.combineTypes(r):P.areTypesSame(r)?r[0]:t?F.AnyType.create():F.UnknownType.create():(i=t?F.AnyType.create():F.UnknownType.create(),a=!0);const o=An(e,"dict");return{type:F.isClass(o)?F.ObjectType.create(F.ClassType.cloneForSpecialization(o,[n,i],!0,!1,void 0,a)):F.UnknownType.create(),node:e}}(e,t);return Object.assign(Object.assign({},i),{expectedTypeDiagAddendum:n})}(e,r);break;case 30:a=function(e,t){const n=F.FunctionType.createInstance("","","",0);let i;if(se(e,n,!1),t)if(F.isFunction(t))i=t;else if(F.isUnion(t))i=F.findSubtype(t,(e=>F.isFunction(e)));else if(F.isObject(t)){const e=P.lookUpObjectMember(t,"__call__");if(e){const n=Hn(e);if(n&&F.isFunction(n)){const e=di(t,n);e&&(i=e)}}}e.parameters.forEach(((e,t)=>{let s=F.UnknownType.create();i&&t<i.details.parameters.length&&(s=F.FunctionType.getEffectiveParameterType(i,t)),e.name&&se(e.name,s,!1),e.defaultValue&&he(e.defaultValue,void 0,1);const r={category:e.category,name:e.name?e.name.value:void 0,hasDefault:!!e.defaultValue,defaultValueExpression:e.defaultValue,hasDeclaredType:!0,type:s};F.FunctionType.addParameter(n,r)}));const s=i?$n(i):void 0;j.isSpeculative(e)?On(e.expression,(()=>{n.inferredReturnType=he(e.expression,s).type}),!1):n.inferredReturnType=he(e.expression,s).type;return{type:n,node:e}}(e,r);break;case 45:a=function(e,t){const n=[];if(e.entries.forEach(((e,i)=>{let s;s=32===e.nodeType?Pt(e,t):he(e).type,(i<R||void 0!==t)&&n.push(s)})),t&&n.length>0){const i=P.mapSubtypes(t,(e=>{if(F.isObject(e)&&F.ClassType.isBuiltIn(e.classType,"set")&&e.classType.typeArguments){const t=e.classType.typeArguments[0],i=new A.TypeVarMap(P.getTypeVarScopeId(e));for(const e of n)if(!ii(t,e,new l.DiagnosticAddendum,i))return;return P.applySolvedTypeVars(e,i)}}));if(!F.isNever(i))return{type:i,node:e}}let i=n.length>0?F.combineTypes(n.map((e=>P.stripLiteralValue(e)))):F.UnknownType.create();t||(i=P.stripLiteralValue(i));return{type:En(e,"set",[i]),node:e}}(e,r);break;case 3:a=he(e.rightExpression),$e(e.leftExpression,a.type,!1,e.rightExpression,!0);break;case 4:a=he(e.rightExpression),$e(e.name,a.type,!1,e.rightExpression,!0);break;case 60:a=function(e){let t;const n=v.getEnclosingFunction(e);if(n){const e=jt(n);e&&(t=P.getDeclaredGeneratorSendType(e.functionType))}e.expression&&he(e.expression).type;return{type:t||F.UnknownType.create(),node:e}}(e);break;case 61:a=function(e){const t=he(e.expression).type;let n,i=P.getGeneratorTypeArgs(t);if(i)n=i.length>=2?i[2]:F.UnknownType.create();else{const s=xe(t,!1,e)||F.UnknownType.create();i=P.getGeneratorTypeArgs(s),n=i&&i.length>=2?i[2]:F.UnknownType.create()}return{type:n||F.UnknownType.create(),node:e}}(e);break;case 56:{let t;if(r){const n=An(e,"Iterable");n&&F.isClass(n)&&(t=F.ObjectType.create(F.ClassType.cloneForSpecialization(n,[r],!0)))}const i=he(e.expression,t,n).type;if(0==(128&n)&&F.isVariadicTypeVar(i)&&!i.isVariadicUnpacked)a={type:F.TypeVarType.cloneForUnpacked(i),node:e};else{a={type:De(i,!1,e)||F.UnknownType.create(),unpackedType:i,node:e}}break}case 54:a=he(e.typeAnnotation,void 0,1256);break;case 0:Nn(e,(()=>{e.child&&he(e.child)})),a={type:F.UnknownType.create(),node:e}}if(a||o.fail(`Unhandled expression type '${v.printExpression(e)}'`),p&&!a.isIncomplete){const t=P.transformTypeObjectToClass(a.type);if(128&n&&F.isTypeVar(a.type)&&a.type.details.isVariadic&&(Re(h.Localizer.Diagnostic.typeVarTupleContext(),e),a.type=F.UnknownType.create()),!F.TypeBase.isInstantiable(t)){F.isObject(t)&&F.ClassType.isTupleClass(t.classType)&&0===(null===(i=t.classType.tupleTypeArguments)||void 0===i?void 0:i.length)||Ve(a.type,e)}}return P.isTypeAliasPlaceholder(a.type)||se(e,a.type,!!a.isIncomplete,t,!0),a}function ye(e){return void 0!==e.futureImports.get("annotations")||e.executionEnvironment.pythonVersion>=u.PythonVersion.V3_10||e.isStubFile}function ge(e,t=!1,n=!1,i=!1){var s,r,a;const l=Rn(e);if(l.isTypingStubFile||l.isTypingExtensionsStubFile){const t=function(e){if(!e.parent||54!==e.parent.nodeType)return;if(38!==e.parent.valueExpression.nodeType)return;const t=e.parent.valueExpression.value,n={Tuple:{alias:"tuple",module:"builtins"},Generic:{alias:"",module:"builtins"},Protocol:{alias:"",module:"builtins"},Callable:{alias:"",module:"builtins"},Type:{alias:"type",module:"builtins"},ClassVar:{alias:"",module:"builtins"},Final:{alias:"",module:"builtins"},Literal:{alias:"",module:"builtins"},TypedDict:{alias:"_TypedDict",module:"self"},Union:{alias:"",module:"builtins"},Optional:{alias:"",module:"builtins"},Annotated:{alias:"",module:"builtins"},TypeAlias:{alias:"",module:"builtins"},Concatenate:{alias:"",module:"builtins"},TypeGuard:{alias:"",module:"builtins"},Unpack:{alias:"",module:"builtins"},Required:{alias:"",module:"builtins"},NotRequired:{alias:"",module:"builtins"}}[t];if(n){const i=ie(e);if(i)return o.assert(F.isClass(i)),i;const s=Mt(e,t,n);return se(e,s,!1),s}return}(e);if(t)return t}let c=1129;i||(c|=128),ye(l)&&(c|=4),c|=n?8192:4096,3===(null===(s=null==e?void 0:e.parent)||void 0===s?void 0:s.nodeType)&&e.parent.typeAnnotationComment===e?c|=4:62===(null===(r=null==e?void 0:e.parent)||void 0===r?void 0:r.nodeType)?(e.parent.returnTypeAnnotation===e||e.parent.paramTypeAnnotations.some((t=>t===e)))&&(c|=4):41===(null===(a=null==e?void 0:e.parent)||void 0===a?void 0:a.nodeType)&&e.parent.typeAnnotationComment===e&&(c|=4),t||(c|=16);const p=he(e,void 0,c).type;return P.convertToInstance(p)}function fe(e,t){const n=he(e.expression);if(F.isClass(n.type)&&F.ClassType.isBuiltIn(n.type,"classmethod")&&P.isProperty(t))return t;const i=[{argumentCategory:0,type:t}],s=dt(e.expression,i,n.type,void 0,!0,void 0).returnType||F.UnknownType.create();return!F.isFunction(s)||s.details.declaredReturnType||s.details.parameters.some(((e,t)=>!(e.name&&!e.hasDeclaredType)||0===e.category&&(0!==t||!e.isTypeInferred)))?s:t}function Te(e,t,n,i={method:"get"},s=new l.DiagnosticAddendum,r=0,a){const o=Je(e,t.classType,n,i,s,8|r,a);if(o)return{node:e,type:o.type,isIncomplete:!!o.isTypeIncomplete}}function _e(e,t,n,i={method:"get"},s=new l.DiagnosticAddendum,r=0,a){let o;if(F.ClassType.isPartiallyConstructed(t))return Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.classDefinitionCycle().format({name:t.details.name}),e),{node:e,type:F.UnknownType.create()};if(0==(32&r)&&(o=Je(e,t,n,i,s,1|r,a)),!o){const s=t.details.effectiveMetaclass;s&&F.isClass(s)&&!F.ClassType.isSameGenericClass(s,t)&&(o=Je(e,s,n,i,new l.DiagnosticAddendum,r,t))}return o?{node:e,type:o.type,isIncomplete:!!o.isTypeIncomplete}:void 0}function ve(e,t,n=!1){const i=P.lookUpClassMember(e,t,12);if(i){const t=Hn(i);if(F.isFunction(t)||F.isOverloadedFunction(t)){const i=di(F.ObjectType.create(e),t,void 0,void 0,void 0,n);if(i)return i}}}function be(e,t){if(t>=e.parameters.length)return;const n=e.parameters[t];if(n.typeAnnotation)return n.typeAnnotation;if(n.typeAnnotationComment)return n.typeAnnotationComment;if(!e.functionAnnotationComment||e.functionAnnotationComment.isParamListEllipsis)return;let i=0;const s=e.functionAnnotationComment.paramTypeAnnotations;s.length<e.parameters.length&&(i=1);const r=t-i;return r<0||r>=s.length?void 0:s[r]}function Se(e){if(54===e.nodeType&&38===e.valueExpression.nodeType){const t=wn(e,e.valueExpression.value,!1);if(t){return void 0!==t.symbol.getDeclarations().find((e=>_.isExplicitTypeAliasDeclaration(e)))}}return!1}function Ce(e){let t,n,i;switch(e.nodeType){case 38:{const n=wn(e,e.value,!0);if(n&&(t=n.symbol,void 0===Wn(t)&&2===n.scope.type)){const n=v.getEnclosingClassOrFunction(e);if(n&&10===n.nodeType){const i=Vt(n);if(i){const n=P.lookUpClassMember(i.classType,e.value,24);n&&(t=n.symbol)}}}break}case 54:return Ce(e.valueExpression);case 35:{const s=Be(he(e.leftExpression).type);let r;F.isObject(s)?(r=P.lookUpObjectMember(s,e.memberName.value,16),n=s,i=null==r?void 0:r.classType):F.isClass(s)&&(r=P.lookUpClassMember(s,e.memberName.value,24),n=s,i=null==r?void 0:r.classType),r&&(t=r.symbol);break}case 24:{const t=Ce(e.baseExpression);if(t&&F.isObject(t)){const n=P.lookUpClassMember(t.classType,"__setitem__");if(n){const i=Hn(n);if(F.isFunction(i)){const s=di(t,i,F.isClass(n.classType)?n.classType:void 0,e,void 0,!1);if(s&&F.isFunction(s)&&2===s.details.parameters.length){const e=F.FunctionType.getEffectiveParameterType(s,1);if(!F.isAnyOrUnknown(e))return e}}}}break}}if(t){let s=Wn(t);if(s){if(P.isProperty(s)){const e=P.lookUpClassMember(s.classType,"fset"),t=e?Hn(e):void 0;if(!t||!F.isFunction(t)||t.details.parameters.length<2)return;s=t.details.parameters[1].type}return n&&(i&&F.isClass(i)&&(s=P.partiallySpecializeType(s,i)),(F.isFunction(s)||F.isOverloadedFunction(s))&&(s=di(n,s,void 0,e))),s}}}function Ie(e,t){return P.mapSubtypes(e,(e=>{if(F.isAnyOrUnknown(e))return e;const n=Ge(e);if(n)return n;if(F.isObject(e)){const n=Ke(e,"__await__",t);if(n){if(F.isAnyOrUnknown(n))return n;if(F.isObject(n)){if(Ke(n,"__iter__",t)){const e=Ge(n);if(e)return e}}}}if(t){Ue(Rn(t).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotAwaitable().format({type:yi(e)}),t)}return F.UnknownType.create()}))}function De(e,t,n){const i=t?"__aiter__":"__iter__",s=t?"__anext__":"__next__";let r=!0;e=Be(e),P.isOptionalType(e)&&(n&&Ue(Rn(n).diagnosticRuleSet.reportOptionalIterable,c.DiagnosticRule.reportOptionalIterable,h.Localizer.Diagnostic.noneNotIterable(),n),e=F.removeNoneFromUnion(e));const a=P.mapSubtypes(e,(e=>{if(e=P.transformTypeObjectToClass(e),F.isAnyOrUnknown(e))return e;const a=new l.DiagnosticAddendum;if(F.isObject(e)||F.isClass(e)){let r;if(F.isObject(e)?r=Ke(e,i,n):F.isClass(e)&&e.details.effectiveMetaclass&&F.isClass(e.details.effectiveMetaclass)&&(r=Ke(F.ObjectType.create(e.details.effectiveMetaclass),i,n,e)),r){const e=Be(r);if(F.isAnyOrUnknown(e))return e;if(F.isObject(e)){const i=Ke(e,s,n);if(i)return t?Ie(i,n):i;a.addMessage(h.Localizer.Diagnostic.methodNotDefinedOnType().format({name:s,type:yi(r)}))}else a.addMessage(h.Localizer.Diagnostic.methodReturnsNonObject().format({name:i}))}else{if(F.isObject(e)){const t=Ke(e,"__getitem__",n);if(t)return t}a.addMessage(h.Localizer.Diagnostic.methodNotDefined().format({name:i}))}}n&&Ue(Rn(n).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotIterable().format({type:yi(e)})+a.getString(),n),r=!1}));return r?a:void 0}function xe(e,t,n){const i=t?"__aiter__":"__iter__";let s=!0;e=Be(e),P.isOptionalType(e)&&(n&&Ue(Rn(n).diagnosticRuleSet.reportOptionalIterable,c.DiagnosticRule.reportOptionalIterable,h.Localizer.Diagnostic.noneNotIterable(),n),e=F.removeNoneFromUnion(e));const r=P.mapSubtypes(e,(e=>{if(e=P.transformTypeObjectToClass(e),F.isAnyOrUnknown(e))return e;if(F.isObject(e)||F.isClass(e)){let t;if(F.isObject(e)?t=Ke(e,i,n):F.isClass(e)&&e.details.effectiveMetaclass&&F.isClass(e.details.effectiveMetaclass)&&(t=Ke(F.ObjectType.create(e.details.effectiveMetaclass),i,n,e)),t)return Be(t)}n&&Ue(Rn(n).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotIterable().format({type:yi(e)}),n),s=!1}));return s?r:void 0}function ke(e,t,n){o.assert(F.ClassType.isDataClass(t));const i=F.FunctionType.createInstance("__new__","","",65),s=F.FunctionType.createInstance("__init__","","",64);F.FunctionType.addParameter(i,{category:0,name:"cls",type:t,hasDeclaredType:!0}),F.FunctionType.addDefaultParameters(i),i.details.declaredReturnType=F.ObjectType.create(t);const r={category:0,name:"self",type:F.ObjectType.create(t),hasDeclaredType:!0};F.FunctionType.addParameter(s,r),s.details.declaredReturnType=F.NoneType.createInstance();const a=[],l=[],c=function(e,t){let n=!0;for(let i=e.details.mro.length-1;i>=0;i--){const s=e.details.mro[i];if(F.isClass(s)){const e=P.buildTypeVarMapFromSpecializedClass(s,!1);F.ClassType.getDataClassEntries(s).forEach((n=>{const i=t.findIndex((e=>e.name===n.name)),s=Object.assign({},n);s.type=P.applySolvedTypeVars(s.type,e),i>=0?t[i]=s:t.push(s)}))}else n=!1}return n}(t,l);c||F.FunctionType.addDefaultParameters(s);const p=[];e.suite.statements.forEach((n=>{47===n.nodeType&&n.statements.forEach((n=>{let i,s,r,o=!1,c=!0;if(3===n.nodeType){if(54===n.leftExpression.nodeType&&38===n.leftExpression.valueExpression.nodeType&&(i=n.leftExpression.valueExpression,s=()=>ge(n.leftExpression.typeAnnotation,!0)),o=!0,r=n.rightExpression,9===n.rightExpression.nodeType){const t=he(n.rightExpression.leftExpression).type;if(F.isOverloadedFunction(t)&&"field"===t.overloads[0].details.builtInName){const t=n.rightExpression.arguments.find((e=>{var t;return"init"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(t&&t.valueExpression){!1===S.evaluateStaticBoolExpression(t.valueExpression,Rn(e).executionEnvironment)&&(c=!1)}o=n.rightExpression.arguments.some((e=>{var t,n;return"default"===(null===(t=e.name)||void 0===t?void 0:t.value)||"default_factory"===(null===(n=e.name)||void 0===n?void 0:n.value)}))}}}else 54===n.nodeType&&38===n.valueExpression.nodeType&&(i=n.valueExpression,s=()=>ge(n.typeAnnotation,!0));if(i&&s){const e=i.value,n=t.details.fields.get(e);if(!(null==n?void 0:n.isClassVar())){const t={name:e,hasDefault:o,defaultValueExpression:r,includeInInit:c,type:F.UnknownType.create()};p.push({entry:t,evaluator:s});let n=a.findIndex((t=>t.name===e));n>=0?a[n]=t:a.push(t),n=l.findIndex((t=>t.name===e)),n>=0?l[n]=t:(l.push(t),n=l.length-1);const u=l.findIndex((e=>e.hasDefault&&e.includeInInit));c&&!o&&u>=0&&u<n&&Re(h.Localizer.Diagnostic.dataClassFieldWithDefault(),i)}}}))})),t.details.dataClassEntries=a,p.forEach((e=>{e.entry.type=e.evaluator()}));const u=t.details.fields;!n&&c&&(l.forEach((e=>{if(e.includeInInit){const t={category:0,name:e.name,hasDefault:e.hasDefault,defaultValueExpression:e.defaultValueExpression,type:e.type,hasDeclaredType:!0};F.FunctionType.addParameter(s,t)}})),u.set("__init__",C.Symbol.createWithType(4,s)),u.set("__new__",C.Symbol.createWithType(4,i)));const d=(t,n)=>{const i=F.FunctionType.createInstance(t,"","",64);F.FunctionType.addParameter(i,r),F.FunctionType.addParameter(i,{category:0,name:"x",type:n,hasDeclaredType:!0}),i.details.declaredReturnType=En(e,"bool"),u.set(t,C.Symbol.createWithType(4,i))};if(F.ClassType.isSkipSynthesizedDataClassEq(t)||d("__eq__",En(e,"object")),F.ClassType.isSynthesizedDataclassOrder(t)){const e=F.ObjectType.create(t);["__lt__","__le__","__gt__","__ge__"].forEach((t=>{d(t,e)}))}let m=An(e,"dict");F.isClass(m)&&(m=F.ObjectType.create(F.ClassType.cloneForSpecialization(m,[En(e,"str"),F.AnyType.create()],!0))),u.set("__dataclass_fields__",C.Symbol.createWithType(4,m)),at(t,l.map((e=>e.type)),!0)}function Fe(e,t){o.assert(F.ClassType.isTypedDictClass(t));const n=F.FunctionType.createInstance("__new__","","",65);F.FunctionType.addParameter(n,{category:0,name:"cls",type:t,hasDeclaredType:!0}),F.FunctionType.addDefaultParameters(n),n.details.declaredReturnType=F.ObjectType.create(t);const i=F.FunctionType.createInstance("__init__","","",64);F.FunctionType.addParameter(i,{category:0,name:"self",type:F.ObjectType.create(t),hasDeclaredType:!0}),i.details.declaredReturnType=F.NoneType.createInstance(),F.FunctionType.addParameter(i,{category:1,type:F.AnyType.create(),hasDeclaredType:!0});const s=pi(t);s.forEach(((e,t)=>{F.FunctionType.addParameter(i,{category:0,name:t,hasDefault:!e.isRequired,type:e.valueType,hasDeclaredType:!0})}));const r=t.details.fields;r.set("__init__",C.Symbol.createWithType(4,i)),r.set("__new__",C.Symbol.createWithType(4,n));const a=An(e,"str");if(F.isClass(a)){const n={category:0,name:"self",type:F.ObjectType.create(t),hasDeclaredType:!0},i=He(e);let o=F.TypeVarType.createInstance(`__${t.details.name}_default`);o.details.isSynthesized=!0,o=F.TypeVarType.cloneForScopeId(o,i,t.details.name);const l=(e,t,i)=>{const s=F.FunctionType.createInstance("get","","",320);return F.FunctionType.addParameter(s,n),F.FunctionType.addParameter(s,{category:0,name:"k",type:e,hasDeclaredType:!0}),i?(F.FunctionType.addParameter(s,{category:0,name:"default",type:t,hasDeclaredType:!0,hasDefault:!0}),s.details.declaredReturnType=t):s.details.declaredReturnType=F.combineTypes([t,F.NoneType.createInstance()]),s},c=(e,t)=>{const s={category:0,name:"k",type:e,hasDeclaredType:!0},r=F.FunctionType.createInstance("pop","","",320);F.FunctionType.addParameter(r,n),F.FunctionType.addParameter(r,s),r.details.declaredReturnType=t;const a=F.FunctionType.createInstance("pop","","",320);return F.FunctionType.addParameter(a,n),F.FunctionType.addParameter(a,s),F.FunctionType.addParameter(a,{category:0,name:"default",hasDeclaredType:!0,type:o,hasDefault:!0}),a.details.declaredReturnType=F.combineTypes([t,o]),a.details.typeVarScopeId=i,[r,a]},p=(e,t,s=!1)=>{const r=F.FunctionType.createInstance("setdefault","","",320);return F.FunctionType.addParameter(r,n),F.FunctionType.addParameter(r,{category:0,name:"k",hasDeclaredType:!0,type:e}),F.FunctionType.addParameter(r,{category:0,name:"default",hasDeclaredType:!0,type:s?F.AnyType.create():o,hasDefault:!0}),r.details.declaredReturnType=s?t:F.combineTypes([t,o]),r.details.typeVarScopeId=i,r},u=e=>{const t=F.FunctionType.createInstance("delitem","","",320);return F.FunctionType.addParameter(t,n),F.FunctionType.addParameter(t,{category:0,name:"k",hasDeclaredType:!0,type:e}),t.details.declaredReturnType=F.NoneType.createInstance(),t},d=[],h=[],m=[];s.forEach(((e,t)=>{const n=F.ObjectType.create(F.ClassType.cloneWithLiteral(a,t));e.isRequired||d.push(l(n,e.valueType,!1)),d.push(l(n,e.valueType,!0)),h.push(...c(n,e.valueType)),m.push(p(n,e.valueType,e.isRequired))}));const y=F.ObjectType.create(a);d.push(l(y,F.AnyType.create(),!1)),d.push(l(y,F.AnyType.create(),!0)),h.push(...c(y,F.AnyType.create())),m.push(p(y,F.AnyType.create())),r.set("get",C.Symbol.createWithType(4,F.OverloadedFunctionType.create(d))),r.set("pop",C.Symbol.createWithType(4,F.OverloadedFunctionType.create(h))),r.set("setdefault",C.Symbol.createWithType(4,F.OverloadedFunctionType.create(m))),r.set("__delitem__",C.Symbol.createWithType(4,u(y)))}}function Pe(e,t){return Ae(t,Rn(e).typingModulePath)}function Ae(t,n){if(!n)return;const i=e(n);if(!i)return;const s=i.symbolTable.get(t);return s?zn(s):void 0}function Ee(e){const t=f.getFlowNode(e);return!!t&&!!Cn(t)}function we(e){const t=f.getAfterFlowNode(e);return!!t&&(!!Cn(t)&&!!function(e,t){const n=_n(e.id);return void 0!==bn(n,t,void 0,void 0,F.UnboundType.create()).type}(e,t))}function Ne(e,t){const n=f.getFlowNode(e),i=f.getFlowNode(t);return!(!n||!i)&&(n===i||Cn(i,n))}function Oe(e,t,n){return Me("information",e,t,n)}function Re(e,t,n){return Me("error",e,t,n)}function Me(e,t,n,i){if(!Le(n)){return Rn(n).diagnosticSink.addDiagnosticWithTextRange(e,t,i||n)}}function Le(e){return W.some((t=>v.isNodeContainedWithin(e,t)))||j.isSpeculative(e)||$.isUndoTrackingEnabled()}function Ue(e,t,n,i){if("none"===e)return;const s=Me(e,n,i);return s&&s.setRule(t),s}function Ve(e,t){const n=Rn(t),i=new l.DiagnosticAddendum;F.isUnion(e)&&P.doForEachSubtype(e,(e=>{F.TypeBase.isInstantiable(e)||i.addMessage(h.Localizer.DiagnosticAddendum.typeNotClass().format({type:yi(e)}))})),Ue(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeExpectedClass().format({type:yi(e)})+i.getString(),t)}function ze(e,t,n,i,s){const r=e.value,a=wn(e,r,!1);if(!a)return;const o=a.symbol.getDeclarations(),p=Wn(a.symbol),u=Rn(e);let d=t;if(p&&i){let n=new l.DiagnosticAddendum;ii(p,t,n)?d=li(p,t):(s&&(n=s),Ue(u.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeAssignmentMismatch().format({sourceType:yi(t),destType:yi(p)})+n.getString(),i||e),d=p)}else{const t=b.getScopeForNode(e);if(2===(null==t?void 0:t.type)){const t=I.isConstantName(r),n=I.isPrivateOrProtectedName(r);!F.TypeBase.isInstance(d)||t||n&&"none"!==Rn(e).diagnosticRuleSet.reportPrivateUsage||(d=P.stripLiteralValue(d))}}const m=o.find((e=>1===e.type));m&&1===m.type&&i&&m.isConstant&&e!==o[0].node&&Ue(u.diagnosticRuleSet.reportConstantRedefinition,c.DiagnosticRule.reportConstantRedefinition,h.Localizer.Diagnostic.constantRedefinition().format({name:r}),e),se(e,d,n,void 0,!1)}function je(e,t,n,i,s){const r=e.memberName.value,a=Rn(e),l=v.getEnclosingClass(e);if(!l)return;const p=Vt(l);if(p&&F.isClass(p.classType)){let l=P.lookUpClassMember(p.classType,r,i?0:8);const u=p.classType.details.fields;if(l){if(F.isClass(l.classType)&&F.ClassType.isSameGenericClass(p.classType,l.classType)&&l.isInstanceMember===i){const t=u.get(r);o.assert(void 0!==t);const n=t.getDeclarations();let i=D.isFinalVariable(t);if(n.length>0&&1===n[0].type&&s&&e.memberName!==n[0].node){n[0].isConstant&&Ue(a.diagnosticRuleSet.reportConstantRedefinition,c.DiagnosticRule.reportConstantRedefinition,h.Localizer.Diagnostic.constantRedefinition().format({name:e.memberName.value}),e.memberName);const t=v.getEnclosingFunction(e);t&&"__init__"===t.name.value&&(i=!1),i&&Re(h.Localizer.Diagnostic.finalReassigned().format({name:e.memberName.value}),e.memberName)}}else{const n=Wn(l.symbol);if(n&&!P.isProperty(n)&&!l.isInstanceMember&&i){qe(a,l.symbol,e.memberName);const n=Hn(l);t=F.combineTypes([t,n])}}}l=P.lookUpClassMember(p.classType,r,16),l||!s||n||Ft(a.diagnosticRuleSet.reportUnknownMemberType,c.DiagnosticRule.reportUnknownMemberType,e.memberName,t,e,!0)}}function Be(e){return P.mapSubtypes(e,(e=>{if(F.isTypeVar(e)&&!e.details.recursiveTypeAliasName){if(e.details.boundType)return F.TypeBase.isInstantiable(e)?P.convertToInstantiable(e.details.boundType):P.convertToInstance(e.details.boundType);if(e.details.recursiveTypeAliasName)return e;if(e.details.constraints.length>0){const t=e.details.constraints.map(((t,n)=>({type:t,constraints:[{typeVarName:F.TypeVarType.getNameWithScope(e),constraintIndex:n}]})));return F.combineConstrainedTypes(t)}return F.TypeBase.isInstantiable(e)?H&&F.isClass(H)?F.ObjectType.create(H):F.AnyType.create():K||F.AnyType.create()}return e}))}function We(e,t,n){const i=[];let s=!1;const r=e=>{const r=Be(e);if(F.isUnion(r))r.subtypes.forEach(((a,o)=>{const l=r.constraints?r.constraints[o]:void 0;if(t&&!F.SubtypeConstraint.isCompatible(l,t))return;const c=n(a,e,l);c!==e&&(s=!0),c&&i.push({type:c,constraints:l})}));else{const t=n(r,e,void 0);t!==e&&(s=!0),t&&i.push({type:t,constraints:void 0})}};return F.isUnion(e)?e.subtypes.forEach((e=>{r(e)})):r(e),s?F.combineConstrainedTypes(i):e}function $e(e,t,n,i,s=!1,r){if(F.isTypeVar(t)&&i&&9===i.nodeType){const n=he(i.leftExpression).type;F.isClass(n)&&(F.ClassType.isBuiltIn(n,"TypeVar")||F.ClassType.isBuiltIn(n,"TypeVarTuple")||F.ClassType.isBuiltIn(n,"ParamSpec"))&&(38===e.nodeType&&e.value===t.details.name||Re(t.details.isParamSpec?h.Localizer.Diagnostic.paramSpecAssignedName().format({name:F.TypeVarType.getReadableName(t)}):h.Localizer.Diagnostic.typeVarAssignedName().format({name:F.TypeVarType.getReadableName(t)}),e))}switch(t=F.removeUnbound(t),e.nodeType){case 38:n||Ft(Rn(e).diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,e,t,e,s),ze(e,t,n,i,r);break;case 35:!function(e,t,n,i,s){const r=he(e.leftExpression),a=Be(r.type);if(38===e.leftExpression.nodeType){const s=v.getEnclosingClass(e);if(s){const r=Vt(s);if(r&&F.isClass(r.classType)&&(F.isObject(a)?F.ClassType.isSameGenericClass(a.classType,r.classType)&&je(e,t,n,!0,i):F.isClass(a)&&F.ClassType.isSameGenericClass(a,r.classType)&&je(e,t,n,!1,i),F.ClassType.isProtocolClass(r.classType))){const t=r.classType.details.fields.get(e.memberName.value);t&&0===t.getDeclarations().filter((e=>!v.getEnclosingFunction(e.node))).length&&Re(h.Localizer.Diagnostic.assignmentInProtocol(),e.memberName)}}}Qe(e,r,{method:"set",setType:t,setErrorNode:i,setExpectedTypeDiag:s},0),se(e.memberName,t,n,void 0,!1),se(e,t,n,void 0,!1)}(e,t,n,i,r);break;case 24:{const s=he(e.baseExpression,void 0,2);tt(e,s.type,{method:"set",setType:t,setErrorNode:i,setExpectedTypeDiag:r},0),se(e,t,n);break}case 52:!function(e,t,n,i){const s=new Array(e.expressions.length);for(let t=0;t<e.expressions.length;t++)s[t]=[];const r=e.expressions.findIndex((e=>56===e.nodeType));P.doForEachSubtype(t,((t,n,a)=>{const o=P.getSpecializedTupleType(t);if(o&&o.tupleTypeArguments){const t=o.tupleTypeArguments,n=t.length;if(P.isOpenEndedTupleClass(o))for(let n=0;n<e.expressions.length;n++)s[n].push({type:t[0],constraints:a});else{let i=0,o=0;for(o=0;o<e.expressions.length;o++)if(o===r){const r=e.expressions.length-o-1,l=n-i;let c=Math.max(l-r,0);for(;c>0;)s[o].push({type:t[i],constraints:a}),i++,c--}else{if(i>=n)break;s[o].push({type:t[i],constraints:a}),i++}if(o<e.expressions.length||i<n){const t=Rn(e),i=r>=0?e.expressions.length-1:e.expressions.length;Ue(t.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.tupleSizeMismatch().format({expected:i,received:n}),e)}}}else{const n=De(t,!1,i)||F.UnknownType.create();for(let t=0;t<e.expressions.length;t++)s[t].push({type:n,constraints:a})}})),e.expressions.forEach(((e,t)=>{const a=s[t];let o=0===a.length?F.UnknownType.create():F.combineConstrainedTypes(a);if(o=P.removeNoReturnFromUnion(o),t===r){const t=An(e,"list");F.isClass(t)&&(o=F.ObjectType.create(F.ClassType.cloneForSpecialization(t,[o],!0)))}$e(e,o,n,i,!0)})),se(e,t,n)}(e,t,n,i);break;case 54:{const n=ge(e.typeAnnotation,v.isFinalAllowedForAssignmentTarget(e.valueExpression));if(!F.isObject(n)||!F.ClassType.isBuiltIn(n.classType,"Final")){F.isObject(n)&&F.ClassType.isBuiltIn(n.classType,"TypeAlias")||ii(n,t,new l.DiagnosticAddendum)&&(F.isObject(t)&&F.ClassType.isEnumClass(t.classType)||(t=li(n,t)))}$e(e.valueExpression,t,!1,i,s,r);break}case 56:38===e.expression.nodeType&&ze(e.expression,t,!1,i);break;case 31:{const n=De(t,!1,i)||F.UnknownType.create();e.entries.forEach((e=>{$e(e,n,!1,i,s)}));break}case 0:e.child&&Nn(e.child,(()=>{he(e.child)}));break;default:Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.assignmentTargetExpr(),e);break}}function qe(e,t,n){j.isSpeculative(n)||$.isUndoTrackingEnabled()||e.accessedSymbolMap.set(t.id,!0)}function Ge(e){if(F.isAnyOrUnknown(e))return e;if(F.isObject(e)){const t=e.classType;if(F.ClassType.isBuiltIn(t,"Generator")){const e=t.typeArguments;if(e&&e.length>=3)return e[2]}}}function Ke(e,t,n,i){const s=P.lookUpObjectMember(e,t,8);if(!s)return;const r=Hn(s);if(F.isAnyOrUnknown(r))return r;if(F.isFunction(r)){const t=di(i||e,r,s&&F.isClass(s.classType)?s.classType:void 0,n,void 0,!1,i);if(t)return $n(t)}}function He(e){return`${Rn(e).filePath}.${e.start.toString()}`}function Ye(e){const t=[];let n=e;for(;n&&(n=v.getTypeVarScopeNode(n),n);)t.push(He(n)),n=n.parent;return t}function Qe(e,t,n,i){var s,r,a;const o=t.type,p=e.memberName.value;let d=new l.DiagnosticAddendum;const m=Rn(e);let y,g=!1;switch(o.category){case 2:case 1:y=o;break;case 4:y=F.UnknownType.create();break;case 7:{const i=_e(e.memberName,o,p,n,d,0,t.bindToType);y=null==i?void 0:i.type,(null==i?void 0:i.isIncomplete)&&(g=!0);break}case 11:return o.details.isParamSpec?"args"===p?41!==(null===(s=e.parent)||void 0===s?void 0:s.nodeType)||1!==e.parent.category?(Re(h.Localizer.Diagnostic.paramSpecArgsUsage(),e),{type:F.UnknownType.create(),node:e}):{type:o,node:e}:"kwargs"===p?41!==(null===(r=e.parent)||void 0===r?void 0:r.nodeType)||2!==e.parent.category?(Re(h.Localizer.Diagnostic.paramSpecKwargsUsage(),e),{type:F.UnknownType.create(),node:e}):{type:o,node:e}:(Ue(m.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramSpecUnknownMember().format({name:p}),e),{type:F.UnknownType.create(),node:e}):64&i?(Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarNoMember().format({type:yi(o),name:p}),e.leftExpression),{type:F.UnknownType.create(),node:e}):o.details.recursiveTypeAliasName?{type:F.UnknownType.create(),node:e,isIncomplete:!0}:Qe(e,{type:Be(o),node:e,bindToType:o},n,0);case 8:{const s=P.transformTypeObjectToClass(o);if(F.TypeBase.isInstantiable(s))return Qe(e,{type:s,node:t.node,bindToType:t.bindToType},n,i);if(F.ClassType.isEnumClass(o.classType)&&o.classType.literalValue instanceof F.EnumLiteral)if("name"===p||"_name_"===p){const t=An(e,"str");if(F.isClass(t))return{node:e,type:F.ObjectType.create(F.ClassType.cloneWithLiteral(t,o.classType.literalValue.itemName))}}else if("value"===p||"_value_"===p)return{node:e,type:o.classType.literalValue.itemType};const r=Te(e.memberName,o,p,n,d,void 0,t.bindToType);y=null==r?void 0:r.type,(null==r?void 0:r.isIncomplete)&&(g=!0);break}case 9:{const t=F.ModuleType.getField(o,p);if(t)"get"===n.method&&qe(Rn(e),t,e.memberName),y=jn(t,void 0,!0).type,F.isUnbound(y)&&(y=F.UnknownType.create());else{if("get"===n.method){const e=F.ModuleType.getField(o,"__getattr__");if(e){if(m.executionEnvironment.pythonVersion>=u.PythonVersion.V3_7||e.getDeclarations().some((e=>e.path.toLowerCase().endsWith(".pyi")))){const t=jn(e);F.isFunction(t.type)&&(y=$n(t.type),t.isIncomplete&&(g=!0))}}}y||(Ue(m.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.moduleUnknownMember().format({name:p}),e.memberName),y=F.UnknownType.create())}break}case 10:y=P.mapSubtypes(o,(t=>{if(F.isNone(t))Ue(Rn(e).diagnosticRuleSet.reportOptionalMemberAccess,c.DiagnosticRule.reportOptionalMemberAccess,h.Localizer.Diagnostic.noneUnknownMember().format({name:p}),e.memberName);else if(!F.isUnbound(t)){return Qe(e,{type:t,node:e},n,0).type}}));break;case 5:case 6:{const t=En(e,"function");y=t&&"__defaults__"!==p?Qe(e,{type:t,node:e},n,i).type:F.AnyType.create();break}default:d.addMessage(h.Localizer.DiagnosticAddendum.typeUnsupported().format({type:yi(o)}))}if(!y){let t=h.Localizer.Diagnostic.memberAccess();"set"===n.method?t=h.Localizer.Diagnostic.memberSet():"del"===n.method&&(t=h.Localizer.Diagnostic.memberDelete()),n.setExpectedTypeDiag&&(d=n.setExpectedTypeDiag);const i=F.isFunction(o)||F.isOverloadedFunction(o)||F.isObject(o)&&F.ClassType.isBuiltIn(o.classType,"function"),[s,r]=i?[m.diagnosticRuleSet.reportFunctionMemberAccess,c.DiagnosticRule.reportFunctionMemberAccess]:[m.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues];Ue(s,r,t.format({name:p,type:yi(o)})+d.getString(),e.memberName),y=i?F.AnyType.create():F.UnknownType.create()}return 0==(2&i)&&F.isClass(y)&&!y.typeArguments&&(y=xn(y,void 0,i,e)),"get"===n.method&&(1===(null===(a=e.parent)||void 0===a?void 0:a.nodeType)&&F.isClass(y)||g||Ft(m.diagnosticRuleSet.reportUnknownMemberType,c.DiagnosticRule.reportUnknownMemberType,e.memberName,y,e,!1)),{type:y,node:e,isIncomplete:g}}function Je(e,t,n,i,s,r,a){var c;let p=0;1&r&&(p|=8),2&r&&(p|=2),4&r&&(p|=4),128&r&&(p|=1);let u=P.lookUpClassMember(t,n,16|p);if(u||(u=P.lookUpClassMember(t,n,p)),u){let o,l=!1;if("get"===i.method){const t=Yn(e,u);t?(o=t.type,t.isIncomplete&&(l=!0)):o=F.UnknownType.create()}else{const n=v.getEnclosingClass(e);if(n){const e=null===(c=Vt(n))||void 0===c?void 0:c.classType;e&&F.isClass(e)&&F.ClassType.isSameGenericClass(e,t)&&(o=Wn(u.symbol)||F.UnknownType.create(),o&&F.isClass(u.classType)&&(o=P.partiallySpecializeType(o,u.classType)))}if(!o){const t=Yn(e,u);t?(o=t.type,t.isIncomplete&&(l=!0)):o=F.UnknownType.create()}}if(F.ClassType.isTypedDictClass(t)){const e=u.symbol.getTypedDeclarations();if(e.length>0&&1===e[0].type)return void s.addMessage(h.Localizer.DiagnosticAddendum.memberUnknown().format({name:n}))}"get"===i.method&&F.isClass(u.classType)&&F.ClassType.isSameGenericClass(u.classType,t)&&qe(Rn(e),u.symbol,e);const p=Ze(o,u,t,a,0==(1&r),r,e,n,i,s);if(!p)return;if(o=p,"set"===i.method){if(!ii(o,i.setType,s.createAddendum()))return void s.addMessage(h.Localizer.DiagnosticAddendum.memberAssignment().format({type:yi(i.setType),name:n,classType:mi(t)}));if(F.isClass(u.classType)&&F.ClassType.isFrozenDataClass(u.classType)&&0==(1&r))return void s.addMessage(h.Localizer.DiagnosticAddendum.dataclassFrozen().format({name:yi(F.ObjectType.create(u.classType))}))}return{type:o,isTypeIncomplete:l,isClassMember:!u.isInstanceMember}}if(0==(65&r)){const c=function(e,t,n){var i,s,r,a;if("get"===n.method){const n=null===(i=_e(t,e,"__getattribute__",{method:"get"},new l.DiagnosticAddendum,4))||void 0===i?void 0:i.type;if(n&&F.isFunction(n))return $n(n);const r=null===(s=_e(t,e,"__getattr__",{method:"get"},new l.DiagnosticAddendum,4))||void 0===s?void 0:s.type;if(r&&F.isFunction(r))return $n(r)}else if("set"===n.method){if(null===(r=_e(t,e,"__setattr__",{method:"get"},new l.DiagnosticAddendum,4))||void 0===r?void 0:r.type)return F.AnyType.create()}else{o.assert("del"===n.method);if(null===(a=_e(t,e,"__detattr__",{method:"get"},new l.DiagnosticAddendum,4))||void 0===a?void 0:a.type)return F.AnyType.create()}return}(t,e,i);if(c){const o=Ze(c,u,t,a,!1,r,e,n,i,s);if(!o)return;return{type:o,isTypeIncomplete:!1,isClassMember:!1}}}s.addMessage(h.Localizer.DiagnosticAddendum.memberUnknown().format({name:n}))}function Ze(e,t,n,i,s,r,a,o,l,c){const p=0!=(16&r);let u=!0;return e=P.mapSubtypes(e,(e=>{if(F.isObject(e)){let r;r="get"===l.method?"__get__":"set"===l.method?"__set__":"__delete__";const p=e.classType,d=P.lookUpClassMember(p,r,8);if(F.ClassType.isPropertyClass(e.classType))if("set"===l.method){if(!d)return c.addMessage(h.Localizer.DiagnosticAddendum.propertyMissingSetter().format({name:o})),void(u=!1)}else if("del"===l.method&&!d)return c.addMessage(h.Localizer.DiagnosticAddendum.propertyMissingDeleter().format({name:o})),void(u=!1);if(d){let r=Hn(d);const o=[{argumentCategory:0,type:e},{argumentCategory:0,type:s?i||F.ObjectType.create(n):F.NoneType.createInstance()}];if("get"===l.method?o.push({argumentCategory:0,type:n}):"set"===l.method&&o.push({argumentCategory:0,type:l.setType}),F.ClassType.isPropertyClass(e.classType)&&t&&F.isClass(t.classType)&&(F.isFunction(r)?$n(r):F.isOverloadedFunction(r)&&r.overloads.forEach((e=>{$n(e)})),r=P.partiallySpecializeType(r,t.classType)),F.isOverloadedFunction(r)){const e=ot(a,o,r,void 0,new A.TypeVarMap(P.getTypeVarScopeId(d.classType)));e&&(r=e)}if(r&&F.isFunction(r)){const n=Nn(a,(()=>{const n=di(e,r,t&&F.isClass(t.classType)?t.classType:void 0,a);if(n&&F.isFunction(n)){const e=ht(a,o.slice(1),n,new A.TypeVarMap(P.getTypeVarScopeId(n)),!0);return e.argumentErrors?(u=!1,F.AnyType.create()):"get"===l.method?e.returnType||F.UnknownType.create():F.AnyType.create()}}));if(n)return n}}}else if((F.isFunction(e)||F.isOverloadedFunction(e))&&(!s||!(null==t?void 0:t.isInstanceMember)))return di(s?F.ObjectType.create(n):n,e,t&&F.isClass(t.classType)?t.classType:void 0,a,void 0,p,i);if("set"===l.method){if((null==t?void 0:t.symbol.isClassVar())&&8&r)return void c.addMessage(h.Localizer.DiagnosticAddendum.memberSetClassVar().format({name:o}));let n=!1;if((t&&t.symbol.hasTypedDeclarations()||t&&!t.symbol.getDeclarations().some((e=>e.node===a)))&&(n=!0),n){let n=e;return s&&!t.isInstanceMember&&F.isFunction(e)&&(F.FunctionType.isClassMethod(e)||F.FunctionType.isInstanceMethod(e))&&(n=F.FunctionType.clone(e,!0)),n}}return e})),u?e:void 0}function Xe(e,t){const n=t.findIndex((e=>F.isVariadicTypeVar(e)));if(n>=0&&Y&&F.isClass(Y)){const i=e.slice(n,n+1+e.length-t.length);if(1===i.length&&F.isVariadicTypeVar(i[0].type))et(i[0].type,i[0].node);else{i.forEach(((e,t)=>{At(e,0===t)}));const s=1===i.length&&i[0].isEmptyTupleShorthand?[]:i.map((e=>P.convertToInstance(e.type))),r=P.convertToInstance(P.specializeTupleClass(Y,s,!0,!0,!0));e=[...e.slice(0,n),{node:e[n].node,type:r},...e.slice(n+1+e.length-t.length,e.length)]}}return e}function et(e,t){return!!e.isVariadicUnpacked||(Re(h.Localizer.Diagnostic.unpackedTypeVarTupleExpected().format({name1:e.details.name,name2:e.details.name}),t),!1)}function tt(e,t,n,i){var s,r;if((null===(s=t.typeAliasInfo)||void 0===s?void 0:s.typeParameters)&&t.typeAliasInfo.typeParameters.length>0&&!t.typeAliasInfo.typeArguments){const n=t.typeAliasInfo.typeParameters,s=Xe(it(e,i),n);s.length>n.length&&!n.some((e=>e.details.isVariadic))&&Re(h.Localizer.Diagnostic.typeArgsTooMany().format({name:yi(t),expected:n.length,received:s.length}),s[n.length].node);const a=new A.TypeVarMap(t.typeAliasInfo.typeVarScopeId),o=new l.DiagnosticAddendum;n.forEach(((e,t)=>{ni(e,t<s.length?P.convertToInstance(s[t].type):F.UnknownType.create(),o,a)})),o.isEmpty()||Re(h.Localizer.Diagnostic.typeNotSpecializable().format({type:yi(t)})+o.getString(),e);let c=P.applySolvedTypeVars(t,a);if(t.typeAliasInfo&&c!==t){const e=[];null===(r=t.typeAliasInfo.typeParameters)||void 0===r||r.forEach((t=>{e.push(a.getTypeVarType(t)||F.UnknownType.create())})),c=F.TypeBase.cloneForTypeAlias(c,t.typeAliasInfo.name,t.typeAliasInfo.fullName,t.typeAliasInfo.typeVarScopeId,t.typeAliasInfo.typeParameters,e)}return{type:c,node:e}}if(P.isTypeAliasPlaceholder(t)){const n=it(e,i).map((e=>P.convertToInstance(e.type)));return{type:F.TypeBase.cloneForTypeAlias(t,t.details.recursiveTypeAliasName,"",t.details.recursiveTypeAliasScopeId,void 0,n),node:e}}let a=!1;const p=P.mapSubtypes(t,(t=>{const s=Be(t=P.transformTypeObjectToClass(t));if(F.isAnyOrUnknown(s))return s;if(64&i&&F.isTypeVar(t))return Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarNotSubscriptable().format({type:yi(t)}),e.baseExpression),it(e,i,!1,!1),F.UnknownType.create();if(F.isClass(s)){if("set"===n.method?Re(h.Localizer.Diagnostic.genericClassAssigned(),e.baseExpression):"del"===n.method&&Re(h.Localizer.Diagnostic.genericClassDeleted(),e.baseExpression),F.ClassType.isSpecialBuiltIn(s,"Literal"))return function(e,t){if(0===e.items.length)return Re(h.Localizer.Diagnostic.literalEmptyArgs(),e.baseExpression),F.UnknownType.create();const n=[];for(const i of e.items){let s;const r=i.valueExpression;if(0!==i.argumentCategory)Re(h.Localizer.Diagnostic.unpackedArgInTypeArgument(),r),s=F.UnknownType.create();else if(i.name)Re(h.Localizer.Diagnostic.keywordArgInTypeArgument(),r),s=F.UnknownType.create();else if(48===r.nodeType){const t=0!=(32&r.strings[0].token.flags),n=r.strings.map((e=>e.value)).join("");s=wt(e,t?"bytes":"str",n)}else 40===r.nodeType?!r.isImaginary&&r.isInteger&&(s=wt(e,"int",r.value)):11===r.nodeType?33===r.constType?s=wt(e,"bool",!0):15===r.constType?s=wt(e,"bool",!1):26===r.constType&&(s=F.NoneType.createType()):55===r.nodeType&&33===r.operator&&40===r.expression.nodeType&&!r.expression.isImaginary&&r.expression.isInteger&&(s=wt(e,"int",-r.expression.value));if(!s){const e=he(r);if(F.isObject(e.type)&&F.ClassType.isEnumClass(e.type.classType)&&void 0!==e.type.classType.literalValue)s=e.type.classType;else{let t=!0;P.doForEachSubtype(e.type,(e=>{F.isClass(e)&&void 0!==e.literalValue||(t=!1)})),t&&(s=e.type)}}s||(0!=(64&t)?(Re(h.Localizer.Diagnostic.literalUnsupportedType(),i),s=F.UnknownType.create()):s=F.AnyType.create()),n.push(s)}return F.combineTypes(n)}(e,i);if(F.ClassType.isBuiltIn(s,"InitVar")){const t=it(e,i);return 1===t.length?t[0].type:(Re(h.Localizer.Diagnostic.typeArgsMismatchOne().format({received:t.length}),e.baseExpression),F.UnknownType.create())}if(F.ClassType.isEnumClass(s))return F.ObjectType.create(s);const t=F.isClass(s)&&F.ClassType.isBuiltIn(s,"Annotated"),r=F.isClass(s)&&F.ClassType.hasCustomClassGetItem(s);let a=it(e,i,t,r);return t||(a=Xe(a,s.details.typeParameters)),r?s:xn(s,a,i,e)}if(F.isObject(s)){const t=function(e,t,n){var i;if(F.ClassType.isTypedDictClass(t.classType)){const i=function(e,t,n){if(1!==e.items.length)return Re(h.Localizer.Diagnostic.typeArgsMismatchOne().format({received:e.items.length}),e),{node:e,type:F.UnknownType.create()};if(e.trailingComma||e.items[0].name||0!==e.items[0].argumentCategory)return;const i=pi(t.classType,!0),s=he(e.items[0].valueExpression),r=s.type;let a=new l.DiagnosticAddendum,o=!0;const p=P.mapSubtypes(r,(e=>{if(F.isAnyOrUnknown(e))return e;if(F.isObject(e)&&F.ClassType.isBuiltIn(e.classType,"str")){if(void 0===e.classType.literalValue)return F.UnknownType.create();const s=e.classType.literalValue,r=i.get(s);return r?(r.isRequired||"get"!==n.method||a.addMessage(h.Localizer.DiagnosticAddendum.keyNotRequired().format({name:s,type:yi(t)})),"set"===n.method?ii(r.valueType,n.setType,a):"del"===n.method&&r.isRequired&&(a.addMessage(h.Localizer.DiagnosticAddendum.keyRequiredDeleted().format({name:s})),o=!1),r.valueType):(a.addMessage(h.Localizer.DiagnosticAddendum.keyUndefined().format({name:s,type:yi(t)})),o=!1,F.UnknownType.create())}return a.addMessage(h.Localizer.DiagnosticAddendum.typeNotStringLiteral().format({type:yi(e)})),o=!1,F.UnknownType.create()}));n.setExpectedTypeDiag&&(a=n.setExpectedTypeDiag);if(!a.isEmpty()){let t;t="set"===n.method?h.Localizer.Diagnostic.typedDictSet():"del"===n.method?h.Localizer.Diagnostic.typedDictDelete():h.Localizer.Diagnostic.typedDictAccess();const i=Rn(e);Ue(o?i.diagnosticRuleSet.reportTypedDictNotRequiredAccess:i.diagnosticRuleSet.reportGeneralTypeIssues,o?c.DiagnosticRule.reportTypedDictNotRequiredAccess:c.DiagnosticRule.reportGeneralTypeIssues,t+a.getString(),e)}return{node:e,type:p,isIncomplete:!!s.isIncomplete}}(e,t,n);if(i)return i}let s;"get"===n.method?s="__getitem__":"set"===n.method?s="__setitem__":(o.assert("del"===n.method),s="__delitem__");const r=null===(i=Te(e,t,s))||void 0===i?void 0:i.type;if(!r){return Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.methodNotDefinedOnType().format({name:s,type:yi(t)}),e.baseExpression),{node:e,type:F.UnknownType.create()}}if(1===e.items.length&&!e.trailingComma&&!e.items[0].name&&0===e.items[0].argumentCategory){const n=t.classType,i=e.items[0].valueExpression,s=he(i).type;if(F.isObject(s)&&F.ClassType.isBuiltIn(s.classType,"int")&&P.isLiteralType(s)){const t=s.classType.literalValue,i=P.getSpecializedTupleType(n);if(i&&i.tupleTypeArguments){if(P.isOpenEndedTupleClass(i))return{node:e,type:i.tupleTypeArguments[0]};if(t>=0&&t<i.tupleTypeArguments.length)return{node:e,type:i.tupleTypeArguments[t]};if(t<0&&i.tupleTypeArguments.length+t>=0)return{node:e,type:i.tupleTypeArguments[i.tupleTypeArguments.length+t]}}}}const a=e.items.filter((e=>0===e.argumentCategory&&!e.name)),p=e.items.filter((e=>1===e.argumentCategory)),u=e.items.filter((e=>0===e.argumentCategory&&!!e.name)),d=e.items.filter((e=>2===e.argumentCategory));let m;if(1!==a.length||0!==p.length||e.trailingComma)if(0===a.length&&0===p.length)m=Y&&F.isClass(Y)?P.convertToInstance(P.specializeTupleClass(Y,[])):F.UnknownType.create();else{const e=[];a.forEach((t=>{e.push(he(t.valueExpression).type)})),p.forEach((t=>{const n=De(he(t.valueExpression).type,!1,t)||F.UnknownType.create();e.push(n)})),m=nt(e,p.length>0)}else m=he(a[0].valueExpression).type;let y,g=[{argumentCategory:0,type:m}];"set"===n.method&&g.push({argumentCategory:0,type:n.setType||F.AnyType.create()});return u.forEach((e=>{g.push({argumentCategory:0,valueExpression:e.valueExpression,node:e,name:e.name})})),d.forEach((e=>{g.push({argumentCategory:2,valueExpression:e.valueExpression,node:e})})),On(e,(()=>{if(y=dt(e,g,r,new A.TypeVarMap(P.getTypeVarScopeId(r))),y.argumentErrors&&F.isObject(m)&&0===u.length&&0===d.length){const t=[...g];t[0]=Object.assign({},t[0]);if(Te(e,m,"__index__")){const n=En(e,"int");F.isObject(n)&&(t[0].type=n)}y=dt(e,t,r,new A.TypeVarMap(P.getTypeVarScopeId(r))),y.argumentErrors||(g=t)}})),y=dt(e,g,r,new A.TypeVarMap(P.getTypeVarScopeId(r))),{node:e,type:y.returnType||F.UnknownType.create(),isIncomplete:!!y.isTypeIncomplete}}(e,s,n);return t.isIncomplete&&(a=!0),t.type}if(F.isNever(s))return F.UnknownType.create();if(F.isNone(s))return Ue(Rn(e).diagnosticRuleSet.reportOptionalSubscript,c.DiagnosticRule.reportOptionalSubscript,h.Localizer.Diagnostic.noneNotSubscriptable(),e.baseExpression),F.UnknownType.create();if(!F.isUnbound(s)){Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotSubscriptable().format({type:yi(s)}),e.baseExpression)}return F.UnknownType.create()}));return e.items.forEach((e=>{he(e.valueExpression,void 0,4&i)})),{type:p,node:e,isIncomplete:a}}function nt(e,t=!1){return Y&&F.isClass(Y)?t?P.convertToInstance(P.specializeTupleClass(Y,[F.combineTypes(e),F.AnyType.create(!0)])):P.convertToInstance(P.specializeTupleClass(Y,e)):F.UnknownType.create()}function it(e,t,n=!1,i=!1){const s=[],r=-163&t,a=(e,t)=>{let s;return s=i||n&&t>0?he(e,void 0,162):function(e,t){let n,i=1113|t;Rn(e).isStubFile&&(i|=4);n=31===e.nodeType?{type:F.UnknownType.create(),typeList:e.entries.map((e=>he(e,void 0,i))),node:e}:he(e,void 0,i);return n}(e,r),s};return 1===e.items.length&&!e.trailingComma&&!e.items[0].name&&52===e.items[0].valueExpression.nodeType&&e.items[0].valueExpression.expressions.length>0?e.items[0].valueExpression.expressions.forEach(((e,t)=>{s.push(a(e,t))})):e.items.forEach(((e,t)=>{const n=a(e.valueExpression,t);0!==e.argumentCategory&&(1===e.argumentCategory&&F.isVariadicTypeVar(n.type)&&!n.type.isVariadicUnpacked?n.type=F.TypeVarType.cloneForUnpacked(n.type):(Re(h.Localizer.Diagnostic.unpackedArgInTypeArgument(),e.valueExpression),n.type=F.UnknownType.create())),e.name&&Re(h.Localizer.Diagnostic.keywordArgInTypeArgument(),e.valueExpression),s.push(n)})),s}function st(e,t){if(t=P.transformPossibleRecursiveTypeAlias(t),!F.isObject(t))return;if(!Y||!F.isClass(Y))return;const n=[];if(P.isTupleClass(t.classType)&&t.classType.tupleTypeArguments)if(P.isOpenEndedTupleClass(t.classType)){const i=P.transformPossibleRecursiveTypeAlias(t.classType.tupleTypeArguments[0]);for(let t=0;t<e.expressions.length;t++)n.push(i)}else t.classType.tupleTypeArguments.forEach((e=>{n.push(P.transformPossibleRecursiveTypeAlias(e))}));else{const i=new A.TypeVarMap(P.getTypeVarScopeId(Y));if(!ut(Y,t,i,Ye(e)))return;const s=P.applySolvedTypeVars(Y,i);if(!s.typeArguments||1!==s.typeArguments.length)return;const r=P.transformPossibleRecursiveTypeAlias(s.typeArguments[0]);for(let t=0;t<e.expressions.length;t++)n.push(r)}const i=e.expressions.map(((e,t)=>he(e,t<n.length?n[t]:void 0))),s=n.some((e=>P.isLiteralTypeOrUnion(e)));return{type:P.convertToInstance(P.specializeTupleClass(Y,rt(i),!0,!s)),node:e}}function rt(e){const t=[];let n=!1;for(const i of e)if(i.unpackedType)if(F.isObject(i.unpackedType)&&P.isTupleClass(i.unpackedType.classType)){const e=i.unpackedType.classType.tupleTypeArguments;!e||P.isOpenEndedTupleClass(i.unpackedType.classType)?(t.push(i.type),n=!0):t.push(...e)}else t.push(i.type),n=!0;else t.push(i.type);return n?[F.combineTypes(t),F.AnyType.create(!0)]:t}function at(e,t,n){const i=e.details.mro.findIndex((e=>F.isClass(e)&&F.ClassType.isBuiltIn(e,"NamedTuple")));if(i<0||e.details.mro.length<i+2)return;const s=e.details.mro[i],r=e.details.mro[i+1];if(!F.isClass(r)||!P.isTupleClass(r))return;const a=P.specializeTupleClass(r,t,n),o=F.ClassType.cloneForSpecialization(s,[],n);o.details=Object.assign({},o.details),o.details.mro=[...o.details.mro],o.details.mro[1]=a.details.mro[0],o.details.baseClasses=o.details.baseClasses.map((e=>F.isClass(e)&&P.isTupleClass(e)?a:e)),e.details.mro[i]=o,e.details.mro[i+1]=a,e.details.baseClasses=e.details.baseClasses.map((e=>F.isClass(e)&&F.ClassType.isBuiltIn(e,"NamedTuple")?o:e))}function ot(e,t,n,i,s){let r;for(const a of n.overloads)if(F.FunctionType.isOverloaded(a)){const n=s?s.clone():new A.TypeVarMap(P.getTypeVarScopeId(a));if(n.addSolveForScope(P.getTypeVarScopeId(a)),On(e,(()=>{ht(e,t,a,n,!0,i).argumentErrors||(r=a)})),r)break}return r}function lt(e,t,n,i,s){var r;let a,o=!1,p=!1;const u=e=>F.isFunction(e)&&F.FunctionType.isSkipConstructorCheck(e),d=null===(r=Te(e,F.ObjectType.create(n),"__init__",{method:"get"},new l.DiagnosticAddendum,68))||void 0===r?void 0:r.type;if(d&&!u(d)){if(s&&(a=P.mapSubtypes(s,(s=>{s=P.transformPossibleRecursiveTypeAlias(s);const r=new A.TypeVarMap(P.getTypeVarScopeId(n));if(ut(n,s,r,Ye(e))){let a;if(On(e,(()=>{a=dt(e,t,d,r.clone(),i,F.NoneType.createInstance())})),!(null==a?void 0:a.argumentErrors))return dt(e,t,d,r,i,F.NoneType.createInstance()),ct(n,s,r)}})),F.isNever(a)&&(a=void 0)),!a){const s=n.typeArguments?P.buildTypeVarMapFromSpecializedClass(n,!1):new A.TypeVarMap(P.getTypeVarScopeId(n));s.addSolveForScope(P.getTypeVarScopeId(d));dt(e,t,d,s,i).argumentErrors?p=!0:a=pt(n,void 0,s)}o=!0,i=!0}if(!p){const r=Je(e,n,"__new__",{method:"get"},new l.DiagnosticAddendum,21,n);if(r&&!u(r.type)){const l=r.type,c=new A.TypeVarMap(P.getTypeVarScopeId(n));if(l){const r=dt(e,t,l,c,i);if(r.argumentErrors)p=!0;else{let e=r.returnType;e&&(F.isObject(e)&&F.ClassType.isSameGenericClass(e.classType,n)?(P.isPartlyUnknown(e)||P.requiresSpecialization(e))&&void 0!==a||(F.isObject(e)&&F.ClassType.isTupleClass(e.classType)&&!e.classType.tupleTypeArguments&&e.classType.typeArguments&&1===e.classType.typeArguments.length&&(e=F.ObjectType.create(P.specializeTupleClass(e.classType,[e.classType.typeArguments[0],F.AnyType.create(!0)]))),a=e):a||F.isUnknown(e)||(a=e))}a||(a=pt(n,s,c)),o=!0}}}if(o||t.forEach((e=>{e.valueExpression&&!j.isSpeculative(e.valueExpression)&&he(e.valueExpression)})),!o&&t.length>0){if(!(!!n.details.effectiveMetaclass&&F.isClass(n.details.effectiveMetaclass)&&!F.ClassType.isBuiltIn(n.details.effectiveMetaclass))){Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.constructorNoArgs().format({type:n.aliasName||n.details.name}),e)}}if(!a){const t=new A.TypeVarMap(P.getTypeVarScopeId(n));s&&ut(n,s,t,Ye(e)),a=pt(n,s,t)}return{argumentErrors:p,returnType:a}}function ct(e,t,n){const i=P.applySolvedTypeVars(F.ObjectType.create(e),n,!0);if(ii(t,i,new l.DiagnosticAddendum))return F.isAny(t)?t:i}function pt(e,t,n){if(t){const i=P.mapSubtypes(t,(t=>ct(e,t,n)));if(!F.isNever(i))return i}const i=P.applySolvedTypeVars(e,n,!0);return F.ObjectType.create(i)}function ut(e,t,n,i){if(F.isAny(t))return e.details.typeParameters.forEach((e=>{n.setTypeVarType(e,t)})),!0;if(!F.isObject(t))return!1;const s=t.classType.typeArguments;if(!s)return ii(e,t.classType,new l.DiagnosticAddendum,n);if(F.ClassType.isSameGenericClass(t.classType,e)){const e=P.buildTypeVarMapFromSpecializedClass(t.classType);return e.getTypeVars().forEach((t=>{const i=e.getTypeVarType(t.typeVar);n.setTypeVarType(t.typeVar,1===t.typeVar.details.variance?void 0:i,2===t.typeVar.details.variance?void 0:i,t.retainLiteral)})),!0}const r=P.getTypeVarScopeId(t.classType),a=F.ClassType.getTypeParameters(t.classType).map(((e,t)=>{const n=F.TypeVarType.createInstance(`__dest${t}`);return n.details.isSynthesized=!0,n.details.variance=e.details.variance,n.scopeId=r,n})),o=F.ClassType.cloneForSpecialization(t.classType,a,!0),c=F.ClassType.getTypeParameters(e).map(((e,t)=>{const n=F.TypeVarType.createInstance(`__source${t}`);return n.details.isSynthesized=!0,n.details.synthesizedIndex=t,n})),p=F.ClassType.cloneForSpecialization(e,c,!0),u=new A.TypeVarMap(r);return!!ii(o,p,new l.DiagnosticAddendum,u)&&(a.forEach(((e,t)=>{const r=u.getTypeVarType(e);if(r&&F.isTypeVar(r)&&r.details.isSynthesized&&void 0!==r.details.synthesizedIndex){const a=F.ClassType.getTypeParameters(p)[r.details.synthesizedIndex];if(t<s.length){const r=P.transformExpectedTypeForConstructor(s[t],n,i);r&&n.setTypeVarType(a,1===e.details.variance?void 0:r,2===e.details.variance?void 0:r)}}})),!0)}function dt(e,t,n,i,s=!1,r){let a,m=!1,y=!1;const g=P.mapSubtypes(n,(n=>{var g;let f=!1;F.isObject(n)&&F.ClassType.isBuiltIn(n.classType,"Type")&&(n=P.transformTypeObjectToClass(n),f=!0);const T=Be(n);switch(T.category){case 1:case 2:return t.forEach((e=>{e.valueExpression&&!j.isSpeculative(e.valueExpression)&&kn(e)})),T;case 10:{const n=dt(e,t,T,i,s,r);return n.argumentErrors&&(m=!0),n.overloadUsed&&(a=n.overloadUsed),n.isTypeIncomplete&&(y=!0),n.returnType}case 5:{if("namedtuple"===T.details.builtInName)return Ue(Rn(e).diagnosticRuleSet.reportUntypedNamedTuple,c.DiagnosticRule.reportUntypedNamedTuple,h.Localizer.Diagnostic.namedTupleNoTypes(),e),ft(e,t,!1);if("NewType"===T.details.builtInName){const n=ht(e,t,T,new A.TypeVarMap(P.getTypeVarScopeId(T)),s,r);return n.isTypeIncomplete&&(y=!0),n.argumentErrors?n.returnType:function(e,t){const n=Rn(e);let i="_";if(t.length>=1){const e=t[0];0===e.argumentCategory&&e.valueExpression&&48===e.valueExpression.nodeType&&(i=e.valueExpression.strings.map((e=>e.value)).join(""))}if(t.length>=2){const s=Fn(t[1]);if(F.isClass(s)){F.ClassType.isProtocolClass(s)?Re(h.Localizer.Diagnostic.newTypeProtocolClass(),t[1].node||e):void 0!==s.literalValue&&Re(h.Localizer.Diagnostic.newTypeLiteral(),t[1].node||e);const r=-4&s.details.flags,a=F.ClassType.create(i,gt(e,n.moduleName,i),n.moduleName,n.filePath,r,gi(e),void 0,s.details.effectiveMetaclass);a.details.baseClasses.push(s),P.computeMroLinearization(a);const o=F.FunctionType.createInstance("__init__","","",64);F.FunctionType.addParameter(o,{category:0,name:"self",type:F.ObjectType.create(a),hasDeclaredType:!0}),F.FunctionType.addParameter(o,{category:0,name:"_x",type:F.ObjectType.create(s),hasDeclaredType:!0}),o.details.declaredReturnType=F.NoneType.createInstance(),a.details.fields.set("__init__",C.Symbol.createWithType(4,o));const l=F.FunctionType.createInstance("__new__","","",65);return F.FunctionType.addParameter(l,{category:0,name:"cls",type:a,hasDeclaredType:!0}),F.FunctionType.addDefaultParameters(l),l.details.declaredReturnType=F.ObjectType.create(a),a.details.fields.set("__new__",C.Symbol.createWithType(4,l)),a}F.isAnyOrUnknown(s)||Re(h.Localizer.Diagnostic.newTypeNotAClass(),t[1].node||e)}return}(e,t)}const n=ht(e,t,T,i||new A.TypeVarMap(P.getTypeVarScopeId(T)),s,r);return n.argumentErrors&&(m=!0),n.isTypeIncomplete&&(y=!0),"__import__"===T.details.builtInName?F.AnyType.create():n.returnType}case 6:{const n=ot(e,t,T,r,i);if(n){if("cast"===n.details.builtInName&&2===t.length){const n=Fn(t[0]),i=kn(t[1]);return F.isClass(n)&&F.isObject(i)&&F.isTypeSame(n,i.classType)&&Ue(Rn(e).diagnosticRuleSet.reportUnnecessaryCast,c.DiagnosticRule.reportUnnecessaryCast,h.Localizer.Diagnostic.unnecessaryCast().format({type:yi(i)}),e),P.convertToInstance(n)}const o=i||new A.TypeVarMap(P.getTypeVarScopeId(T));o.addSolveForScope(P.getTypeVarScopeId(n));const l=ht(e,t,n,o,s,r);return a=n,l.argumentErrors&&(m=!0),l.isTypeIncomplete&&(y=!0),l.returnType||F.UnknownType.create()}if(!Le(e)){const n=T.overloads[0].details.name||"<anonymous function>",i=new l.DiagnosticAddendum,s=t.map((e=>yi(kn(e))));i.addMessage(h.Localizer.DiagnosticAddendum.argumentTypes().format({types:s.join(", ")})),Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.noOverload().format({name:n})+i.getString(),e)}return m=!0,F.UnknownType.create()}case 7:{if(void 0!==T.literalValue)return Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.literalNotCallable(),e),m=!0,F.UnknownType.create();if(F.ClassType.isBuiltIn(T)){const n=T.aliasName||T.details.name;if("type"===n){if(lt(e,t,T,s,r),1===t.length){const e=kn(t[0]);if(F.isObject(e)||F.isTypeVar(e)&&F.TypeBase.isInstance(e))return P.convertToInstantiable(P.stripLiteralValue(e))}else if(t.length>=2)return function(e,t){const n=Rn(e),i=kn(t[0]);if(!F.isObject(i)||!F.ClassType.isBuiltIn(i.classType,"str"))return;const s=i.classType.literalValue||"_",r=kn(t[1]);if(!F.isObject(r)||!P.isTupleClass(r.classType)||void 0===r.classType.tupleTypeArguments)return;const a=F.ClassType.create(s,gt(e,n.moduleName,s),n.moduleName,n.filePath,0,gi(e),void 0,r.classType.details.effectiveMetaclass);r.classType.tupleTypeArguments.forEach((n=>{F.isClass(n)||F.isAnyOrUnknown(n)?a.details.baseClasses.push(n):Ve(n,t[1].valueExpression||e)})),P.computeMroLinearization(a)||Re(h.Localizer.Diagnostic.methodOrdering(),e);return a}(e,t)||F.AnyType.create();return F.AnyType.create()}if("TypeVar"===n)return function(e,t){var n;let i,s="";if(0===t.length)return void Re(h.Localizer.Diagnostic.typeVarFirstArg(),e);const r=t[0];r.valueExpression&&48===r.valueExpression.nodeType?s=r.valueExpression.strings.map((e=>e.value)).join(""):Re(h.Localizer.Diagnostic.typeVarFirstArg(),r.valueExpression||e);const a=F.TypeVarType.createInstantiable(s,!1);for(let s=1;s<t.length;s++){const r=t[s].name,o=r?r.value:void 0,l=new Map;if(o){if(l.get(o)&&Re(h.Localizer.Diagnostic.duplicateParam().format({name:o}),t[s].valueExpression||e),"bound"===o)if(a.details.constraints.length>0)Re(h.Localizer.Diagnostic.typeVarBoundAndConstrained(),t[s].valueExpression||e);else{const n=Fn(t[s]);P.requiresSpecialization(n)&&Re(h.Localizer.Diagnostic.typeVarGeneric(),t[s].valueExpression||e),a.details.boundType=P.convertToInstance(n)}else"covariant"===o?t[s].valueExpression&&yt(t[s].valueExpression)&&(2===a.details.variance?Re(h.Localizer.Diagnostic.typeVarVariance(),t[s].valueExpression):a.details.variance=1):"contravariant"===o?t[s].valueExpression&&yt(t[s].valueExpression)&&(1===a.details.variance?Re(h.Localizer.Diagnostic.typeVarVariance(),t[s].valueExpression):a.details.variance=2):Re(h.Localizer.Diagnostic.typeVarUnknownParam().format({name:o}),(null===(n=t[s].node)||void 0===n?void 0:n.name)||t[s].valueExpression||e);l.set(o,o)}else if(a.details.boundType)Re(h.Localizer.Diagnostic.typeVarBoundAndConstrained(),t[s].valueExpression||e);else{const n=Fn(t[s]);P.requiresSpecialization(n)&&Re(h.Localizer.Diagnostic.typeVarGeneric(),t[s].valueExpression||e),F.TypeVarType.addConstraint(a,P.convertToInstance(n)),void 0===i&&(i=t[s])}}1===a.details.constraints.length&&i&&Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarSingleConstraint(),i.valueExpression||e);return a}(e,t);if("TypeVarTuple"===n)return function(e,t){var n,i;let s="";if(0===t.length)return void Re(h.Localizer.Diagnostic.typeVarFirstArg(),e);const r=t[0];r.valueExpression&&48===r.valueExpression.nodeType?s=r.valueExpression.strings.map((e=>e.value)).join(""):Re(h.Localizer.Diagnostic.typeVarFirstArg(),r.valueExpression||e);const a=F.TypeVarType.createInstantiable(s,!1);a.details.isVariadic=!0;for(let s=1;s<t.length;s++)Re(h.Localizer.Diagnostic.typeVarUnknownParam().format({name:(null===(n=t[s].name)||void 0===n?void 0:n.value)||"?"}),(null===(i=t[s].node)||void 0===i?void 0:i.name)||t[s].valueExpression||e);return a}(e,t);if("ParamSpec"===n)return function(e,t){var n,i;const s=Rn(e);!s.isStubFile&&s.executionEnvironment.pythonVersion<u.PythonVersion.V3_9&&Re(h.Localizer.Diagnostic.paramSpecIllegal(),e);if(0===t.length)return void Re(h.Localizer.Diagnostic.paramSpecFirstArg(),e);const r=t[0];let a="";r.valueExpression&&48===r.valueExpression.nodeType?a=r.valueExpression.strings.map((e=>e.value)).join(""):Re(h.Localizer.Diagnostic.paramSpecFirstArg(),r.valueExpression||e);const o=F.TypeVarType.createInstantiable(a,!0);for(let s=1;s<t.length;s++){if(!(null===(n=t[s].name)||void 0===n?void 0:n.value)){Re(h.Localizer.Diagnostic.paramSpecUnknownArg(),t[s].valueExpression||e);break}Re(h.Localizer.Diagnostic.paramSpecUnknownParam().format({name:t[s].name.value}),(null===(i=t[s].node)||void 0===i?void 0:i.name)||t[s].valueExpression||e)}return o}(e,t);if("NamedTuple"===n)return ft(e,t,!0);if("Protocol"===n||"Generic"===n||"Callable"===n||"Concatenate"===n||"Type"===n){return Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotIntantiable().format({type:n}),e),F.AnyType.create()}if("Enum"===n||"IntEnum"===n||"Flag"===n||"IntFlag"===n)return function(e,t,n){const i=Rn(e);let s="enum";if(0===n.length)return;{const e=n[0];if(0!==e.argumentCategory||!e.valueExpression||48!==e.valueExpression.nodeType)return;s=e.valueExpression.strings.map((e=>e.value)).join("")}const r=F.ClassType.create(s,gt(e,i.moduleName,s),i.moduleName,i.filePath,1048576,gi(e),void 0,t.details.effectiveMetaclass);r.details.baseClasses.push(t),P.computeMroLinearization(r);const a=r.details.fields;if(a.set("__class__",C.Symbol.createWithType(68,r)),n.length<2)return;{const t=n[1];if(0!==t.argumentCategory||!t.valueExpression||48!==t.valueExpression.nodeType)return;t.valueExpression.strings.map((e=>e.value)).join("").split(" ").forEach((n=>{if(n=n.trim()){const i=F.UnknownType.create(),s=C.Symbol.createWithType(4,i),r=t.valueExpression;o.assert(48===r.nodeType);const l=Rn(e),c={type:1,node:r,path:l.filePath,range:p.convertOffsetsToRange(r.start,d.TextRange.getEnd(r),l.lines),moduleName:l.moduleName};s.addDeclaration(c),a.set(n,s)}}))}return r}(e,T,t);if("TypedDict"===n)return function(e,t,n){const i=Rn(e);let s="TypedDict";if(0===n.length)Re(h.Localizer.Diagnostic.typedDictFirstArg(),e);else{const t=n[0];0===t.argumentCategory&&t.valueExpression&&48===t.valueExpression.nodeType?s=t.valueExpression.strings.map((e=>e.value)).join(""):Re(h.Localizer.Diagnostic.typedDictFirstArg(),n[0].valueExpression||e)}const r=F.ClassType.create(s,gt(e,i.moduleName,s),i.moduleName,i.filePath,128,gi(e),void 0,t.details.effectiveMetaclass);r.details.baseClasses.push(t),P.computeMroLinearization(r);const a=r.details.fields;a.set("__class__",C.Symbol.createWithType(68,r));let o=!1;if(n.length<2)Re(h.Localizer.Diagnostic.typedDictSecondArgDict(),e);else{const t=n[1],s=new Map;if(0===t.argumentCategory&&t.valueExpression&&15===t.valueExpression.nodeType){o=!0;t.valueExpression.entries.forEach((e=>{if(17!==e.nodeType)return void Re(h.Localizer.Diagnostic.typedDictSecondArgDictEntry(),e);if(48!==e.keyExpression.nodeType)return void Re(h.Localizer.Diagnostic.typedDictEntryName(),e.keyExpression);const t=e.keyExpression.strings.map((e=>e.value)).join("");if(!t)return void Re(h.Localizer.Diagnostic.typedDictEmptyName(),e.keyExpression);if(s.has(t))return void Re(h.Localizer.Diagnostic.typedDictEntryUnique(),e.keyExpression);s.set(t,!0),Pn(e.valueExpression,!0);const n=new C.Symbol(8),r={type:1,node:e.keyExpression,path:i.filePath,typeAnnotationNode:e.valueExpression,range:p.convertOffsetsToRange(e.keyExpression.start,d.TextRange.getEnd(e.keyExpression),i.lines),moduleName:i.moduleName};n.addDeclaration(r),a.set(t,n)}))}else if(t.name)for(let t=1;t<n.length;t++){const i=n[t];if(!i.name||!i.valueExpression)continue;if(s.has(i.name.value)){Re(h.Localizer.Diagnostic.typedDictEntryUnique(),i.valueExpression);continue}s.set(i.name.value,!0),Pn(i.valueExpression,!0);const r=new C.Symbol(8),o=Rn(e),l={type:1,node:i.name,path:o.filePath,typeAnnotationNode:i.valueExpression,range:p.convertOffsetsToRange(i.name.start,d.TextRange.getEnd(i.valueExpression),o.lines),moduleName:o.moduleName};r.addDeclaration(l),a.set(i.name.value,r)}else Re(h.Localizer.Diagnostic.typedDictSecondArgDict(),e)}o&&(n.length>=3&&(!n[2].name||"total"!==n[2].name.value||!n[2].valueExpression||11!==n[2].valueExpression.nodeType||15!==n[2].valueExpression.constType&&33!==n[2].valueExpression.constType?Re(h.Localizer.Diagnostic.typedDictTotalParam(),n[2].valueExpression||e):15===n[2].valueExpression.constType&&(r.details.flags|=256)),n.length>3&&Re(h.Localizer.Diagnostic.typedDictExtraArgs(),n[3].valueExpression||e));return Fe(e,r),r}(e,T,t);if("auto"===n&&0===t.length)return En(e,"int")}if(!f&&F.ClassType.hasAbstractMethods(T)){const t=ci(T),n=new l.DiagnosticAddendum,i=2;t.forEach(((e,s)=>{if(s===i)n.addMessage(h.Localizer.DiagnosticAddendum.memberIsAbstractMore().format({count:t.length-i}));else if(s<i&&F.isClass(e.classType)){const t=e.classType.details.name;n.addMessage(h.Localizer.DiagnosticAddendum.memberIsAbstract().format({type:t,name:e.symbolName}))}}));Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeAbstract().format({type:T.details.name})+n.getString(),e)}if(!f&&F.ClassType.hasAbstractMethods(T)){const t=ci(T),n=new l.DiagnosticAddendum,i=2;t.forEach(((e,s)=>{if(s===i)n.addMessage(h.Localizer.DiagnosticAddendum.memberIsAbstractMore().format({count:t.length-i}));else if(s<i&&F.isClass(e.classType)){const t=e.classType.details.name;n.addMessage(h.Localizer.DiagnosticAddendum.memberIsAbstract().format({type:t,name:e.symbolName}))}}));Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeAbstract().format({type:T.details.name})+n.getString(),e)}const i=lt(e,t,T,s,r);i.argumentErrors&&(m=!0);let a=i.returnType;if(F.isTypeVar(n)&&(a=P.convertToInstance(n)),a&&F.isObject(a)&&a.classType.details.mro.some((e=>F.isClass(e)&&F.ClassType.isBuiltIn(e,"type")))){const t="__class_"+a.classType.details.name,n=F.ClassType.create(t,"","",Rn(e).filePath,0,gi(e),a.classType,a.classType);return n.details.baseClasses.push(An(e,"object")),P.computeMroLinearization(n),n}return a}case 8:{const a=null===(g=Te(e,T,"__call__"))||void 0===g?void 0:g.type;if(a&&(F.isFunction(a)||F.isOverloadedFunction(a))){const n=dt(e,t,a,i,s,r);return n.argumentErrors&&(m=!0),n.returnType||F.UnknownType.create()}return Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.objectNotCallable().format({type:yi(n)}),e),F.UnknownType.create()}case 3:return void Ue(Rn(e).diagnosticRuleSet.reportOptionalCall,c.DiagnosticRule.reportOptionalCall,h.Localizer.Diagnostic.noneNotCallable(),e)}}));return{argumentErrors:m,returnType:F.isNever(g)?void 0:g,overloadUsed:a,isTypeIncomplete:y}}function ht(e,t,n,i,s=!1,r){let a=0;const p=n.details.parameters;let u=!1;if(n.boundTypeVarScopeId&&(i.addSolveForScope(n.boundTypeVarScopeId),"__init__"===n.details.name&&F.FunctionType.isOverloaded(n)&&n.strippedFirstParamType&&n.boundToType&&F.isObject(n.strippedFirstParamType)&&F.isObject(n.boundToType)&&F.ClassType.isSameGenericClass(n.strippedFirstParamType.classType,n.boundToType.classType)&&n.strippedFirstParamType.classType.typeArguments)){const e=n.strippedFirstParamType.classType.details.typeParameters;n.strippedFirstParamType.classType.typeArguments.forEach(((t,n)=>{const s=e[n];F.isTypeSame(s,t)||i.setTypeVarType(e[n],t)}))}r&&!P.requiresSpecialization(r)&&n.details.declaredReturnType&&(F.isUnion(r)&&!P.containsLiteralType(r)||ii($n(n),r,new l.DiagnosticAddendum,i,132));const d=p.find((e=>2===e.category));let m=!1;const y=new Map;p.forEach((e=>{e.name&&0===e.category&&y.set(e.name,{argsNeeded:0!==e.category||e.hasDefault?0:1,argsReceived:0})}));let g=p.findIndex((e=>1===e.category&&!e.name));const f=p.findIndex((e=>1===e.category)),T=p.findIndex((e=>2===e.category));let _,v,b=p.findIndex((e=>0===e.category&&!e.name));if(g<0&&(g=f,g>=0&&g++),g<0&&(g=T),f>=0&&T>=0){const e=p[f],t=p[T];if(e.name&&e.hasDeclaredType&&e.typeAnnotation&&35===e.typeAnnotation.nodeType&&"args"===e.typeAnnotation.memberName.value&&38===e.typeAnnotation.leftExpression.nodeType&&t.name&&t.hasDeclaredType&&t.typeAnnotation&&35===t.typeAnnotation.nodeType&&"kwargs"===t.typeAnnotation.memberName.value&&38===t.typeAnnotation.leftExpression.nodeType&&e.typeAnnotation.leftExpression.value===t.typeAnnotation.leftExpression.value){const t=he(e.typeAnnotation.leftExpression).type;F.isTypeVar(t)&&t.details.isParamSpec&&(t.scopeId===n.details.typeVarScopeId?(_=[],v=t):b=f)}}g<0&&(g=p.length);let S=t.findIndex((e=>2===e.argumentCategory||void 0!==e.name));if(S<0&&(S=t.length),b>=0&&S<b){const e=p.findIndex((e=>e.hasDefault)),n=e>=0&&e<b?e:b;S=Math.min(n,t.length)}let C,I=[];function D(e,t){e.active&&(C=t)}let x=void 0!==t.find((e=>1===e.argumentCategory)),k=0,A=0,E=0;for(;a<S;){if(k===b){k++;continue}if(a<b&&t[a].name){Ue(Rn(t[a].name).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.argPositional(),t[a].name),m=!0}if(k>=g){x&&1===t[a].argumentCategory||(Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,1===g?h.Localizer.Diagnostic.argPositionalExpectedOne():h.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:g}),t[a].valueExpression||e),m=!0);break}const i=F.FunctionType.getEffectiveParameterType(n,k);if(1===t[a].argumentCategory){if(!t[a].valueExpression)break;const s=1===p[k].category&&F.isVariadicTypeVar(i);let r=!1;const o=kn(t[a]);let l,u=!1;n.details.paramSpec&&k<g&&(Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,1===g?h.Localizer.Diagnostic.argPositionalExpectedOne():h.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:g}),t[a].valueExpression||e),m=!0);const d=P.combineSameSizedTuples(o,Y);!s&&d&&F.isObject(d)&&d.classType.tupleTypeArguments.length>0?(l=d.classType.tupleTypeArguments[A],x=void 0!==t.find(((e,t)=>t>a&&1===e.argumentCategory)),A++,A>=d.classType.tupleTypeArguments.length&&(A=0,u=!0)):s&&F.isVariadicTypeVar(o)?(l=o,r=!0):(l=De(o,!1,t[a].valueExpression)||F.UnknownType.create(),F.isParamSpec(l)&&(l=F.AnyType.create()));const f={argumentCategory:0,type:l},T=p[k].name;s&&!r?(Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.unpackedArgWithVariadicParam(),t[a].valueExpression||e),m=!0):I.push({paramCategory:p[k].category,paramType:i,requiresTypeVarMatching:P.requiresSpecialization(i),argument:f,errorNode:t[a].valueExpression||e,paramName:p[k].isNameSynthesized?void 0:T}),D(t[a],p[k]),T&&0===p[k].category&&y.get(T).argsReceived++,(u||1===p[k].category)&&a++,1!==p[k].category&&k++}else if(1===p[k].category){if(D(t[a],p[k]),_)_.push(t[a]);else{let n=p[k].category,s=i;const r=p[k].name;if(F.isVariadicTypeVar(p[k].type)&&F.isObject(i)&&P.isTupleClass(i.classType)&&i.classType.tupleTypeArguments&&E<i.classType.tupleTypeArguments.length){s=i.classType.tupleTypeArguments[E],n=F.isVariadicTypeVar(s)?1:0,E++;const r=S-a-1,o=i.classType.tupleTypeArguments.length-E;E>=i.classType.tupleTypeArguments.length?k++:o>0&&r<=0&&(Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,1===o?h.Localizer.Diagnostic.argMorePositionalExpectedOne():h.Localizer.Diagnostic.argMorePositionalExpectedCount().format({expected:o}),t[a].valueExpression||e),m=!0)}I.push({paramCategory:n,paramType:s,requiresTypeVarMatching:P.requiresSpecialization(i),argument:t[a],errorNode:t[a].valueExpression||e,paramName:r,mapsToVarArgList:!0})}a++}else{const n=p[k].name;I.push({paramCategory:p[k].category,paramType:i,requiresTypeVarMatching:P.requiresSpecialization(i),argument:t[a],errorNode:t[a].valueExpression||e,paramName:p[k].isNameSynthesized?void 0:n}),D(t[a],p[k]),n&&y.get(n).argsReceived++,a++,k++}}if(!m){let i=!1;for(;a<t.length;){if(2===t[a].argumentCategory){const n=kn(t[a]),s=Pe(e,"Mapping"),r=En(e,"str");if(s&&F.isClass(s)&&r&&F.isObject(r)){const i=F.ObjectType.create(F.ClassType.cloneForSpecialization(s,[r,F.AnyType.create()],!0)),o=new l.DiagnosticAddendum;F.isParamSpec(n)||ii(i,n,o)||(Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.unpackedDictArgumentNotMapping()+o.getString(),t[a].valueExpression||e),m=!0)}i=!0}else{const i=t[a].name;if(i){const s=i.value,r=y.get(s);if(r)if(r.argsReceived>0)Ue(Rn(i).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramAlreadyAssigned().format({name:s}),i),m=!0;else{y.get(i.value).argsReceived++;const r=p.findIndex((e=>e.name===s));o.assert(r>=0);const l=F.FunctionType.getEffectiveParameterType(n,r);I.push({paramCategory:0,paramType:l,requiresTypeVarMatching:P.requiresSpecialization(l),argument:t[a],errorNode:t[a].valueExpression||e,paramName:s}),D(t[a],p[r])}else if(d){if(o.assert(T>=0),_)_.push(t[a]);else{let r=y.get(s);if(r&&r.argsReceived>0)Ue(Rn(i).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramAlreadyAssigned().format({name:s}),i),m=!0;else{const i=F.FunctionType.getEffectiveParameterType(n,T);I.push({paramCategory:2,paramType:i,requiresTypeVarMatching:P.requiresSpecialization(d.type),argument:t[a],errorNode:t[a].valueExpression||e,paramName:s}),r||(r={argsNeeded:1,argsReceived:1}),y.set(s,r)}}D(t[a],d)}else Ue(Rn(i).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramNameMissing().format({name:i.value}),i),m=!0}else if(0===t[a].argumentCategory){const n=g;Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,1===n?h.Localizer.Diagnostic.argPositionalExpectedOne():h.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:n}),t[a].valueExpression||e),m=!0}}a++}if(!i&&!x&&!F.FunctionType.isDefaultParameterCheckDisabled(n)){const t=[...y.keys()].filter((e=>{const t=y.get(e);return t.argsReceived<t.argsNeeded}));if(t.length>0){const n=t.map((e=>`"${e}"`)).join(", ");Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,1===t.length?h.Localizer.Diagnostic.argMissingForParam().format({name:n}):h.Localizer.Diagnostic.argMissingForParams().format({names:n}),e),m=!0}p.forEach(((t,i)=>{if(0===t.category&&t.name){const s=y.get(t.name);if(0===s.argsNeeded&&0===s.argsReceived){const s=F.FunctionType.getEffectiveParameterType(n,i);t.defaultType&&!P.isEllipsisType(t.defaultType)&&P.requiresSpecialization(s)&&I.push({paramCategory:t.category,paramType:s,requiresTypeVarMatching:!0,argument:{argumentCategory:0,type:t.defaultType},errorNode:e,paramName:t.isNameSynthesized?void 0:t.name})}}}))}}if(["cast","isinstance","issubclass"].some((e=>e===n.details.builtInName))&&(s=!0),!m||!j.isSpeculative(void 0)){if(f>=0&&p[f].hasDeclaredType){const t=F.FunctionType.getEffectiveParameterType(n,f),i=I.filter((e=>e.mapsToVarArgList));if(F.isTypeVar(t)&&t.details.isVariadic&&Y&&F.isClass(Y)){const n=i.map((e=>P.stripLiteralValue(kn(e.argument)))),s={paramCategory:1,paramType:t,requiresTypeVarMatching:!0,argument:{argumentCategory:0,type:F.ObjectType.create(P.specializeTupleClass(Y,n,!0,!0,!0))},errorNode:e,paramName:p[f].name,mapsToVarArgList:!0};I=[...I.filter((e=>!e.mapsToVarArgList)),s]}}const r=I.filter((e=>e.requiresTypeVarMatching)).length;if(r>0){const t=Math.min(r,2);for(let r=0;r<t;r++)On(e,(()=>{I.forEach((e=>{if(e.requiresTypeVarMatching){mt(e,i,n.details.name,s).isTypeIncomplete&&(u=!0)}}))}));i.lock()}I.forEach((e=>{const t=mt(e,i,n.details.name,s);t.isCompatible?t.isTypeIncomplete&&(u=!0):m=!0})),$.isUndoTrackingEnabled()||t.forEach((e=>{e.valueExpression&&!j.isSpeculative(e.valueExpression)&&(I.some((t=>t.argument===e))||he(e.valueExpression))}))}!m&&_&&v&&(function(e,t,n,i){var s;const r=i.getParamSpec(n);if(!r||!r.parameters)return Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramSpecNotBound().format({type:yi(n)}),(null===(s=t[0])||void 0===s?void 0:s.valueExpression)||e),!1;let a=!1;const o=new Map,l=r.parameters;l.forEach((e=>{e.name&&o.set(e.name,e)}));let p=0;if(t.forEach((t=>{if(0===t.argumentCategory){let n;if(t.name){const i=o.get(t.name.value);i?(n=i.type,o.delete(t.name.value)):(Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramNameMissing().format({name:t.name.value}),t.valueExpression||e),a=!0)}else{if(p<l.length){const e=l[p];n=e.type,e.name&&o.delete(e.name)}else Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,1===l.length?h.Localizer.Diagnostic.argPositionalExpectedOne():h.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:l.length}),t.valueExpression||e),a=!0;p++}n&&(mt({paramCategory:0,paramType:n,requiresTypeVarMatching:!1,argument:t,errorNode:t.valueExpression||e},i,"",!1)||(a=!0))}})),!a){const t=[...o.keys()];if(t.length>0){const n=t.map((e=>`"${e}"`)).join(", ");Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,1===t.length?h.Localizer.Diagnostic.argMissingForParam().format({name:n}):h.Localizer.Diagnostic.argMissingForParams().format({names:n}),e),a=!0}}return!a}(e,_,v,i)||(m=!0));const w=$n(n,I,!m),N=P.applySolvedTypeVars(w,i);return F.isFunction(N)&&!N.details.name&&(N.details=Object.assign(Object.assign({},N.details),{typeVarScopeId:F.WildcardTypeVarScopeId})),{argumentErrors:m,returnType:N,isTypeIncomplete:u,activeParam:C}}function mt(e,t,n,i){let s,r,a=!1;if(e.argument.valueExpression){let n=F.isTypeVar(e.paramType)?void 0:P.applySolvedTypeVars(e.paramType,t);n&&F.isUnknown(n)&&(n=void 0);const i=he(e.argument.valueExpression,n);if(s=i.type,i.isIncomplete&&(a=!0),i.typeErrors)return{isCompatible:!1};r=i.expectedTypeDiagAddendum,e.argument&&e.argument.name&&!j.isSpeculative(e.errorNode)&&se(e.argument.name,n||s,!!i.isIncomplete)}else s=kn(e.argument);2===e.paramCategory&&F.isTypeVar(e.paramType)&&(s=P.stripLiteralValue(s));let o=new l.DiagnosticAddendum;if(!ii(e.paramType,s,o.createAddendum(),t)){if(!Le(e.errorNode)){const t=Rn(e.errorNode),i=yi(s),a=yi(e.paramType);let l;l=e.paramName?n?h.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:i,paramType:a,functionName:n,paramName:e.paramName}):h.Localizer.Diagnostic.argAssignmentParam().format({argType:i,paramType:a,paramName:e.paramName}):n?h.Localizer.Diagnostic.argAssignmentFunction().format({argType:i,paramType:a,functionName:n}):h.Localizer.Diagnostic.argAssignment().format({argType:i,paramType:a}),r&&(o=r),Ue(t.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,l+o.getString(),e.errorNode)}return{isCompatible:!1}}if(!i){const t=F.removeUnbound(s),i=Rn(e.errorNode),r=()=>{const t=new l.DiagnosticAddendum;return e.paramName&&t.addMessage((n?h.Localizer.DiagnosticAddendum.argParamFunction().format({paramName:e.paramName,functionName:n}):h.Localizer.DiagnosticAddendum.argParam().format({paramName:e.paramName}))+t.getString()),t};if(!F.isAny(e.paramType))if(F.isUnknown(t)){const t=r();Ue(i.diagnosticRuleSet.reportUnknownArgumentType,c.DiagnosticRule.reportUnknownArgumentType,h.Localizer.Diagnostic.argTypeUnknown()+t.getString(),e.errorNode)}else if(P.isPartlyUnknown(t,!0)&&!P.isPartlyUnknown(e.paramType)&&!F.isClass(t)){const n=r();n.addMessage(h.Localizer.DiagnosticAddendum.argumentType().format({type:yi(t,!0)})),Ue(i.diagnosticRuleSet.reportUnknownArgumentType,c.DiagnosticRule.reportUnknownArgumentType,h.Localizer.Diagnostic.argTypePartiallyUnknown()+n.getString(),e.errorNode)}}return{isCompatible:!0,isTypeIncomplete:a}}function yt(e){if(11===e.nodeType){if(15===e.constType)return!1;if(33===e.constType)return!0}return Re(h.Localizer.Diagnostic.expectedBoolLiteral(),e),!1}function gt(e,t,n){const i=[n];let s=e;for(;s;)s=v.getEnclosingClass(s),s&&i.push(s.name.value);return i.push(t),i.reverse().join(".")}function ft(e,t,n){const i=Rn(e);let s="namedtuple";if(0===t.length)Re(h.Localizer.Diagnostic.namedTupleFirstArg(),e);else{const n=t[0];0!==n.argumentCategory?Re(h.Localizer.Diagnostic.namedTupleFirstArg(),t[0].valueExpression||e):n.valueExpression&&48===n.valueExpression.nodeType&&(s=n.valueExpression.strings.map((e=>e.value)).join(""))}const r=Pe(e,"NamedTuple")||F.UnknownType.create(),a=F.ClassType.create(s,gt(e,i.moduleName,s),i.moduleName,i.filePath,0,gi(e),void 0,F.isClass(r)?r.details.effectiveMetaclass:F.UnknownType.create());a.details.baseClasses.push(r);const o=a.details.fields;o.set("__class__",C.Symbol.createWithType(68,a));const l=F.FunctionType.createInstance("__new__","","",65);l.details.declaredReturnType=F.ObjectType.create(a),v.isAssignmentToDefaultsFollowingNamedTuple(e)&&(l.details.flags|=32),F.FunctionType.addParameter(l,{category:0,name:"cls",type:a,hasDeclaredType:!0});const c={category:0,name:"self",type:F.ObjectType.create(a),hasDeclaredType:!0};let u=!1;const m=[];if(t.length<2)Re(h.Localizer.Diagnostic.namedTupleSecondArg(),e),u=!0;else{const e=t[1];if(0!==e.argumentCategory)u=!0;else if(!n&&e.valueExpression&&48===e.valueExpression.nodeType){e.valueExpression.strings.map((e=>e.value)).join("").split(/[,\s]+/).forEach((t=>{if(t=t.trim()){const s=F.UnknownType.create(),r={category:0,name:t,type:s,hasDeclaredType:n};F.FunctionType.addParameter(l,r);const a=C.Symbol.createWithType(8,s),c=e.valueExpression,u={type:1,node:c,path:i.filePath,range:p.convertOffsetsToRange(c.start,d.TextRange.getEnd(c),i.lines),moduleName:i.moduleName};a.addDeclaration(u),o.set(t,a),m.push(s)}}))}else if(e.valueExpression&&31===e.valueExpression.nodeType){const t=e.valueExpression,s=new Map;t.entries.forEach(((e,t)=>{let r,a,c,u="";n?52===e.nodeType&&2===e.expressions.length?(c=e.expressions[0],r=e.expressions[1],a=P.convertToInstance(Pn(r))):Re(h.Localizer.Diagnostic.namedTupleNameType(),e):(c=e,a=F.UnknownType.create()),c&&48===c.nodeType?(u=c.strings.map((e=>e.value)).join(""),u||Re(h.Localizer.Diagnostic.namedTupleEmptyName(),c)):Re(h.Localizer.Diagnostic.namedTupleNameString(),c||e),u||(u=`_${t.toString()}`),s.has(u)&&Re(h.Localizer.Diagnostic.namedTupleNameUnique(),c||e),s.set(u,u),a||(a=F.UnknownType.create());const y={category:0,name:u,type:a,hasDeclaredType:n};F.FunctionType.addParameter(l,y),m.push(a);const g=C.Symbol.createWithType(8,a);if(c&&48===c.nodeType){const e={type:1,node:c,path:i.filePath,typeAnnotationNode:r,range:p.convertOffsetsToRange(c.start,d.TextRange.getEnd(c),i.lines),moduleName:i.moduleName};g.addDeclaration(e)}o.set(u,g)}))}else u=!0}u&&(F.FunctionType.addDefaultParameters(l),m.push(F.AnyType.create(!1)),m.push(F.AnyType.create(!0)));const y=F.FunctionType.createInstance("__init__","","",192);F.FunctionType.addParameter(y,c),F.FunctionType.addDefaultParameters(y),y.details.declaredReturnType=F.NoneType.createInstance(),o.set("__new__",C.Symbol.createWithType(4,l)),o.set("__init__",C.Symbol.createWithType(4,y));const g=F.FunctionType.createInstance("keys","","",64),f=F.FunctionType.createInstance("items","","",64);g.details.declaredReturnType=En(e,"list",[En(e,"str")]),f.details.declaredReturnType=g.details.declaredReturnType,o.set("keys",C.Symbol.createWithType(8,g)),o.set("items",C.Symbol.createWithType(8,f));const T=F.FunctionType.createInstance("__len__","","",64);if(T.details.declaredReturnType=En(e,"int"),F.FunctionType.addParameter(T,c),o.set("__len__",C.Symbol.createWithType(4,T)),u){const t=F.FunctionType.createInstance("__getattribute__","","",64);t.details.declaredReturnType=F.AnyType.create(),F.FunctionType.addParameter(t,c),F.FunctionType.addParameter(t,{category:0,name:"name",type:En(e,"str")}),o.set("__getattribute__",C.Symbol.createWithType(4,t))}return P.computeMroLinearization(a),at(a,m,!u),a}function Tt(e){return!(!E[e]||!E[e][2])||!!w[e]}function _t(e,t,n){const i=e.leftExpression;let s=e.rightExpression,r=!1;Tt(e.operator)&&7===s.nodeType&&!s.parenthesized&&Tt(s.operator)&&(_t(s,t,n),s=s.leftExpression);let a=37===e.operator||36===e.operator?t:void 0;26===e.operator&&t&&F.isObject(t)&&F.ClassType.isBuiltIn(t.classType,"list")&&t.classType.typeArguments&&t.classType.typeArguments.length>=1&&31===e.leftExpression.nodeType&&(a=t);const o=he(i,a,n);let l=o.type;a||37!==e.operator&&36!==e.operator||(a=l);const p=he(s,a,n);let d=p.type;if((o.isIncomplete||p.isIncomplete)&&(r=!0),6===e.operator&&!vt(l,"__or__")&&!vt(d,"__ror__")){let t=d;if(!F.isNone(l)&&F.isNone(d)&&F.TypeBase.isInstance(d)&&(t=F.NoneType.createType()),F.isUnionableType([l,t])){const i=Rn(e);return i.isStubFile||0!=(4&n)||i.executionEnvironment.pythonVersion>=u.PythonVersion.V3_10||Re(h.Localizer.Diagnostic.unionSyntaxIllegal(),e,e.operatorToken),{type:F.combineTypes([l,t]),node:e}}}return void 0===w[e.operator]&&(P.isOptionalType(l)&&(12!==e.operator&&28!==e.operator&&Ue(Rn(e).diagnosticRuleSet.reportOptionalOperand,c.DiagnosticRule.reportOptionalOperand,h.Localizer.Diagnostic.noneOperator().format({operator:v.printOperator(e.operator)}),e.leftExpression),l=F.removeNoneFromUnion(l)),12!==e.operator&&28!==e.operator||(d=F.removeNoneFromUnion(d))),{type:St(e.operator,l,d,e,t),node:e,isIncomplete:r}}function vt(e,t){if(!F.isClass(e))return!1;const n=e.details.effectiveMetaclass;if(!n||!F.isClass(n))return!1;if(F.ClassType.isBuiltIn(n,"type"))return!1;return!!P.lookUpClassMember(n,t)}function bt(e,t){const n={1:["__iadd__",0],34:["__isub__",33],27:["__imul__",26],14:["__ifloordiv__",13],11:["__itruediv__",10],25:["__imod__",24],30:["__ipow__",29],23:["__imatmul__",22],4:["__iand__",3],7:["__ior__",6],9:["__ixor__",8],18:["__ilshift__",17],32:["__irshift__",31]};let i;const s=he(e.leftExpression),r=s.type,a=he(e.rightExpression),o=a.type,l=!!a.isIncomplete||!!s.isIncomplete;if(i=We(r,void 0,((i,s,r)=>We(o,r,((r,a)=>{if(F.isAnyOrUnknown(s)||F.isAnyOrUnknown(a))return F.isUnknown(s)||F.isUnknown(a)?F.UnknownType.create():F.AnyType.create();const o=n[e.operator][0];let l=Ct(s,[a],o,e,t);return l||s===i||(l=Ct(i,[a],o,e,t)),l||a===r||(l=Ct(i,[r],o,e,t)),l})))),!i||F.isNever(i)){i=St(n[e.operator][1],r,o,e,t)}return{node:e,type:i,isIncomplete:l}}function St(e,t,n,i,s){let r;const a=new l.DiagnosticAddendum;let o=Be(t);if(void 0!==w[e]){if(36===e){if(!P.canBeTruthy(o))return t;if(!P.canBeFalsy(o))return n;o=P.removeTruthinessFromType(o)}else if(37===e){if(!P.canBeFalsy(o))return t;if(!P.canBeTruthy(o))return n;o=P.removeFalsinessFromType(o)}41===e||42===e?(r=We(n,void 0,((s,r,c)=>We(o,c,(o=>{if(F.isAnyOrUnknown(o)||F.isAnyOrUnknown(r))return F.isUnknown(o)||F.isUnknown(r)?F.UnknownType.create():F.AnyType.create();let c=Ct(s,[o],"__contains__",i,void 0);if(!c){const e=De(s,!1,void 0);e&&ii(e,o,new l.DiagnosticAddendum)&&(c=En(i,"bool"))}return c||a.addMessage(h.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:v.printOperator(e),leftType:yi(t),rightType:yi(n)})),c})))),r&&!F.isNever(r)&&(r=En(i,"bool"))):r=We(o,void 0,((t,s,r)=>We(n,r,((t,n)=>36===e||37===e?F.combineTypes([s,n]):En(i,"bool")))))}else E[e]&&(r=We(t,void 0,((r,o,l)=>We(n,l,((l,c)=>{if(F.isAnyOrUnknown(o)||F.isAnyOrUnknown(c))return F.isUnknown(o)||F.isUnknown(c)?F.UnknownType.create():F.AnyType.create();const p=E[e][0];let u=Ct(o,[c],p,i,s);if(u||o===r||(u=Ct(r,[c],p,i,s)),u||c===l||(u=Ct(r,[l],p,i,s)),!u){const t=E[e][1];u=Ct(c,[o],t,i,s),u||c===l||(u=Ct(l,[o],t,i,s)),u||o===r||(u=Ct(l,[r],t,i,s))}return u||a.addMessage(h.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:v.printOperator(e),leftType:yi(t),rightType:yi(n)})),u})))));if(!a.isEmpty()||!r||F.isNever(r)){Ue(Rn(i).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:v.printOperator(e),leftType:yi(t),rightType:yi(n)})+a.getString(),i),r=F.UnknownType.create()}return r}function Ct(e,t,n,i,s){let r=!0;const a=e=>{var a,o;let l;const c=Be(e);if(F.isObject(c)?l=null===(a=Te(i,c,n,void 0,void 0,void 0,e))||void 0===a?void 0:a.type:F.isClass(c)&&(l=null===(o=_e(i,c,n,void 0,void 0,32))||void 0===o?void 0:o.type),l){const e=t.map((e=>({argumentCategory:0,type:e})));let n;return On(i,(()=>{n=dt(i,e,l,new A.TypeVarMap(P.getTypeVarScopeId(l)),!0,s)})),n.argumentErrors&&(r=!1),n.returnType}r=!1},o=P.mapSubtypes(e,(e=>{if(F.isAnyOrUnknown(e))return e;if(F.isObject(e)||F.isClass(e)||F.isTypeVar(e))return a(e);if(F.isNone(e)){const e=En(i,"object");if(F.isObject(e))return a(e)}r=!1}));if(r)return o}function It(e,t,n){if(t=P.transformPossibleRecursiveTypeAlias(t),!F.isObject(t))return;const i=[],s=[];if(F.ClassType.isTypedDictClass(t.classType)){return Dt(e,i,s,!!t,void 0,void 0,pi(t.classType),n),F.ClassType.isTypedDictClass(t.classType)&&function(e,t,n,i){o.assert(F.ClassType.isTypedDictClass(e)),o.assert(t.length===n.length);let s=!0;const r=pi(e);if(t.forEach(((t,a)=>{if(F.isObject(t)&&F.ClassType.isBuiltIn(t.classType,"str")&&P.isLiteralType(t)){const o=t.classType.literalValue,c=r.get(o);if(c){const e=new l.DiagnosticAddendum;ii(c.valueType,n[a],e)||(i.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldTypeMismatch().format({name:t.classType.literalValue,type:yi(n[a])})),s=!1),c.isProvided=!0}else s=!1,i.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldUndefined().format({name:t.classType.literalValue,type:yi(F.ObjectType.create(e))}))}else s=!1})),!s)return!1;return r.forEach(((t,n)=>{t.isRequired&&!t.isProvided&&(i.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldRequired().format({name:n,type:yi(F.ObjectType.create(e))})),s=!1)})),s}(t.classType,i,s,n)?{type:t,node:e}:void 0}const r=En(e,"dict");if(!F.isObject(r))return;const a=new A.TypeVarMap(P.getTypeVarScopeId(r.classType));if(!ut(r.classType,t,a,Ye(e)))return;const c=P.applySolvedTypeVars(r.classType,a);if(!c.typeArguments||2!==c.typeArguments.length)return;const p=c.typeArguments[0],u=c.typeArguments[1];Dt(e,i,s,!!t,p,u,void 0,n);const d=F.isObject(t)&&F.ClassType.isBuiltIn(t.classType,"dict"),m=kt(p,i,!1),y=kt(u,s,!d);if(!m||!y)return;return{type:En(e,"dict",[m,y]),node:e}}function Dt(e,t,n,i,s,r,a,o){e.entries.forEach(((p,u)=>{let d=!0;if(17===p.nodeType){let e,c=he(p.keyExpression,s).type;if(s){const e=Be(s);F.isAnyOrUnknown(e)||ii(e,c,new l.DiagnosticAddendum,void 0)&&(c=e)}e=a&&F.isObject(c)&&F.ClassType.isBuiltIn(c.classType,"str")&&P.isLiteralType(c)&&a.has(c.classType.literalValue)?he(p.valueExpression,a.get(c.classType.literalValue).valueType):he(p.valueExpression,r),o&&e.expectedTypeDiagAddendum&&o.addAddendum(e.expectedTypeDiagAddendum);const h=e.type;(!i||u<R)&&(t.push(c),n.push(h)),d=!1}else if(16===p.nodeType){const s=he(p.expandExpression).type;if(F.isAnyOrUnknown(s))d=!1;else{const r=Pe(e,"Mapping");if(r&&F.isClass(r)){const a=new A.TypeVarMap(P.getTypeVarScopeId(r));if(ii(F.ObjectType.create(r),s,new l.DiagnosticAddendum,a)){const e=P.applySolvedTypeVars(r,a).typeArguments;e&&e.length>=2&&((!i||u<R)&&(t.push(e[0]),n.push(e[1])),d=!1)}else{Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.dictUnpackIsNotMapping(),p)}}}}else if(32===p.nodeType){const e=Pt(p,r,s);if(F.isObject(e)){const s=e.classType;if(P.isTupleClass(s)){const e=s.tupleTypeArguments;e&&2===e.length&&((!i||u<R)&&(t.push(e[0]),n.push(e[1])),d=!1)}}}d&&(!i||u<R)&&(t.push(F.UnknownType.create()),n.push(F.UnknownType.create()))}))}function xt(e,t){if(t=P.transformPossibleRecursiveTypeAlias(t),!F.isObject(t))return;const n=En(e,"list");if(!F.isObject(n))return;const i=new A.TypeVarMap(P.getTypeVarScopeId(n.classType));if(!ut(n.classType,t,i,Ye(e)))return;const s=P.applySolvedTypeVars(n.classType,i);if(!s.typeArguments||1!==s.typeArguments.length)return;const r=s.typeArguments[0],a=[];e.entries.forEach((e=>{32===e.nodeType?a.push(Pt(e,r)):a.push(he(e,r).type)}));const o=F.isObject(t)&&F.ClassType.isBuiltIn(t.classType,"list"),l=kt(r,a,!o);if(!l)return;return{type:En(e,"list",[l]),node:e}}function kt(e,t,n){const i=new l.DiagnosticAddendum,s=F.TypeVarType.createInstance("__typeArg");s.details.isSynthesized=!0,s.details.boundType=e;const r="__typeArgScopeId";s.scopeId=r;let a=new A.TypeVarMap(r);if(a.setTypeVarType(s,n?void 0:e,e),!t.some((e=>!ii(s,P.stripLiteralValue(e),i,a)))||(a=new A.TypeVarMap(r),a.setTypeVarType(s,n?void 0:e,e,!0),!t.some((e=>!ii(s,e,i,a)))))return P.applySolvedTypeVars(s,a)}function Ft(e,t,n,i,s,r){if("none"===e)return;const a=n.value,o=F.removeUnbound(i);if(F.isUnknown(o))Ue(e,t,h.Localizer.Diagnostic.typeUnknown().format({name:a}),s);else if(P.isPartlyUnknown(o)&&(!r||!F.isObject(i)||!i.classType.isEmptyContainer)){const n=new l.DiagnosticAddendum;n.addMessage(h.Localizer.DiagnosticAddendum.typeOfSymbol().format({name:a,type:yi(o,!0)})),Ue(e,t,h.Localizer.Diagnostic.typePartiallyUnknown().format({name:a})+n.getString(),s)}}function Pt(e,t,n){for(const t of e.comprehensions)if(33===t.nodeType){const e=he(t.iterableExpression),n=De(P.stripLiteralValue(e.type),!!t.isAsync,t.iterableExpression)||F.UnknownType.create();$e(t.targetExpression,n,!!e.isIncomplete,t.iterableExpression)}else o.assert(34===t.nodeType),j.isSpeculative(t.testExpression)||he(t.testExpression);let i=F.UnknownType.create();if(17===e.expression.nodeType){let s=he(e.expression.keyExpression,n).type;n&&P.containsLiteralType(n)||(s=P.stripLiteralValue(s));let r=he(e.expression.valueExpression,t).type;t&&P.containsLiteralType(t)||(r=P.stripLiteralValue(r)),i=nt([s,r])}else 16===e.expression.nodeType?he(e.expression.expandExpression,t):m.isExpressionNode(e)&&(i=P.stripLiteralValue(he(e.expression,t).type));return i}function At(e,t=!1,n=!1,i=!1){if(e.typeList)return Re(h.Localizer.Diagnostic.typeArgListNotAllowed(),e.node),!1;if(P.isEllipsisType(e.type))return Re(h.Localizer.Diagnostic.ellipsisContext(),e.node),!1;if(F.isModule(e.type))return Re(h.Localizer.Diagnostic.moduleContext(),e.node),!1;if(F.isParamSpec(e.type)&&!i)return Re(h.Localizer.Diagnostic.paramSpecContext(),e.node),!1;if(F.isVariadicTypeVar(e.type)){if(!n)return Re(h.Localizer.Diagnostic.typeVarTupleContext(),e.node),!1;et(e.type,e.node)}return!(!t&&e.isEmptyTupleShorthand)||(Re(h.Localizer.Diagnostic.zeroLengthTupleNotAllowed(),e.node),!1)}function Et(e,t,n){const i=En(e,t);return F.isObject(i)?F.ObjectType.create(F.ClassType.cloneWithLiteral(i.classType,n)):F.UnknownType.create()}function wt(e,t,n){const i=En(e,t);return F.isObject(i)?F.ClassType.cloneWithLiteral(i.classType,n):F.UnknownType.create()}function Nt(e,t,n,i=!1){const s=F.ClassType.isTupleClass(e);if(t)if(s&&1===t.length&&t[0].isEmptyTupleShorthand)t=[];else{let e=!1,r=!1;t.forEach(((a,o)=>{P.isEllipsisType(a.type)?s?2!==t.length||1!==o?Re(h.Localizer.Diagnostic.ellipsisSecondArg(),a.node):F.isTypeVar(t[0].type)&&F.isVariadicTypeVar(t[0].type)&&Re(h.Localizer.Diagnostic.typeVarTupleContext(),t[0].node):Re(h.Localizer.Diagnostic.ellipsisContext(),a.node):F.isParamSpec(a.type)&&i||(F.isVariadicTypeVar(a.type)&&void 0===n?(e&&(r||(Re(h.Localizer.Diagnostic.variadicTypeArgsTooMany(),a.node),r=!0)),et(a.type,a.node),e=!0):At(a))}))}let r=t?t.map((e=>P.convertToInstance(e.type))):[];if(void 0!==n)if(t&&r.length>n)Re(h.Localizer.Diagnostic.typeArgsTooMany().format({name:e.aliasName||e.details.name,expected:n,received:r.length}),t[n].node),r=r.slice(0,n);else if(r.length<n)for(;r.length<n;)r.push(F.UnknownType.create());return s?(t||(r.push(F.UnknownType.create()),r.push(F.AnyType.create(!0))),P.specializeTupleClass(e,r,void 0!==t)):F.ClassType.cloneForSpecialization(e,r,void 0!==t)}function Ot(e,t){var n,i,s,r;const a=v.getEnclosingClass(e,!0);if(a){const o=Vt(a);if(o&&F.ClassType.isEnumClass(o.classType)){let a=3===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&e.parent.leftExpression===e||54===(null===(i=e.parent)||void 0===i?void 0:i.nodeType)&&e.parent.valueExpression===e&&3===(null===(s=e.parent.parent)||void 0===s?void 0:s.nodeType)||Rn(e).isStubFile&&54===(null===(r=e.parent)||void 0===r?void 0:r.nodeType)&&e.parent.valueExpression===e;I.isSingleDunderName(e.value)&&(a=!1),"name"!==e.value&&"value"!==e.value||(a=!1);const l=t();if(F.isObject(l)&&l.classType.details.fields.get("__get__")&&(a=!1),a)return F.ObjectType.create(F.ClassType.cloneWithLiteral(o.classType,new F.EnumLiteral(o.classType.details.name,e.value,l)))}}}function Rt(e,t,n){if(!F.TypeBase.isInstantiable(e))return e;if(P.isTypeAliasPlaceholder(e))return e;let i=[];F.isTypeVar(e)&&!F.TypeBase.isAnnotated(e)||P.doForEachSubtype(e,(e=>{P.addTypeVarsToListIfUnique(i,P.getTypeVarArgumentsRecursive(e))})),i=i.filter((e=>!e.details.isSynthesized));const s=i.filter((e=>F.isVariadicTypeVar(e)));s.length>1&&Re(h.Localizer.Diagnostic.variadicTypeParamTooManyAlias().format({names:s.map((e=>`"${e.details.name}"`)).join(", ")}),n);const r=Rn(t);return F.TypeBase.cloneForTypeAlias(e,t.value,`${r.moduleName}.${t.value}`,He(t),i.length>0?i:void 0)}function Mt(t,n,i){const s=Rn(t);let r=F.ClassType.create(n,gt(t,s.moduleName,n),s.moduleName,s.filePath,3,0,void 0,void 0);s.isTypingExtensionsStubFile&&(r.details.flags|=65536);const a=i.alias||"object";let o;if("builtins"===i.module)o=An(t,a);else if("collections"===i.module){if(s.collectionsModulePath){const t=e(s.collectionsModulePath);if(t){const e=t.symbolTable.get(a);e&&(o=zn(e))}}}else if("self"===i.module){const e=wn(t,a,!1);e&&(o=zn(e.symbol),F.isClass(o)&&F.ClassType.isBuiltIn(o,"_TypedDict")&&(o.details.flags&=-1537))}return o&&F.isClass(o)?i.alias?r=F.ClassType.cloneForTypingAlias(o,n):(r.details.baseClasses.push(o),r.details.effectiveMetaclass=o.details.effectiveMetaclass,P.computeMroLinearization(r)):(r.details.baseClasses.push(F.UnknownType.create()),r.details.effectiveMetaclass=F.UnknownType.create(),P.computeMroLinearization(r)),r}function Lt(e){var t;const n=Rn(e);if(ie(e))return;let i,s=ie(e.rightExpression),r=!1;if(!s&&((n.isTypingStubFile||n.isTypingExtensionsStubFile)&&(s=function(e){if(38!==e.leftExpression.nodeType)return;const t=e.leftExpression.value;if("Any"===t)return F.AnyType.create();const n={overload:{alias:"",module:"builtins"},TypeVar:{alias:"",module:"builtins"},_promote:{alias:"",module:"builtins"},no_type_check:{alias:"",module:"builtins"},NoReturn:{alias:"",module:"builtins"},Counter:{alias:"Counter",module:"collections"},List:{alias:"list",module:"builtins"},Dict:{alias:"dict",module:"builtins"},DefaultDict:{alias:"defaultdict",module:"collections"},Set:{alias:"set",module:"builtins"},FrozenSet:{alias:"frozenset",module:"builtins"},Deque:{alias:"deque",module:"collections"},ChainMap:{alias:"ChainMap",module:"collections"},OrderedDict:{alias:"OrderedDict",module:"collections"}}[t];return n?Mt(e,t,n):void 0}(e),s&&se(e.rightExpression,s,!1)),!s)){const a=Ce(e.leftExpression);let o,p=2;n.isStubFile&&(p|=256);let u,d=!1;if(Se(e.leftExpression))p|=232,o=e.leftExpression.valueExpression;else if(38===e.leftExpression.nodeType){const t=wn(e.leftExpression,e.leftExpression.value,!1);if(t){const n=t.symbol.getDeclarations();1===n.length&&_.isPossibleTypeAliasDeclaration(n[0])&&(o=e.leftExpression,d=!0)}}if(o){u=F.TypeVarType.createInstantiable(`__type_alias_${o.value}`),u.details.isSynthesized=!0,u.details.recursiveTypeAliasName=o.value;const t=He(o);u.details.recursiveTypeAliasScopeId=t,u.scopeId=t,se(e,u,!1),se(e.leftExpression,u,!1)}const m=he(e.rightExpression,a,p);let y=m.type;i=m.expectedTypeDiagAddendum,m.isIncomplete&&(r=!0);const g=S.evaluateStaticBoolExpression(e.rightExpression,n.executionEnvironment);if(void 0!==g){const t=En(e,"bool");F.isObject(t)&&(y=F.ObjectType.create(F.ClassType.cloneWithLiteral(t.classType,g)))}if(a){ii(a,y,new l.DiagnosticAddendum)&&(y=li(a,y))}s=y,38!==e.leftExpression.nodeType||e.typeAnnotationComment||(s=Ot(e.leftExpression,(()=>s))||s),o&&(re(e),re(e.leftExpression),(!d||F.TypeBase.isInstantiable(s)&&!F.isUnknown(s))&&(s=Rt(s,o,e.rightExpression),P.isTypeAliasRecursive(u,s)&&Ue(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeAliasIsRecursive().format({name:o.value}),e.rightExpression),u.details.boundType=s,u.details.recursiveTypeParameters=null===(t=s.typeAliasInfo)||void 0===t?void 0:t.typeParameters))}$e(e.leftExpression,s,r,e.rightExpression,!0,i),se(e,s,r)}function Ut(e){if(ie(e))return;const t=bt(e,void 0);$e(e.destExpression,t.type,!!t.isIncomplete,e.rightExpression),se(e,t.type,!!t.isIncomplete)}function Vt(e){const t=ie(e.name);if(t){if(!F.isClass(t))return;return{classType:t,decoratedType:ie(e)||F.UnknownType.create()}}const n=b.getScopeForNode(e),i=Rn(e);let s=0;(4===(null==n?void 0:n.type)||i.isTypingStubFile||i.isTypingExtensionsStubFile||i.isBuiltInStubFile)&&(s|=1,i.isTypingExtensionsStubFile&&(s|=65536),"property"===e.name.value&&(s|=2048),"tuple"===e.name.value&&(s|=524288));const r=F.ClassType.create(e.name.value,gt(e,i.moduleName,e.name.value),i.moduleName,i.filePath,s,0,void 0,void 0,v.getDocString(e.suite.statements));r.details.typeVarScopeId=He(e);const a=null==n?void 0:n.lookUpSymbol(e.name.value);let o;const p=f.getDeclaration(e);p&&(o=p),o&&pe(a,o,r),r.details.flags|=131072,se(e,r,!1),se(e.name,r,!1);const m=[];let y;const g=[];let T,_=10816;i.isStubFile&&(_|=4),e.arguments.forEach((e=>{if(e.name)if("metaclass"===e.name.value)T?Re(h.Localizer.Diagnostic.metaclassDuplicate(),e):T=e.valueExpression;else if("total"===e.name.value&&F.ClassType.isTypedDictClass(r)){const t=S.evaluateStaticBoolExpression(e.valueExpression,i.executionEnvironment);void 0===t?Re(h.Localizer.Diagnostic.typedDictTotalParam(),e.valueExpression):t||(r.details.flags|=256)}else g.push({argumentCategory:0,node:e,name:e.name,valueExpression:e.valueExpression});else{let t=he(e.valueExpression,void 0,_).type;if(F.isUnion(t)&&(t=F.removeUnbound(t)),F.isAnyOrUnknown(t)||F.isUnbound(t)||(t=P.transformTypeObjectToClass(t),F.isClass(t)?(F.ClassType.isBuiltIn(t,"Protocol")&&(!i.isStubFile&&!F.ClassType.isTypingExtensionClass(t)&&i.executionEnvironment.pythonVersion<u.PythonVersion.V3_7&&Re(h.Localizer.Diagnostic.protocolIllegal(),e.valueExpression),r.details.flags|=8192),F.ClassType.isBuiltIn(t,"property")&&(r.details.flags|=2048),i.executionEnvironment.pythonVersion>=u.PythonVersion.V3_6&&F.ClassType.isBuiltIn(t,"NamedTuple")&&(r.details.flags|=4),F.ClassType.isBuiltIn(t,"TypedDict")||F.ClassType.isTypedDictClass(t)?r.details.flags|=128:F.ClassType.isTypedDictClass(r)&&!F.ClassType.isTypedDictClass(t)&&Re(h.Localizer.Diagnostic.typedDictBaseClass(),e),P.derivesFromClassRecursive(t,r,!0)&&(Re(h.Localizer.Diagnostic.baseClassCircular(),e),t=F.UnknownType.create())):(Ue(i.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.baseClassInvalid(),e),t=F.UnknownType.create())),F.isUnknown(t)&&Ue(i.diagnosticRuleSet.reportUntypedBaseClass,c.DiagnosticRule.reportUntypedBaseClass,h.Localizer.Diagnostic.baseClassUnknown(),e),r.details.baseClasses.some((e=>F.isClass(e)&&F.isClass(t)&&F.ClassType.isSameGenericClass(t,e)))&&Ue(i.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.duplicateBaseClass(),e.name||e),r.details.baseClasses.push(t),F.isClass(t)&&(F.ClassType.isEnumClass(t)&&(r.details.flags|=1048576),(F.ClassType.supportsAbstractMethods(t)||F.ClassType.isProtocolClass(t)&&!F.ClassType.isBuiltIn(t))&&(r.details.flags|=512),F.ClassType.isPropertyClass(t)&&(r.details.flags|=2048),F.ClassType.isFinal(t))){const n=mi(t);Re(h.Localizer.Diagnostic.baseClassFinal().format({type:n}),e.valueExpression)}P.addTypeVarsToListIfUnique(m,P.getTypeVarArgumentsRecursive(t)),F.isClass(t)&&F.ClassType.isBuiltIn(t,"Generic")&&(y||(y=[],P.addTypeVarsToListIfUnique(y,P.getTypeVarArgumentsRecursive(t))))}})),r.details.baseClasses.length>1&&r.details.baseClasses.some((e=>F.isClass(e)&&F.ClassType.isBuiltIn(e,"NamedTuple")))&&Ue(i.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.namedTupleMultipleInheritance(),e.name),F.ClassType.isBuiltIn(r,"object")||r.details.baseClasses.push(An(e,"object")),r.details.typeParameters=y||m;const C=r.details.typeParameters.filter((e=>F.isVariadicTypeVar(e)));C.length>1&&Re(h.Localizer.Diagnostic.variadicTypeParamTooManyClass().format({names:C.map((e=>`"${e.details.name}"`)).join(", ")}),e.name,d.TextRange.combine(e.arguments)||e.name),P.computeMroLinearization(r)||Re(h.Localizer.Diagnostic.methodOrdering(),e.name);const I=b.getScopeForNode(e.suite);if(r.details.fields=(null==I?void 0:I.symbolTable)||new Map,F.ClassType.isTypedDictClass(r)&&Fe(e,r),!i.isStubFile&&0===r.details.typeParameters.length){const t=r.details.fields.get("__init__");if(t){const n=t.getTypedDeclarations();if(1===n.length&&3===n[0].type){const t=n[0].node,i=t.parameters;if(i.length>1&&!i.some(((e,n)=>!!be(t,n)))){const n=i.filter(((e,t)=>t>0&&e.name&&0===e.category));n.length>0&&(r.details.flags|=16384,r.details.typeParameters=n.map((n=>{const i=F.TypeVarType.createInstance(`__type_of_${n.name.value}`);return i.details.isSynthesized=!0,i.scopeId=He(t),i.details.boundType=F.UnknownType.create(),F.TypeVarType.cloneForScopeId(i,He(e),e.name.value)})))}}}}if(0===r.details.typeParameters.length&&(r.details.baseClasses.some((e=>F.isClass(e)&&F.ClassType.hasCustomClassGetItem(e)))||r.details.fields.has("__class_getitem__"))&&(r.details.flags|=262144),T){const e=he(T,void 0,_).type;(F.isClass(e)||F.isUnknown(e))&&(r.details.declaredMetaclass=e,F.isClass(e)&&(F.ClassType.isBuiltIn(e,"EnumMeta")?r.details.flags|=1048576:F.ClassType.isBuiltIn(e,"ABCMeta")&&(r.details.flags|=512)))}let D=r.details.declaredMetaclass,x=!1;if(!D||F.isClass(D))for(const t of r.details.baseClasses){if(!F.isClass(t)){D=F.UnknownType.create();break}{const n=t.details.effectiveMetaclass||H;if(!n||!F.isClass(n)){D=n?F.UnknownType.create():void 0;break}D?P.derivesFromClassRecursive(n,D,!1)?D=n:P.derivesFromClassRecursive(D,n,!1)||x||(Ue(i.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.metaclassConflict(),e.name),x=!0):D=n}}if(!D){const t=An(e,"type");D=t&&F.isClass(t)?t:F.UnknownType.create()}r.details.effectiveMetaclass=D,F.ClassType.supportsAbstractMethods(r)&&ci(r).length>0&&(r.details.flags|=1024);let k=r,E=!1;for(let t=e.decorators.length-1;t>=0;t--){const n=e.decorators[t],s=zt(k,r,n);P.containsUnknown(s)?E||(Ue(i.diagnosticRuleSet.reportUntypedClassDecorator,c.DiagnosticRule.reportUntypedClassDecorator,h.Localizer.Diagnostic.classDecoratorTypeUnknown(),e.decorators[t].expression),E=!0):k=s}if(F.ClassType.isDataClass(r)){let t=F.ClassType.isSkipSynthesizedDataClassInit(r);if(!t){const e=P.lookUpClassMember(r,"__init__",2);if(e){const n=Hn(e);F.isFunction(n)&&F.FunctionType.isSynthesizedMethod(n)||(t=!0)}}ke(e,r,t)}return r.details.flags&=-131073,se(e.name,r,!1),se(e,k,!1),function(e,t,n){const i=n.length>0?n[0].node.name:e.name,s=Je(i,t,"__init_subclass__",{method:"get"},new l.DiagnosticAddendum,133,t);if(s){const e=s.type;e&&dt(i,n,e,new A.TypeVarMap(P.getTypeVarScopeId(e)),!1,F.NoneType.createInstance())}}(e,r,g),{classType:r,decoratedType:k}}function zt(e,t,n){const i=he(n.expression).type;if(F.isOverloadedFunction(i))"dataclass"===i.overloads[0].details.builtInName&&(t.details.flags|=4);else if(F.isFunction(i)){if(9===n.expression.nodeType){const i=he(n.expression.leftExpression).type;if(F.isOverloadedFunction(i)&&"dataclass"===i.overloads[0].details.builtInName)return t.details.flags|=4,n.expression.arguments&&n.expression.arguments.forEach((e=>{if(e.name&&e.valueExpression){const i=Rn(n),s=S.evaluateStaticBoolExpression(e.valueExpression,i.executionEnvironment);!0===s?"order"===e.name.value?t.details.flags|=64:"frozen"===e.name.value&&(t.details.flags|=8,t.details.baseClasses.some((e=>F.isClass(e)&&F.ClassType.isDataClass(e)&&!F.ClassType.isFrozenDataClass(e)))&&Ue(i.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.dataClassBaseClassNotFrozen(),e)):!1===s&&("init"===e.name.value?t.details.flags|=16:"eq"===e.name.value&&(t.details.flags|=32))}})),e}"final"===i.details.builtInName?t.details.flags|=4096:"runtime_checkable"===i.details.builtInName&&(t.details.flags|=32768)}return fe(n,e)}function jt(e){const n=Rn(e),i=ie(e.name);if(i){if(!F.isFunction(i))return;return{functionType:i,decoratedType:ie(e)||F.UnknownType.create()}}let s;const r=f.getDeclaration(e);r&&(s=r);const a=v.getEnclosingClass(e,!0);let o;if(a){const e=Vt(a);if(!e)return;o=e.classType}let p=$t(e,!!a);(null==s?void 0:s.isGenerator)&&(p|=16),a&&"__class_getitem__"===e.name.value&&(p|=2),n.isStubFile?p|=2048:n.isInPyTypedPackage&&t.disableInferenceForPyTypedSources&&(p|=4096),e.isAsync&&(p|=512);const u=F.FunctionType.createInstance(e.name.value,function(e,t,n){const i=[n];let s=e;for(;s;)s=v.getEnclosingClassOrFunction(s),s&&i.push(s.name.value);return i.push(t),i.reverse().join(".")}(e,n.moduleName,e.name.value),n.moduleName,p,v.getDocString(e.suite.statements));u.details.typeVarScopeId=He(e),(n.isBuiltInStubFile||n.isTypingStubFile||n.isTypingExtensionsStubFile)&&(u.details.builtInName=e.name.value),u.details.declaration=s;const d=b.getScopeForNode(e),m=null==d?void 0:d.lookUpSymbolRecursive(e.name.value);s&&m&&pe(m.symbol,s,u),se(e,u,!1),se(e.name,u,!1);const y=o&&F.ClassType.isPseudoGenericClass(o)&&"__init__"===e.name.value,g=[];let T=0,_=0;if(o&&0==(4&u.details.flags)&&(_=1),e.functionAnnotationComment&&!e.functionAnnotationComment.isParamListEllipsis){const t=e.parameters.length-_,n=e.functionAnnotationComment.paramTypeAnnotations.length;_>0&&n===e.parameters.length?_=0:n!==t&&Re(h.Localizer.Diagnostic.annotatedParamCountMismatch().format({expected:t,received:n}),e.functionAnnotationComment)}if(e.parameters.forEach(((t,i)=>{let s,r,a,p,d=!1;if(t.typeAnnotation)a=t.typeAnnotation;else if(t.typeAnnotationComment)a=t.typeAnnotationComment;else if(e.functionAnnotationComment&&!e.functionAnnotationComment.isParamListEllipsis){const t=i-_;t>=0&&t<e.functionAnnotationComment.paramTypeAnnotations.length&&(a=e.functionAnnotationComment.paramTypeAnnotations[t])}if(a&&(r=ge(a,!1,!0,1===t.category),F.isVariadicTypeVar(r)&&!r.isVariadicUnpacked&&(Re(h.Localizer.Diagnostic.unpackedTypeVarTupleExpected().format({name1:r.details.name,name2:r.details.name}),a),r=F.UnknownType.create())),!r&&y&&i>0&&0===t.category&&t.name&&(r=o.details.typeParameters[T],T++),r&&t.defaultValue&&11===t.defaultValue.nodeType&&26===t.defaultValue.constType&&(d=!0,n.diagnosticRuleSet.strictParameterNoneValue||(r=F.combineTypes([r,F.NoneType.createInstance()]))),t.defaultValue&&(p=he(t.defaultValue,r,1).type),r){if(t.defaultValue&&p){const i=new l.DiagnosticAddendum,s=new A.TypeVarMap(u.details.typeVarScopeId);if(o&&void 0!==o.details.typeVarScopeId&&("__init__"!==e.name.value&&"__new__"!==e.name.value||s.addSolveForScope(o.details.typeVarScopeId)),!ii(r,p,i,s)){const e=Ue(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramAssignmentMismatch().format({sourceType:yi(p),paramType:yi(r)})+i.getString(),t.defaultValue);if(d&&a){const t={action:"pyright.addoptionalforparam",offsetOfTypeNode:a.start+1};e&&e.addAction(t)}}}s=r}const m={category:t.category,name:t.name?t.name.value:void 0,hasDefault:!!t.defaultValue,defaultValueExpression:t.defaultValue,defaultType:p,type:s||F.UnknownType.create(),typeAnnotation:a,hasDeclaredType:!!a};if(F.FunctionType.addParameter(u,m),t.name){const n=Wt(e,t.category,m.type);g.push(n)}else g.push(m.type)})),o&&u.details.parameters.length>0){if(!be(e,0)){const t=Bt(u.details.flags,o,e);t&&(u.details.parameters[0].type=t,F.isAnyOrUnknown(t)||(u.details.parameters[0].isTypeInferred=!0),g[0]=t)}}if(g.forEach(((t,n)=>{const i=e.parameters[n].name;i&&(F.isUnknown(t)&&(u.details.flags|=16384),se(i,t,!1))})),e.returnTypeAnnotation){u.details.declaredReturnType=F.UnknownType.create();const t=ge(e.returnTypeAnnotation,!1,!0);u.details.declaredReturnType=t}else if(e.functionAnnotationComment){u.details.declaredReturnType=F.UnknownType.create();const t=ge(e.functionAnnotationComment.returnTypeAnnotation,!1,!0);u.details.declaredReturnType=t}else n.isStubFile&&("__init__"===e.name.value?u.details.declaredReturnType=F.NoneType.createInstance():u.details.declaredReturnType=F.UnknownType.create());let S=e.isAsync?function(e,t){const n=F.FunctionType.clone(t);t.details.declaredReturnType&&(n.details.declaredReturnType=Kt(e,t.details.declaredReturnType));return n.details.flags|=1024,n}(e,u):u,C=!1;for(let t=e.decorators.length-1;t>=0;t--){const i=e.decorators[t],s=qt(S,u,i,e);P.containsUnknown(s)?C||(Ue(n.diagnosticRuleSet.reportUntypedFunctionDecorator,c.DiagnosticRule.reportUntypedFunctionDecorator,h.Localizer.Diagnostic.functionDecoratorTypeUnknown(),e.decorators[t].expression),C=!0):S=s}return F.isFunction(S)&&(S=function(e,t){let n;const i=f.getDeclaration(e);i&&(n=i);const s=wn(e,e.name.value,!1);if(s){const i=s.symbol.getDeclarations(),r=i.findIndex((e=>e===n));if(r>0){for(let e=0;e<r;e++){const t=i[e];3===t.type&&jt(t.node)}const n=[],s=i[r-1];if(3===s.type){const e=jt(s.node);e&&(F.isFunction(e.decoratedType)?F.FunctionType.isOverloaded(e.decoratedType)&&n.push(e.decoratedType):F.isOverloadedFunction(e.decoratedType)&&n.push(...e.decoratedType.overloads))}if(n.push(t),1===n.length)return n[0];const a=F.OverloadedFunctionType.create(n),o=n[n.length-2];return F.FunctionType.isAbstractMethod(o)!==F.FunctionType.isAbstractMethod(t)&&Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.overloadAbstractMismatch().format({name:e.name.value}),e.name),a}}return t}(e,S)),se(e.name,u,!1),se(e,S,!1),{functionType:u,decoratedType:S}}function Bt(e,t,n){if(0==(4&e)&&t){const i=3&e,s=F.TypeVarType.createInstance(`__type_of_self_${t.details.name}`),r=He(n);if(s.details.isSynthesized=!0,s.details.isSynthesizedSelfCls=!0,s.nameWithScope=F.TypeVarType.makeNameWithScope(s.details.name,r),s.scopeId=r,s.details.boundType=F.ObjectType.create(P.selfSpecializeClassType(t,!0)),!i)return s;const a=Pe(n,"Type");return a&&F.isClass(a)?F.ObjectType.create(F.ClassType.cloneForSpecialization(a,[s],!0)):F.AnyType.create()}}function Wt(e,t,n){switch(t){case 0:return n;case 1:if(Y&&F.isClass(Y)){let e,t=!1;return F.isVariadicTypeVar(n)&&n.isVariadicUnpacked?(e=[n],t=!0):e=[n,F.AnyType.create(!0)],F.ObjectType.create(P.specializeTupleClass(Y,e,!0,!0,t))}return F.UnknownType.create();case 2:{const t=An(e,"dict"),i=En(e,"str");return F.isClass(t)&&F.isObject(i)?F.ObjectType.create(F.ClassType.cloneForSpecialization(t,[i,n],!0)):F.UnknownType.create()}}}function $t(e,t){const n=Rn(e);let i=0;"__new__"===e.name.value&&t&&(i|=1),"__init_subclass__"===e.name.value&&t&&(i|=2);for(const s of e.decorators){let e=2;n.isStubFile&&(e|=4);const r=he(s.expression,void 0,e).type;F.isFunction(r)?"abstractmethod"===r.details.builtInName?t&&(i|=8):"final"===r.details.builtInName&&(i|=8192):F.isClass(r)&&(F.ClassType.isBuiltIn(r,"staticmethod")?t&&(i|=4):F.ClassType.isBuiltIn(r,"classmethod")&&t&&(i|=2))}return i}function qt(e,t,n,i){let s=2;Rn(n).isStubFile&&(s|=4);const r=he(n.expression,void 0,s).type;if(F.isClass(r)&&F.ClassType.isSpecialBuiltIn(r,"overload")&&F.isFunction(e))return e.details.flags|=256,t.details.flags|=256,e;if(F.isClass(r)&&F.ClassType.isSpecialBuiltIn(r,"no_type_check"))return e;let a=fe(n,e);if(F.isFunction(r)){if("abstractmethod"===r.details.builtInName)return e;if(35===n.expression.nodeType){const t=he(n.expression.leftExpression).type;if(P.isProperty(t)){const s=n.expression.memberName.value;if("setter"===s)return F.isFunction(e)?(Gt(e,n),function(e,t,n){if(!P.isProperty(e))return e;const i=e.classType,s=F.ClassType.create(i.details.name,i.details.fullName,i.details.moduleName,Rn(n).filePath,i.details.flags,i.details.typeSourceId,i.details.declaredMetaclass,i.details.effectiveMetaclass);P.computeMroLinearization(s);const r=F.ObjectType.create(s),a=s.details.fields;i.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||a.set(t,e)}));const o=Rn(n);if("none"!==o.diagnosticRuleSet.reportPropertyTypeMismatch&&n.parameters.length>=2){const e=be(n,1);if(e){const t=ei(i,!1);if(t&&!F.isAnyOrUnknown(t)){const n=ge(e),i=new l.DiagnosticAddendum;ii(t,n,i)||Ue(o.diagnosticRuleSet.reportPropertyTypeMismatch,c.DiagnosticRule.reportPropertyTypeMismatch,h.Localizer.Diagnostic.setterGetterTypeMismatch()+i.getString(),e)}}}const p=C.Symbol.createWithType(4,t);a.set("fset",p);const u=F.FunctionType.createInstance("__set__","","",64);u.details.parameters.push({category:0,name:"self",type:e,hasDeclaredType:!0});let d=t.details.parameters.length>0?t.details.parameters[0].type:F.AnyType.create();F.isTypeVar(d)&&d.details.isSynthesized&&d.details.boundType&&(d=Be(d));u.details.parameters.push({category:0,name:"obj",type:F.combineTypes([d,F.NoneType.createInstance()]),hasDeclaredType:!0}),u.details.declaredReturnType=F.NoneType.createInstance();let m=F.UnknownType.create();t.details.parameters.length>=2&&0===t.details.parameters[1].category&&t.details.parameters[1].name&&(m=t.details.parameters[1].type);u.details.parameters.push({category:0,name:"value",type:m,hasDeclaredType:!0});const y=C.Symbol.createWithType(4,u);return a.set("__set__",y),r}(t,e,i)):e;if("deleter"===s)return F.isFunction(e)?(Gt(e,n),function(e,t,n){if(!P.isProperty(e))return e;const i=e.classType,s=F.ClassType.create(i.details.name,i.details.fullName,i.details.moduleName,Rn(n).filePath,i.details.flags,i.details.typeSourceId,i.details.declaredMetaclass,i.details.effectiveMetaclass);P.computeMroLinearization(s);const r=F.ObjectType.create(s),a=s.details.fields;i.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||a.set(t,e)}));const o=C.Symbol.createWithType(4,t);a.set("fdel",o);const l=F.FunctionType.createInstance("__delete__","","",64);l.details.parameters.push({category:0,name:"self",type:e,hasDeclaredType:!0});let c=t.details.parameters.length>0?t.details.parameters[0].type:F.AnyType.create();F.isTypeVar(c)&&c.details.isSynthesized&&c.details.boundType&&(c=Be(c));l.details.parameters.push({category:0,name:"obj",type:F.combineTypes([c,F.NoneType.createInstance()]),hasDeclaredType:!0}),l.details.declaredReturnType=F.NoneType.createInstance();const p=C.Symbol.createWithType(4,l);return a.set("__delete__",p),r}(t,e,i)):e}}}else if(F.isClass(r)){if(F.ClassType.isBuiltIn(r))switch(r.details.name){case"classmethod":case"staticmethod":return e}if(F.ClassType.isPropertyClass(r))return F.isFunction(e)?(Gt(e,n),function(e,t,n,i){const s=Rn(e),r=An(e,"type"),a=F.ClassType.create(t,gt(e,s.moduleName,`__property_${n.details.name}`),s.moduleName,s.filePath,2048,i,void 0,F.isClass(r)?r:F.UnknownType.create());P.computeMroLinearization(a);const o=F.ObjectType.create(a),l=a.details.fields,c=C.Symbol.createWithType(4,n);l.set("fget",c);const p=F.FunctionType.createInstance("__get__","","",320);p.details.parameters.push({category:0,name:"self",type:o,hasDeclaredType:!0}),p.details.parameters.push({category:0,name:"obj",type:F.NoneType.createInstance(),hasDeclaredType:!0}),p.details.parameters.push({category:0,name:"type",type:F.AnyType.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:F.AnyType.create()}),p.details.declaredReturnType=F.FunctionType.isClassMethod(n)?n.details.declaredReturnType:o,p.details.declaration=n.details.declaration;const u=F.FunctionType.createInstance("__get__","","",320);u.details.parameters.push({category:0,name:"self",type:o,hasDeclaredType:!0});let d=n.details.parameters.length>0?n.details.parameters[0].type:F.AnyType.create();F.isTypeVar(d)&&d.details.isSynthesized&&d.details.boundType&&(d=Be(d));u.details.parameters.push({category:0,name:"obj",type:F.FunctionType.isClassMethod(n)?P.convertToInstance(d):d,hasDeclaredType:!0}),u.details.parameters.push({category:0,name:"type",type:F.AnyType.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:F.AnyType.create()}),u.details.declaredReturnType=n.details.declaredReturnType,u.details.declaration=n.details.declaration,u.details.typeVarScopeId=P.getTypeVarScopeId(n);const h=F.OverloadedFunctionType.create([p,u]),m=C.Symbol.createWithType(4,h);return l.set("__get__",m),["getter","setter","deleter"].forEach((e=>{const t=F.FunctionType.createInstance(e,"","",64);t.details.parameters.push({category:0,name:"self",type:F.AnyType.create(),hasDeclaredType:!0}),t.details.parameters.push({category:0,name:"accessor",type:F.AnyType.create(),hasDeclaredType:!0}),t.details.declaredReturnType=o;const n=C.Symbol.createWithType(4,t);l.set(e,n)})),o}(n,r.details.name,e,gi(n))):F.UnknownType.create()}return F.isFunction(e)&&F.isFunction(a)&&(a=F.FunctionType.clone(a),F.FunctionType.isOverloaded(e)&&(a.details.flags|=256),a.details.docString||(a.details.docString=e.details.docString)),a}function Gt(e,t){F.FunctionType.isStaticMethod(e)&&Ue(Rn(t).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.propertyStaticMethod(),t)}function Kt(e,t){let n;if(F.isObject(t)){const i=t.classType;if(F.ClassType.isBuiltIn(i))if("Generator"===i.details.name){const t=Pe(e,"AsyncGenerator");if(t&&F.isClass(t)){const e=[],s=i.typeArguments;s&&s.length>0&&e.push(s[0]),s&&s.length>1&&e.push(s[1]),n=F.ObjectType.create(F.ClassType.cloneForSpecialization(t,e,!0))}}else["AsyncGenerator","AsyncIterator","AsyncIterable"].some((e=>e===i.details.name))&&(n=t)}if(!n){const i=Pe(e,"Coroutine");n=i&&F.isClass(i)?F.ObjectType.create(F.ClassType.cloneForSpecialization(i,[F.AnyType.create(),F.AnyType.create(),t],!0)):F.UnknownType.create()}return n}function Ht(e,t){var n;if(e.returnTypeAnnotation||(null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation))return;let i=ie(e.suite);if(i)return i;if(!M.has(e.id)){M.set(e.id,!0);try{let n;const s=f.getDeclaration(e);s&&(n=s);const r=!we(e),a=we(e.suite);if(Rn(e).isStubFile)i=F.UnknownType.create();else{if(r)if(t||function(e){if(!e||!e.isMethod||e.returnStatements||e.yieldStatements||!e.raiseStatements)return!1;for(const t of e.raiseStatements){if(!t.typeExpression||t.valueExpression)return!1;const e=he(t.typeExpression).type,n=F.isClass(e)?e:F.isObject(e)?e.classType:void 0;if(!n||!F.ClassType.isBuiltIn(n,"NotImplementedError"))return!1}return!0}(n))i=F.UnknownType.create();else{const t=Pe(e,"NoReturn");i=t&&F.isClass(t)?F.ObjectType.create(t):F.UnknownType.create()}else{const e=[];(null==n?void 0:n.returnStatements)&&n.returnStatements.forEach((t=>{if(Ee(t))if(t.returnExpression){const n=he(t.returnExpression).type;e.push(n||F.UnknownType.create())}else e.push(F.NoneType.createInstance())})),!r&&a&&e.push(F.NoneType.createInstance()),i=F.combineTypes(e),i=F.removeUnbound(i),i=P.removeNoReturnFromUnion(i)}if(null==n?void 0:n.yieldStatements){const t=[];n.yieldStatements.forEach((e=>{if(Ee(e))if(61===e.nodeType){const n=De(he(e.expression).type,!1,e);t.push(n||F.UnknownType.create())}else if(e.expression){const n=he(e.expression).type;t.push(n||F.UnknownType.create())}else t.push(F.NoneType.createInstance())})),0===t.length&&t.push(F.NoneType.createInstance());const s=F.combineTypes(t),r=Pe(e,"Generator");i=r&&F.isClass(r)?F.ObjectType.create(F.ClassType.cloneForSpecialization(r,[s,F.NoneType.createInstance(),P.isNoReturnType(i)?F.NoneType.createInstance():i],!0)):F.UnknownType.create()}}se(e.suite,i,!1)}finally{M.delete(e.id)}}return i}function Yt(e){if(ie(e))return;const t=he(e.iterableExpression),n=De(t.type,!!e.isAsync,e.iterableExpression)||F.UnknownType.create();$e(e.targetExpression,n,!!t.isIncomplete,e.targetExpression),se(e,n,!!t.isIncomplete)}function Qt(e){if(o.assert(void 0!==e.typeExpression),ie(e))return;const t=he(e.typeExpression).type;function n(e,t){if(e=Be(e),F.isAnyOrUnknown(e))return e;if(F.isObject(e)&&(e=P.transformTypeObjectToClass(e)),F.isClass(e))return F.ObjectType.create(e);if(F.isObject(e)){const n=De(e,!1,t)||F.UnknownType.create();return P.mapSubtypes(n,(e=>{if(F.isAnyOrUnknown(e))return e;const t=P.transformTypeObjectToClass(e);return F.isClass(t)?F.ObjectType.create(t):F.UnknownType.create()}))}return F.UnknownType.create()}const i=P.mapSubtypes(t,(t=>{const i=P.getSpecializedTupleType(t);if(i&&i.tupleTypeArguments){const t=i.tupleTypeArguments.map((t=>n(t,e.typeExpression)));return F.combineTypes(t)}return n(t,e.typeExpression)}));e.name&&$e(e.name,i,!1,e.name),se(e,i,!1)}function Jt(e){if(ie(e))return;const t=he(e.expression);let n=t.type;const i=e.parent&&58===e.parent.nodeType&&!!e.parent.isAsync;if(P.isOptionalType(n)){Ue(Rn(e).diagnosticRuleSet.reportOptionalContextManager,c.DiagnosticRule.reportOptionalContextManager,h.Localizer.Diagnostic.noneNotUsableWith(),e.expression),n=F.removeNoneFromUnion(n)}const s=i?"__aenter__":"__enter__",r=P.mapSubtypes(n,(t=>{var n;if(t=Be(t),F.isAnyOrUnknown(t))return t;const r=new l.DiagnosticAddendum,a=new l.DiagnosticAddendum;if(F.isObject(t)){const o=null===(n=Te(e.expression,t,s,{method:"get"},r))||void 0===n?void 0:n.type;if(o){let t;return t=F.isFunction(o)?$n(o):F.UnknownType.create(),i&&(t=Ie(t,e)),t}if(!i){Te(e.expression,t,"__aenter__",{method:"get"},r)&&a.addMessage(h.Localizer.DiagnosticAddendum.asyncHelp())}}return Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotUsableWith().format({type:yi(t),method:s})+a.getString(),e.expression),F.UnknownType.create()})),a=i?"__aexit__":"__exit__";P.doForEachSubtype(n,(t=>{if(t=Be(t),F.isAnyOrUnknown(t))return;const n=new l.DiagnosticAddendum;if(F.isObject(t)){if(Te(e.expression,t,a,{method:"get"},n))return}Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotUsableWith().format({type:yi(t),method:a}),e.expression)})),e.target&&$e(e.target,r,!!t.isIncomplete,e.target),se(e,r,!!t.isIncomplete)}function Zt(e){if(ie(e))return;let t;if(t=e.alias?e.alias:e.module.nameParts[0],!t)return;let n=pn(e,t.value)||F.UnknownType.create();const i=ie(e);i&&F.isModule(i)&&n&&F.isTypeSame(n,i)&&(n=i),ze(t,n,!1),se(e,n,!1)}function Xt(t){var n;if(ie(t))return;const i=t.alias||t.name,s=Rn(t);if((null===(n=t.alias)||void 0===n?void 0:n.value)===t.name.value){const e=wn(t,t.name.value,!0);e&&qe(s,e.symbol,t)}let r=pn(t,i.value);if(!r){const n=t.parent;o.assert(n&&22===n.nodeType),o.assert(!n.isWildcardImport);const i=f.getImportInfo(n.module);if(i&&i.isImportFound&&!i.isNativeLib){const n=i.resolvedPaths[i.resolvedPaths.length-1],a=e(n);let o=!1;if(a){if(o=!0,s.executionEnvironment.pythonVersion>=u.PythonVersion.V3_7||s.isStubFile){const e=a.symbolTable.get("__getattr__");if(e){const t=zn(e);F.isFunction(t)&&(r=$n(t),o=!1)}}}else n||(o=!0);o&&Ue(s.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.importSymbolUnknown().format({name:t.name.value}),t.name)}r||(r=F.UnknownType.create())}ze(i,r,!1),se(t,r,!1)}function en(e){if(ie(e))return;if(!e.parent||63!==e.parent.nodeType)return void o.fail("Expected parent of case statement to be match statement");const t=he(e.parent.subjectExpression);ln(t.type,!!t.isIncomplete,e.pattern),se(e,t.type,!!t.isIncomplete)}function tn(e,t,n){switch(t.nodeType){case 65:return function(e,t,n){if(!n)return e;let i=an(e,t.entries.length,t.starEntryIndex);return i=i.filter((e=>{let n=!0;const i=[];let s=e.isTuple;return t.entries.forEach(((r,a)=>{const o=tn(on(e,a,t.entries.length,t.starEntryIndex),r,!0);a===t.starEntryIndex?F.isObject(o)&&o.classType.tupleTypeArguments&&!P.isOpenEndedTupleClass(o.classType)&&o.classType.tupleTypeArguments?i.push(...o.classType.tupleTypeArguments):s=!1:i.push(o),F.isNever(o)&&(n=!1)})),n&&s&&Y&&F.isClass(Y)&&(e.subtype=F.ObjectType.create(P.specializeTupleClass(Y,i))),n})),F.combineTypes(i.map((e=>e.subtype)))}(e,t,n);case 67:return function(e,t,n){const i=he(t.expression).type;if(!n)return P.mapSubtypes(e,(e=>{if(!ii(i,e,new l.DiagnosticAddendum))return F.isObject(e)&&F.ClassType.isBuiltIn(e.classType,"bool")&&void 0===e.classType.literalValue&&F.isObject(i)&&F.ClassType.isBuiltIn(i.classType,"bool")&&void 0!==i.classType.literalValue?F.ObjectType.create(F.ClassType.cloneWithLiteral(i.classType,!i.classType.literalValue)):e}));return P.mapSubtypes(e,(e=>{if(ii(e,i,new l.DiagnosticAddendum))return i}))}(e,t,n);case 68:return function(e,t,n){const i=he(t.className).type;if(!n){if(t.arguments.length>0)return e;if(!F.isClass(i))return e;if(i.details.typeParameters.length>0)return e;const n=new l.DiagnosticAddendum,s=P.convertToInstance(i);return P.mapSubtypes(e,(e=>{if(!ii(s,e,n))return e}))}if(!F.TypeBase.isInstantiable(i))return Ue(Rn(t).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.DiagnosticAddendum.typeNotClass().format({type:yi(i)}),t.className),F.NeverType.create();return We(i,void 0,((n,i)=>F.isAnyOrUnknown(n)?i:F.isClass(n)?P.mapSubtypes(e,(e=>{const s=Be(e);if(F.isAnyOrUnknown(s))return e;if(F.isObject(s)){let r;if(ii(n,s.classType,new l.DiagnosticAddendum))r=e;else{if(!ii(s.classType,n,new l.DiagnosticAddendum))return;r=P.convertToInstance(i)}let a=[];t.arguments.some((e=>!e.name))&&(a=nn(n));let o=!0;if(t.arguments.forEach(((e,t)=>{const i=sn(e,t,a,n);F.isNever(i)&&(o=!1)})),o)return r}})):void 0))}(e,t,n);case 66:return function(e,t,n){let i=e;if(!n)return t.orPatterns.forEach((e=>{i=tn(i,e,!1)})),i;const s=t.orPatterns.map((e=>{const t=tn(i,e,!0);return i=tn(i,e,!1),t}));return F.combineTypes(s)}(e,t,n);case 70:return function(e,t,n){if(!n)return e;let i=rn(e);return i=i.filter((e=>{let i=!0;return t.entries.forEach((s=>{if(e.typedDict){if(71===s.nodeType){const r=tn(En(t,"str"),s.keyPattern,n);F.isNever(r)&&(i=!1);const a=P.mapSubtypes(r,(t=>{if(F.isAnyOrUnknown(t))return t;if(F.isObject(t)&&F.ClassType.isBuiltIn(t.classType,"str")){if(!P.isLiteralType(t))return F.UnknownType.create();const n=pi(e.typedDict).get(t.classType.literalValue);if(n){const e=tn(n.valueType,s.valuePattern,!0);if(!F.isNever(e))return e}}}));F.isNever(a)&&(i=!1)}}else if(e.dictTypeArgs&&71===s.nodeType){const t=tn(e.dictTypeArgs.key,s.keyPattern,n),r=tn(e.dictTypeArgs.value,s.valuePattern,n);(F.isNever(t)||F.isNever(r))&&(i=!1)}})),i})),F.combineTypes(i.map((e=>e.subtype)))}(e,t,n);case 73:return function(e,t,n){if(!n)return e;const i=he(t.expression).type,s=[];return We(i,void 0,((n,i,r)=>{s.push(We(e,r,((e,s)=>{if(F.isNever(n)||F.isNever(s))return F.NeverType.create();if(F.isAnyOrUnknown(n)||F.isAnyOrUnknown(s))return F.isUnknown(n)||F.isUnknown(s)?F.UnknownType.create():F.AnyType.create();const r=E[12][0];return On(t.expression,(()=>Ct(n,[s],r,t.expression,void 0)))?i:void 0})))})),F.combineTypes(s)}(e,t,n);case 69:return n?e:F.NeverType.create();case 0:return e}}function nn(e){const t=P.lookUpClassMember(e,"__match_args__");if(t){const e=Hn(t);if(F.isObject(e)&&P.isTupleClass(e.classType)&&!P.isOpenEndedTupleClass(e.classType)&&e.classType.tupleTypeArguments){const t=e.classType.tupleTypeArguments;if(!t.some((e=>!F.isObject(e)||!F.ClassType.isBuiltIn(e.classType,"str")||!P.isLiteralType(e))))return t.map((e=>e.classType.literalValue))}}return[]}function sn(e,t,n,i){let s,r;if(e.name?s=e.name.value:t<n.length&&(s=n[t]),s){const e=P.lookUpClassMember(i,s);e&&(r=Hn(e))}return r||(r=F.UnknownType.create()),tn(r,e.pattern,!0)}function rn(e){const t=[];return P.doForEachSubtype(e,(e=>{const n=Be(e);if(F.isAnyOrUnknown(n))t.push({subtype:e,dictTypeArgs:{key:n,value:n}});else if(F.isObject(n))if(F.ClassType.isTypedDictClass(n.classType))t.push({subtype:e,typedDict:n.classType});else{let i;for(const e of n.classType.details.mro)if(F.isClass(e)&&F.ClassType.isBuiltIn(e,"Mapping")){i=e;break}if(i){const s=P.partiallySpecializeType(i,n.classType);s.typeArguments&&s.typeArguments.length>=2&&t.push({subtype:e,dictTypeArgs:{key:s.typeArguments[0],value:s.typeArguments[1]}})}}})),t}function an(e,t,n){const i=[],s=void 0===n?t:t-1;return P.doForEachSubtype(e,(e=>{const t=Be(e);let r;if(F.isAnyOrUnknown(t))i.push({subtype:e,entryTypes:[t],isIndeterminateLength:!0,isTuple:!1});else if(F.isObject(t)){for(const e of t.classType.details.mro){if(!F.isClass(e))break;if(F.ClassType.isBuiltIn(e,"str"))break;if(F.ClassType.isBuiltIn(e,"bytes"))break;if(F.ClassType.isBuiltIn(e,"Sequence")){r=e;break}if(P.isTupleClass(e)){r=e;break}}if(r){const a=P.partiallySpecializeType(r,t.classType);P.isTupleClass(a)?a.tupleTypeArguments&&(P.isOpenEndedTupleClass(a)?i.push({subtype:e,entryTypes:[a.tupleTypeArguments[0]],isIndeterminateLength:!0,isTuple:!0}):a.tupleTypeArguments.length>=s&&(void 0!==n||a.tupleTypeArguments.length===s)&&i.push({subtype:e,entryTypes:a.tupleTypeArguments,isIndeterminateLength:!1,isTuple:!0})):i.push({subtype:e,entryTypes:[a.typeArguments&&a.typeArguments.length>0?a.typeArguments[0]:F.UnknownType.create()],isIndeterminateLength:!0,isTuple:!1})}}})),i}function on(e,t,n,i){if(e.isIndeterminateLength)return i===t?Y&&F.isClass(Y)?F.ObjectType.create(P.specializeTupleClass(Y,[e.entryTypes[0],F.AnyType.create(!0)])):F.UnknownType.create():e.entryTypes[0];if(void 0===i||t<i)return e.entryTypes[t];if(t===i){const t=e.entryTypes.slice(i,i+e.entryTypes.length-n+1);return Y&&F.isClass(Y)?F.ObjectType.create(P.specializeTupleClass(Y,t)):F.UnknownType.create()}{const i=e.entryTypes.length-(n-t);return o.assert(i>=0&&i<e.entryTypes.length),e.entryTypes[i]}}function ln(e,t,n){switch(e=tn(e,n,!0),n.nodeType){case 65:{const i=an(e,n.entries.length,n.starEntryIndex);n.entries.forEach(((e,s)=>{ln(F.combineTypes(i.map((e=>on(e,s,n.entries.length,n.starEntryIndex)))),t,e)}));break}case 66:n.target&&$e(n.target,e,t,n.target),n.orPatterns.forEach((n=>{ln(e,t,n),e=tn(e,n,!1)}));break;case 69:$e(n.target,n.isWildcard?F.AnyType.create():e,t,n.target);break;case 70:{const i=rn(e);n.entries.forEach((e=>{const s=[],r=[];i.forEach((t=>{if(t.typedDict)if(71===e.nodeType){const i=tn(En(n,"str"),e.keyPattern,!0);s.push(i),P.doForEachSubtype(i,(e=>{if(F.isObject(e)&&F.ClassType.isBuiltIn(e.classType,"str")&&P.isLiteralType(e)){const n=pi(t.typedDict).get(e.classType.literalValue);r.push(n?n.valueType:F.UnknownType.create())}else r.push(F.UnknownType.create())}))}else 72===e.nodeType&&(s.push(En(n,"str")),r.push(F.UnknownType.create()));else if(t.dictTypeArgs)if(71===e.nodeType){const n=tn(t.dictTypeArgs.key,e.keyPattern,!0);s.push(n),r.push(tn(t.dictTypeArgs.value,e.valuePattern,!0))}else 72===e.nodeType&&(s.push(t.dictTypeArgs.key),r.push(t.dictTypeArgs.value))}));const a=F.combineTypes(s),o=F.combineTypes(r);if(71===e.nodeType)ln(a,t,e.keyPattern),ln(o,t,e.valuePattern);else if(72===e.nodeType){const i=An(n,"dict"),s=En(n,"str"),r=i&&F.isClass(i)&&F.isObject(s)?F.ObjectType.create(F.ClassType.cloneForSpecialization(i,[a,o],!0)):F.UnknownType.create();$e(e.target,r,t,e.target)}}));break}case 68:{const i=n.arguments.map((e=>[]));We(e,void 0,(t=>{F.isObject(t)?P.doForEachSubtype(e,(e=>{const s=Be(e);if(F.isAnyOrUnknown(s))n.arguments.forEach(((e,t)=>{i[t].push(s)}));else if(F.isObject(s)){let e=[];n.arguments.some((e=>!e.name))&&(e=nn(t.classType)),n.arguments.forEach(((n,s)=>{const r=sn(n,s,e,t.classType);i[s].push(r)}))}})):n.arguments.forEach(((e,t)=>{i[t].push(F.UnknownType.create())}))})),n.arguments.forEach(((e,n)=>{ln(F.combineTypes(i[n]),t,e.pattern)}));break}}}function cn(e){if(ie(e))return;const t=e.module.nameParts[0];let n=pn(e,t.value)||F.UnknownType.create();const i=ie(e);i&&F.isModule(i)&&n&&F.isTypeSame(n,i)&&(n=i),ze(t,n,!1),se(e,n,!1)}function pn(e,t){const n=wn(e,t,!0);if(!n)return;const i=n.symbol.getDeclarations().filter((t=>v.isNodeContainedWithin(e,t.node)));let s=i.length>0?i[i.length-1]:void 0;if(s||(s=n.symbol.getDeclarations().find((e=>6===e.type))),!s)return;o.assert(6===s.type);const r=Vn(s,!0);return r?Un(s):r}function un(e){let t=e,n=e;function i(e){var t,n,i;return 41===e.nodeType&&30===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||(1===e.nodeType&&9===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)||(54===(null===(i=e.parent)||void 0===i?void 0:i.nodeType)||(9===e.nodeType||15===e.nodeType||27===e.nodeType||31===e.nodeType||30===e.nodeType||35===e.nodeType||45===e.nodeType||49===e.nodeType||52===e.nodeType||56===e.nodeType||17===e.nodeType||16===e.nodeType||32===e.nodeType||33===e.nodeType||34===e.nodeType||65===e.nodeType||67===e.nodeType||68===e.nodeType||66===e.nodeType||69===e.nodeType||70===e.nodeType||73===e.nodeType)))}if(38===e.nodeType&&e.parent){if(28===e.parent.nodeType&&e.parent.name===e)return void jt(e.parent);if(10===e.parent.nodeType&&e.parent.name===e)return void Vt(e.parent);if(29===e.parent.nodeType||39===e.parent.nodeType)return void he(e,void 0,4)}for(;n;){const e=i(n);if(!e&&!m.isExpressionNode(n))break;e&&(t=n),n=n.parent}const s=t.parent;if(3===s.nodeType)return void(t===s.typeAnnotationComment?ge(t,v.isFinalAllowedForAssignmentTarget(s.leftExpression)):Lt(s));if(5===s.nodeType)return void Ut(s);const r=e=>{const t=e.parent;if(3===(null==t?void 0:t.nodeType)&&t.leftExpression===s)Lt(t);else{const t=ge(e.typeAnnotation,v.isFinalAllowedForAssignmentTarget(e.valueExpression));t&&se(e.valueExpression,t,!1)}};if(64===s.nodeType)return void en(s);if(54===s.nodeType)return void r(s);if(37===s.nodeType)return;if(1===s.nodeType&&t===s.name)return;if(44===s.nodeType&&s.returnExpression){const t=v.getEnclosingFunction(e),n=t?Kn(t):void 0;return void he(s.returnExpression,n,0)}const a=m.isExpressionNode(s)&&0!==s.nodeType?s:t;if(54===a.nodeType)r(a);else{const e=Rn(a).isStubFile?4:0;he(a,void 0,e)}}function dn(e){o.assert(void 0!==e.name);const t=e.parent;if(30===t.nodeType)return void un(t);o.assert(28===t.nodeType);const n=t,i=n.parameters.findIndex((t=>t===e)),s=be(n,i);if(s)se(e.name,Wt(e,e.category,ge(s,!1,!0,1===n.parameters[i].category)),!1);else{if(0===i){const t=v.getEnclosingClass(n,!0);if(t){const i=Vt(t);if(i){const t=Bt($t(n,!0),i.classType,n);return void se(e.name,t||F.UnknownType.create(),!1)}}}se(e.name,Wt(e,e.category,F.UnknownType.create()),!1)}}function hn(e){let t=e;for(;t;){switch(t.nodeType){case 3:if(!(t.parent&&(3===t.parent.nodeType||4===t.parent.nodeType||5===t.parent.nodeType)&&t.parent.rightExpression===t))return void Lt(t);break;case 4:return void he(t);case 5:return void Ut(t);case 10:return void Vt(t);case 41:return void dn(t);case 30:return void un(t);case 28:return void jt(t);case 26:return void Yt(t);case 25:return void Qt(t);case 59:return void Jt(t);case 33:{const e=t.parent;return o.assert(32===e.nodeType),void un(e)}case 21:return void Zt(t);case 23:return void Xt(t);case 22:return void cn(t);case 64:return void en(t)}t=t.parent}o.fail("Unexpected assignment target")}function mn(e,t){const n=f.getImportInfo(e.node.module);o.assert(void 0!==n&&n.isImportFound),o.assert(e.node.isWildcardImport);const i=wn(e.node,t,!1);o.assert(void 0!==i);const s=i.symbol.getDeclarations().find((t=>t.node===e.node));return s&&Un(s)||F.UnknownType.create()}function yn(e){var t;if(38===e.nodeType){const n=wn(e,e.value,!1);if(!n)return;const i=n.symbol,s=Wn(i);if(s)return s;const r=i.getDeclarations();if(0===r.length)return;const a=r[r.length-1];return 2===a.type?null===(t=gn(a.node.name,(()=>{dn(a.node)})))||void 0===t?void 0:t.type:6===a.type?Un(a):void 0}if(35===e.nodeType){const t=e.memberName.value;let n=yn(e.leftExpression);if(!n)return;n=Be(n);const i=P.mapSubtypes(n,(e=>{let n;if(F.isModule(e))n=F.ModuleType.getField(e,t);else if(F.isClass(e)){const i=P.lookUpClassMember(e,t);n=i?i.symbol:void 0}else if(F.isObject(e)){const i=P.lookUpClassMember(e.classType,t);n=i?i.symbol:void 0}return n?Wn(n):void 0}));if(!F.isNever(i))return i}}function gn(e,t){let n=ie(e);if(n)return{node:e,type:n};const i=Q;try{if(Q=new Map,t(),n=ie(e),n)return{node:e,type:n};if(n=Q.get(e.id),n)return{node:e,type:n,isIncomplete:!0}}finally{Q=i}}function fn(e,t){var n;if(U.has(e.id))return U.get(e.id);U.set(e.id,!1);let i=!1;if(9===e.nodeType){const s=yn(e.leftExpression);if(s&&F.isClass(s)){const r=t?"__aexit__":"__exit__",a=null===(n=Te(e.leftExpression,F.ObjectType.create(s),r))||void 0===n?void 0:n.type;if(a&&F.isFunction(a)&&a.details.declaredReturnType){const e=a.details.declaredReturnType;i=F.isObject(e)&&F.ClassType.isBuiltIn(e.classType,"bool")}}}return U.set(e.id,i),i}function Tn(e){if(L.has(e.id))return L.get(e.id);L.set(e.id,!1);let t=!1;const n=yn(e.leftExpression);return n&&P.doForEachSubtype(n,(e=>{let n;if(F.isFunction(e))n=e;else if(F.isOverloadedFunction(e)){const t=e;n=t.overloads[t.overloads.length-1]}if(n&&!F.FunctionType.isAsync(n))if(n.details.declaredReturnType)P.isNoReturnType(n.details.declaredReturnType)&&(t=!0);else if(n.details.declaration&&!(n.details.declaration.yieldStatements||F.FunctionType.isAbstractMethod(n)||F.FunctionType.isStubDefinition(n)||F.FunctionType.isPyTypedDefinition(n))){const e=n.details.declaration.node.suite.statements;let i=!1;for(const t of e){if(47!==t.nodeType||1!==t.statements.length)break;const e=t.statements[0];if(48!==e.nodeType){if(43===e.nodeType&&e.typeExpression){const t=e=>38===(null==e?void 0:e.nodeType)&&"NotImplementedError"===e.value;(t(e.typeExpression)||9===e.typeExpression.nodeType&&t(e.typeExpression.leftExpression))&&(i=!0)}break}}i||we(n.details.declaration.node)||(t=!0)}})),L.set(e.id,t),t}function _n(e){let t=V.get(e);return t||(t=Sn(),V.set(e,t)),t}function vn(e,t,n){const i=T.createKeyForReference(e),s=v.getExecutionScopeNode(e),r=f.getCodeFlowExpressions(s);if(o.assert(void 0!==r),!r.has(i))return{type:void 0,isIncomplete:!1};const a=v.getExecutionScopeNode(e);let l;l=ae(a)?function(){const e=X.length;return o.assert(e>0),X[e-1].codeFlowAnalyzer}():_n(a.id);const c=f.getFlowNode(e);return void 0===c?{type:void 0,isIncomplete:!1}:bn(l,c,e,t,n)}function bn(e,t,n,i,s){let r;$.enterTrackingScope();try{r=e.getTypeFromCodeFlow(t,n,i,s)}finally{$.exitTrackingScope()}return r.isIncomplete&&$.enableUndoTracking(),{type:r.type,isIncomplete:r.isIncomplete}}function Sn(){const e=new Map;return{getTypeFromCodeFlow:function(t,n,i,s){const r=void 0!==n&&void 0!==i?T.createKeyForReference(n)+`.${i.toString()}`:".";let a=e.get(r);function l(e,t,n){if(n){const n=a.get(e.id);if(void 0===n)J++;else if(t&&n.isIncompleteType){const e=n;e.type&&!F.isTypeSame(e.type,t)&&J++}}else J++;const i=n?{isIncompleteType:!0,type:t,incompleteSubtypes:[],generationCount:J}:t;return a.set(e.id,i),j.trackEntry(a,e.id),{type:t,isIncomplete:n,generationCount:J,incompleteSubtypes:n?[]:void 0}}function c(e,t,n){const i=a.get(e.id);void 0!==i&&x.isIncompleteType(i)||o.fail("setIncompleteSubtype can be called only on a valid incomplete cache entry");const s=i.incompleteSubtypes;return t<s.length?s[t]=n:(o.assert(s.length===t),s.push(n)),J++,u(e)}function p(e){a.delete(e.id)}function u(e){if(!a.has(e.id))return;const t=a.get(e.id);if(void 0===t)return{type:t,isIncomplete:!1};if(!x.isIncompleteType(t))return{type:t,isIncomplete:!1};let n=t.type;if(t.incompleteSubtypes.length>0){const e=[];t.incompleteSubtypes.forEach((t=>{t&&e.push(t)})),n=e.length>0?F.combineTypes(e):void 0}return{type:n,isIncomplete:!0,incompleteSubtypes:t.incompleteSubtypes,generationCount:t.generationCount}}function d(e){let t=e.node;const n=e.node.parent;return n&&(28!==n.nodeType&&10!==n.nodeType||(t=n)),gn(t,(()=>{hn(e.node)}))}return a||(a=new Map,e.set(r,a)),t?function e(t,n,i,s){let r=t;for(ne();;){const t=u(r);if(t&&(!t.isIncomplete||t.generationCount===J))return t;if(r.flags&T.FlowFlags.Unreachable)return l(r,void 0,!1);if(r.flags&T.FlowFlags.VariableAnnotation){r=r.antecedent}else if(r.flags&T.FlowFlags.Call){const e=r;if(Tn(e.node))return l(r,void 0,!1);r=e.antecedent}else if(r.flags&T.FlowFlags.Assignment){const e=r;if(n){if(i===e.targetSymbolId&&v.isMatchingExpression(n,e.node)){if(r.flags&T.FlowFlags.Unbind)return l(r,F.UnboundType.create(),!1);if(t&&void 0===t.type)return{type:void 0,isIncomplete:!0};l(r,void 0,!0);let n=d(e);return n&&P.isTypeAliasPlaceholder(n.type)&&(n=void 0),l(r,null==n?void 0:n.type,!!(null==n?void 0:n.isIncomplete))}if(v.isPartialMatchingExpression(n,e.node))return l(r,s,!1)}r=e.antecedent}else if(r.flags&T.FlowFlags.AssignmentAlias){const e=r;i===e.targetSymbolId&&(i=e.aliasSymbolId),r=e.antecedent}else{if(r.flags&T.FlowFlags.BranchLabel){if(r.flags&T.FlowFlags.PostContextManager){const e=r;if(!e.expressions.some((t=>fn(t,e.isAsync))))return l(r,void 0,!1)}const t=[];let a=!1;r.antecedents.forEach((r=>{const o=e(r,n,i,s);o.isIncomplete&&(a=!0),o.type&&t.push(o.type)}));const o=F.combineTypes(t);return l(r,o,a)}if(r.flags&T.FlowFlags.LoopLabel){const t=r;let a=!1,o=!1,d=u(r);return void 0===d&&(o=!0,d=l(r,void 0,!0)),t.antecedents.forEach(((t,o)=>{if(o>=d.incompleteSubtypes.length){d=c(r,o,void 0);const l=e(t,n,i,s);l.isIncomplete&&0===o&&(a=!0),d=c(r,o,l.type)}})),o?a?(p(r),{type:d.type,isIncomplete:!0}):l(r,d.type,!1):d}if(r.flags&(T.FlowFlags.TrueCondition|T.FlowFlags.FalseCondition)){const t=r;if(n){const a=In(n,t);if(a){const o=e(t.antecedent,n,i,s);let c=o.type;return c&&(c=a(c)),l(r,c,o.isIncomplete)}}r=t.antecedent}else if(r.flags&(T.FlowFlags.TrueNeverCondition|T.FlowFlags.FalseNeverCondition)){const e=r;if(e.reference){const t=wn(e.reference,e.reference.value,!1);if(t&&t.symbol.getTypedDeclarations().length>0){const t=In(e.reference,e);if(t){const n=he(e.reference),i=t(n.type)||n.type;if(F.isNever(i))return l(r,void 0,!!n.isIncomplete)}}}r=e.antecedent}else if(r.flags&T.FlowFlags.PreFinallyGate){const e=r;if(e.isGateClosed)return{type:void 0,isIncomplete:!1};r=e.antecedent}else{if(r.flags&T.FlowFlags.PostFinally){const t=r,a=t.preFinallyGate.isGateClosed;try{let o;return t.preFinallyGate.isGateClosed=!0,On(t.finallyNode,(()=>{o=e(t.antecedent,n,i,s)})),o.isIncomplete?o:l(r,o.type,!1)}finally{t.preFinallyGate.isGateClosed=a}}if(r.flags&T.FlowFlags.Start)return l(r,s,!1);if(!(r.flags&T.FlowFlags.WildcardImport))return o.fail("Unexpected flow node flags"),l(r,void 0,!1);{const e=r;if(n&&38===n.nodeType){const t=n.value;if(e.names.some((e=>e===t))){const n=mn(e,t);return l(r,n,!1)}}r=e.antecedent}}}}}(t,n,i,s):{type:s,isIncomplete:!1}}}}function Cn(e,t){const n=new Map;if(r.has(e.id))return!0;r.set(e.id,!0);try{return function e(t,i){let s=t;for(;;){if(n.has(s.id))return!1;if(n.set(s.id,!0),s.flags&T.FlowFlags.Unreachable)return!1;if(s===i)return!0;if(s.flags&(T.FlowFlags.VariableAnnotation|T.FlowFlags.Assignment|T.FlowFlags.AssignmentAlias|T.FlowFlags.TrueCondition|T.FlowFlags.FalseCondition|T.FlowFlags.WildcardImport|T.FlowFlags.TrueNeverCondition|T.FlowFlags.FalseNeverCondition))s=s.antecedent;else{if(!(s.flags&T.FlowFlags.Call)){if(s.flags&(T.FlowFlags.BranchLabel|T.FlowFlags.LoopLabel)){if(s.flags&T.FlowFlags.PostContextManager){const e=s;if(!e.expressions.some((t=>fn(t,e.isAsync))))return!1}const t=s;for(const n of t.antecedents)if(e(n,i))return!0;return!1}if(s.flags&T.FlowFlags.Start)return!i;if(s.flags&T.FlowFlags.PreFinallyGate)return!s.isGateClosed;if(s.flags&T.FlowFlags.PostFinally){const t=s,n=t.preFinallyGate.isGateClosed;try{return t.preFinallyGate.isGateClosed=!0,e(t.antecedent,i)}finally{t.preFinallyGate.isGateClosed=n}}return o.fail("Unexpected flow node flags"),!1}{const e=s;if(void 0===i&&Tn(e.node))return!1;s=e.antecedent}}}}(e,t)}finally{r.delete(e.id)}}function In(e,t){let n=t.expression;const i=!!(t.flags&(T.FlowFlags.TrueCondition|T.FlowFlags.TrueNeverCondition));if(4===n.nodeType&&(v.isMatchingExpression(e,n.rightExpression)?n=n.rightExpression:v.isMatchingExpression(e,n.name)&&(n=n.name)),7===n.nodeType){const t=39===n.operator||40===n.operator,s=12===n.operator||28===n.operator;if(t||s){const r=39===n.operator||12===n.operator?i:!i;if(11===n.rightExpression.nodeType&&26===n.rightExpression.constType){let t=n.leftExpression;if(4===t.nodeType&&(t=t.name),v.isMatchingExpression(e,t))return e=>{const t=P.mapSubtypes(e,(e=>P.transformPossibleRecursiveTypeAlias(e)));return P.mapSubtypes(t,(e=>F.isAnyOrUnknown(e)||F.isNone(e)===r?e:void 0))}}if(t&&9===n.leftExpression.nodeType){const t=he(n.leftExpression.leftExpression).type;if(F.isClass(t)&&F.ClassType.isBuiltIn(t,"type")&&1===n.leftExpression.arguments.length&&0===n.leftExpression.arguments[0].argumentCategory){const t=n.leftExpression.arguments[0].valueExpression;if(v.isMatchingExpression(e,t)){const e=he(n.rightExpression).type;if(F.isClass(e))return t=>P.mapSubtypes(t,(t=>{if(F.isObject(t)){const n=F.ClassType.isDerivedFrom(e,t.classType);return r?n?F.ObjectType.create(e):void 0:t}return F.isNone(t)&&r?void 0:t}))}}}if(t&&v.isMatchingExpression(e,n.leftExpression)){const e=he(n.rightExpression).type;if(F.isObject(e)&&F.ClassType.isEnumClass(e.classType)&&void 0!==e.classType.literalValue)return t=>Dn(t,e,r,!0)}if(s){const t=12===n.operator?i:!i;if(v.isMatchingExpression(e,n.leftExpression)){const e=he(n.rightExpression).type;if(F.isObject(e)&&void 0!==e.classType.literalValue)return n=>Dn(n,e,t,!1)}if(v.isMatchingExpression(e,n.rightExpression)){const e=he(n.leftExpression).type;if(F.isObject(e)&&void 0!==e.classType.literalValue)return n=>Dn(n,e,t,!1)}if(35===n.leftExpression.nodeType&&v.isMatchingExpression(e,n.leftExpression.leftExpression)){const e=he(n.rightExpression).type,i=n.leftExpression.memberName;if(F.isObject(e)&&void 0!==e.classType.literalValue)return n=>function(e,t,n,i){let s=!0;const r=P.mapSubtypes(e,(e=>{let r;if(e=P.transformTypeObjectToClass(e),F.isObject(e)?r=P.lookUpObjectMember(e,t):F.isClass(e)&&(r=P.lookUpClassMember(e,t)),r&&r.isTypeDeclared){const t=Hn(r);if(P.isLiteralTypeOrUnion(t))return i?ii(t,n,new l.DiagnosticAddendum)?e:void 0:ii(n,t,new l.DiagnosticAddendum)?void 0:e}return s=!1,e}));return s?r:e}(n,i.value,e,t)}}}if(41===n.operator&&i&&v.isMatchingExpression(e,n.leftExpression)){const e=he(n.rightExpression).type;return t=>function(e,t){if(!F.isObject(t)||!F.ClassType.isBuiltIn(t.classType))return e;const n=t.classType,i=n.details.name;if(!["list","set","frozenset","deque"].some((e=>e===i)))return e;if(!n.typeArguments||1!==n.typeArguments.length)return e;const s=n.typeArguments[0];let r=!0;const a=P.mapSubtypes(e,(e=>F.isAnyOrUnknown(e)?(r=!1,e):ii(s,e,new l.DiagnosticAddendum)?e:void 0));return r?a:e}(t,e)}if((41===n.operator||42===n.operator)&&v.isMatchingExpression(e,n.rightExpression)){const e=he(n.leftExpression).type;if(F.isObject(e)&&F.ClassType.isBuiltIn(e.classType,"str")&&P.isLiteralType(e)){const t=41===n.operator?i:!i;return n=>function(e,t,n){return P.mapSubtypes(e,(e=>{if(F.isObject(e)&&F.ClassType.isTypedDictClass(e.classType)){const i=pi(e.classType,!0).get(t.literalValue);if(n){if(!i)return;if(i.isRequired)return e;const n=e.classType.typedDictNarrowedEntries,s=new Map;return n&&n.forEach(((e,t)=>{s.set(t,e)})),s.set(t.literalValue,{valueType:i.valueType,isRequired:!0,isProvided:!0}),F.ObjectType.create(F.ClassType.cloneForNarrowedTypedDictEntries(e.classType,s))}return void 0!==i&&i.isRequired?void 0:e}return e}))}(n,e.classType,t)}}}if(9===n.nodeType){if(38===n.leftExpression.nodeType)if("isinstance"!==n.leftExpression.value&&"issubclass"!==n.leftExpression.value||2!==n.arguments.length){if("callable"===n.leftExpression.value&&1===n.arguments.length){const t=n.arguments[0].valueExpression;if(v.isMatchingExpression(e,t))return e=>function(e,t,n){return P.mapSubtypes(e,(e=>{switch(e.category){case 5:case 6:case 7:return t?e:void 0;case 3:case 9:return t?void 0:e;case 8:{const i=P.transformTypeObjectToClass(e);if(F.TypeBase.isInstantiable(i))return t?e:void 0;return Te(n,e,"__call__")?t?e:void 0:t?void 0:e}default:return e}}))}(e,i,n)}}else{const t="isinstance"===n.leftExpression.value,s=n.arguments[0].valueExpression,r=n.arguments[1].valueExpression;if(v.isMatchingExpression(e,s)){const e=function(e){if(e=P.transformTypeObjectToClass(e),F.isClass(e)||F.isTypeVar(e)&&F.TypeBase.isInstantiable(e))return[e];if(F.isObject(e)){const t=e.classType;if(P.isTupleClass(t)&&t.tupleTypeArguments){let e=!1;const n=[];if(t.tupleTypeArguments.forEach((t=>{t=P.transformTypeObjectToClass(t),F.isClass(t)||F.isTypeVar(t)&&F.TypeBase.isInstantiable(t)?n.push(t):e=!0})),!e)return n}}if(F.isUnion(e)){let t=!0;const n=[];if(P.doForEachSubtype(e,(e=>{F.isClass(e)||F.isTypeVar(e)&&F.TypeBase.isInstantiable(e)?n.push(e):t=!1})),t&&n.length>0)return n}return}(he(r,void 0,168).type);if(e)return n=>function(e,t,n,i){const s=P.mapSubtypes(e,(e=>P.transformPossibleRecursiveTypeAlias(e))),r=P.mapSubtypes(s,(e=>P.transformTypeObjectToClass(e))),a=(e,s,r)=>{const a=[];let o=!1,l=!1;for(const r of t){const t=Be(r);if(F.isClass(t)){const n=!F.isTypeVar(r)&&(F.ClassType.isDerivedFrom(e,t)||F.ClassType.isBuiltIn(t,"dict")&&F.ClassType.isTypedDictClass(e)),c=F.ClassType.isDerivedFrom(t,e);n&&(o=!0),c&&n&&!F.ClassType.isSameGenericClass(e,t)&&(l=!0),i&&(n?F.isTypeVar(s)&&0===s.details.constraints.length?a.push(s):a.push(e):c&&a.push(r))}else F.isTypeVar(r)&&F.TypeBase.isInstantiable(r)&&(n&&F.TypeBase.isInstance(s)?F.isTypeVar(s)&&F.isTypeSame(P.convertToInstance(r),s)?i&&a.push(s):i?a.push(P.convertToInstance(r)):(a.push(s),l=!0):!n&&F.TypeBase.isInstantiable(s)&&(F.isTypeVar(s)&&F.isTypeSame(r,s)?i&&a.push(s):i?a.push(r):(a.push(s),l=!0)))}return i||o&&!l||a.push(r),n?a.map((e=>P.convertToInstance(e))):a},o=[],l=[],c=We(r,void 0,((e,s,r)=>{const c=r?e:s;return n&&F.isObject(e)?F.combineTypes(a(e.classType,P.convertToInstance(s),c)):!n&&F.isClass(e)?F.combineTypes(a(e,s,c)):!n&&F.isObject(e)&&F.ClassType.isBuiltIn(e.classType,"type")&&K&&F.isObject(K)?F.combineTypes(a(K.classType,P.convertToInstantiable(s),c)):i&&F.isAnyOrUnknown(e)?(n?o.push(F.combineTypes(t.map((e=>P.convertToInstance(e))))):o.push(F.combineTypes(t)),void l.push(e)):i?void 0:c}));if(F.isNever(c)&&o.length>0)return F.combineTypes(o);if(l.length>0)return F.combineTypes([c,...l]);return c}(n,e,t,i)}}if(n.arguments.length>=1){const t=n.arguments[0].valueExpression;if(v.isMatchingExpression(e,t)){const e=he(n.leftExpression).type;if(F.isFunction(e)&&e.details.declaredReturnType&&F.isObject(e.details.declaredReturnType)&&F.ClassType.isBuiltIn(e.details.declaredReturnType.classType,"TypeGuard")){const e=he(n).type;if(F.isObject(e)&&F.ClassType.isBuiltIn(e.classType,"TypeGuard")){const t=e.classType.typeArguments,n=t&&t.length>0?t[0]:F.UnknownType.create();return e=>i?n:e}}}}}if(v.isMatchingExpression(e,n))return e=>P.mapSubtypes(e,(e=>{if(i){if(P.canBeTruthy(e))return P.removeFalsinessFromType(e)}else if(P.canBeFalsy(e))return P.removeTruthinessFromType(e)}))}function Dn(e,t,n,i){return P.mapSubtypes(e,(e=>{if(F.isObject(e)&&F.ClassType.isSameGenericClass(t.classType,e.classType)){if(void 0!==e.classType.literalValue){const i=F.ClassType.isLiteralValueSame(e.classType,t.classType);if(i&&!n||!i&&n)return;return e}if(n)return t;{const n=function(e){if(F.ClassType.isBuiltIn(e.classType,"bool"))return[F.ObjectType.create(F.ClassType.cloneWithLiteral(e.classType,!0)),F.ObjectType.create(F.ClassType.cloneWithLiteral(e.classType,!1))];if(F.ClassType.isEnumClass(e.classType)){const t=[];return e.classType.details.fields.forEach(((n,i)=>{if(!n.isIgnoredForProtocolMatch()&&!n.isInstanceMember()){const i=zn(n);F.isObject(i)&&F.ClassType.isSameGenericClass(e.classType,i.classType)&&void 0!==i.classType.literalValue&&t.push(i)}})),t}return}(e);if(n)return F.combineTypes(n.filter((e=>!F.ClassType.isLiteralValueSame(e.classType,t.classType))))}}else if(i&&n)return;return e}))}function xn(e,t,n,i){if(F.ClassType.isSpecialBuiltIn(e)){const s=e.aliasName||e.details.name;switch(s){case"Callable":return function(e,t){const n=F.FunctionType.createInstantiable("","","",0);n.details.declaredReturnType=F.UnknownType.create();const i=v.getEnclosingClassOrFunction(t);if(n.details.typeVarScopeId=i?He(i):F.WildcardTypeVarScopeId,e&&e.length>0){if(e[0].typeList){const t=e[0].typeList;let i=!1,s=!1;t.forEach(((e,t)=>{let r=e.type,a=0;const o=`_p${t.toString()}`;F.isVariadicTypeVar(r)?(i&&(s||(Re(h.Localizer.Diagnostic.variadicTypeArgsTooMany(),e.node),s=!0)),i=!0,et(r,e.node),a=0):At(e)||(r=F.UnknownType.create()),F.FunctionType.addParameter(n,{category:a,name:o,isNameSynthesized:!0,type:P.convertToInstance(r),hasDeclaredType:!0})}))}else if(P.isEllipsisType(e[0].type))F.FunctionType.addDefaultParameters(n),n.details.flags|=32768;else if(F.isParamSpec(e[0].type))n.details.paramSpec=e[0].type;else if(F.isClass(e[0].type)&&F.ClassType.isBuiltIn(e[0].type,"Concatenate")){const t=e[0].type.typeArguments;t&&t.length>0&&t.forEach(((e,i)=>{i===t.length-1?F.isParamSpec(e)&&(n.details.paramSpec=e):F.FunctionType.addParameter(n,{category:0,name:`__p${i}`,isNameSynthesized:!0,hasDeclaredType:!0,type:e})}))}else Re(h.Localizer.Diagnostic.callableFirstArg(),e[0].node);if(e.length>1){let t=e[1].type;At(e[1])||(t=F.UnknownType.create()),n.details.declaredReturnType=P.convertToInstance(t)}else Ue(Rn(t).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.callableSecondArg(),t),n.details.declaredReturnType=F.UnknownType.create();e.length>2&&Re(h.Localizer.Diagnostic.callableExtraArgs(),e[2].node)}else F.FunctionType.addDefaultParameters(n,!0),n.details.flags|=32768;return n}(t,i);case"Optional":return function(e,t){if(!t||1!==t.length)return Re(h.Localizer.Diagnostic.optionalExtraArgs(),e),F.UnknownType.create();let n=t[0].type;return At(t[0])?F.TypeBase.isInstantiable(n)||Ve(n,t[0].node):n=F.UnknownType.create(),F.combineTypes([n,F.NoneType.createType()])}(i,t);case"Type":return Nt(e,t,1);case"ClassVar":return function(e,t){if(!t||0===t.length)return Re(h.Localizer.Diagnostic.classVarFirstArgMissing(),e),F.UnknownType.create();if(t.length>1)return Re(h.Localizer.Diagnostic.classVarTooManyArgs(),t[1].node),F.UnknownType.create();let n=t[0].type;return n=Be(n),n}(i,t);case"Protocol":case"Tuple":return Nt(e,t,void 0);case"Union":return function(e){const t=[];if(e)for(const n of e){let e=n.type;At(n,!1,!0)?F.TypeBase.isInstantiable(e)||Ve(e,n.node):e=F.UnknownType.create(),t.push(e)}return t.length>0?F.combineTypes(t):F.NeverType.create()}(t);case"Generic":return function(e,t,n){n&&0!==n.length||Re(h.Localizer.Diagnostic.genericTypeArgMissing(),e);const i=[];return n&&n.forEach((e=>{if(F.isTypeVar(e.type)){for(const t of i)if(t===e.type){Re(h.Localizer.Diagnostic.genericTypeArgUnique(),e.node);break}i.push(e.type)}else Re(h.Localizer.Diagnostic.genericTypeArgTypeVar(),e.node)})),Nt(t,n,void 0,!0)}(i,e,t);case"Final":return function(e,t,n,i){return 16&i?(Re(h.Localizer.Diagnostic.finalContext(),t),F.AnyType.create()):n&&0!==n.length?(n.length>1&&Re(h.Localizer.Diagnostic.finalTooManyArgs(),t),n[0].type):e}(e,i,t,n);case"Annotated":return function(e,t){if(t&&t.length<2&&Re(h.Localizer.Diagnostic.annotatedTypeArgMissing(),e),!t||0===t.length)return F.AnyType.create();let n=t[0].type;return At(t[0])||(n=F.UnknownType.create()),F.TypeBase.cloneForAnnotated(n)}(i,t);case"Concatenate":return function(e,t,n){return n&&0!==n.length?n.forEach(((e,t)=>{t===n.length-1?F.isParamSpec(e.type)||Re(h.Localizer.Diagnostic.concatenateParamSpecMissing(),e.node):F.isParamSpec(e.type)&&Re(h.Localizer.Diagnostic.paramSpecContext(),e.node)})):Re(h.Localizer.Diagnostic.concatenateTypeArgsMissing(),e),Nt(t,n,void 0,!0)}(i,e,t);case"TypeGuard":return function(e,t,n){let i;return n&&1===n.length||Re(h.Localizer.Diagnostic.typeGuardArgCount(),e),n&&n.length>0?(i=n[0].type,At(n[0])||(i=F.UnknownType.create())):i=F.UnknownType.create(),F.ClassType.cloneForSpecialization(t,[P.convertToInstance(i)],!!n)}(i,e,t);case"Unpack":return function(e,t){if(!t||1!==t.length)return Re(h.Localizer.Diagnostic.unpackArgCount(),e),F.UnknownType.create();let n=t[0].type;return F.isUnion(n)&&1===n.subtypes.length&&(n=n.subtypes[0]),!F.isVariadicTypeVar(n)||n.isVariadicUnpacked?(Re(h.Localizer.Diagnostic.unpackExpectedTypeVarTuple(),e),F.UnknownType.create()):F.TypeVarType.cloneForUnpacked(n)}(i,t);case"Required":case"NotRequired":return function(e,t,n,i){var s;if(!i||1!==i.length)return Re(n?h.Localizer.Diagnostic.requiredArgCount():h.Localizer.Diagnostic.notRequiredArgCount(),t),e;const r=i[0].type,a=v.getEnclosingClass(t,!0),o=a?Vt(a):void 0;let l=!1;return o&&F.isClass(o.classType)&&F.ClassType.isTypedDictClass(o.classType)&&54===(null===(s=t.parent)||void 0===s?void 0:s.nodeType)&&t.parent.typeAnnotation===t&&(l=!0),l?r:(Re(n?h.Localizer.Diagnostic.requiredNotInTypedDict():h.Localizer.Diagnostic.notRequiredNotInTypedDict(),t),F.ClassType.cloneForSpecialization(e,[P.convertToInstance(r)],!!i))}(e,i,"Required"===s,t)}}const s=Rn(i);if(s.isStubFile||s.executionEnvironment.pythonVersion>=u.PythonVersion.V3_9||ye(Rn(i))||0!=(4&n)){if(F.ClassType.isBuiltIn(e,"type")&&t){const e=Pe(i,"Type");if(e&&F.isClass(e))return Nt(e,t,1)}if(P.isTupleClass(e))return Nt(e,t,void 0)}let r=t?t.length:0;const a=F.ClassType.getTypeParameters(e);if(0===a.length&&0===r)return e;const o=a.findIndex((e=>F.isVariadicTypeVar(e)));if(t){if(r>a.length){if(!F.ClassType.isPartiallyConstructed(e)&&!F.ClassType.isTupleClass(e)){const n=Rn(i);0===a.length?Ue(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeArgsExpectingNone(),t[a.length].node):Ue(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeArgsTooMany().format({name:e.aliasName||e.details.name,expected:a.length,received:r}),t[a.length].node)}r=a.length}else if(r<a.length){Ue(Rn(i).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeArgsTooFew().format({name:e.aliasName||e.details.name,expected:a.length,received:r}),t.length>0?t[0].node.parent:i)}t.forEach(((e,t)=>{if(t===o){if(F.isObject(e.type)&&P.isTupleClass(e.type.classType))return;if(F.isVariadicTypeVar(e.type))return void et(e.type,e.node)}At(e,!1,!1,!0)}))}const p=t?t.map((e=>P.convertToInstance(e.type))):[],d=F.ClassType.getTypeParameters(e);for(let e=p.length;e<d.length;e++)p.push(F.UnknownType.create());p.forEach(((e,n)=>{if(n<r){const i=new l.DiagnosticAddendum;if(!function(e,t,n,i=0,s=0){if(s>F.maxTypeRecursionCount)return!0;if(F.isAnyOrUnknown(t))return!0;let r=t;if(F.isTypeVar(t)){if(F.isTypeSame(t,e))return!0;r=Be(t)}const a=e.details.boundType;if(a&&!ii(a,r,n.createAddendum(),void 0,i,s+1))return e.details.isSynthesized||n.addMessage(h.Localizer.DiagnosticAddendum.typeBound().format({sourceType:yi(r),destType:yi(a),name:F.TypeVarType.getReadableName(e)})),!1;if(e.details.isParamSpec){if(F.isParamSpec(t))return!0}else{if(F.isParamSpec(t))return n.addMessage(h.Localizer.Diagnostic.paramSpecContext()),!1;{const t=e.details.constraints;if(0===t.length)return!0;for(const e of t){if(F.isAnyOrUnknown(e))return!0;if(F.isUnion(r)){if(F.findSubtype(r,(t=>ii(e,t,new l.DiagnosticAddendum))))return!0}else if(ii(e,r,new l.DiagnosticAddendum))return!0}}}return n.addMessage(h.Localizer.DiagnosticAddendum.typeConstrainedTypeVar().format({type:yi(r),name:F.TypeVarType.getReadableName(e)})),!1}(a[n],e,i)){Ue(Rn(t[n].node).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarAssignmentMismatch().format({type:yi(e),name:F.TypeVarType.getReadableName(a[n])})+i.getString(),t[n].node)}}}));return F.ClassType.cloneForSpecialization(e,p,void 0!==t)}function kn(e){return e.type?e.type:he(e.valueExpression).type}function Fn(e){return e.type?e.type:Pn(e.valueExpression)}function Pn(e,t=!1){let n=232;return Rn(e).isStubFile&&(n|=4),t||(n|=16),he(e,void 0,n).type}function An(e,t){const n=b.getScopeForNode(e);if(n){const e=b.getBuiltInScope(n).lookUpSymbol(t);if(e)return zn(e)}return F.UnknownType.create()}function En(e,t,n){const i=An(e,t);if(F.isClass(i)){let e=i;return n&&(e=F.ClassType.cloneForSpecialization(e,n,void 0!==n)),F.ObjectType.create(e)}return i}function wn(e,t,n){const i=b.getScopeForNode(e);let s=null==i?void 0:i.lookUpSymbolRecursive(t);if(s&&n){0===s.symbol.getDeclarations().filter((t=>{if(6!==t.type){const n=v.getExecutionScopeNode(e),i=4===t.type||3===t.type?t.node.name:t.node;if(n===v.getExecutionScopeNode(i)&&!Ne(i,e)){const t=f.getFlowNode(e);return!(t&&Cn(t))}}return!0})).length&&(s=s.scope.parent?s.scope.parent.lookUpSymbolRecursive(t,s.isOutsideCallerModule||3===s.scope.type,s.isBeyondExecutionScope||s.scope.isIndependentlyExecutable()):void 0)}return s}function Nn(e,t){W.push(e);try{return t()}finally{W.pop()}}function On(e,t,n=!0){j.enterSpeculativeContext(e,n);try{return t()}finally{j.leaveSpeculativeContext()}}function Rn(e){for(;36!==e.nodeType;)e=e.parent;return f.getFileInfo(e)}function Mn(e,t){if(F.isFunction(e)&&e.details.declaration){const n=e.details.declaration;if(3===n.type){const e=n.node,i=f.getScope(e);if(i){const e=i.lookUpSymbol(t);if(e)return e.getDeclarations().find((e=>2===e.type))}}}}function Ln(e){var t;switch(e.type){case 0:{if("Any"===e.intrinsicType)return F.AnyType.create();if("class"===e.intrinsicType){const t=Vt(v.getEnclosingClass(e.node));return t?t.classType:void 0}const t=En(e.node,"str"),n=En(e.node,"int");if(F.isObject(n)&&F.isObject(t)){if("str"===e.intrinsicType)return t;if("int"===e.intrinsicType)return n;if("Iterable[str]"===e.intrinsicType){const n=An(e.node,"Iterable");if(F.isClass(n))return F.ObjectType.create(F.ClassType.cloneForSpecialization(n,[t],!0))}if("Dict[str, Any]"===e.intrinsicType){const n=An(e.node,"dict");if(F.isClass(n))return F.ObjectType.create(F.ClassType.cloneForSpecialization(n,[t,F.AnyType.create()],!0))}}return F.UnknownType.create()}case 4:{const t=Vt(e.node);return t?t.decoratedType:void 0}case 5:return ge(e.node.typeAnnotation);case 3:{const t=jt(e.node);return t?t.decoratedType:void 0}case 2:{let n=e.node.typeAnnotation||e.node.typeAnnotationComment;if(!n&&28===(null===(t=e.node.parent)||void 0===t?void 0:t.nodeType)){const t=e.node.parent;if(t.functionAnnotationComment&&!t.functionAnnotationComment.isParamListEllipsis){const i=t.parameters.findIndex((t=>t===e.node));n=be(t,i)}}if(n){const t=ge(n,!1,!0,1===e.node.category);return Wt(e.node,e.node.category,t)}return}case 1:{const t=e.typeAnnotationNode;if(t){const n=Se(t)?v.getTypeAnnotationNode(t):void 0;let i=ge(t);if(i)return 38===e.node.nodeType&&(i=Ot(e.node,(()=>i))||i),n&&38===n.valueExpression.nodeType&&(i=Rt(i,n.valueExpression,e.node)),i}return}case 6:return}}function Un(n){var i,s;const r=Vn(n,!0);if(!r)return F.UnknownType.create();function a(e,t,n){if(t.path){const i=n(t.path);if(!i)return F.UnknownType.create();e.fields=i.symbolTable,e.docString=i.docString}return t.implicitImports&&t.implicitImports.forEach(((t,i)=>{const s=e.moduleName?e.moduleName+"."+i:"",r=a(F.ModuleType.create(s,t.path),t,n),o=C.Symbol.createWithType(0,r);e.loaderFields.set(i,o)})),e}if(6===r.type){let t=r.moduleName;if(6===n.type&&(n.symbolName&&(t+="."+n.symbolName),t.startsWith("."))){const e=Rn(n.node).moduleName.split(".");for(t=t.substr(1);t.startsWith(".")&&e.length>0;)t=t.substr(1),e.pop();t=e.join(".")+"."+t}const i=F.ModuleType.create(t,r.path);return r.symbolName&&r.submoduleFallback?a(i,r.submoduleFallback,e):a(i,r,e)}const o=Ln(r);if(o)return o;const l=Rn(r.node);let c=!1;if(l.isInPyTypedPackage&&!l.isStubFile&&t.disableInferenceForPyTypedSources){if(1!==r.type)return F.UnknownType.create();const e=v.getEnclosingClass(r.node,!0);let t=!1;if(e){const n=Vt(e);n&&F.ClassType.isEnumClass(n.classType)&&(t=!0)}if(!r.isFinal&&!r.isConstant&&!t){if(!r.typeAliasName)return F.UnknownType.create();r.typeAliasAnnotation||(c=!0)}}if(2===r.type)return null===(i=gn(r.node.name,(()=>{dn(r.node)})))||void 0===i?void 0:i.type;if(1===r.type&&r.inferredTypeSource){const e=r.typeAliasName&&r.inferredTypeSource.parent?r.inferredTypeSource.parent:r.inferredTypeSource;let t=null===(s=gn(r.node,(()=>{hn(e)})))||void 0===s?void 0:s.type;if(t&&38===r.node.nodeType){const e=Ot(r.node,(()=>{var e;return(null===(e=gn(r.inferredTypeSource,(()=>{hn(r.inferredTypeSource)})))||void 0===e?void 0:e.type)||F.UnknownType.create()}));e&&(t=e)}if(t&&r.typeAliasName)if(F.TypeBase.isInstantiable(t)&&!F.isAnyOrUnknown(t))t=Rt(t,r.typeAliasName,r.node);else if(c)return F.UnknownType.create();return t}}function Vn(t,n){return g.resolveAliasDeclaration(e,t,n)}function zn(e){return jn(e).type}const jn=t.logCalls?(e,t,n=!1)=>te("getEffectiveTypeOfSymbolForUsage",(()=>Bn(e,t,n)),e):Bn;function Bn(e,t,n=!1){if(e.hasTypedDeclarations()){const t=Wn(e);return{type:t||F.UnknownType.create(),isIncomplete:!1,includesVariableDecl:e.getTypedDeclarations().some((e=>1===e.type)),isRecursiveDefinition:!t}}let i=B.get(e.id);const s=t?t.id:void 0;if(i)for(const e of i)if(e.usageNodeId===s&&e.useLastDecl===n)return e.result;const r=[],a=e.isPrivateMember(),o=e.getDeclarations(),l=D.isFinalVariable(e);let c=!1,p=!1;if(o.forEach(((i,s)=>{var u,d;let h=!n||s===o.length-1;if(void 0!==t&&6!==i.type){v.getExecutionScopeNode(t)===v.getExecutionScopeNode(i.node)&&(Ne(i.node,t)||(h=!1))}if(h){const t=_.isExplicitTypeAliasDeclaration(i)||_.isPossibleTypeAliasDeclaration(i);if(t&&1===i.type&&3===(null===(d=null===(u=i.inferredTypeSource)||void 0===u?void 0:u.parent)||void 0===d?void 0:d.nodeType)&&(Lt(i.inferredTypeSource.parent),i.typeAliasAnnotation&&he(i.typeAliasAnnotation)),le(e,i))try{let n=Un(i);if(ce(e)||(c=!0),n){if(1===i.type){p=!0;let e=1===i.type&&!!i.isConstant;F.isObject(n)&&F.ClassType.isEnumClass(n.classType)&&function(e){const t=v.getEnclosingClass(e.node,!0);if(!t)return!1;const n=Vt(t);if(!n)return!1;return F.ClassType.isEnumClass(n.classType)}(i)&&(e=!0),!F.TypeBase.isInstance(n)||t||a||e||l||(n=P.stripLiteralValue(n))}r.push(n)}else c=!0}catch(t){throw ce(e),t}else c=!0}})),r.length>0){const t={type:F.combineTypes(r),isIncomplete:!1,includesVariableDecl:p,isRecursiveDefinition:!1};return i||(i=[],B.set(e.id,i)),i.push({usageNodeId:s,useLastDecl:n,result:t}),t}return{type:F.UnboundType.create(),isIncomplete:c,includesVariableDecl:p,isRecursiveDefinition:!1}}function Wn(e){const t=e.getSynthesizedType();if(t)return t;const n=e.getTypedDeclarations();if(0===n.length)return;let i=n.length-1;for(;i>=0;){const t=n[i],s=ue(e,t);if(s)return s;if(oe(e,t)<0&&le(e,t))try{const n=Ln(t);if(ce(e)||4===t.type)return n}catch(t){throw ce(e),t}i--}}function $n(e,t,n=!0){const i=F.FunctionType.getSpecializedReturnType(e);return i||(n?qn(e,t):F.UnknownType.create())}const qn=t.logCalls?(e,t)=>te("getFunctionInferredReturnType",(()=>Gn(e,t)),e):Gn;function Gn(e,t){let n;if(F.FunctionType.isStubDefinition(e)||F.FunctionType.isPyTypedDefinition(e))return F.UnknownType.create();if(e.inferredReturnType)n=e.inferredReturnType;else{if(e.details.declaration){const t=e.details.declaration.node;!function(e){const t=j.disableSpeculativeMode();try{e()}finally{j.enableSpeculativeMode(t)}}((()=>{n=Ht(t,F.FunctionType.isAbstractMethod(e))})),n&&F.FunctionType.isWrapReturnTypeInAwait(e)&&(n=Kt(t,n))}n||(n=F.UnknownType.create()),e.inferredReturnType=n}if(P.isPartlyUnknown(n)&&F.FunctionType.hasUnannotatedParams(e)&&!F.FunctionType.isStubDefinition(e)&&!F.FunctionType.isPyTypedDefinition(e)&&t){const i=function(e,t){let n;if(!e.details.declaration)return;const i=e.details.declaration.node;if(t.some((e=>!e.paramName)))return;if(X.some((e=>e.functionNode===i)))return;const s=jt(i);if(!s)return;if(t.length>6)return;if(X.length>=3)return;if(Nn(i,(()=>{const r=ee;X.push({functionNode:i,codeFlowAnalyzer:Sn()});try{ee=new Map;let a=!0;i.parameters.forEach(((e,n)=>{if(e.name){let r;const o=t.find((t=>e.name.value===t.paramName));o&&o.argument.valueExpression?(r=he(o.argument.valueExpression).type,F.isUnknown(r)||(a=!1)):e.defaultValue?(r=he(e.defaultValue).type,F.isUnknown(r)||(a=!1)):0===n&&(F.FunctionType.isInstanceMethod(s.functionType)||F.FunctionType.isClassMethod(s.functionType))&&s.functionType.details.parameters.length>0&&i.parameters[0].name&&(r=s.functionType.details.parameters[0].type),r||(r=F.UnknownType.create()),se(e.name,r,!1)}})),a||(n=Ht(i,F.FunctionType.isAbstractMethod(e)))}finally{X.pop(),ee=r}})),n)return n=F.removeUnbound(n),F.FunctionType.isWrapReturnTypeInAwait(e)&&!P.isNoReturnType(n)&&(n=Kt(i,n)),n;return}(e,t);i&&(n=P.removeNoReturnFromUnion(i))}return n}function Kn(e){const t=jt(e);return t?F.FunctionType.isAbstractMethod(t.functionType)?F.AnyType.create():F.FunctionType.isGenerator(t.functionType)?P.getDeclaredGeneratorReturnType(t.functionType):t.functionType.details.declaredReturnType:F.AnyType.create()}function Hn(e){return F.isClass(e.classType)?P.partiallySpecializeType(zn(e.symbol),e.classType):F.UnknownType.create()}function Yn(e,t){if(F.isClass(t.classType)){const n=jn(t.symbol);if(n)return{node:e,type:P.partiallySpecializeType(n.type,t.classType),isIncomplete:!!n.isIncomplete}}}function Qn(e,t,n,i,s,r,a){if(a>F.maxTypeRecursionCount)return!0;const o=e.details.fields;if(F.ClassType.isSameGenericClass(t,e))return!!F.isTypeSame(t,e)||ti(e,t,n,i,s,a+1);const l=F.ClassType.cloneForSpecialization(e,void 0,!1),c=new A.TypeVarMap(P.getTypeVarScopeId(e));let p=!0;const u=P.buildTypeVarMapFromSpecializedClass(t);if(o.forEach(((e,i)=>{if(e.isClassMember()&&!e.isIgnoredForProtocolMatch()){let s,o=!1;if(r&&t.details.effectiveMetaclass&&F.isClass(t.details.effectiveMetaclass)&&(s=P.lookUpClassMember(t.details.effectiveMetaclass,i),u.addSolveForScope(P.getTypeVarScopeId(t.details.effectiveMetaclass)),o=!0),s||(s=P.lookUpClassMember(t,i)),s){let r=Wn(e);if(r){let e=Hn(s);if(F.isFunction(e)||F.isOverloadedFunction(e))if(o){const n=di(t,e,void 0,void 0,a+1,!1,t);if(n&&(e=n),F.isFunction(r)||F.isOverloadedFunction(r)){const e=di(t,r,void 0,void 0,a+1,!1,t);e&&(r=e)}}else if(F.isClass(s.classType)){const n=di(F.ObjectType.create(t),e,s.classType);if(n&&(e=n),F.isFunction(r)||F.isOverloadedFunction(r)){const e=di(F.ObjectType.create(t),r,s.classType,void 0,a+1);e&&(r=e)}}const l=n.createAddendum();F.isObject(r)&&F.ClassType.isPropertyClass(r.classType)&&F.isObject(e)&&F.ClassType.isPropertyClass(e.classType)?Zn(r.classType,e.classType,t,l.createAddendum(),c,a+1)||(l.addMessage(h.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:i})),p=!1):ii(r,e,l.createAddendum(),c,0,a+1)||(l.addMessage(h.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:i})),p=!1)}e.isClassVar()&&!s.symbol.isClassMember()&&(n.addMessage(h.Localizer.DiagnosticAddendum.protocolMemberClassVar().format({name:i})),p=!1)}else n.addMessage(h.Localizer.DiagnosticAddendum.protocolMemberMissing().format({name:i})),p=!1}})),e.details.baseClasses.forEach((o=>{if(F.isClass(o)&&!F.ClassType.isBuiltIn(o,"object")&&!F.ClassType.isBuiltIn(o,"Protocol")){Qn(P.specializeForBaseClass(e,o),t,n.createAddendum(),i,s,r,a+1)||(p=!1)}})),p&&e.details.typeParameters.length>0&&e.typeArguments){const t=P.applySolvedTypeVars(l,c);ti(e,t,n,i,s,a)||(p=!1)}return p}function Jn(e,t,n,i,s,r){if(r>F.maxTypeRecursionCount)return!0;let a=!0;const o=e.details.fields,l=F.ClassType.cloneForSpecialization(e,void 0,!1),c=new A.TypeVarMap(P.getTypeVarScopeId(e));if(o.forEach(((i,s)=>{if(i.isClassMember()&&!i.isIgnoredForProtocolMatch()){const o=t.fields.get(s);if(o){let t=Wn(i);if(t){const i=zn(o);if((F.isFunction(i)||F.isOverloadedFunction(i))&&(F.isFunction(t)||F.isOverloadedFunction(t))){const n=di(F.ObjectType.create(e),t,e);n&&(t=n)}const l=n.createAddendum();ii(t,i,l.createAddendum(),c,0,r+1)||(l.addMessage(h.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:s})),a=!1)}}else n.addMessage(h.Localizer.DiagnosticAddendum.protocolMemberMissing().format({name:s})),a=!1}})),e.details.baseClasses.forEach((o=>{if(F.isClass(o)&&!F.ClassType.isBuiltIn(o,"object")&&!F.ClassType.isBuiltIn(o,"Protocol")){Jn(P.specializeForBaseClass(e,o),t,n.createAddendum(),i,s,r+1)||(a=!1)}})),a&&e.details.typeParameters.length>0&&e.typeArguments){const t=P.applySolvedTypeVars(l,c);ti(e,t,n,i,s,r)||(a=!1)}return a}function Zn(e,t,n,i,s,r=0){const a=F.ObjectType.create(n);let o=!0;return[{name:"fget",missingDiagMsg:h.Localizer.DiagnosticAddendum.missingGetter,incompatibleDiagMsg:h.Localizer.DiagnosticAddendum.incompatibleGetter},{name:"fset",missingDiagMsg:h.Localizer.DiagnosticAddendum.missingSetter,incompatibleDiagMsg:h.Localizer.DiagnosticAddendum.incompatibleSetter},{name:"fdel",missingDiagMsg:h.Localizer.DiagnosticAddendum.missingDeleter,incompatibleDiagMsg:h.Localizer.DiagnosticAddendum.incompatibleDeleter}].forEach((n=>{const l=e.details.fields.get(n.name),c=l?Wn(l):void 0;if(c&&F.isFunction(c)){const e=t.details.fields.get(n.name),l=e?Wn(e):void 0;if(!l||!F.isFunction(l))return i.addMessage(n.missingDiagMsg()),void(o=!1);const p=di(a,c),u=di(a,l);if(!p||!u||!ii(p,u,i.createAddendum(),s,0,r+1))return i.addMessage("getter type is incompatible"),void(o=!1)}})),o}function Xn(e,t,n,i,s,r,a,l=!1){if(F.ClassType.isTypedDictClass(e)&&F.ClassType.isTypedDictClass(t))return function(e,t,n,i){let s=!0;const r=pi(e),a=pi(t,!0);return r.forEach(((r,o)=>{const l=a.get(o);l?(r.isRequired&&!l.isRequired?(n.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldRequired().format({name:o,type:yi(e)})),s=!1):!r.isRequired&&l.isRequired&&(n.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldNotRequired().format({name:o,type:yi(e)})),s=!1),F.isTypeSame(r.valueType,l.valueType,i+1)||(n.addMessage(h.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:o})),s=!1)):(n.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldMissing().format({name:o,type:yi(t)})),s=!1)})),s}(e,t,n,r);const c=O[e.details.fullName];if(c&&c.some((e=>e===t.details.fullName))&&0==(1&s))return!0;const p=[],u=F.ClassType.isDerivedFrom(t,e,p);if(F.ClassType.isProtocolClass(e)&&(!u||l))return Qn(e,t,n,i,s,l,r+1);if((0==(1&s)||F.ClassType.isSameGenericClass(t,e))&&u)return o.assert(p.length>0),function(e,t,n,i,s,r,a){let o=t,l=s||new A.TypeVarMap(P.getTypeVarScopeId(e)),c=r;s||(c&=-9);for(let t=n.length-1;t>=0;t--){const s=n[t];if(F.isUnknown(s))return!0;if(F.ClassType.isBuiltIn(s,"object"))return!0;if(t<n.length-1&&(o=P.specializeForBaseClass(o,s)),0===t&&F.ClassType.isTupleClass(e)){if(e.tupleTypeArguments&&o.tupleTypeArguments){const t=e.tupleTypeArguments;let n=t.length;const s=2===n&&P.isEllipsisType(t[1]);s&&(n=1);const r=n>0&&F.isVariadicTypeVar(t[n-1]),p=o.tupleTypeArguments;let u=p.length;const d=2===u&&P.isEllipsisType(p[1]);if(d&&(u=1),r&&d)return i.addMessage(h.Localizer.DiagnosticAddendum.typeVarTupleRequiresKnownLength()),!1;if(!(p.length===n&&!d||s||r))return d?i.addMessage(h.Localizer.DiagnosticAddendum.tupleSizeMismatchIndeterminate().format({expected:n})):i.addMessage(h.Localizer.DiagnosticAddendum.tupleSizeMismatch().format({expected:n,received:p.length})),!1;{const o=Math.max(n,u);for(let m=0;m<o;m++){let o,y,g=!1;d?o=p[0]:m<p.length?o=p[m]:(o=F.AnyType.create(),e.isTypeArgumentExplicit&&r&&m<n-1&&!s&&(g=!0));let f=!1;if(r&&m>=n-1){if(y=t[n-1],Y&&F.isClass(Y)){const e=p.slice(m);o=P.convertToInstance(P.specializeTupleClass(Y,e.map((e=>P.stripLiteralValue(e))),!0,!0,!0)),f=!0}}else y=s?t[0]:m<t.length?t[m]:F.AnyType.create();const T=i.createAddendum();if(g||!ii(y,o,T.createAddendum(),l,c,a+1))return T.addMessage(h.Localizer.DiagnosticAddendum.tupleEntryTypeMismatch().format({entry:m+1})),!1;f&&(m=u)}}}return!0}if(0!==F.ClassType.getTypeParameters(s).length){if(!s.typeArguments)return!0;if(!ti(s,o,i,l,c,a))return!1;l=new A.TypeVarMap(P.getTypeVarScopeId(s)),c&=-9}}if(e.typeArguments){if(!ti(e,o,i,s,r,a))return!1}else if(s&&e.details.typeParameters.length>0&&o.typeArguments&&!s.isLocked()){const t=o.typeArguments;for(let n=0;n<e.details.typeParameters.length;n++){const i=n<t.length?t[n]:F.UnknownType.create();s.setTypeVarType(e.details.typeParameters[n],void 0,i)}F.ClassType.isTupleClass(o)&&o.tupleTypeArguments&&e.details.typeParameters.length>=1&&s.setVariadicTypeVar(e.details.typeParameters[0],o.tupleTypeArguments)}return!0}(e,t,p,n,i,s,r+1);if(F.ClassType.isBuiltIn(e,"object")&&0==(1&s))return!0;const d=a?F.ObjectType.create(e):e,m=a?F.ObjectType.create(t):t;return n.addMessage(h.Localizer.DiagnosticAddendum.typeIncompatible().format({sourceType:yi(m),destType:yi(d)})),!1}function ei(e,t){if(!F.ClassType.isPropertyClass(e))return;const n=e.details.fields.get("fget");if(n){const e=Wn(n);if(e&&F.isFunction(e))return $n(e,void 0,t)}}function ti(e,t,n,i,s,r){o.assert(F.ClassType.isSameGenericClass(e,t));const a=F.ClassType.getTypeParameters(e);let c,p;if(!e.typeArguments||!t.typeArguments)return!0;if(F.ClassType.isTupleClass(e)?(c=e.tupleTypeArguments||[],p=t.tupleTypeArguments):(c=e.typeArguments,p=t.typeArguments),p&&t.isTypeArgumentExplicit)for(let e=0;e<p.length;e++){const t=p[e],o=e>=c.length?c.length-1:e,u=o>=0?c[o]:F.UnknownType.create(),d=o<a.length?a[o]:void 0,m=new l.DiagnosticAddendum;if(d&&1!==d.details.variance){if(2===d.details.variance){if(!ii(t,u,m,i,2^s,r+1)){const e=n.createAddendum();return e.addMessage(h.Localizer.DiagnosticAddendum.typeVarIsContravariant().format({name:F.TypeVarType.getReadableName(d)})),e.addAddendum(m),!1}}else if(!ii(u,t,m,i,1|s,r+1)){const e=n.createAddendum();return e.addMessage(h.Localizer.DiagnosticAddendum.typeVarIsInvariant().format({name:F.TypeVarType.getReadableName(d)})),e.addAddendum(m),!1}}else if(!ii(u,t,m,i,s,r+1)){if(d){const e=n.createAddendum();e.addMessage(h.Localizer.DiagnosticAddendum.typeVarIsCovariant().format({name:F.TypeVarType.getReadableName(d)})),e.addAddendum(m)}return!1}}return!0}function ni(e,t,n,i,s=0,r=0){let a=!0;const o=0!=(2&s);if(!e.scopeId)return!0;if(!i.hasSolveForScope(e.scopeId)){if(F.isAnyOrUnknown(t))return!0;if(a=!1,!e.details.isSynthesized)return n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(t),destType:yi(e)})),!1}if(e.details.isParamSpec){if(F.isTypeVar(t)&&t.details.isParamSpec){const n=i.getParamSpec(e);if(!n)return i.setParamSpec(e,{paramSpec:t}),!0;if(!n.parameters&&n.paramSpec&&F.isTypeSame(n.paramSpec,t))return!0}return n.addMessage(h.Localizer.DiagnosticAddendum.typeParamSpec().format({type:yi(t),name:e.details.name})),!1}if(e.details.isVariadic){const e=F.isObject(t)&&P.isTupleClass(t.classType)&&!!t.classType.isTupleForUnpackedVariadicTypeVar;F.isVariadicTypeVar(t)||e||(t=Y&&F.isClass(Y)?P.convertToInstance(P.specializeTupleClass(Y,[t],!0,!0,!0)):F.UnknownType.create())}const c=i.getTypeVar(e),p=null==c?void 0:c.narrowBound,u=null==c?void 0:c.wideBound;if(e.details.constraints.length>0){let s;const r=Be(t);if(F.isTypeVar(t))ii(e,r,new l.DiagnosticAddendum,new A.TypeVarMap(e.scopeId))&&(s=t);else{let t=!0;s=P.mapSubtypes(r,(n=>{let i;return F.isAnyOrUnknown(n)?n:(e.details.constraints.forEach((e=>{ii(e,n,new l.DiagnosticAddendum)&&(i&&!ii(i,e,new l.DiagnosticAddendum)||(i=e))})),i||o||(t=!1),i)})),!F.isNever(s)&&t||(s=void 0)}if(!s||F.isUnion(s)&&!s.constraints)return n.addMessage(h.Localizer.DiagnosticAddendum.typeConstrainedTypeVar().format({type:yi(t),name:e.details.name})),!1;if(p&&!F.isAnyOrUnknown(p)){if(!ii(p,s,new l.DiagnosticAddendum)){if(!ii(s,p,new l.DiagnosticAddendum))return n.addMessage(h.Localizer.DiagnosticAddendum.typeConstrainedTypeVar().format({type:yi(s),name:yi(p)})),!1;!i.isLocked()&&a&&i.setTypeVarType(e,s)}}else!i.isLocked()&&a&&i.setTypeVarType(e,s);return!0}let d=p,m=u;const y=new l.DiagnosticAddendum,g=0!=(128&s)||i.getRetainLiterals(e)||e.details.boundType&&P.containsLiteralType(e.details.boundType)||e.details.constraints.some((e=>P.containsLiteralType(e))),f=g?t:P.stripLiteralValue(t);if(o||0!=(4&s)){if(u){if(!F.isTypeSame(u,f))if(ii(u,f,y))m=t;else if(!ii(f,u,y))return n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(f),destType:yi(u)})),n.addAddendum(y),!1}else m=f;if(p&&!ii(m,p,new l.DiagnosticAddendum))return n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(f),destType:yi(p)})),n.addAddendum(y),!1}else{if(p){if(!F.isTypeSame(p,f))if(ii(p,f,y,i,s,r+1))d=F.isUnknown(p)?f:p;else{if(i.isLocked()||F.isTypeVar(f))return n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(p),destType:yi(f)})),!1;if(F.isVariadicTypeVar(e))return n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(p),destType:yi(f)})),!1;d=ii(f,p,new l.DiagnosticAddendum,i,s,r+1)?f:F.isUnion(p)&&p.subtypes.length>64&&void 0!==e.details.boundType&&K&&F.isObject(K)?F.combineTypes([p,K]):F.combineTypes([p,f])}}else d=f;if(u&&!ii(Be(u),d,new l.DiagnosticAddendum,i,s,r+1))return n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(u),destType:yi(f)})),!1}if(e.details.boundType){const s=F.TypeBase.isInstantiable(e)?P.convertToInstantiable(e.details.boundType):e.details.boundType,a=d||m,o=F.isTypeVar(t)&&F.TypeBase.isInstantiable(t)?P.convertToInstantiable(a):a;if(!ii(s,o,n.createAddendum(),i,0,r+1))return e.details.isSynthesized||n.addMessage(h.Localizer.DiagnosticAddendum.typeBound().format({sourceType:yi(o),destType:yi(s),name:F.TypeVarType.getReadableName(e)})),!1}return!i.isLocked()&&a&&i.setTypeVarType(e,d,m,g),!0}function ii(e,t,n,i,s=0,r=0){if(e=P.transformPossibleRecursiveTypeAlias(e),t=P.transformPossibleRecursiveTypeAlias(t),F.isUnion(e)&&1===e.subtypes.length&&F.isVariadicTypeVar(e.subtypes[0])&&(e=e.subtypes[0]),F.isUnion(t)&&1===t.subtypes.length&&F.isVariadicTypeVar(t.subtypes[0])&&(t=t.subtypes[0]),r>F.maxTypeRecursionCount)return!0;if(e===t)return!0;if(F.isUnbound(e)||F.isUnbound(t))return!0;const a=s;if(s&=-69,F.isTypeVar(e)){if(F.isTypeSame(e,t))return!0;const o=e;if(o.details.constraints.length>0&&void 0===F.findSubtype(t,((e,t)=>!F.isTypeSame(o,e)&&(!(null==t?void 0:t.find((e=>e.typeVarName===F.TypeVarType.getNameWithScope(o))))||!o.details.constraints.some((t=>ii(t,e,new l.DiagnosticAddendum)))))))return!0;if(F.isVariadicTypeVar(o)&&F.isObject(t)&&P.isTupleClass(t.classType)&&t.classType.tupleTypeArguments&&1===t.classType.tupleTypeArguments.length&&F.isTypeSame(o,t.classType.tupleTypeArguments[0]))return!0;if(0==(2&s))return 8&s?ii(Be(e),Be(t),n,void 0,s,r+1):ni(e,t,n,i||new A.TypeVarMap,a,r+1)}if(F.isAnyOrUnknown(e))return!0;if(F.isAnyOrUnknown(t)){if(i){const n=P.isEllipsisType(t)?F.AnyType.create():t;P.setTypeArgumentsRecursive(e,n,i)}if(0==(16&s))return!0}if(F.isNever(t))return i&&P.setTypeArgumentsRecursive(e,F.UnknownType.create(),i),!0;if(F.isTypeVar(t)&&0!=(2&s))return 0!=(8&s)?ii(Be(t),Be(e),n,void 0,s,r+1):ni(t,e,n,i||new A.TypeVarMap(P.getTypeVarScopeId(t)),a,r+1);if(F.isUnion(t)){if(F.isTypeSame(t,e))return!0;let a=!1;return P.doForEachSubtype(t,(t=>{ii(e,t,new l.DiagnosticAddendum,i,s,r+1)||ii(e,Be(t),n.createAddendum(),i,s,r+1)||(a=!0)})),!a||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(t),destType:yi(e)})),!1)}if(F.isUnion(e)){if(1&s){let a=!1;return P.doForEachSubtype(e,((o,c)=>{let p=!1;F.isAnyOrUnknown(o)||P.doForEachSubtype(e,((e,t)=>{c===t||p||ii(e,o,new l.DiagnosticAddendum,void 0,0,r+1)&&(p=!0)})),p||ii(o,t,n.createAddendum(),i,s,r+1)||(a=!0)})),!a||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(t),destType:yi(e)})),!1)}const a=new l.DiagnosticAddendum;let o=!1;if(F.isNone(t)&&P.isOptionalType(e))o=!0;else{let n,l;P.doForEachSubtype(e,(e=>{const c=null==i?void 0:i.clone();if(ii(e,t,a,c,s,r+1)&&(o=!0,c)){const e=c.getScore();(void 0===l||l<=e)&&(l=e,n=c)}})),i&&n&&i.copyFromClone(n)}return o||F.isTypeVar(t)&&t.details.constraints.length>0&&(o=ii(e,Be(t),a,i,s,r+1)),!!o||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(t),destType:yi(e)})),n.addAddendum(a),!1)}if(F.isNone(e)&&F.isNone(t))return!0;if(F.isObject(t)&&F.ClassType.isBuiltIn(t.classType,"type")){const a=t.classType.typeArguments;if(a&&a.length>=1){if(F.isAnyOrUnknown(a[0]))return F.TypeBase.isInstantiable(e);if(F.isObject(a[0])||F.isTypeVar(a[0]))return!!ii(P.transformTypeObjectToClass(e),P.convertToInstantiable(a[0]),n.createAddendum(),i,s,r+1)||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(t),destType:yi(e)})),!1)}}if(F.isClass(e)){const a=Be(t);if(F.isClass(a))return!!Xn(e,a,n,i,s,r+1,!1)||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(t),destType:yi(e)})),!1)}if(F.isObject(e)){const o=e.classType;if(F.ClassType.isBuiltIn(o,"Type")){const e=o.typeArguments;if(e&&e.length>=1){const a=P.transformTypeObjectToClass(t);if(F.TypeBase.isInstance(e[0])&&F.TypeBase.isInstantiable(a))return ii(e[0],P.convertToInstance(a),n,i,s,r+1)}}else if(F.ClassType.isBuiltIn(o,"type")){if(F.TypeBase.isInstantiable(t))return!0}else if(F.ClassType.isBuiltIn(o,"TypeGuard")&&0!=(64&a)&&F.isObject(t)&&F.ClassType.isBuiltIn(t.classType,"bool"))return!0;const l=Be(t);if(F.isObject(l)){if(void 0!==e.classType.literalValue){if(void 0===l.classType.literalValue||!F.ClassType.isLiteralValueSame(l.classType,e.classType))return n.addMessage(h.Localizer.DiagnosticAddendum.literalAssignmentMismatch().format({sourceType:yi(t),destType:yi(e)})),!1}return!!Xn(o,l.classType,n,i,s,r+1,!0)}if(F.isFunction(l)){const t=si(e);if(t)return ai(t,l,n,i||new A.TypeVarMap,s,r+1);if(K&&F.isObject(K))return ii(e,K,n,i,s,r+1)}else if(F.isModule(l)){if(F.ClassType.isBuiltIn(o,"ModuleType"))return!0;if(F.ClassType.isProtocolClass(e.classType))return Jn(e.classType,l,n,i,s,r+1)}else if(F.isClass(l)){const t=si(e);if(t)return ii(t,l,n,i,s,r+1);const a=l.details.effectiveMetaclass;if(a)return!!F.isAnyOrUnknown(a)||Xn(o,F.ClassType.isProtocolClass(o)?l:a,n,i,s,r+1,!1,!0)}else if(F.isAnyOrUnknown(l))return 0==(16&s)}if(F.isFunction(e)){let a,o=Be(t);if(F.isObject(o)){const e=P.lookUpObjectMember(o,"__call__");if(e){const t=Hn(e);if(F.isFunction(t)||F.isOverloadedFunction(t)){const e=di(o,t);e&&(o=e)}}}if(F.isOverloadedFunction(o)){if(e.details.paramSpec)return n.addMessage(h.Localizer.DiagnosticAddendum.paramSpecOverload()),!1;const t=o.overloads,l=t.findIndex((t=>{if(!F.FunctionType.isOverloaded(t))return!1;const a=i?i.clone():void 0;return ii(e,t,n.createAddendum(),a,s,r+1)}));if(l<0)return n.addMessage(h.Localizer.DiagnosticAddendum.noOverloadAssignable().format({type:yi(e)})),!1;a=t[l]}else if(F.isFunction(o))a=o;else if(F.isClass(o)&&void 0===o.literalValue){const e=F.FunctionType.createInstance("__init__","","",69);e.details.declaredReturnType=F.ObjectType.create(o);let t=P.lookUpClassMember(o,"__init__",12);t||(t=P.lookUpClassMember(o,"__new__",12));const n=t?Hn(t):void 0;n&&F.isFunction(n)?n.details.parameters.forEach(((t,n)=>{n>0&&F.FunctionType.addParameter(e,t)})):F.FunctionType.addDefaultParameters(e),a=e}else if(F.isAnyOrUnknown(o))return 0==(16&s);if(a&&ai(e,a,n.createAddendum(),i||new A.TypeVarMap,s,r+1))return!0}if(F.isOverloadedFunction(e)){const a=n.createAddendum();return!!!e.overloads.some((e=>!!F.FunctionType.isOverloaded(e)&&(i&&i.addSolveForScope(P.getTypeVarScopeId(e)),!ii(e,t,a.createAddendum(),i||new A.TypeVarMap(P.getTypeVarScopeId(e)),s,r+1))))||(a.addMessage(h.Localizer.DiagnosticAddendum.overloadNotAssignable().format({name:e.overloads[0].details.name})),!1)}return!(!F.isObject(e)||!F.ClassType.isBuiltIn(e.classType,"object")||0!=(1&s))||(F.isNone(t)&&F.isObject(e)&&F.ClassType.isProtocolClass(e.classType)&&G&&F.isClass(G)?Qn(e.classType,G,n,i,s,!1,r):F.isNone(e)?(n.addMessage(h.Localizer.DiagnosticAddendum.assignToNone()),!1):(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:yi(t),destType:yi(e)})),!1))}function si(e){if(!F.ClassType.isProtocolClass(e.classType))return;const t=P.lookUpObjectMember(e,"__call__");if(!t)return;const n=Hn(t);if(F.isFunction(n)){const t=di(e,n);if(t)return t}}function ri(e,t,n,i,s,r,a,o){if(F.isTypeVar(e)&&e.details.isSynthesized&&e.details.boundType&&F.isObject(e.details.boundType)&&F.ClassType.isProtocolClass(e.details.boundType.classType))return!0;ii(t,e,new l.DiagnosticAddendum,s,2^a,o+1);return!!ii(t,P.applySolvedTypeVars(e,s),i.createAddendum(),r,a,o+1)||(i.addMessage(h.Localizer.DiagnosticAddendum.paramAssignment().format({index:n+1,sourceType:yi(e),destType:yi(t)})),!1)}function ai(e,t,n,i,s,r){let a=!0;const o=0==(32&s);s&=-33;const c=t.details.parameters,p=e.details.parameters;let u=c.findIndex(((e,t)=>2===e.category||1===e.category&&!e.name||t>0&&1===c[t-1].category)),d=u<0?c:c.slice(0,u);const m=d.findIndex((e=>1===e.category&&e.name));d=d.filter((e=>0===e.category&&e.name));const y=p.findIndex(((e,t)=>2===e.category||1===e.category&&!e.name||t>0&&1===p[t-1].category));let g=y<0?p:p.slice(0,y);const f=g.findIndex((e=>1===e.category&&e.name)),T=f>=0&&F.isVariadicTypeVar(g[f].type)?g[f]:void 0;g=g.filter((e=>0===e.category&&e.name));const _=g.findIndex((e=>0===e.category&&F.isVariadicTypeVar(e.type)));if(_>=0){const e=d.slice(_,_+1+d.length-g.length);if(m<0){const n=e.map((e=>{const n=c.findIndex((t=>t===e));return F.FunctionType.getEffectiveParameterType(t,n)}));if(1!==n.length||!F.isVariadicTypeVar(n[0])){let e;e=Y&&F.isClass(Y)?P.convertToInstance(P.specializeTupleClass(Y,n,!0,!0,!0)):F.UnknownType.create(),d=[...d.slice(0,_),{category:0,name:"_arg_combined",isNameSynthesized:!0,hasDeclaredType:!0,type:e},...d.slice(_+1+d.length-g.length,d.length)]}}}const v=Math.min(d.length,g.length),b=new A.TypeVarMap(P.getTypeVarScopeId(t)),S=c.findIndex((e=>2===e.category&&e.name)),C=p.findIndex((e=>2===e.category&&e.name)),D=c.findIndex((e=>0===e.category&&!e.name)),x=p.findIndex((e=>0===e.category&&!e.name));if(!F.FunctionType.shouldSkipParamCompatibilityCheck(e)){for(let o=0;o<v;o++){const l=c.findIndex((e=>e===d[o])),u=l>=0?F.FunctionType.getEffectiveParameterType(t,l):d[o].type,m=p.findIndex((e=>e===g[o])),y=F.FunctionType.getEffectiveParameterType(e,m),f=g[o].name,T=d[o].name||"";if(f&&!I.isPrivateOrProtectedName(f)&&!I.isPrivateOrProtectedName(T)){D>=0&&o<D&&x>=0&&o<x||f===T||(n.createAddendum().addMessage(h.Localizer.DiagnosticAddendum.functionParamName().format({srcName:T,destName:f})),a=!1)}0===o&&"__init__"===t.details.name&&F.FunctionType.isInstanceMethod(t)&&"__init__"===e.details.name&&F.FunctionType.isInstanceMethod(e)&&F.FunctionType.isOverloaded(e)&&g[o].hasDeclaredType||(ri(y,u,o,n.createAddendum(),i,b,s,r)||(a=!1))}if(T){const o=d.slice(g.length).map((e=>e.type));let l,p=!1;if(m>=0){const e=F.FunctionType.getEffectiveParameterType(t,m);F.isVariadicTypeVar(e)?o.push(e):p=!0}l=1===o.length&&F.isVariadicTypeVar(o[0])?o[0]:Y&&F.isClass(Y)?P.convertToInstance(P.specializeTupleClass(Y,o,!0,!0,!0)):F.UnknownType.create(),p?(n.createAddendum().addMessage(h.Localizer.DiagnosticAddendum.argsParamWithVariadic().format({paramName:c[m].name})),a=!1):ri(F.FunctionType.getEffectiveParameterType(e,f),l,f,n.createAddendum(),i,b,s,r)||(a=!1)}else if(g.length<d.length){if(!e.details.paramSpec){const o=c.filter((e=>!!e.name&&!e.hasDefault)).length;if(f<0)g.length<o&&(n.createAddendum().addMessage(h.Localizer.DiagnosticAddendum.functionTooFewParams().format({expected:o,received:g.length})),a=!1);else{const o=F.FunctionType.getEffectiveParameterType(e,f);if(!F.isAnyOrUnknown(o))for(let e=g.length;e<d.length;e++){ri(o,F.FunctionType.getEffectiveParameterType(t,c.findIndex((t=>t===d[e]))),e,n.createAddendum(),i,b,s,r)||(a=!1)}}}}else if(d.length<g.length)if(m>=0){const o=F.FunctionType.getEffectiveParameterType(t,m);for(let t=d.length;t<g.length;t++){const l=F.FunctionType.getEffectiveParameterType(e,p.findIndex((e=>e===g[t])));F.isVariadicTypeVar(l)&&!F.isVariadicTypeVar(o)?(n.addMessage(h.Localizer.DiagnosticAddendum.typeVarTupleRequiresKnownLength()),a=!1):ri(l,o,t,n.createAddendum(),i,b,s,r)||(a=!1)}}else n.addMessage(h.Localizer.DiagnosticAddendum.functionTooManyParams().format({expected:d.length,received:g.length})),a=!1;if(m>=0&&f>=0){const o=F.FunctionType.getEffectiveParameterType(t,m);ri(F.FunctionType.getEffectiveParameterType(e,f),o,f,n.createAddendum(),i,b,s,r)||(a=!1)}if(m<0&&f>=0&&!T&&(n.createAddendum().addMessage(h.Localizer.DiagnosticAddendum.argsParamMissing().format({paramName:p[f].name})),a=!1),!e.details.paramSpec){const o=new Map;let l=!1;if(y>=0&&p.forEach(((e,t)=>{t>=y&&(2===e.category?l=!0:e.name&&0===e.category&&o.set(e.name,e))})),g.length<d.length&&f<0&&(u=g.length),u>=0&&c.forEach(((t,c)=>{if(c>=u&&t.name&&0===t.category){const c=o.get(t.name),p=n.createAddendum();if(c){const e=i?P.applySolvedTypeVars(c.type,i):c.type;ii(t.type,e,p.createAddendum(),void 0,s,r+1)||(p.addMessage(h.Localizer.DiagnosticAddendum.namedParamTypeMismatch().format({name:t.name,sourceType:yi(e),destType:yi(t.type)})),a=!1),o.delete(t.name)}else if(l||t.hasDefault){if(l){ri(F.FunctionType.getEffectiveParameterType(e,C),t.type,C,n.createAddendum(),i,b,s,r)||(a=!1)}}else p.addMessage(h.Localizer.DiagnosticAddendum.namedParamMissingInDest().format({name:t.name})),a=!1}})),o.forEach(((e,l)=>{if(S>=0&&e.name){const l=F.FunctionType.getEffectiveParameterType(t,S);ri(e.type,l,C,n.createAddendum(),i,b,s,r)||(a=!1),o.delete(e.name)}else{n.createAddendum().addMessage(h.Localizer.DiagnosticAddendum.namedParamMissingInSource().format({name:l})),a=!1}})),S>=0&&C>=0){const o=F.FunctionType.getEffectiveParameterType(t,S);ri(F.FunctionType.getEffectiveParameterType(e,C),o,C,n.createAddendum(),i,b,s,r)||(a=!1)}S<0&&C>=0&&(n.createAddendum().addMessage(h.Localizer.DiagnosticAddendum.argsParamMissing().format({paramName:p[C].name})),a=!1)}}if(i&&!i.isLocked()&&(b.getTypeVars().forEach((e=>{ii(e.typeVar,b.getTypeVarType(e.typeVar),new l.DiagnosticAddendum,i)})),i.getTypeVars().forEach((e=>{if(e.narrowBound){const t=P.applySolvedTypeVars(e.narrowBound,i);t!==e.narrowBound&&i.setTypeVarType(e.typeVar,t,e.wideBound,e.retainLiteral)}})),e.details.paramSpec&&i.setParamSpec(e.details.paramSpec,{parameters:t.details.parameters.map(((e,n)=>({category:e.category,name:e.name,hasDefault:!!e.hasDefault,type:F.FunctionType.getEffectiveParameterType(t,n)}))).slice(e.details.parameters.length,t.details.parameters.length)})),o){const o=$n(e);if(!F.isAnyOrUnknown(o)){const e=P.applySolvedTypeVars($n(t),b),l=n.createAddendum();ii(o,e,l.createAddendum(),i,s,r+1)||(l.addMessage(h.Localizer.DiagnosticAddendum.functionReturnTypeMismatch().format({sourceType:yi(e),destType:yi(o)})),a=!1)}}return a}function oi(e,t){if(t.details.typeParameters.length>0&&t.typeArguments&&t.typeArguments.length<=t.details.typeParameters.length){const n=new A.TypeVarMap(P.getTypeVarScopeId(t));ut(F.ClassType.cloneForSpecialization(t,void 0,!1),F.ObjectType.create(e),n,[]);let i=!1;const s=t.typeArguments.map(((e,s)=>{const r=t.details.typeParameters[s],a=n.getTypeVarType(r);return a&&(F.isAny(a)||F.isAnyOrUnknown(e))?(i=!0,a):e}));if(i)return F.ClassType.cloneForSpecialization(t,s,!0)}}function li(e,t){const n=new l.DiagnosticAddendum,i=P.mapSubtypes(t,(t=>{const i=P.mapSubtypes(e,(i=>{if(F.isAnyOrUnknown(e))return e;if(ii(i,t,n)){if(F.isClass(i)&&F.isClass(t)){const e=oi(i,t);e&&(t=e)}else if(F.isObject(i)&&F.isObject(t)){const e=oi(i.classType,t.classType);e&&(t=F.ObjectType.create(e))}else if(F.isAnyOrUnknown(t))return e;return t}}));return F.isNever(i)?t:i}));return F.isAnyOrUnknown(t)?e:i}function ci(e){const t=new Map;e.details.mro.forEach((e=>{F.isClass(e)&&e.details.fields.forEach(((n,i)=>{if(n.isClassMember()){let s;const r=D.getLastTypedDeclaredForSymbol(n);if(r&&3===r.type){s=!!(8&$t(r.node,!0))}else s=!1;t.has(i)||t.set(i,{symbol:n,symbolName:i,isAbstract:s,classType:e})}}))}));const n=[];return t.forEach((e=>{e.isAbstract&&n.push(e)})),n}function pi(e,t=!1){if(!e.details.typedDictEntries){const t=new Map;ui(e,t),e.details.typedDictEntries=t}const n=new Map;return e.details.typedDictEntries.forEach(((e,t)=>{n.set(t,Object.assign({},e))})),t&&e.typedDictNarrowedEntries&&e.typedDictNarrowedEntries.forEach(((e,t)=>{n.set(t,Object.assign({},e))})),n}function ui(e,t,n=0){o.assert(F.ClassType.isTypedDictClass(e)),n>F.maxTypeRecursionCount||(e.details.baseClasses.forEach((e=>{F.isClass(e)&&F.ClassType.isTypedDictClass(e)&&ui(e,t,n+1)})),e.details.fields.forEach(((n,i)=>{if(!n.isIgnoredForProtocolMatch()){const s=D.getLastTypedDeclaredForSymbol(n);if(s&&1===s.type){const r=Wn(n)||F.UnknownType.create();let a=!F.ClassType.isCanOmitDictValues(e);D.isRequiredTypedDictVariable(n)?a=!0:D.isNotRequiredTypedDictVariable(n)&&(a=!1);const o=t.get(i);if(o&&!F.isTypeSame(o.valueType,r)){const e=new l.DiagnosticAddendum;e.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldRedefinition().format({parentType:yi(o.valueType),childType:yi(r)})),Ue(Rn(s.node).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typedDictFieldRedefinition().format({name:i})+e.getString(),s.node)}t.set(i,{valueType:r,isRequired:a,isProvided:!1})}}})))}function di(e,t,n,i,s=0,r=!1,a){if(F.isFunction(t)){if(!e)return F.FunctionType.clone(t,!0);if(F.FunctionType.isInstanceMethod(t)){const r=F.isObject(e)?e:F.ObjectType.create(P.specializeClassType(e));return hi(e,t,n||r.classType,i,s+1,a||r,F.isObject(e))}if(F.FunctionType.isClassMethod(t)||r&&F.FunctionType.isConstructorMethod(t)){const r=F.isClass(e)?e:e.classType,o=a?F.isClass(e)?a:P.convertToInstantiable(a):r;return hi(e,t,n||r,i,s+1,o,!0)}if(F.FunctionType.isStaticMethod(t)){const r=F.isClass(e)?e:e.classType;return hi(e,t,n||r,i,s+1,void 0,!1)}}else if(F.isOverloadedFunction(t)){const o=F.OverloadedFunctionType.create();return t.overloads.forEach((t=>{const i=di(e,t,n,void 0,s+1,r,a);i&&F.OverloadedFunctionType.addOverload(o,i)})),1===o.overloads.length?o.overloads[0]:0===o.overloads.length?void(i&&t.overloads.forEach((t=>{di(e,t,n,i,s+1,r,a)}))):o}return t}function hi(e,t,n,i,s,r,a=!0){const o=n.typeArguments?P.buildTypeVarMapFromSpecializedClass(n):new A.TypeVarMap(P.getTypeVarScopeId(n));if(r&&t.details.parameters.length>0){const n=t.details.parameters[0],a=F.FunctionType.getEffectiveParameterType(t,0),p=P.stripLiteralValue(r);o.addSolveForScope(P.getTypeVarScopeId(t));const u=new l.DiagnosticAddendum;if(F.isTypeVar(a)&&a.details.boundType&&F.isObject(a.details.boundType)&&F.ClassType.isProtocolClass(a.details.boundType.classType))o.isLocked()||o.setTypeVarType(a,p);else if(!ii(a,p,u,o,void 0,s+1)&&n.name&&!n.isNameSynthesized&&n.hasDeclaredType){if(!i)return;Ue(Rn(i).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.bindTypeMismatch().format({type:yi(e),methodName:t.details.name,paramName:n.name})+u.getString(),i)}}$n(t);const p=P.applySolvedTypeVars(t,o);return F.FunctionType.clone(p,a,e,P.getTypeVarScopeId(e))}function mi(e){return k.printObjectTypeForClass(e,t.printTypeFlags,$n)}function yi(e,n=!1){return k.printType(e,t.printTypeFlags,$n,n)}function gi(e){return e.start}return{runWithCancellationToken:function(e,t){try{return q=e,t()}finally{q=void 0}},getType:de,getTypeOfClass:Vt,getTypeOfFunction:jt,evaluateTypesForStatement:hn,getDeclaredTypeForExpression:Ce,verifyRaiseExceptionType:function(e){const t=An(e,"BaseException");if(e.typeExpression){const n=de(e.typeExpression);if(n&&t&&F.isClass(t)){const i=new l.DiagnosticAddendum;if(P.doForEachSubtype(n,(n=>{const s=Be(n);if(!F.isAnyOrUnknown(s))if(F.isClass(s)&&void 0===s.literalValue)if(P.derivesFromClassRecursive(s,t,!1)){let t;Nn(e.typeExpression,(()=>{t=lt(e.typeExpression,[],s,!1,void 0)})),t&&t.argumentErrors&&i.addMessage(h.Localizer.Diagnostic.exceptionTypeNotInstantiable().format({type:yi(n,!1)}))}else i.addMessage(h.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:yi(n,!1)}));else F.isObject(s)&&P.derivesFromClassRecursive(s.classType,t,!1)||i.addMessage(h.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:yi(n,!1)}))})),!i.isEmpty()){Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.expectedExceptionClass()+i.getString(),e.typeExpression)}}}},verifyDeleteExpression:function(e){switch(e.nodeType){case 38:he(e,void 0,16384);break;case 35:{const t=he(e.leftExpression),n=Qe(e,t,{method:"del"},16384);se(e.memberName,n.type,!1),se(e,n.type,!1);break}case 24:{const t=he(e.baseExpression,void 0,2);tt(e,t.type,{method:"del"},16384),se(e,F.UnboundType.create(),!1);break}case 0:e.child&&Nn(e.child,(()=>{he(e.child,void 0,16384)}));break;default:Ue(Rn(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.delTargetExpr(),e);break}},isAfterNodeReachable:we,isNodeReachable:Ee,suppressDiagnostics:Nn,getDeclarationsForNameNode:function(e){var t;if(f.isCodeUnreachable(e))return;const n=[];if(e.parent&&23===e.parent.nodeType&&e.parent.alias&&e===e.parent.name){const t=b.getScopeForNode(e);if(t){const i=t.lookUpSymbolRecursive(e.parent.alias.value);if(i){const t=i.symbol.getDeclarations().filter((t=>6===t.type&&t.node===e.parent)).map((e=>{if(6===e.type){const t=Object.assign({},e);return t.usesLocalName=!1,t}return e}));n.push(...t)}}}else if(e.parent&&35===e.parent.nodeType&&e===e.parent.memberName){let t=de(e.parent.leftExpression);if(t){t=P.transformTypeObjectToClass(Be(t));const i=e.parent.memberName.value;P.doForEachSubtype(t,(e=>{let t;if(e=Be(e),F.isClass(e)){let n=P.lookUpClassMember(e,i,16);n||(n=P.lookUpClassMember(e,i)),n&&(t=n.symbol)}else if(F.isObject(e)){let n=P.lookUpObjectMember(e,i,16);n||(n=P.lookUpObjectMember(e,i)),n&&(t=n.symbol)}else F.isModule(e)&&(t=F.ModuleType.getField(e,i));if(t){const e=t.getTypedDeclarations();e.length>0?n.push(...e):n.push(...t.getDeclarations())}}))}}else if(e.parent&&37===e.parent.nodeType){const t=e.parent.nameParts.findIndex((t=>t===e)),i=f.getImportInfo(e.parent);if(t>=0&&i&&!i.isNativeLib&&t<i.resolvedPaths.length&&i.resolvedPaths[t]){hn(e);const s={type:6,node:void 0,path:i.resolvedPaths[t],range:d.getEmptyRange(),implicitImports:new Map,usesLocalName:!1,moduleName:""};n.push(s)}}else if(e.parent&&1===e.parent.nodeType&&e===e.parent.name){const i=e.parent,s=e.value;if(i.parent&&9===i.parent.nodeType){const e=de(i.parent.leftExpression);if(e)if(F.isFunction(e)&&e.details.declaration){const t=Mn(e,s);t&&n.push(t)}else if(F.isOverloadedFunction(e))e.overloads.forEach((e=>{const t=Mn(e,s);t&&n.push(t)}));else if(F.isClass(e)){const r=null===(t=Te(i.parent.leftExpression,F.ObjectType.create(e),"__init__",{method:"get"},new l.DiagnosticAddendum,4))||void 0===t?void 0:t.type;if(r&&F.isFunction(r)){const t=Mn(r,s);if(t)n.push(t);else if(F.ClassType.isDataClass(e)){const t=P.lookUpClassMember(e,s);t&&n.push(...t.symbol.getDeclarations())}}}}}else{let t=Rn(e).isStubFile;v.isWithinTypeAnnotation(e,!ye(Rn(e)))&&(t=!0);const i=wn(e,e.value,!t);i&&n.push(...i.symbol.getDeclarations())}return n},getTypeForDeclaration:Ln,resolveAliasDeclaration:Vn,getTypeFromIterable:xe,getTypeFromIterator:De,getTypedDictMembersForClass:pi,getGetterTypeFromProperty:ei,markNamesAccessed:function(e,t){const n=Rn(e),i=b.getScopeForNode(e);i&&t.forEach((t=>{const s=i.lookUpSymbolRecursive(t);s&&qe(n,s.symbol,e)}))},getScopeIdForNode:He,makeTopLevelTypeVarsConcrete:Be,getEffectiveTypeOfSymbol:zn,getFunctionDeclaredReturnType:Kn,getFunctionInferredReturnType:qn,getBuiltInType:An,getTypeOfMember:Hn,bindFunctionToClassOrObject:di,getCallSignatureInfo:function(e,t,n){const i=e.leftExpression,s=de(i);if(void 0===s)return;const r=[];let a=0;function o(){r.push({argumentCategory:a,type:F.UnknownType.create(),active:!0})}e.arguments.forEach(((e,i)=>{let s=!1;i===t&&(n?s=!0:o()),a=e.argumentCategory,r.push({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,name:e.name,active:s})})),e.arguments.length<t&&o();const l=[];function c(t){let n;On(e,(()=>{n=ht(i,r,t,new A.TypeVarMap(P.getTypeVarScopeId(t)),!0)})),l.push({type:t,activeParam:null==n?void 0:n.activeParam})}function p(e){F.isFunction(e)?c(e):e.overloads.forEach((e=>{F.FunctionType.isOverloaded(e)&&c(e)}))}return P.doForEachSubtype(s,(e=>{switch(e.category){case 5:case 6:p(e);break;case 7:{let t;t=ve(e,"__init__"),(!t||F.isFunction(t)&&F.FunctionType.isSkipConstructorCheck(t))&&(t=ve(e,"__new__",!0)),t&&p(t);break}case 8:{const t=ve(e.classType,"__call__");t&&p(t);break}}})),0!==l.length?{callNode:e,signatures:l}:void 0},getTypeAnnotationForParameter:be,canAssignType:ii,canOverrideMethod:function(e,t,n){if(F.isOverloadedFunction(e)&&(e=e.overloads[e.overloads.length-1]),!F.isFunction(e))return n.addMessage(h.Localizer.DiagnosticAddendum.overrideType().format({type:yi(e)})),!1;let i=!0;const s=e.details.parameters,r=t.details.parameters,a=r.find((e=>1===e.category&&!!e.name)),o=r.find((e=>2===e.category&&!!e.name));let l=!1;if(r.length<s.length)a&&o||(l=!0);else if(r.length>s.length)for(let e=s.length;e<r.length;e++){const t=r[e];0===t.category&&t.name&&!t.hasDefault&&(l=!0)}l&&(n.addMessage(h.Localizer.DiagnosticAddendum.overrideParamCount().format({baseCount:s.length,overrideCount:r.length})),i=!1);const c=Math.min(s.length,r.length),p=s.findIndex((e=>!e.name&&0===e.category));for(let a=0;a<c;a++){if(0===a&&(F.FunctionType.isInstanceMethod(t)||F.FunctionType.isClassMethod(t)||F.FunctionType.isConstructorMethod(t)))continue;const o=s[a],l=r[a];if(a>p&&!I.isPrivateOrProtectedName(o.name||"")&&0===o.category&&o.name!==l.name)0===l.category&&(n.addMessage(h.Localizer.DiagnosticAddendum.overrideParamName().format({index:a+1,baseName:o.name||"*",overrideName:l.name||"*"})),i=!1);else{const s=F.FunctionType.getEffectiveParameterType(e,a),r=F.FunctionType.getEffectiveParameterType(t,a),c=F.isTypeVar(s)&&s.details.isSynthesized,p=F.isTypeVar(r)&&r.details.isSynthesized;c||p||o.category===l.category&&ii(r,s,n.createAddendum(),void 0,8)||(n.addMessage(h.Localizer.DiagnosticAddendum.overrideParamType().format({index:a+1,baseType:yi(s),overrideType:yi(r)})),i=!1)}}const u=$n(e),d=$n(t);return ii(u,d,n.createAddendum(),void 0,8)||(n.addMessage(h.Localizer.DiagnosticAddendum.overrideReturnType().format({baseType:yi(u),overrideType:yi(d)})),i=!1),i},canAssignProtocolClassToSelf:function e(t,n,i=1){o.assert(F.ClassType.isProtocolClass(t)),o.assert(F.ClassType.isProtocolClass(n)),o.assert(F.ClassType.isSameGenericClass(t,n)),o.assert(t.details.typeParameters.length>0);const s=new l.DiagnosticAddendum,r=new A.TypeVarMap;let a=!0;return t.details.fields.forEach(((e,l)=>{if(a&&e.isClassMember()&&!e.isIgnoredForProtocolMatch()){const c=P.lookUpClassMember(n,l);o.assert(void 0!==c);let p=Wn(e);if(p){const e=Hn(c);p=P.partiallySpecializeType(p,t),F.isObject(p)&&F.ClassType.isPropertyClass(p.classType)&&F.isObject(e)&&F.ClassType.isPropertyClass(e.classType)?Zn(p.classType,e.classType,n,s,r,i+1)||(a=!1):ii(p,e,s,r,0,i+1)||(a=!1)}}})),t.details.baseClasses.forEach((s=>{if(F.isClass(s)&&!F.ClassType.isBuiltIn(s,"object")&&!F.ClassType.isBuiltIn(s,"Protocol")&&s.details.typeParameters.length>0){e(P.specializeForBaseClass(t,s),P.specializeForBaseClass(n,s),i+1)||(a=!1)}})),a},addError:Re,addWarning:function(e,t,n){return Me("warning",e,t,n)},addInformation:Oe,addUnusedCode:function(e,t){if(!Le(e)){Rn(e).diagnosticSink.addUnusedCodeWithTextRange(h.Localizer.Diagnostic.unreachableCode(),t)}},addDiagnostic:Ue,addDiagnosticForTextRange:function(e,t,n,i,s){if("none"===t)return;const r=e.diagnosticSink.addDiagnosticWithTextRange(t,i,s);return r.setRule(n),r},printType:yi,printFunctionParts:function(e){return k.printFunctionParts(e,t.printTypeFlags,$n)},getTypeCacheSize:function(){return z.size}}}},96938:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTypeEvaluatorWithTracker=void 0;const i=n(98173),s=n(76962),r=n(68755);t.createTypeEvaluatorWithTracker=function(e,t,n,a){if(!t.logCalls&&i.isDebugMode())return r.createTypeEvaluator(e,t,n,void 0);function o(e,i,r){return t.logCalls?n.log(e,(e=>(e.add(null==a?void 0:a.print(r)),s.timingStats.typeEvaluationTime.timeOperation(i))),t.minimumLoggingThreshold,!0):s.timingStats.typeEvaluationTime.timeOperation(i)}const l=t.logCalls?i=>n.log("import lookup",(t=>(t.add(null==a?void 0:a.printFileOrModuleName(i)),e(i))),t.minimumLoggingThreshold,!0):e,c=r.createTypeEvaluator(l,t,n,a);return{runWithCancellationToken:c.runWithCancellationToken,getType:e=>o("getType",(()=>c.getType(e)),e),getTypeOfClass:e=>o("getTypeOfClass",(()=>c.getTypeOfClass(e)),e),getTypeOfFunction:e=>o("getTypeOfFunction",(()=>c.getTypeOfFunction(e)),e),evaluateTypesForStatement:e=>o("evaluateTypesForStatement",(()=>c.evaluateTypesForStatement(e)),e),getDeclaredTypeForExpression:e=>o("getDeclaredTypeForExpression",(()=>c.getDeclaredTypeForExpression(e)),e),verifyRaiseExceptionType:e=>o("verifyRaiseExceptionType",(()=>c.verifyRaiseExceptionType(e)),e),verifyDeleteExpression:e=>o("verifyDeleteExpression",(()=>c.verifyDeleteExpression(e)),e),isAfterNodeReachable:e=>o("isAfterNodeReachable",(()=>c.isAfterNodeReachable(e)),e),isNodeReachable:e=>o("isNodeReachable",(()=>c.isNodeReachable(e)),e),suppressDiagnostics:(e,t)=>o("suppressDiagnostics",(()=>c.suppressDiagnostics(e,t))),getDeclarationsForNameNode:e=>o("getDeclarationsForNameNode",(()=>c.getDeclarationsForNameNode(e)),e),getTypeForDeclaration:e=>o("getTypeForDeclaration",(()=>c.getTypeForDeclaration(e)),e),resolveAliasDeclaration:(e,t)=>o("resolveAliasDeclaration",(()=>c.resolveAliasDeclaration(e,t)),e),getTypeFromIterable:(e,t,n)=>o("getTypeFromIterable",(()=>c.getTypeFromIterable(e,t,n)),e),getTypeFromIterator:(e,t,n)=>o("getTypeFromIterator",(()=>c.getTypeFromIterator(e,t,n)),e),getTypedDictMembersForClass:(e,t)=>o("getTypedDictMembersForClass",(()=>c.getTypedDictMembersForClass(e,t)),e),getGetterTypeFromProperty:(e,t)=>o("getGetterTypeFromProperty",(()=>c.getGetterTypeFromProperty(e,t)),e),markNamesAccessed:(e,t)=>o("markNamesAccessed",(()=>c.markNamesAccessed(e,t)),e),getScopeIdForNode:e=>o("getScopeIdForNode",(()=>c.getScopeIdForNode(e)),e),makeTopLevelTypeVarsConcrete:e=>o("makeTopLevelTypeVarsConcrete",(()=>c.makeTopLevelTypeVarsConcrete(e)),e),getEffectiveTypeOfSymbol:e=>o("getEffectiveTypeOfSymbol",(()=>c.getEffectiveTypeOfSymbol(e)),e),getFunctionDeclaredReturnType:e=>o("getFunctionDeclaredReturnType",(()=>c.getFunctionDeclaredReturnType(e)),e),getFunctionInferredReturnType:e=>o("getFunctionInferredReturnType",(()=>c.getFunctionInferredReturnType(e)),e),getBuiltInType:(e,t)=>o("getBuiltInType",(()=>c.getBuiltInType(e,t)),e),getTypeOfMember:e=>o("getTypeOfMember",(()=>c.getTypeOfMember(e)),e.symbol),bindFunctionToClassOrObject:(e,t)=>o("bindFunctionToClassOrObject",(()=>c.bindFunctionToClassOrObject(e,t)),t),getCallSignatureInfo:(e,t,n)=>o("getCallSignatureInfo",(()=>c.getCallSignatureInfo(e,t,n)),e),getTypeAnnotationForParameter:(e,t)=>o("getTypeAnnotationForParameter",(()=>c.getTypeAnnotationForParameter(e,t)),e),canAssignType:(e,t,n,i,s)=>o("canAssignType",(()=>c.canAssignType(e,t,n,i,s)),e),canOverrideMethod:(e,t,n)=>o("canOverrideMethod",(()=>c.canOverrideMethod(e,t,n)),t),canAssignProtocolClassToSelf:(e,t)=>o("canAssignProtocolClassToSelf",(()=>c.canAssignProtocolClassToSelf(e,t))),addError:(e,t)=>o("addError",(()=>c.addError(e,t)),t),addWarning:(e,t)=>o("addWarning",(()=>c.addWarning(e,t)),t),addInformation:(e,t)=>o("addInformation",(()=>c.addInformation(e,t)),t),addUnusedCode:(e,t)=>o("addUnusedCode",(()=>c.addUnusedCode(e,t)),e),addDiagnostic:(e,t,n,i)=>o("addDiagnostic",(()=>c.addDiagnostic(e,t,n,i)),i),addDiagnosticForTextRange:(e,t,n,i,s)=>o("addDiagnosticForTextRange",(()=>c.addDiagnosticForTextRange(e,t,n,i,s))),printType:(e,t)=>o("printType",(()=>c.printType(e,t)),e),printFunctionParts:e=>o("printFunctionParts",(()=>c.printFunctionParts(e)),e),getTypeCacheSize:c.getTypeCacheSize}}},22105:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.printFunctionParts=t.printObjectTypeForClass=t.printLiteralValue=t.printType=void 0;const a=r(n(23241)),o=n(59195),l=n(10425),c=/'/g,p=/'''/g;function u(e,t,n,i=!1,s=0){const r=0!=(16&t);if(t&=-17,s>=o.maxTypeRecursionCount)return"...";if(e.typeAliasInfo&&!i){let i=e.typeAliasInfo.name;const r=e.typeAliasInfo.typeParameters;if(r){let a;e.typeAliasInfo.typeArguments?(0==(2&t)||e.typeAliasInfo.typeArguments.some((e=>!o.isAnyOrUnknown(e))))&&(a=[],e.typeAliasInfo.typeArguments.forEach(((e,i)=>{const c=i<r.length?r[i]:r[r.length-1];o.isVariadicTypeVar(c)&&o.isObject(e)&&l.isTupleClass(e.classType)&&e.classType.tupleTypeArguments?e.classType.tupleTypeArguments.forEach((e=>{a.push(u(e,t,n,!1,s+1))})):a.push(u(e,t,n,!1,s+1))}))):(0==(2&t)||r.some((e=>!o.isAnyOrUnknown(e))))&&(a=[],r.forEach((e=>{a.push(u(e,t,n,!1,s+1))}))),a&&(0===a.length?i+="[()]":i+=`[${a.join(", ")}]`)}if(11!==e.category)return i}switch(e.category){case 0:return"Unbound";case 1:return 0!=(1&t)?"Any":"Unknown";case 9:return`Module("${e.moduleName}")`;case 7:return void 0!==e.literalValue?`Type[Literal[${d(e)}]]`:`Type[${h(e,t,n,s+1)}]`;case 8:return void 0!==e.classType.literalValue?`Literal[${d(e.classType)}]`:h(e.classType,t,n,s+1);case 5:{const i=m(e,t,n,s);if(e.details.paramSpec){if(e.details.parameters.length>0){return`Callable[Concatenate[${e.details.parameters.map((e=>u(e.type,t,n))).join(", ")}, ${e.details.paramSpec.details.name}], ${i[1]}]`}return`Callable[${e.details.paramSpec.details.name}, ${i[1]}]`}const r=`(${i[0].join(", ")})`;return o.FunctionType.isParamSpecValue(e)?r:`${r} -> ${i[1]}`}case 6:return`Overload[${e.overloads.map((e=>u(e,t,n,!1,s+1))).join(", ")}]`;case 10:{if(e.constraints&&(e=o.combineTypes(e.subtypes)),l.isOptionalType(e)){const i=u(o.removeNoneFromUnion(e),t,n,!1,s+1);return 8&t?i+" | None":"Optional["+i+"]"}let i=[];l.doForEachSubtype(e,(e=>{i.push(e)}));const a=e=>o.isClass(e)&&o.ClassType.isPseudoGenericClass(e)||o.isObject(e)&&o.ClassType.isPseudoGenericClass(e.classType);if(i.some((e=>a(e)))){const e=[];i.forEach((t=>{a(t)?o.isClass(t)?e.some((e=>o.isClass(e)&&o.ClassType.isSameGenericClass(e,t)))||e.push(t):o.isObject(t)&&(e.some((e=>o.isObject(e)&&o.ClassType.isSameGenericClass(e.classType,t.classType)))||e.push(t)):e.push(t)})),i=e}const c=e=>o.isObject(e)&&void 0!==e.classType.literalValue,p=e=>o.isClass(e)&&void 0!==e.literalValue,h=[];for(;i.length>0;){const e=i.shift();if(c(e)){const t=i.filter((e=>c(e)));t.unshift(e);const n=t.map((e=>d(e.classType)));h.push(`Literal[${n.join(", ")}]`),t.length>1&&(i=i.filter((e=>!c(e))))}else if(p(e)){const t=i.filter((e=>p(e)));t.unshift(e);const n=t.map((e=>d(e)));h.push(`Type[Literal[${n.join(", ")}]]`),t.length>1&&(i=i.filter((e=>!p(e))))}else h.push(u(e,t,n,!1,s+1))}const m=new Map,y=[];if(h.forEach((e=>{m.has(e)||(y.push(e),m.set(e,e))})),1===y.length)return y[0];if(8&t){const e=y.join(" | ");return r?`(${e})`:e}return`Union[${y.join(", ")}]`}case 11:{if(e.details.isSynthesized){if(e.details.recursiveTypeAliasName)return i&&e.details.boundType?u(e.details.boundType,t,n,i,s+1):e.details.recursiveTypeAliasName;if(e.details.boundType){const i=u(e.details.boundType,t,n,!1,s+1);return o.TypeBase.isInstantiable(e)?`Type[${i}]`:i}return 0!=(1&t)?"Any":"Unknown"}if(e.details.isParamSpec)return`${o.TypeVarType.getReadableName(e)}`;let r=o.TypeVarType.getReadableName(e);return e.isVariadicUnpacked&&(r=`*${r}`),o.TypeBase.isInstantiable(e)?`Type[${r}]`:r}case 3:return o.TypeBase.isInstantiable(e)?"NoneType":"None";case 4:return"Never";case 2:return e.isEllipsis?"...":"Any"}return""}function d(e){const t=e.literalValue;if(void 0===t)return"";let n;if("string"==typeof t){const i="bytes"===e.details.name?"b":"";n=t.toString(),n=n.indexOf("\n")>=0?`${i}'''${n.replace(p,"\\'\\'\\'")}'''`:`${i}'${n.replace(c,"\\'")}'`}else n="boolean"==typeof t?t?"True":"False":t instanceof o.EnumLiteral?`${t.className}.${t.itemName}`:t.toString();return n}function h(e,t,n,i=0){let s=e.aliasName||e.details.name;if(!o.ClassType.isPseudoGenericClass(e)){const r=o.ClassType.getTypeParameters(e),a=r.length>0?r[r.length-1]:void 0,l=!!a&&a.details.isVariadic,c=e.tupleTypeArguments||e.typeArguments;if(c)if(c.length>0){const e=[];let a=!0;c.forEach(((s,l)=>{const c=l<r.length?r[l]:void 0;c&&c.details.isVariadic&&o.isObject(s)&&o.ClassType.isBuiltIn(s.classType,"tuple")&&s.classType.tupleTypeArguments?0===s.classType.tupleTypeArguments.length?(o.isAnyOrUnknown(s)||(a=!1),e.push("()")):e.push(...s.classType.tupleTypeArguments.map((e=>(o.isAnyOrUnknown(e)||(a=!1),u(e,t,n,!1,i+1))))):(o.isAnyOrUnknown(s)||(a=!1),e.push(u(s,t,n,!1,i+1)))})),0!=(2&t)&&a||(s+="["+e.join(", ")+"]")}else(o.ClassType.isTupleClass(e)||l)&&(s+="[()]");else r.length>0&&(0==(2&t)||r.some((e=>!o.isAnyOrUnknown(e))))&&(s+="["+r.map((e=>u(e,t,n,!1,i+1))).join(", ")+"]")}return s}function m(e,t,n,i=0){const s=[];e.details.parameters.forEach(((r,l)=>{if(l===e.details.parameters.length-1&&1===r.category&&o.isVariadicTypeVar(r.type)){const r=o.FunctionType.getEffectiveParameterType(e,l);if(o.isObject(r)&&o.ClassType.isBuiltIn(r.classType,"tuple")&&r.classType.tupleTypeArguments)return void r.classType.tupleTypeArguments.forEach(((e,r)=>{const a=`_p${(l+r).toString()}: ${u(e,t,n,!1,i+1)}`;s.push(a)}))}let c="";1===r.category?c+="*":2===r.category&&(c+="**"),r.name&&(c+=r.name);let p="=";if(r.name)if(r.hasDeclaredType||r.isTypeInferred){const s=o.FunctionType.getEffectiveParameterType(e,l);c+=": "+(i<o.maxTypeRecursionCount?u(s,t,n,!1,i+1):""),o.isParamSpec(s)&&(1===r.category?c+=".args":2===r.category&&(c+=".kwargs")),p=" = "}else 0==(2&t)&&(c+=": Unknown",p=" = ");else 0===r.category&&(c+="/");r.hasDefault&&(r.defaultValueExpression?c+=p+a.printExpression(r.defaultValueExpression):c+=p+"..."),s.push(c)}));const r=n(e);let l=i<o.maxTypeRecursionCount?u(r,16|t,n,!1,i+1):"";return 8&t&&o.isUnion(r)&&i>0&&(l=`(${l})`),[s,l]}t.printType=u,t.printLiteralValue=d,t.printObjectTypeForClass=h,t.printFunctionParts=m},96786:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TypeStubWriter=void 0;const a=r(n(35696)),o=r(n(23241)),l=n(22339),c=n(57203),p=r(n(91197));class u{constructor(e){this.importName=e,this.isAccessed=!1}}class d extends u{constructor(e,t,n){super(e),this.alias=t,this.symbol=n}}class h extends u{constructor(e,t,n){super(e),this.isWildcardImport=t,this.node=n,this.symbols=[]}addSymbol(e,t,n,i=!1){this.symbols.find((e=>e.name===t))||this.symbols.push({symbol:e,name:t,alias:n,isAccessed:i})}}class m extends l.ParseTreeWalker{constructor(e,t){super(),this._accessedImportedSymbols=e,this._treatStringsAsSymbols=t}analyze(e){this.walk(e)}walk(e){a.isCodeUnreachable(e)||super.walk(e)}visitName(e){return this._accessedImportedSymbols.set(e.value,!0),!0}visitString(e){return this._treatStringsAsSymbols&&this._accessedImportedSymbols.set(e.value,!0),!0}}class y extends l.ParseTreeWalker{constructor(e,t,n){super(),this._stubPath=e,this._sourceFile=t,this._evaluator=n,this._indentAmount=0,this._includeAllImports=!1,this._typeStubText="",this._lineEnd="\n",this._tab="    ",this._classNestCount=0,this._functionNestCount=0,this._ifNestCount=0,this._emittedSuite=!1,this._emitDocString=!0,this._trackedImportAs=new Map,this._trackedImportFrom=new Map,this._accessedImportedSymbols=new Map,this._stubPath.endsWith("__init__.pyi")&&(this._includeAllImports=!0)}write(){const e=this._sourceFile.getParseResults();this._lineEnd=e.tokenizerOutput.predominantEndOfLineSequence,this._tab=e.tokenizerOutput.predominantTabSequence,this.walk(e.parseTree),this._writeFile()}walk(e){a.isCodeUnreachable(e)||super.walk(e)}visitClass(e){const t=e.name.value;this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n=`class ${t}`;return e.arguments.length>0&&(n+=`(${e.arguments.map((e=>{let t="";return e.name&&(t=e.name.value+"="),t+=this._printExpression(e.valueExpression),t})).join(", ")})`),n+=":",this._emitLine(n),this._emitSuite((()=>{this._classNestCount++,this.walk(e.suite),this._classNestCount--})),this._emitLine(""),this._emitLine(""),!1}visitFunction(e){const t=e.name.value;if(0===this._functionNestCount&&!p.isPrivateOrProtectedName(t)){this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n,i=e.isAsync?"async ":"";i+=`def ${t}`,i+=`(${e.parameters.map(((t,n)=>this._printParameter(t,e,n))).join(", ")})`,e.returnTypeAnnotation?n=this._printExpression(e.returnTypeAnnotation,!0):e.functionAnnotationComment?n=this._printExpression(e.functionAnnotationComment.returnTypeAnnotation,!0):"__init__"===e.name.value?n="None":"__str__"===e.name.value?n="str":["__int__","__hash__"].some((t=>t===e.name.value))?n="int":["__eq__","__ne__","__gt__","__lt__","__ge__","__le__"].some((t=>t===e.name.value))&&(n="bool"),n&&(i+=" -> "+n),i+=":",this._emitLine(i),this._emitSuite((()=>{this._functionNestCount++,this.walk(e.suite),this._functionNestCount--})),this._emitLine("")}return!1}visitWhile(e){return this._emitDocString=!1,!1}visitFor(e){return this._emitDocString=!1,!1}visitTry(e){return this._emitDocString=!1,!1}visitWith(e){return this._emitDocString=!1,!1}visitIf(e){if(this._emitDocString=!1,0===this._functionNestCount&&0===this._ifNestCount){this._ifNestCount++,this._emittedSuite=!0,this._emitLine("if "+this._printExpression(e.testExpression)+":"),this._emitSuite((()=>{this.walkMultiple(e.ifSuite.statements)}));const t=e.elseSuite;t&&(this._emitLine("else:"),this._emitSuite((()=>{19===t.nodeType?this.walkMultiple([t.testExpression,t.ifSuite,t.elseSuite]):this.walkMultiple(t.statements)}))),this._ifNestCount--}return!1}visitAssignment(e){let t=!1,n="";if(38===e.leftExpression.nodeType){if("__all__"===e.leftExpression.value)return!1;0===this._functionNestCount&&(n=this._printExpression(e.leftExpression),e.typeAnnotationComment&&(n+=": "+this._printExpression(e.typeAnnotationComment,!0)));const i=this._evaluator.getType(e.leftExpression);(null==i?void 0:i.typeAliasInfo)&&(t=!0)}else if(54===e.leftExpression.nodeType){const t=e.leftExpression.valueExpression;38===t.nodeType&&0===this._functionNestCount&&(n=`${this._printExpression(t)}: ${this._printExpression(e.leftExpression.typeAnnotation,!0)}`)}return n&&(this._emittedSuite=!0,n+=" = ",n+=t?this._printExpression(e.rightExpression):"...",this._emitLine(n)),!1}visitAugmentedAssignment(e){return!1}visitTypeAnnotation(e){if(0===this._functionNestCount){let t="";if(38===e.valueExpression.nodeType)t=this._printExpression(e.valueExpression);else if(35===e.valueExpression.nodeType){const n=e.valueExpression.leftExpression;if(38===n.nodeType&&"self"===n.value){const n=e.valueExpression.memberName.value;p.isPrivateOrProtectedName(n)||(t=this._printExpression(e.valueExpression))}}t&&(t+=": "+this._printExpression(e.typeAnnotation,!0),this._emitLine(t))}return!1}visitImport(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=c.getScopeForNode(e);return t&&e.list.forEach((e=>{const n=this._printModuleName(e.module);if(!this._trackedImportAs.has(n)){const i=e.alias?e.alias.value:e.module.nameParts.length>0?e.module.nameParts[0].value:"",s=t.lookUpSymbolRecursive(i);if(s){const t=new d(n,e.alias?e.alias.value:void 0,s.symbol);this._trackedImportAs.set(n,t)}}})),!1}visitImportFrom(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=c.getScopeForNode(e);if(t){const n=this._printModuleName(e.module);let i=this._trackedImportFrom.get(n);i||(i=new h(n,e.isWildcardImport,e),this._trackedImportFrom.set(n,i)),e.imports.forEach((e=>{const n=e.alias?e.alias.value:e.name.value,s=t.lookUpSymbolRecursive(n);s&&i.addSymbol(s.symbol,e.name.value,e.alias?e.alias.value:void 0,!1)}))}return!1}visitStatementList(e){return e.statements.length>0&&48===e.statements[0].nodeType&&!this._emittedSuite&&this._emitDocString&&this._emitLine(this._printExpression(e.statements[0])),this._emitDocString=!1,this.walkMultiple(e.statements),!1}_emitSuite(e){this._increaseIndent((()=>{const t=this._emittedSuite;this._emittedSuite=!1,e(),this._emittedSuite||this._emitLine("..."),this._emittedSuite=t}))}_increaseIndent(e){this._indentAmount++,e(),this._indentAmount--}_emitDecorators(e){e.forEach((e=>{this._emitLine("@"+this._printExpression(e.expression))}))}_printHeaderDocString(){return'"""'+this._lineEnd+"This type stub file was generated by pyright."+this._lineEnd+'"""'+this._lineEnd+this._lineEnd}_emitLine(e){for(let e=0;e<this._indentAmount;e++)this._typeStubText+=this._tab;this._typeStubText+=e+this._lineEnd}_printModuleName(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map((e=>e.value)).join("."),t}_printParameter(e,t,n){let i="";1===e.category?i+="*":2===e.category&&(i+="**"),e.name&&(i+=e.name.value);const s=this._evaluator.getTypeAnnotationForParameter(t,n);let r="";return s&&(r=this._printExpression(s,!0)),r&&(i+=": "+r),e.defaultValue&&(i+=r?" = ...":"=..."),i}_printExpression(e,t=!1,n=!1){return new m(this._accessedImportedSymbols,n).analyze(e),o.printExpression(e,t?1:0)}_printTrackedImports(){let e="",t=!1;return this._trackedImportAs.forEach((n=>{this._accessedImportedSymbols.get(n.alias||n.importName)&&(n.isAccessed=!0),(n.isAccessed||this._includeAllImports)&&(e+=`import ${n.importName}`,n.alias&&(e+=` as ${n.alias}`),e+=this._lineEnd,t=!0)})),this._trackedImportFrom.forEach((n=>{n.symbols.forEach((e=>{this._accessedImportedSymbols.get(e.alias||e.name)&&(e.isAccessed=!0)})),n.isWildcardImport&&(e+=`from ${n.importName} import *`+this._lineEnd,t=!0);const i=n.symbols.filter((e=>e.isAccessed||this._includeAllImports)).sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0));i.length>0&&(e+=`from ${n.importName} import `,e+=i.map((e=>{let t=e.name;return e.alias&&(t+=" as "+e.alias),t})).join(", "),e+=this._lineEnd,t=!0)})),t&&(e+=this._lineEnd),e}_writeFile(){let e=this._printHeaderDocString();e+=this._printTrackedImports(),e+=this._typeStubText,this._sourceFile.fileSystem.writeFileSync(this._stubPath,e,"utf8")}}t.TypeStubWriter=y},10425:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.containsUnknown=t.getMembersForModule=t.getMembersForClass=t.convertToInstantiable=t.convertToInstance=t.getDeclaredGeneratorReturnType=t.getDeclaredGeneratorSendType=t.getDeclaredGeneratorYieldType=t.removeTruthinessFromType=t.removeFalsinessFromType=t.derivesFromClassRecursive=t.specializeForBaseClass=t.buildTypeVarMap=t.buildTypeVarMapFromSpecializedClass=t.setTypeArgumentsRecursive=t.specializeClassType=t.selfSpecializeClassType=t.getTypeVarArgumentsRecursive=t.addTypeVarsToListIfUnique=t.getClassIterator=t.getClassMemberIterator=t.lookUpClassMember=t.lookUpObjectMember=t.transformExpectedTypeForConstructor=t.applySolvedTypeVars=t.partiallySpecializeType=t.isOpenEndedTupleClass=t.isTupleClass=t.isProperty=t.removeNoReturnFromUnion=t.isNoReturnType=t.isEllipsisType=t.containsLiteralType=t.isLiteralTypeOrUnion=t.isLiteralType=t.getSpecializedTupleType=t.getTypeVarScopeId=t.canBeTruthy=t.canBeFalsy=t.transformPossibleRecursiveTypeAlias=t.isTypeAliasRecursive=t.isTypeAliasPlaceholder=t.transformTypeObjectToClass=t.stripLiteralValue=t.getFullNameOfType=t.derivesFromAnyOrUnknown=t.areTypesSame=t.doForEachSubtype=t.mapSubtypes=t.isOptionalType=void 0,t.getDeclaringModulesForType=t.computeMroLinearization=t.requiresSpecialization=t.requiresTypeArguments=t.getGeneratorTypeArgs=t._transformTypeVars=t.specializeTupleClass=t.combineSameSizedTuples=t.isPartlyUnknown=void 0;const i=n(57082),s=n(97882),r=n(15020),a=n(59195),o=n(20670);let l=1;function c(e,t){if(a.isUnion(e)){const n=[];let i=!1;return e.subtypes.forEach(((s,r)=>{const a=e.constraints?e.constraints[r]:void 0,o=t(s);o?(n.push({type:o,constraints:a}),o!==s&&(i=!0)):i=!0})),i?a.combineConstrainedTypes(n):e}const n=t(e);return n||a.NeverType.create()}function p(e,t){a.isUnion(e)?e.constraints?e.subtypes.forEach(((n,i)=>{t(n,i,e.constraints[i])})):e.subtypes.forEach(((e,n)=>{t(e,n,void 0)})):t(e,0,void 0)}function u(e){return a.isObject(e)?(void 0!==e.classType.literalValue&&(e=a.ObjectType.create(a.ClassType.cloneWithLiteral(e.classType,void 0))),e):a.isClass(e)?(void 0!==e.literalValue&&(e=a.ClassType.cloneWithLiteral(e,void 0)),e):a.isUnion(e)?c(e,(e=>u(e))):e}function d(e){if(!a.isObject(e))return e;const t=e.classType;return a.ClassType.isBuiltIn(t,"Type")?!t.typeArguments||t.typeArguments.length<1||!t.isTypeArgumentExplicit?a.UnknownType.create():E(t.typeArguments[0]):e}function h(e,t=0){if(t>a.maxTypeRecursionCount)return!0;switch(e.category){case 0:case 1:case 2:case 4:case 3:return!0;case 10:return void 0!==a.findSubtype(e,(e=>h(e,t+1)));case 5:case 6:case 7:case 9:case 11:return!1;case 8:if(_(e.classType)&&e.classType.tupleTypeArguments)return v(e.classType)||0===e.classType.tupleTypeArguments.length;if(a.ClassType.isBuiltIn(e.classType,"bool")&&void 0!==e.classType.literalValue)return!1===e.classType.literalValue;if(C(e,"__len__"))return!0;return!!C(e,"__bool__")}}function m(e,t=0){if(t>a.maxTypeRecursionCount)return!0;switch(e.category){case 1:case 5:case 6:case 7:case 9:case 11:case 4:case 2:return!0;case 10:return void 0!==a.findSubtype(e,(e=>m(e,t+1)));case 0:case 3:return!1;case 8:return(!_(e.classType)||!e.classType.tupleTypeArguments||0!==e.classType.tupleTypeArguments.length)&&(!1!==e.classType.literalValue&&0!==e.classType.literalValue&&""!==e.classType.literalValue)}}function y(e){return a.isClass(e)?e.details.typeVarScopeId:a.isObject(e)?e.classType.details.typeVarScopeId:a.isFunction(e)?e.details.typeVarScopeId:a.isTypeVar(e)?e.scopeId:void 0}function g(e){return void 0!==e.classType.literalValue}function f(e){return a.isAny(e)&&e.isEllipsis}function T(e){return a.isObject(e)&&a.ClassType.isBuiltIn(e.classType,"NoReturn")}function _(e){return a.ClassType.isBuiltIn(e,"tuple")}function v(e){return e.tupleTypeArguments&&2===e.tupleTypeArguments.length&&f(e.tupleTypeArguments[1])}function b(e,t){if(a.ClassType.isGeneric(t))return e;return S(e,F(t))}function S(e,t,n=!1){return t.isEmpty()&&!n?e:N(e,{transformTypeVar:e=>{if(e.scopeId&&t.hasSolveForScope(e.scopeId)){const i=t.getTypeVarType(e);if(i)return i;if(n)return a.UnknownType.create()}return e},transformVariadicTypeVar:e=>{if(e.scopeId&&t.hasSolveForScope(e.scopeId))return t.getVariadicTypeVar(e)},transformParamSpec:e=>{if(e.scopeId&&t.hasSolveForScope(e.scopeId))return t.getParamSpec(e)}})}function C(e,t,n=0){if(a.isObject(e))return I(e.classType,t,n)}function I(e,t,n=0){var i;return null===(i=D(e,t,n).next())||void 0===i?void 0:i.value}function*D(e,t,n=0){const i=0!=(16&n);if(a.isClass(e)){let r=0;1&n&&(r|=1),2&n&&(r|=2),4&n&&(r|=4);const o=x(e,r);for(const[e,r]of o){if(!a.isClass(e)){if(!i){const e={symbol:s.Symbol.createWithType(0,a.UnknownType.create()),isInstanceMember:!1,classType:a.UnknownType.create(),isTypeDeclared:!1};yield e}continue}if(!a.isClass(r))continue;const o=r.details.fields;if(0==(8&n)){const e=o.get(t);if(e&&e.isInstanceMember()){const t=e.hasTypedDeclarations();if(!i||t){const n={symbol:e,isInstanceMember:!0,classType:r,isTypeDeclared:t};yield n}}}const l=o.get(t);if(l&&l.isClassMember()){const e=l.hasTypedDeclarations();if(!i||e){let t=!1;if(a.ClassType.isDataClass(r)||a.ClassType.isTypedDictClass(r)){const e=l.getDeclarations();e.length>0&&1===e[0].type&&(t=!0)}const n={symbol:l,isInstanceMember:t,classType:r,isTypeDeclared:e};yield n}}}}else if(a.isAnyOrUnknown(e)){const e={symbol:s.Symbol.createWithType(0,a.UnknownType.create()),isInstanceMember:!1,classType:a.UnknownType.create(),isTypeDeclared:!1};yield e}}function*x(e,t=0){if(a.isClass(e)){let n=0!=(1&t);for(const i of e.details.mro){if(n){n=!1;continue}const s=b(i,e);if(!(4&t&&a.isClass(s)&&a.ClassType.isBuiltIn(s,"object"))&&(yield[i,s],0!=(2&t)))break}}}function k(e,t){for(const n of t)e.find((e=>a.isTypeSame(e,n)))||e.push(n)}function F(e,t=!0){const n=a.ClassType.getTypeParameters(e);let i=e.typeArguments;i||t||(i=n);const s=P(n,i,y(e));return a.ClassType.isTupleClass(e)&&e.tupleTypeArguments&&n.length>=1&&s.setVariadicTypeVar(n[0],e.tupleTypeArguments),s}function P(e,t,n){const i=new o.TypeVarMap(n);return e.forEach(((e,n)=>{let s;if(t)if(a.isParamSpec(e)){if(n<t.length)if(s=t[n],a.isFunction(s)&&a.FunctionType.isParamSpecValue(s)){const t=[];s.details.parameters.forEach((e=>{t.push({category:e.category,name:e.name,hasDefault:!!e.hasDefault,type:e.type})})),i.setParamSpec(e,{parameters:t})}else a.isParamSpec(s)&&i.setParamSpec(e,{paramSpec:s})}else s=n>=t.length?a.AnyType.create():t[n],i.setTypeVarType(e,s,void 0,!0)})),i}function A(e){let t=c(e,(e=>{switch((e=d(e)).category){case 7:return a.ObjectType.create(e);case 3:return a.NoneType.createInstance();case 5:if(a.TypeBase.isInstantiable(e))return a.FunctionType.cloneAsInstance(e);break;case 11:if(a.TypeBase.isInstantiable(e))return a.TypeVarType.cloneAsInstance(e)}return e}));return e.typeAliasInfo&&e!==t&&(t=a.TypeBase.cloneForTypeAlias(t,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,e.typeAliasInfo.typeArguments)),t}function E(e){let t=c(e,(e=>{switch(e.category){case 8:return e.classType;case 3:return a.NoneType.createType();case 5:if(a.TypeBase.isInstance(e))return a.FunctionType.cloneAsInstantiable(e);break;case 11:if(a.TypeBase.isInstance(e))return a.TypeVarType.cloneAsInstantiable(e)}return e}));return e.typeAliasInfo&&e!==t&&(t=a.TypeBase.cloneForTypeAlias(t,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,e.typeAliasInfo.typeArguments)),t}function w(e,t,n=!0,i=!0,s=!1){let r=a.AnyType.create(!1);r=2===t.length&&f(t[1])?t[0]:a.combineTypes(t),i&&(r=u(r)),a.isNever(r)&&(r=a.AnyType.create());const o=a.ClassType.cloneForSpecialization(e,[r],n,void 0,t);return s&&(o.isTupleForUnpackedVariadicTypeVar=!0),o}function N(e,t,n=new Map,i=0){var s;if(i>a.maxTypeRecursionCount)return e;if(!L(e))return e;if(a.isAnyOrUnknown(e))return e;if(a.isNone(e))return e;if(a.isTypeVar(e)){if(e.details.recursiveTypeAliasName){if(!(null===(s=e.typeAliasInfo)||void 0===s?void 0:s.typeArguments))return e;let r=!1;const o=e.typeAliasInfo.typeArguments.map((e=>{const s=N(e,t,n,i+1);return s!==e&&(r=!0),s}));return r?a.TypeBase.cloneForTypeAlias(e,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,o):e}let r=e;const o=a.TypeVarType.getNameWithScope(e);return n.has(o)||(r=t.transformTypeVar(e),a.TypeBase.isInstantiable(e)&&!a.TypeBase.isInstantiable(r)&&(r=E(r)),n.set(o,e),r=N(r,t,n,i+1),n.delete(o)),r}if(a.isUnion(e))return c(e,(e=>{let s=N(e,t,n,i+1);if(a.isVariadicTypeVar(e)&&!a.isVariadicTypeVar(s)){const e=[];p(s,(t=>{a.isObject(t)&&_(t.classType)&&t.classType.tupleTypeArguments&&t.classType.isTupleForUnpackedVariadicTypeVar?e.push(...t.classType.tupleTypeArguments):e.push(t)})),s=a.combineTypes(e)}return s}));if(a.isObject(e)){const s=O(e.classType,t,n,i+1);if(a.ClassType.isBuiltIn(s,"Type")){const e=s.typeArguments;if(e&&e.length>=1){if(a.isObject(e[0]))return N(e[0].classType,t,n,i+1);if(a.isTypeVar(e[0])){const n=t.transformTypeVar(e[0]);if(n&&a.isObject(n))return n.classType}}}return s===e.classType?e:a.ObjectType.create(s)}if(a.isClass(e))return O(e,t,n,i+1);if(a.isFunction(e))return R(e,t,n,i+1);if(a.isOverloadedFunction(e)){let s=!1;const r=[];return e.overloads.forEach((e=>{const a=R(e,t,n,i);r.push(a),a!==e&&(s=!0)})),s?a.OverloadedFunctionType.create(r):e}return e}function O(e,t,n,i){if(0===a.ClassType.getTypeParameters(e).length&&!a.ClassType.isSpecialBuiltIn(e))return e;let s,r=[],o=!1;const l=a.ClassType.getTypeParameters(e),c=e=>{const n=t.transformParamSpec(e);if(n){if(n.parameters){const e=a.FunctionType.createInstance("","","",65536);return n.parameters.forEach((t=>{a.FunctionType.addParameter(e,{category:t.category,name:t.name,hasDefault:t.hasDefault,hasDeclaredType:!0,type:t.type})})),e}if(n.paramSpec)return n.paramSpec}return e};return e.typeArguments?r=e.typeArguments.map((e=>{if(a.isTypeVar(e)&&e.details.isParamSpec)return c(e);const s=N(e,t,n,i+1);return s!==e&&(o=!0),s})):l.forEach((e=>{let s=e;if(e.details.isParamSpec)s=c(e);else{const r=a.TypeVarType.getNameWithScope(e);n.has(r)||(s=t.transformTypeVar(e),s!==e&&(n.set(r,e),s=N(s,t,n,i+1),n.delete(r),o=!0))}r.push(s)})),a.ClassType.isTupleClass(e)&&(e.tupleTypeArguments?(s=[],e.tupleTypeArguments.forEach((e=>{const r=N(e,t,n,i+1);r!==e&&(o=!0),a.isVariadicTypeVar(e)&&a.isObject(r)&&_(r.classType)&&r.classType.tupleTypeArguments?s.push(...r.classType.tupleTypeArguments):s.push(r)}))):l.length>0&&(s=t.transformVariadicTypeVar(l[0]),s&&(o=!0))),o?a.ClassType.cloneForSpecialization(e,r,!0,void 0,s):e}function R(e,t,n,i){let s=e;if(s.details.paramSpec){const e=t.transformParamSpec(s.details.paramSpec);e&&(s=a.FunctionType.cloneForParamSpec(s,e))}const r=s.specializedTypes&&s.specializedTypes.returnType?s.specializedTypes.returnType:s.details.declaredReturnType,o=r?N(r,t,n,i+1):void 0;let l=r!==o;const c={parameterTypes:[],returnType:o};if(s.details.parameters.length>=2){const e=s.details.parameters[s.details.parameters.length-2],n=s.details.parameters[s.details.parameters.length-1],i=a.FunctionType.getEffectiveParameterType(s,s.details.parameters.length-2),r=a.FunctionType.getEffectiveParameterType(s,s.details.parameters.length-1);if(1===e.category&&2===n.category&&a.isParamSpec(i)&&a.isParamSpec(r)&&a.isTypeSame(i,r)){const e=t.transformParamSpec(i);e&&(s=a.FunctionType.cloneForParamSpecApplication(s,e))}}let p,u,d;for(let e=0;e<s.details.parameters.length;e++){const r=a.FunctionType.getEffectiveParameterType(s,e),o=N(r,t,n,i+1);c.parameterTypes.push(o),void 0===p&&a.isVariadicTypeVar(r)&&0===s.details.parameters[e].category&&(p=e,a.isObject(o)&&_(o.classType)&&o.classType.isTupleForUnpackedVariadicTypeVar&&(u=o.classType.tupleTypeArguments)),r!==o&&(l=!0)}if(!l)return s;if(s.inferredReturnType&&(d=N(s.inferredReturnType,t,n,i+1)),!u)return a.FunctionType.cloneForSpecialization(s,c,d);const h=a.FunctionType.createInstance("","","",64);return c.parameterTypes.forEach(((e,t)=>{if(t===p)u.forEach((e=>{a.FunctionType.addParameter(h,{category:0,name:`_p${h.details.parameters.length}`,isNameSynthesized:!0,type:e,hasDeclaredType:!0})}));else{const n=Object.assign({},s.details.parameters[t]);n.type=e,n.name&&n.isNameSynthesized&&(n.name=`_p${h.details.parameters.length}`),a.FunctionType.addParameter(h,n)}})),h.details.declaredReturnType=a.FunctionType.getSpecializedReturnType(s),h}function M(e){if(a.isObject(e)){const t=e.classType;if(a.ClassType.isBuiltIn(t)){const e=t.details.name;if("Generator"===e||"AsyncGenerator"===e)return t.typeArguments}}}function L(e,t=0){var n;switch(e.category){case 7:return e.typeArguments?!(t>a.maxTypeRecursionCount)&&void 0!==e.typeArguments.find((e=>L(e,t+1))):a.ClassType.getTypeParameters(e).length>0;case 8:return!(t>a.maxTypeRecursionCount)&&L(e.classType,t+1);case 5:{if(t>a.maxTypeRecursionCount)return!1;for(let n=0;n<e.details.parameters.length;n++)if(L(a.FunctionType.getEffectiveParameterType(e,n),t+1))return!0;const n=e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType;if(n){if(L(n,t+1))return!0}else if(e.inferredReturnType&&L(e.inferredReturnType,t+1))return!0;return!1}case 6:return void 0!==e.overloads.find((e=>L(e,t+1)));case 10:return void 0!==a.findSubtype(e,(e=>L(e,t+1)));case 11:if(!e.details.recursiveTypeAliasName)return!0;if(null===(n=e.typeAliasInfo)||void 0===n?void 0:n.typeArguments)return e.typeAliasInfo.typeArguments.some((e=>L(e,t+1)))}return!1}function U(e,t,n=0){if(n>a.maxTypeRecursionCount)return;const i=e=>{e&&!t.some((t=>t===e))&&t.push(e)};switch(e.category){case 7:i(e.details.moduleName);break;case 8:i(e.classType.details.moduleName);break;case 5:i(e.details.moduleName);break;case 6:e.overloads.forEach((e=>{U(e,t,n+1)}));break;case 10:p(e,(e=>{U(e,t,n+1)}));break;case 9:i(e.moduleName)}}t.isOptionalType=function(e){return!!a.isUnion(e)&&void 0!==a.findSubtype(e,(e=>a.isNone(e)))},t.mapSubtypes=c,t.doForEachSubtype=p,t.areTypesSame=function(e){if(e.length<2)return!0;for(let t=1;t<e.length;t++)if(!a.isTypeSame(e[0],e[t]))return!1;return!0},t.derivesFromAnyOrUnknown=function(e){let t=!1;return p(e,(n=>{a.isAnyOrUnknown(e)?t=!0:a.isClass(n)?a.ClassType.hasUnknownBaseClass(n)&&(t=!0):a.isObject(n)&&a.ClassType.hasUnknownBaseClass(n.classType)&&(t=!0)})),t},t.getFullNameOfType=function(e){var t;if(null===(t=e.typeAliasInfo)||void 0===t?void 0:t.fullName)return e.typeAliasInfo.fullName;switch(e.category){case 2:case 1:return"typing.Any";case 3:return"builtins.None";case 7:return e.details.fullName;case 8:return e.classType.details.fullName;case 5:return e.details.fullName;case 9:return e.moduleName;case 6:return e.overloads[0].details.fullName}},t.stripLiteralValue=u,t.transformTypeObjectToClass=d,t.isTypeAliasPlaceholder=function(e){return!!a.isTypeVar(e)&&(!!e.details.recursiveTypeAliasName&&!e.details.boundType)},t.isTypeAliasRecursive=function(e,t){return 10!==t.category?a.isUnbound(t)&&t.typeAliasInfo&&t.typeAliasInfo.name===e.details.recursiveTypeAliasName:void 0!==a.findSubtype(t,(t=>a.isTypeSame(e,t)))},t.transformPossibleRecursiveTypeAlias=function(e){var t;if(e&&a.isTypeVar(e)&&e.details.recursiveTypeAliasName&&e.details.boundType){const n=a.TypeBase.isInstance(e)?A(e.details.boundType):e.details.boundType;if(!(null===(t=e.typeAliasInfo)||void 0===t?void 0:t.typeArguments)||!e.details.recursiveTypeParameters)return n;return S(n,P(e.details.recursiveTypeParameters,e.typeAliasInfo.typeArguments,y(e)))}return e},t.canBeFalsy=h,t.canBeTruthy=m,t.getTypeVarScopeId=y,t.getSpecializedTupleType=function(e){let t;if(a.isClass(e)?t=e:a.isObject(e)&&(t=e.classType),!t)return;const n=t.details.mro.find((e=>a.isClass(e)&&_(e)));if(!n||!a.isClass(n))return;return a.ClassType.isSameGenericClass(t,n)?t:S(n,F(t))},t.isLiteralType=g,t.isLiteralTypeOrUnion=function(e){return a.isObject(e)?void 0!==e.classType.literalValue:!!a.isUnion(e)&&!a.findSubtype(e,(e=>!a.isObject(e)||void 0===e.classType.literalValue))},t.containsLiteralType=function(e){return!(!a.isObject(e)||!g(e))||!!a.isUnion(e)&&e.subtypes.some((e=>a.isObject(e)&&g(e)))},t.isEllipsisType=f,t.isNoReturnType=T,t.removeNoReturnFromUnion=function(e){return a.removeFromUnion(e,(e=>T(e)))},t.isProperty=function(e){return a.isObject(e)&&a.ClassType.isPropertyClass(e.classType)},t.isTupleClass=_,t.isOpenEndedTupleClass=v,t.partiallySpecializeType=b,t.applySolvedTypeVars=S,t.transformExpectedTypeForConstructor=function(e,t,n){const i=e=>n.some((t=>e.scopeId===t));if(a.isTypeVar(e))return i(e)?e:void 0;const s="__expected_type_scope_id",r="__expected_type_";return t.addSolveForScope(s),N(e,{transformTypeVar:e=>i(e)?e:(e=>{if(e.details.isSynthesized&&e.details.name.startsWith(r))return e;const t=a.TypeBase.isInstance(e);let n=a.TypeVarType.createInstance(`__expected_type_${l}`);return n.details.isSynthesized=!0,n.scopeId=s,n.nameWithScope=a.TypeVarType.makeNameWithScope(n.details.name,s),t||(n=E(n)),n.details.boundType=e.details.boundType,n.details.constraints=e.details.constraints,n.details.variance=e.details.variance,l++,n})(e),transformVariadicTypeVar:e=>{},transformParamSpec:e=>{}})},t.lookUpObjectMember=C,t.lookUpClassMember=I,t.getClassMemberIterator=D,t.getClassIterator=x,t.addTypeVarsToListIfUnique=k,t.getTypeVarArgumentsRecursive=function e(t,n=0){var i,s;if(n>a.maxTypeRecursionCount)return[];const r=t=>{const i=[];return t.typeArguments&&t.typeArguments.forEach((t=>{k(i,e(t,n+1))})),i};if(null===(i=t.typeAliasInfo)||void 0===i?void 0:i.typeArguments){const i=[];return null===(s=t.typeAliasInfo)||void 0===s||s.typeArguments.forEach((t=>{k(i,e(t,n+1))})),i}if(a.isTypeVar(t))return t.details.recursiveTypeAliasName?[]:[t];if(a.isClass(t))return r(t);if(a.isObject(t))return r(t.classType);if(a.isUnion(t)){const i=[];return p(t,(t=>{k(i,e(t,n+1))})),i}if(a.isFunction(t)){const i=[];for(let s=0;s<t.details.parameters.length;s++)k(i,e(a.FunctionType.getEffectiveParameterType(t,s),n+1));t.details.paramSpec&&k(i,[t.details.paramSpec]);const s=a.FunctionType.getSpecializedReturnType(t);return s&&k(i,e(s,n+1)),i}return[]},t.selfSpecializeClassType=function(e,t=!1){if(!a.ClassType.isGeneric(e)&&!t)return e;const n=a.ClassType.getTypeParameters(e);return a.ClassType.cloneForSpecialization(e,n,!1,t)},t.specializeClassType=function(e){const t=new o.TypeVarMap(y(e));return a.ClassType.getTypeParameters(e).forEach((e=>{t.setTypeVarType(e,a.UnknownType.create())})),S(e,t)},t.setTypeArgumentsRecursive=function e(t,n,i,s=0){if(!(s>a.maxTypeRecursionCount||i.isLocked()))switch(t.category){case 10:p(t,(t=>{e(t,n,i,s+1)}));break;case 7:t.typeArguments&&t.typeArguments.forEach((t=>{e(t,n,i,s+1)})),t.tupleTypeArguments&&t.tupleTypeArguments.forEach((t=>{e(t,n,i,s+1)}));break;case 8:e(t.classType,n,i,s+1);break;case 5:t.specializedTypes?(t.specializedTypes.parameterTypes.forEach((t=>{e(t,n,i,s+1)})),t.specializedTypes.returnType&&e(t.specializedTypes.returnType,n,i,s+1)):(t.details.parameters.forEach((t=>{e(t.type,n,i,s+1)})),t.details.declaredReturnType&&e(t.details.declaredReturnType,n,i,s+1));break;case 6:t.overloads.forEach((t=>{e(t,n,i,s+1)}));break;case 11:i.hasTypeVar(t)||i.setTypeVarType(t,n)}},t.buildTypeVarMapFromSpecializedClass=F,t.buildTypeVarMap=P,t.specializeForBaseClass=function(e,t){if(0===a.ClassType.getTypeParameters(t).length)return t;const n=S(t,F(e));return i.assert(a.isClass(n)),n},t.derivesFromClassRecursive=function e(t,n,i){if(a.ClassType.isSameGenericClass(t,n))return!0;for(const s of t.details.baseClasses)if(a.isClass(s)){if(e(s,n,i))return!0}else if(!i&&a.isAnyOrUnknown(s))return!0;return!1},t.removeFalsinessFromType=function(e){return c(e,(e=>{if(a.isObject(e)){if(void 0!==e.classType.literalValue)return e.classType.literalValue?e:void 0;if(a.ClassType.isBuiltIn(e.classType,"bool"))return a.ObjectType.create(a.ClassType.cloneWithLiteral(e.classType,!0))}if(m(e))return e}))},t.removeTruthinessFromType=function(e){return c(e,(e=>{if(a.isObject(e)){if(void 0!==e.classType.literalValue)return e.classType.literalValue?void 0:e;if(a.ClassType.isBuiltIn(e.classType,"bool"))return a.ObjectType.create(a.ClassType.cloneWithLiteral(e.classType,!1))}if(h(e))return e}))},t.getDeclaredGeneratorYieldType=function(e){const t=a.FunctionType.getSpecializedReturnType(e);if(t){const e=M(t);if(e&&e.length>=1)return e[0]}},t.getDeclaredGeneratorSendType=function(e){const t=a.FunctionType.getSpecializedReturnType(e);if(t){const e=M(t);return e&&e.length>=2?e[1]:a.UnknownType.create()}},t.getDeclaredGeneratorReturnType=function(e){const t=a.FunctionType.getSpecializedReturnType(e);if(t){const e=M(t);return e&&e.length>=3?e[2]:a.UnknownType.create()}},t.convertToInstance=A,t.convertToInstantiable=E,t.getMembersForClass=function(e,t,n){for(let i=0;i<e.details.mro.length;i++){const s=e.details.mro[i];if(a.isClass(s)){const e=a.ClassType.isTypedDictClass(s);s.details.fields.forEach(((i,s)=>{(i.isClassMember()||n&&i.isInstanceMember())&&(e&&r.isTypedDictMemberAccessedThroughIndex(i)||t.get(s)||t.set(s,i))}))}}if(!n){const n=e.details.effectiveMetaclass;if(n&&a.isClass(n))for(const e of n.details.mro){if(!a.isClass(e))break;e.details.fields.forEach(((e,n)=>{t.get(n)||t.set(n,e)}))}}},t.getMembersForModule=function(e,t){e.loaderFields&&e.loaderFields.forEach(((e,n)=>{t.set(n,e)})),e.fields.forEach(((e,n)=>{t.set(n,e)}))},t.containsUnknown=function(e){let t=!1;return p(e,(e=>{a.isUnknown(e)&&(t=!0)})),t},t.isPartlyUnknown=function e(t,n=!1,i=0){if(i>a.maxTypeRecursionCount)return!1;if(a.isUnknown(t))return!0;if(a.isUnion(t))return void 0!==a.findSubtype(t,(t=>e(t,n,i+1)));if(a.isObject(t))return e(t.classType,!1,i+1);if(a.isClass(t)){if(!n&&!a.ClassType.isPseudoGenericClass(t)){const s=t.tupleTypeArguments||t.typeArguments;if(s)for(const t of s)if(e(t,n,i+1))return!0}return!1}if(a.isOverloadedFunction(t))return t.overloads.some((t=>e(t,!1,i+1)));if(a.isFunction(t)){for(let n=0;n<t.details.parameters.length;n++)if(t.details.parameters[n].name){if(e(a.FunctionType.getEffectiveParameterType(t,n),!1,i+1))return!0}return!(!t.details.declaredReturnType||!e(t.details.declaredReturnType,!1,i+1))}return!1},t.combineSameSizedTuples=function(e,t){if(!t||!a.isClass(t))return;let n,i=!0;return p(e,(e=>{a.isObject(e)&&_(e.classType)&&!v(e.classType)&&e.classType.tupleTypeArguments?n?n.length===e.classType.tupleTypeArguments.length?e.classType.tupleTypeArguments.forEach(((e,t)=>{n[t].push(e)})):i=!1:n=e.classType.tupleTypeArguments.map((e=>[e])):i=!1})),i&&n?A(w(t,n.map((e=>a.combineTypes(e))))):void 0},t.specializeTupleClass=w,t._transformTypeVars=N,t.getGeneratorTypeArgs=M,t.requiresTypeArguments=function(e){if(e.details.typeParameters.length>0)return!e.details.typeParameters[0].details.isSynthesized;if(a.ClassType.isBuiltIn(e)){if(["Tuple","Callable","Generic","Type","Optional","Union","Final","Literal","Annotated","TypeGuard"].some((t=>t===(e.aliasName||e.details.name))))return!0}return!1},t.requiresSpecialization=L,t.computeMroLinearization=function(e){let t=!0;const n=[],i=e.details.baseClasses.filter((e=>!a.isClass(e)||!a.ClassType.isBuiltIn(e,"Generic")));i.forEach((e=>{if(a.isClass(e)){const t=F(e,!1);n.push(e.details.mro.map((e=>S(e,t))))}else n.push([e])})),n.push(i.map((t=>S(t,F(e,!1)))));const s=F(e,!1);e.details.mro.push(S(e,s));const r=(e,t)=>t.some((t=>t.findIndex((t=>a.isClass(t)&&a.ClassType.isSameGenericClass(t,e)))>0)),o=(e,t)=>{for(let n=0;n<t.length;n++)t[n]=t[n].filter((t=>!a.isClass(t)||!a.ClassType.isSameGenericClass(t,e)))};for(;;){let i,s=!1;for(let t=0;t<n.length;t++){const l=n[t];if(l.length>0){if(void 0===i&&(i=l),!a.isClass(l[0])){s=!0,e.details.mro.push(l[0]),l.shift();break}if(!r(l[0],n)){s=!0,e.details.mro.push(l[0]),o(l[0],n);break}}}if(!i)break;s||(t=!1,a.isClass(i[0])?(e.details.mro.push(i[0]),o(i[0],n)):(e.details.mro.push(i[0]),i.shift()))}return t},t.getDeclaringModulesForType=function(e){const t=[];return U(e,t),t}},20670:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeVarMap=void 0;const i=n(20823),s=n(59195),r=n(10425);class a{constructor(e){this._isLocked=!1,Array.isArray(e)?this._solveForScopes=e:this._solveForScopes=void 0!==e?[e]:void 0,this._typeVarMap=new Map,this._paramSpecMap=new Map}clone(){const e=new a;return this._solveForScopes&&(e._solveForScopes=[...this._solveForScopes]),this._typeVarMap.forEach((t=>{e.setTypeVarType(t.typeVar,t.narrowBound,t.wideBound,t.retainLiteral)})),this._paramSpecMap.forEach((t=>{e.setParamSpec(t.paramSpec,t.type)})),this._variadicTypeVarMap&&this._variadicTypeVarMap.forEach((t=>{e.setVariadicTypeVar(t.typeVar,t.types)})),e._isLocked=this._isLocked,e}copyFromClone(e){this._typeVarMap=e._typeVarMap,this._paramSpecMap=e._paramSpecMap,this._variadicTypeVarMap=e._variadicTypeVarMap,this._isLocked=e._isLocked}getSolveForScopes(){return this._solveForScopes}hasSolveForScope(e){return void 0!==e&&void 0!==this._solveForScopes&&this._solveForScopes.some((t=>t===e||t===s.WildcardTypeVarScopeId))}setSolveForScopes(e){this._solveForScopes=e}addSolveForScope(e){void 0===e||this.hasSolveForScope(e)||(this._solveForScopes||(this._solveForScopes=[]),this._solveForScopes.push(e))}isEmpty(){return 0===this._typeVarMap.size&&0===this._paramSpecMap.size}getScore(){let e=0;return this._typeVarMap.forEach((t=>{e+=1;const n=this.getTypeVarType(t.typeVar);e+=this._getComplexityScoreForType(n)})),e+=this._paramSpecMap.size,e}hasTypeVar(e){return this._typeVarMap.has(this._getKey(e))}getTypeVarType(e){const t=this._typeVarMap.get(this._getKey(e));if(t)return t.narrowBound||t.wideBound}setTypeVarType(e,t,n,s){i.assert(!this._isLocked);const r=this._getKey(e);this._typeVarMap.set(r,{typeVar:e,narrowBound:t,wideBound:n,retainLiteral:s})}getVariadicTypeVar(e){var t,n;return null===(n=null===(t=this._variadicTypeVarMap)||void 0===t?void 0:t.get(this._getKey(e)))||void 0===n?void 0:n.types}setVariadicTypeVar(e,t){i.assert(!this._isLocked);const n=this._getKey(e);this._variadicTypeVarMap||(this._variadicTypeVarMap=new Map),this._variadicTypeVarMap.set(n,{typeVar:e,types:t})}getTypeVar(e){const t=this._getKey(e);return this._typeVarMap.get(t)}getTypeVars(){const e=[];return this._typeVarMap.forEach((t=>{e.push(t)})),e}hasParamSpec(e){return this._paramSpecMap.has(this._getKey(e))}getParamSpec(e){var t;return null===(t=this._paramSpecMap.get(this._getKey(e)))||void 0===t?void 0:t.type}setParamSpec(e,t){i.assert(!this._isLocked),this._paramSpecMap.set(this._getKey(e),{paramSpec:e,type:t})}typeVarCount(){return this._typeVarMap.size}getWideTypeBound(e){const t=this._typeVarMap.get(this._getKey(e));if(t)return t.wideBound}getRetainLiterals(e){const t=this._typeVarMap.get(this._getKey(e));return!!(null==t?void 0:t.retainLiteral)}lock(){i.assert(!this._isLocked),this._isLocked=!0}isLocked(){return this._isLocked}_getKey(e){return s.TypeVarType.getNameWithScope(e)}_getComplexityScoreForType(e,t=0){if(t>s.maxTypeRecursionCount)return 0;switch(e.category){case 5:case 6:return.5;case 10:{let n=1;return e.subtypes.length<16&&r.doForEachSubtype(e,(e=>{const i=this._getComplexityScoreForType(e,t+1);i<n&&(n=i)})),n/2}case 7:return this._getComplexityScoreForClass(e,t+1);case 8:return this._getComplexityScoreForClass(e.classType,t+1)}return 0}_getComplexityScoreForClass(e,t){let n=0,i=0;e.tupleTypeArguments?e.tupleTypeArguments.forEach((e=>{n+=this._getComplexityScoreForType(e,t+1),i++})):e.typeArguments&&e.typeArguments.forEach((e=>{n+=this._getComplexityScoreForType(e,t+1),i++}));let s=.5;return i>0&&(s+=n/i*.5),s}}t.TypeVarMap=a},59195:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSameWithoutLiteralValue=t.combineConstrainedTypes=t.combineTypes=t.isUnionableType=t.findSubtype=t.removeFromUnion=t.removeNoneFromUnion=t.removeUnbound=t.removeUnknownFromUnion=t.removeAnyFromUnion=t.isTypeSame=t.getTypeAliasInfo=t.isOverloadedFunction=t.isFunction=t.isParamSpec=t.isUnpackedVariadicTypeVar=t.isVariadicTypeVar=t.isTypeVar=t.isModule=t.isObject=t.isClass=t.isPossiblyUnbound=t.isUnion=t.isUnbound=t.isAnyOrUnknown=t.isUnknown=t.isAny=t.isNone=t.isNever=t.TypeVarType=t.UnionType=t.SubtypeConstraint=t.AnyType=t.NeverType=t.NoneType=t.OverloadedFunctionType=t.FunctionType=t.ObjectType=t.ClassType=t.ModuleType=t.UnknownType=t.UnboundType=t.TypeBase=t.maxTypeRecursionCount=t.EnumLiteral=t.WildcardTypeVarScopeId=void 0;const i=n(20823);t.WildcardTypeVarScopeId="*";class s{constructor(e,t,n){this.className=e,this.itemName=t,this.itemType=n}}var r,a,o,l,c,p,u,d,h;function m(e){return 4===e.category}function y(e){return 3===e.category}function g(e){return 1===e.category}function f(e){return 2===e.category||1===e.category||!!_(e)&&void 0===e.subtypes.find((e=>!f(e)))}function T(e){return 0===e.category}function _(e){return 10===e.category}function v(e){return 7===e.category}function b(e){return 8===e.category}function S(e){return 11===e.category}function C(e){return _(e)&&1===e.subtypes.length&&(e=e.subtypes[0]),11===e.category&&e.details.isVariadic&&!!e.isVariadicUnpacked}function I(e,n,i=0){if(e.category!==n.category)return!1;if(i>t.maxTypeRecursionCount)return!0;switch(e.category){case 7:{const t=n;if(!o.isSameGenericClass(e,t,i+1))return!1;if(e.tupleTypeArguments&&t.tupleTypeArguments){const n=e.tupleTypeArguments||[],s=t.tupleTypeArguments||[];if(n.length!==s.length)return!1;for(let e=0;e<n.length;e++)if(!I(n[e],s[e],i+1))return!1}else{const n=e.typeArguments||[],s=t.typeArguments||[],r=Math.max(n.length,s.length);for(let e=0;e<r;e++){if(!I(e<n.length?n[e]:u.create(),e<s.length?s[e]:u.create(),i+1))return!1}}return!!o.isLiteralValueSame(e,t)}case 8:{const t=n;return I(e.classType,t.classType,i+1)}case 5:{const t=n,s=e.details.parameters,r=t.details.parameters;if(s.length!==r.length)return!1;for(let n=0;n<s.length;n++){const a=s[n],o=r[n];if(a.category!==o.category)return!1;if(a.name!==o.name)return!1;if(!I(c.getEffectiveParameterType(e,n),c.getEffectiveParameterType(t,n),i+1))return!1}let a=e.details.declaredReturnType;e.specializedTypes&&e.specializedTypes.returnType&&(a=e.specializedTypes.returnType);let o=t.details.declaredReturnType;return t.specializedTypes&&t.specializedTypes.returnType&&(o=t.specializedTypes.returnType),!!(!a&&!o||a&&o&&I(a,o,i+1))&&e.details.declaration===t.details.declaration}case 6:{const t=n;if(e.overloads.length!==t.overloads.length)return!1;for(let n=0;n<e.overloads.length;n++)if(!I(e.overloads[n],t.overloads[n],i+1))return!1;return!0}case 10:{const t=n,s=e.subtypes,r=t.subtypes;return s.length===r.length&&void 0===x(e,((e,n)=>!h.containsType(t,e,n,i+1)))}case 11:{const t=n;if(e.scopeId!==t.scopeId)return!1;if(e.details===t.details)return!0;if(e.details.name!==t.details.name||e.details.isParamSpec!==t.details.isParamSpec||e.details.isVariadic!==t.details.isVariadic||e.details.isSynthesized!==t.details.isSynthesized||e.details.variance!==t.details.variance)return!1;const s=e.details.boundType,r=t.details.boundType;if(s){if(!r||!I(s,r,i+1))return!1}else if(r)return!1;const a=e.details.constraints,o=t.details.constraints;if(a.length!==o.length)return!1;for(let e=0;e<a.length;e++)if(!I(a[e],o[e],i+1))return!1;return!0}case 9:{const t=n;return e.fields===t.fields||0===e.fields.size&&0===t.fields.size}}return!0}function D(e,t){if(_(e)){const n=[];if(e.subtypes.forEach(((i,s)=>{const r=e.constraints?e.constraints[s]:void 0;t(i,r)||n.push({type:i,constraints:r})})),n.length<e.subtypes.length)return k(n)}return e}function x(e,t){return _(e)?e.subtypes.find(((n,i)=>t(n,e.constraints?e.constraints[i]:void 0))):t(e,void 0)?e:void 0}function k(e,t){if(0===(e=e.filter((e=>4!==e.type.category))).length)return p.create();if(1===e.length&&!e[0].constraints&&!C(e[0].type))return e[0].type;let n=[];for(const t of e)if(_(t.type)){const e=t.type;e.subtypes.forEach(((i,s)=>{n.push({type:i,constraints:d.combine(e.constraints?e.constraints[s]:void 0,t.constraints)})}))}else n.push({type:t.type,constraints:t.constraints});if(n=n.sort(((e,t)=>{const n=e.type,i=t.type;return b(n)&&void 0!==n.classType.literalValue||v(n)&&void 0!==n.literalValue?1:b(i)&&void 0!==i.classType.literalValue||v(i)&&void 0!==i.literalValue?-1:b(n)&&n.classType.isEmptyContainer?1:b(i)&&i.classType.isEmptyContainer?-1:0})),0===n.length)return a.create();const i=h.create();let s=!1;return n.forEach(((e,n)=>{0===n?h.addType(i,e.type,e.constraints):void 0===t||i.subtypes.length<t?function(e,t,n){if(!n&&b(t)){if(o.isBuiltIn(t.classType,"str")&&void 0!==t.classType.literalValue&&void 0!==e.literalStrMap)return void(e.literalStrMap.has(t.classType.literalValue)||h.addType(e,t,n));if(o.isBuiltIn(t.classType,"int")&&void 0!==t.classType.literalValue&&void 0!==e.literalIntMap)return void(e.literalIntMap.has(t.classType.literalValue)||h.addType(e,t,n))}for(let i=0;i<e.subtypes.length;i++){const s=e.subtypes[i],r=e.constraints?e.constraints[i]:void 0;if(d.isSame(r,n)){if(I(s,t))return;if(b(s)&&b(t)){if(F(s,t)&&void 0===s.classType.literalValue)return;if(o.isBuiltIn(s.classType,"bool")&&o.isBuiltIn(t.classType,"bool")&&void 0!==t.classType.literalValue&&!t.classType.literalValue===s.classType.literalValue)return void(e.subtypes[i]=l.create(o.cloneWithLiteral(s.classType,void 0)))}if(b(t)&&t.classType.isEmptyContainer&&b(s)&&o.isSameGenericClass(s.classType,t.classType))return}}h.addType(e,t,n)}(i,e.type,e.constraints):s=!0})),s?u.create():1!==i.subtypes.length||i.constraints||C(i.subtypes[0])?i:i.subtypes[0]}function F(e,t){return!!I(e,t)||(v(t)&&void 0!==t.literalValue?I(e,t=o.cloneWithLiteral(t,void 0)):!(!b(t)||void 0===t.classType.literalValue)&&I(e,t=l.create(o.cloneWithLiteral(t.classType,void 0))))}t.EnumLiteral=s,t.maxTypeRecursionCount=16,function(e){e.isInstantiable=function(e){return 0!=(1&e.flags)},e.isInstance=function(e){return 0!=(2&e.flags)},e.isAnnotated=function(e){return 0!=(4&e.flags)},e.cloneForTypeAlias=function(e,t,n,i,s,r){const a=Object.assign({},e);return a.typeAliasInfo={name:t,fullName:n,typeParameters:s,typeArguments:r,typeVarScopeId:i},a},e.cloneForAnnotated=function(e){const t=Object.assign({},e);return t.flags|=4,t}}(r=t.TypeBase||(t.TypeBase={})),function(e){const t={category:0,flags:3};e.create=function(){return t}}(t.UnboundType||(t.UnboundType={})),function(e){const t={category:1,flags:3};e.create=function(){return t}}(a=t.UnknownType||(t.UnknownType={})),function(e){e.create=function(e,t,n){return{category:9,fields:n||new Map,loaderFields:new Map,flags:1,moduleName:e,filePath:t}},e.getField=function(e,t){let n=e.fields.get(t);return!n&&e.loaderFields&&(n=e.loaderFields.get(t)),n}}(t.ModuleType||(t.ModuleType={})),function(e){function n(e,t){return!!(1&e.details.flags)&&(void 0===t||(e.details.name===t||e.aliasName===t))}function i(n,i,s=0){if(s>t.maxTypeRecursionCount)return!0;if(n.details===i.details)return!0;const r=n.details,a=i.details;if(r===a)return!0;if(r.fullName!==a.fullName||r.flags!==a.flags||r.typeSourceId!==a.typeSourceId||r.baseClasses.length!==a.baseClasses.length||r.typeParameters.length!==a.typeParameters.length)return!1;if(e.isBuiltIn(n,"NamedTuple")&&e.isBuiltIn(i,"NamedTuple"))return!0;if(e.isBuiltIn(n,"tuple")&&e.isBuiltIn(i,"tuple"))return!0;for(let e=0;e<r.baseClasses.length;e++)if(!I(r.baseClasses[e],a.baseClasses[e],s+1))return!1;if((r.declaredMetaclass||a.declaredMetaclass)&&(!r.declaredMetaclass||!a.declaredMetaclass||!I(r.declaredMetaclass,a.declaredMetaclass,s+1)))return!1;for(let e=0;e<r.typeParameters.length;e++)if(!I(r.typeParameters[e],a.typeParameters[e],s+1))return!1;return!0}e.create=function(e,t,n,i,s,r,a,o,l){return{category:7,details:{name:e,fullName:t,moduleName:n,filePath:i,flags:s,typeSourceId:r,baseClasses:[],declaredMetaclass:a,effectiveMetaclass:o,mro:[],fields:new Map,typeParameters:[],docString:l},skipAbstractClassTest:!1,flags:1}},e.cloneForSpecialization=function(e,t,n,i=!1,s,r){const o=Object.assign({},e);return o.typeArguments=t?t.map((e=>m(e)?a.create():e)):void 0,o.isTypeArgumentExplicit=n,o.skipAbstractClassTest=i,o.tupleTypeArguments=s?s.map((e=>m(e)?a.create():e)):void 0,void 0!==r&&(o.isEmptyContainer=r),o},e.cloneWithLiteral=function(e,t){const n=Object.assign({},e);return n.literalValue=t,n},e.cloneForTypingAlias=function(e,t){const n=Object.assign({},e);return n.aliasName=t,n},e.cloneForNarrowedTypedDictEntries=function(e,t){const n=Object.assign({},e);return n.typedDictNarrowedEntries=t,n},e.cloneWithNewTypeParameters=function(e,t){const n=Object.assign({},e);return n.details=Object.assign({},n.details),n.details.typeParameters=t,n},e.isLiteralValueSame=function(e,t){return void 0===e.literalValue?void 0===t.literalValue:void 0!==t.literalValue&&(e.literalValue instanceof s?t.literalValue instanceof s&&e.literalValue.itemName===t.literalValue.itemName:e.literalValue===t.literalValue)},e.isGeneric=function(e){return e.details.typeParameters.length>0&&void 0===e.typeArguments},e.isSpecialBuiltIn=function(e,t){return!!(2&e.details.flags||e.aliasName)&&(void 0===t||e.details.name===t)},e.isBuiltIn=n,e.hasAbstractMethods=function(e){return!!(1024&e.details.flags)&&!e.skipAbstractClassTest},e.supportsAbstractMethods=function(e){return!!(512&e.details.flags)},e.isDataClass=function(e){return!!(4&e.details.flags)},e.isSkipSynthesizedDataClassInit=function(e){return!!(16&e.details.flags)},e.isSkipSynthesizedDataClassEq=function(e){return!!(32&e.details.flags)},e.isFrozenDataClass=function(e){return!!(8&e.details.flags)},e.isSynthesizedDataclassOrder=function(e){return!!(64&e.details.flags)},e.isTypedDictClass=function(e){return!!(128&e.details.flags)},e.isCanOmitDictValues=function(e){return!!(256&e.details.flags)},e.isEnumClass=function(e){return!!(1048576&e.details.flags)},e.isPropertyClass=function(e){return!!(2048&e.details.flags)},e.isFinal=function(e){return!!(4096&e.details.flags)},e.isProtocolClass=function(e){return!!(8192&e.details.flags)},e.isPseudoGenericClass=function(e){return!!(16384&e.details.flags)},e.getDataClassEntries=function(e){return e.details.dataClassEntries||[]},e.isRuntimeCheckable=function(e){return!!(32768&e.details.flags)},e.isTypingExtensionClass=function(e){return!!(65536&e.details.flags)},e.isPartiallyConstructed=function(e){return!!(131072&e.details.flags)},e.hasCustomClassGetItem=function(e){return!!(262144&e.details.flags)},e.isTupleClass=function(e){return!!(524288&e.details.flags)},e.getTypeParameters=function(e){return e.details.typeParameters},e.hasUnknownBaseClass=function(e){return e.details.mro.some((e=>f(e)))},e.isSameGenericClass=i,e.isDerivedFrom=function e(t,s,r){if(i(t,s))return r&&r.push(t),!0;if(n(t)&&n(s,"object"))return r&&r.push(s),!0;for(const n of t.details.baseClasses)if(v(n)){if(e(n,s,r))return r&&r.push(t),!0}else if(f(n))return r&&r.push(a.create()),!0;return!1}}(o=t.ClassType||(t.ClassType={})),function(e){e.create=function(e){return{category:8,classType:e,flags:2}}}(l=t.ObjectType||(t.ObjectType={})),function(e){function t(e,t,n,i,s,r){return{category:5,details:{name:e,fullName:t,moduleName:n,flags:i,parameters:[],docString:r},flags:s}}function n(e,t){return i.assert(t<e.details.parameters.length),e.specializedTypes?(i.assert(t<e.specializedTypes.parameterTypes.length),e.specializedTypes.parameterTypes[t]):e.details.parameters[t].type}e.createInstance=function(e,n,i,s,r){return t(e,n,i,s,2,r)},e.createInstantiable=function(e,n,i,s,r){return t(e,n,i,s,1,r)},e.clone=function(e,i=!1,s,r){const a=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return a.details=Object.assign({},e.details),i&&(e.details.parameters.length>0&&0===e.details.parameters[0].category?(e.details.parameters.length>0&&!e.details.parameters[0].isTypeInferred&&(a.strippedFirstParamType=n(e,0)),a.details.parameters=e.details.parameters.slice(1)):i=!1,a.boundToType=s,a.details.flags&=-4,a.details.flags|=4),void 0!==e.typeAliasInfo&&(a.typeAliasInfo=e.typeAliasInfo),e.specializedTypes&&(a.specializedTypes={parameterTypes:i?e.specializedTypes.parameterTypes.slice(1):e.specializedTypes.parameterTypes,returnType:e.specializedTypes.returnType}),a.inferredReturnType=e.inferredReturnType,a.boundTypeVarScopeId=r,a},e.cloneAsInstance=function(e){i.assert(r.isInstantiable(e));const t=Object.assign({},e);return t.flags&=-2,t.flags|=2,t},e.cloneAsInstantiable=function(e){i.assert(r.isInstance(e));const t=Object.assign({},e);return t.flags&=-3,t.flags|=1,t},e.cloneForSpecialization=function(e,n,s){const r=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return r.details=e.details,i.assert(n.parameterTypes.length===e.details.parameters.length),r.specializedTypes=n,s&&(r.inferredReturnType=s),r},e.cloneForParamSpec=function(e,n){const i=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return i.specializedTypes=e.specializedTypes,i.details=Object.assign({},e.details),delete i.details.paramSpec,n&&(n.parameters?(i.details.parameters=[...e.details.parameters,...n.parameters.map((e=>({category:e.category,name:e.name,hasDefault:e.hasDefault,isNameSynthesized:!1,hasDeclaredType:!0,type:e.type})))],i.specializedTypes&&n.parameters.forEach((e=>{i.specializedTypes.parameterTypes.push(e.type)}))):n.paramSpec&&(i.details.paramSpec=n.paramSpec)),i},e.cloneForParamSpecApplication=function(e,n){const i=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return i.details=Object.assign({},e.details),n.parameters?(i.details.parameters=i.details.parameters.slice(0,i.details.parameters.length-2),n.parameters.forEach((e=>{i.details.parameters.push({category:e.category,name:e.name,hasDefault:e.hasDefault,isNameSynthesized:!1,hasDeclaredType:!0,type:e.type})}))):n.paramSpec&&(i.details.paramSpec=n.paramSpec),i},e.addDefaultParameters=function(t,n=!1){e.addParameter(t,{category:1,name:"args",type:n?a.create():u.create(),hasDeclaredType:!n}),e.addParameter(t,{category:2,name:"kwargs",type:n?a.create():u.create(),hasDeclaredType:!n})},e.isInstanceMethod=function(e){return 0==(7&e.details.flags)},e.isConstructorMethod=function(e){return 0!=(1&e.details.flags)},e.isStaticMethod=function(e){return 0!=(4&e.details.flags)},e.isClassMethod=function(e){return 0!=(2&e.details.flags)},e.isAbstractMethod=function(e){return 0!=(8&e.details.flags)},e.isGenerator=function(e){return 0!=(16&e.details.flags)},e.isSynthesizedMethod=function(e){return 0!=(64&e.details.flags)},e.isSkipConstructorCheck=function(e){return 0!=(128&e.details.flags)},e.isOverloaded=function(e){return 0!=(256&e.details.flags)},e.isDefaultParameterCheckDisabled=function(e){return 0!=(32&e.details.flags)},e.isAsync=function(e){return 0!=(512&e.details.flags)},e.isWrapReturnTypeInAwait=function(e){return 0!=(1024&e.details.flags)},e.isStubDefinition=function(e){return 0!=(2048&e.details.flags)},e.isPyTypedDefinition=function(e){return 0!=(4096&e.details.flags)},e.isFinal=function(e){return 0!=(8192&e.details.flags)},e.hasUnannotatedParams=function(e){return 0!=(16384&e.details.flags)},e.shouldSkipParamCompatibilityCheck=function(e){return 0!=(32768&e.details.flags)},e.isParamSpecValue=function(e){return 0!=(65536&e.details.flags)},e.getEffectiveParameterType=n,e.addParameter=function(e,t){e.details.parameters.push(t)},e.getSpecializedReturnType=function(e){return e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType}}(c=t.FunctionType||(t.FunctionType={})),function(e){e.create=function(e=[]){return{category:6,overloads:e,flags:2}},e.addOverload=function(e,t){e.overloads.push(t)}}(t.OverloadedFunctionType||(t.OverloadedFunctionType={})),function(e){const t={category:3,flags:2},n={category:3,flags:1};e.createInstance=function(){return t},e.createType=function(){return n}}(t.NoneType||(t.NoneType={})),function(e){const t={category:4,flags:3};e.create=function(){return t}}(p=t.NeverType||(t.NeverType={})),function(e){const t={category:2,isEllipsis:!1,flags:3},n={category:2,isEllipsis:!0,flags:3};e.create=function(e=!1){return e?n:t}}(u=t.AnyType||(t.AnyType={})),function(e){function t(e,t){return e.typeVarName<t.typeVarName?-1:e.typeVarName>t.typeVarName?1:e.constraintIndex<t.constraintIndex?-1:e.constraintIndex>t.constraintIndex?1:0}e.combine=function(e,n){if(!e)return n;if(!n)return e;const i=[...e];return n.forEach((e=>{i.some((n=>0===t(e,n)))||i.push(e)})),i.sort(t)},e.isSame=function(e,t){return e?!(!t||e.length!==t.length)&&void 0===e.find(((e,n)=>e.typeVarName!==t[n].typeVarName||e.constraintIndex!==t[n].constraintIndex)):!t},e.isCompatible=function(e,t){if(!e||!t)return!0;for(const n of e){let e=!1;const i=t.find((t=>n.typeVarName===t.typeVarName&&(e=!0,n.constraintIndex===t.constraintIndex)));if(e&&!i)return!1}return!0}}(d=t.SubtypeConstraint||(t.SubtypeConstraint={})),function(e){e.create=function(){return{category:10,subtypes:[],flags:3}},e.addType=function(e,t,n){b(t)&&o.isBuiltIn(t.classType,"str")&&void 0!==t.classType.literalValue&&!n?(void 0===e.literalStrMap&&(e.literalStrMap=new Map),e.literalStrMap.set(t.classType.literalValue,t)):b(t)&&o.isBuiltIn(t.classType,"int")&&void 0!==t.classType.literalValue&&!n&&(void 0===e.literalIntMap&&(e.literalIntMap=new Map),e.literalIntMap.set(t.classType.literalValue,t)),n&&(e.constraints||(e.constraints=Array.from({length:e.subtypes.length})),e.constraints.push(n)),e.flags&=t.flags,e.subtypes.push(t)},e.containsType=function(e,t,n,i=0){if(b(t)){if(o.isBuiltIn(t.classType,"str")&&void 0!==t.classType.literalValue&&void 0!==e.literalStrMap)return e.literalStrMap.has(t.classType.literalValue);if(o.isBuiltIn(t.classType,"int")&&void 0!==t.classType.literalValue&&void 0!==e.literalIntMap)return e.literalIntMap.has(t.classType.literalValue)}return void 0!==e.subtypes.find((e=>I(e,t,i+1)))}}(h=t.UnionType||(t.UnionType={})),function(e){function t(e,t){return`${e}.${t}`}function n(e,t,n){return{category:11,details:{name:e,constraints:[],variance:0,isParamSpec:t,isVariadic:!1,isSynthesized:!1},flags:n}}e.createInstance=function(e){return n(e,!1,2)},e.createInstantiable=function(e,t=!1){return n(e,t,1)},e.cloneAsInstance=function(e){i.assert(r.isInstantiable(e));const t=Object.assign({},e);return t.flags&=-2,t.flags|=2,t},e.cloneAsInstantiable=function(e){i.assert(r.isInstance(e));const t=Object.assign({},e);return t.flags&=-3,t.flags|=1,t},e.cloneForScopeId=function(e,n,i){const s=Object.assign({},e);return s.nameWithScope=t(e.details.name,n),s.scopeId=n,s.scopeName=i,s},e.cloneForUnpacked=function(e){i.assert(e.details.isVariadic);const t=Object.assign({},e);return t.isVariadicUnpacked=!0,t},e.cloneForPacked=function(e){i.assert(e.details.isVariadic);const t=Object.assign({},e);return t.isVariadicUnpacked=!1,t},e.cloneAsInvariant=function(e){if(e.details.isParamSpec||e.details.isVariadic)return e;if(0===e.details.variance&&void 0===e.details.boundType&&0===e.details.constraints.length)return e;const t=Object.assign({},e);return t.details=Object.assign({},t.details),t.details.variance=0,t.details.boundType=void 0,t.details.constraints=[],t},e.makeNameWithScope=t,e.addConstraint=function(e,t){e.details.constraints.push(t)},e.getNameWithScope=function(e){return e.nameWithScope||e.details.name},e.getReadableName=function(e){return e.scopeName?`${e.details.name}@${e.scopeName}`:e.details.name}}(t.TypeVarType||(t.TypeVarType={})),t.isNever=m,t.isNone=y,t.isAny=function(e){return 2===e.category},t.isUnknown=g,t.isAnyOrUnknown=f,t.isUnbound=T,t.isUnion=_,t.isPossiblyUnbound=function e(t){return!!T(t)||!!_(t)&&void 0!==t.subtypes.find((t=>e(t)))},t.isClass=v,t.isObject=b,t.isModule=function(e){return 9===e.category},t.isTypeVar=S,t.isVariadicTypeVar=function(e){return 11===e.category&&e.details.isVariadic},t.isUnpackedVariadicTypeVar=C,t.isParamSpec=function(e){return 11===e.category&&e.details.isParamSpec},t.isFunction=function(e){return 5===e.category},t.isOverloadedFunction=function(e){return 6===e.category},t.getTypeAliasInfo=function(e){return e.typeAliasInfo?e.typeAliasInfo:S(e)&&e.details.recursiveTypeAliasName&&e.details.boundType&&e.details.boundType.typeAliasInfo?e.details.boundType.typeAliasInfo:void 0},t.isTypeSame=I,t.removeAnyFromUnion=function(e){return D(e,(e=>f(e)))},t.removeUnknownFromUnion=function(e){return D(e,(e=>g(e)))},t.removeUnbound=function(e){return _(e)?D(e,(e=>T(e))):T(e)?a.create():e},t.removeNoneFromUnion=function(e){return D(e,(e=>y(e)))},t.removeFromUnion=D,t.findSubtype=x,t.isUnionableType=function(e){let t=3;for(const n of e)t&=n.flags;return 0!=(1&t)&&0==(2&t)},t.combineTypes=function(e,t){return k(e.map((e=>({type:e,constraints:void 0}))),t)},t.combineConstrainedTypes=k,t.isSameWithoutLiteralValue=F},69546:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundAnalysisRunnerBase=t.BackgroundAnalysisBase=void 0;const o=n(65013),l=n(20166),c=n(67145),p=n(73054),u=n(15179),d=n(38213),h=n(14943),m=n(11043),y=r(n(20823)),g=n(24319),f=n(77134);t.BackgroundAnalysisBase=class{constructor(e){this.console=e,this._onAnalysisCompletion=l.nullCallback}setup(e){this._worker=e,e.on("message",(e=>this.onMessage(e))),e.on("error",(e=>{this.log(m.LogLevel.Error,`Error occurred on background thread: ${JSON.stringify(e)}`)}))}onMessage(e){switch(e.requestType){case"log":{const t=e.data;this.log(t.level,t.message);break}case"analysisResult":this._onAnalysisCompletion(_(e.data));break;default:y.fail(`${e.requestType} is not expected`)}}setCompletionCallback(e){this._onAnalysisCompletion=null!=e?e:l.nullCallback}setConfigOptions(e){this.enqueueRequest({requestType:"setConfigOptions",data:e})}setTrackedFiles(e){this.enqueueRequest({requestType:"setTrackedFiles",data:e})}setAllowedThirdPartyImports(e){this.enqueueRequest({requestType:"setAllowedThirdPartyImports",data:e})}ensurePartialStubPackages(e){this.enqueueRequest({requestType:"ensurePartialStubPackages",data:{executionRoot:e}})}setFileOpened(e,t,n){this.enqueueRequest({requestType:"setFileOpened",data:{filePath:e,version:t,contents:n}})}setFileClosed(e){this.enqueueRequest({requestType:"setFileClosed",data:e})}markAllFilesDirty(e){this.enqueueRequest({requestType:"markAllFilesDirty",data:e})}markFilesDirty(e,t){this.enqueueRequest({requestType:"markFilesDirty",data:{filePaths:e,evenIfContentsAreSame:t}})}startAnalysis(e,t){this._startOrResumeAnalysis("analyze",e,t)}_startOrResumeAnalysis(e,t,n){const{port1:i,port2:s}=new o.MessageChannel;i.on("message",(e=>{switch(e.requestType){case"analysisResult":this._onAnalysisCompletion(_(e.data));break;case"analysisPaused":d.disposeCancellationToken(n),s.close(),i.close(),this._startOrResumeAnalysis("resumeAnalysis",t,n);break;case"indexResult":{const{path:n,indexResults:i}=e.data;null==t||t.setWorkspaceIndex(n,i);break}case"analysisDone":d.disposeCancellationToken(n),s.close(),i.close();break;default:y.fail(`${e.requestType} is not expected`)}}));const r=d.getCancellationTokenId(n);this.enqueueRequest({requestType:e,data:r,port:s})}startIndexing(e,t){}refreshIndexing(e,t){}cancelIndexing(e){}getDiagnosticsForRange(e,t,n){return a(this,void 0,void 0,(function*(){d.throwIfCancellationRequested(n);const{port1:i,port2:s}=new o.MessageChannel,r=u.getBackgroundWaiter(i),a=d.getCancellationTokenId(n);this.enqueueRequest({requestType:"getDiagnosticsForRange",data:{filePath:e,range:t,cancellationId:a},port:s});const l=yield r;return s.close(),i.close(),v(l)}))}writeTypeStub(e,t,n,i){return a(this,void 0,void 0,(function*(){d.throwIfCancellationRequested(i);const{port1:s,port2:r}=new o.MessageChannel,a=u.getBackgroundWaiter(s),l=d.getCancellationTokenId(i);this.enqueueRequest({requestType:"writeTypeStub",data:{targetImportPath:e,targetIsSingleFile:t,stubPath:n,cancellationId:l},port:r}),yield a,r.close(),s.close()}))}invalidateAndForceReanalysis(){this.enqueueRequest({requestType:"invalidateAndForceReanalysis",data:null})}restart(){this.enqueueRequest({requestType:"restart",data:null})}enqueueRequest(e){this._worker&&this._worker.postMessage(e,e.port?[e.port]:void 0)}log(e,t){m.log(this.console,e,t)}};class T extends u.BackgroundThreadBase{constructor(e){super(o.workerData),this._extension=e;const t=o.workerData;this.log(m.LogLevel.Info,`Background analysis(${o.threadId}) root directory: ${t.rootDirectory}`),this._configOptions=new h.ConfigOptions(t.rootDirectory),this._importResolver=this.createImportResolver(this.fs,this._configOptions);const n=this.getConsole();this._logTracker=new f.LogTracker(n,`BG(${o.threadId})`),this._program=new p.Program(this._importResolver,this._configOptions,n,this._extension,this._logTracker)}get program(){return this._program}start(){this.log(m.LogLevel.Info,`Background analysis(${o.threadId}) started`),null===o.parentPort||void 0===o.parentPort||o.parentPort.on("message",(e=>this.onMessage(e))),null===o.parentPort||void 0===o.parentPort||o.parentPort.on("error",(e=>y.fail(`failed ${e}`))),null===o.parentPort||void 0===o.parentPort||o.parentPort.on("exit",(e=>{0!==e&&y.fail(`worker stopped with exit code ${e}`)}))}onMessage(e){switch(this.log(m.LogLevel.Log,`Background analysis message: ${e.requestType}`),e.requestType){case"analyze":{const t=e.port,n=d.getCancellationTokenFromId(e.data),i=this.program.getFilesToAnalyzeCount();this._onAnalysisCompletion(t,{diagnostics:[],filesInProgram:this.program.getFileCount(),filesRequiringAnalysis:i,checkingOnlyOpenFiles:this.program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:0}),this._analyzeOneChunk(t,n,e);break}case"resumeAnalysis":{const t=e.port,n=d.getCancellationTokenFromId(e.data);this._analyzeOneChunk(t,n,e);break}case"getDiagnosticsForRange":u.run((()=>{const{filePath:t,range:n,cancellationId:i}=e.data,s=d.getCancellationTokenFromId(i);return d.throwIfCancellationRequested(s),this.program.getDiagnosticsForRange(t,n)}),e.port);break;case"writeTypeStub":u.run((()=>{const{targetImportPath:t,targetIsSingleFile:n,stubPath:i,cancellationId:s}=e.data,r=d.getCancellationTokenFromId(s);l.analyzeProgram(this.program,void 0,this._configOptions,l.nullCallback,this.getConsole(),r),this.program.writeTypeStub(t,n,i,r)}),e.port);break;case"setConfigOptions":this._configOptions=u.createConfigOptionsFrom(e.data),this._importResolver=this.createImportResolver(this.fs,this._configOptions),this.program.setConfigOptions(this._configOptions),this.program.setImportResolver(this._importResolver);break;case"setTrackedFiles":{const t=this.program.setTrackedFiles(e.data);this._reportDiagnostics(t,this.program.getFilesToAnalyzeCount(),0);break}case"setAllowedThirdPartyImports":this.program.setAllowedThirdPartyImports(e.data);break;case"ensurePartialStubPackages":{const{executionRoot:t}=e.data,n=this._configOptions.getExecutionEnvironments().find((e=>e.root===t));n&&this._importResolver.ensurePartialStubPackages(n);break}case"setFileOpened":{const{filePath:t,version:n,contents:i}=e.data;this.program.setFileOpened(t,n,i);break}case"setFileClosed":{const t=this.program.setFileClosed(e.data);this._reportDiagnostics(t,this.program.getFilesToAnalyzeCount(),0);break}case"markAllFilesDirty":this.program.markAllFilesDirty(e.data);break;case"markFilesDirty":{const{filePaths:t,evenIfContentsAreSame:n}=e.data;this.program.markFilesDirty(t,n);break}case"invalidateAndForceReanalysis":this._importResolver.invalidateCache(),this.program.markAllFilesDirty(!0);break;case"restart":this._importResolver=this.createImportResolver(this.fs,this._configOptions),this.program.setImportResolver(this._importResolver);break;default:y.fail(`${e.requestType} is not expected`)}}_analyzeOneChunk(e,t,n){l.analyzeProgram(this.program,{openFilesTimeInMs:50,noOpenFilesTimeInMs:200},this._configOptions,(t=>this._onAnalysisCompletion(e,t)),this.getConsole(),t)?this._analysisPaused(e,n.data):(this.processIndexing(e,t),this._analysisDone(e,n.data))}createImportResolver(e,t){return new c.ImportResolver(e,t)}processIndexing(e,t){}reportIndex(e,t){e.postMessage({requestType:"indexResult",data:t})}_reportDiagnostics(e,t,n){o.parentPort&&this._onAnalysisCompletion(o.parentPort,{diagnostics:e,filesInProgram:this.program.getFileCount(),filesRequiringAnalysis:t,checkingOnlyOpenFiles:this.program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:n})}_onAnalysisCompletion(e,t){e.postMessage({requestType:"analysisResult",data:t})}_analysisPaused(e,t){e.postMessage({requestType:"analysisPaused",data:t})}_analysisDone(e,t){e.postMessage({requestType:"analysisDone",data:t})}}function _(e){return e.diagnostics=e.diagnostics.map((e=>({filePath:e.filePath,diagnostics:v(e.diagnostics)}))),e}function v(e){return e.map((e=>{const t=new g.Diagnostic(e.category,e.message,e.range);if(e._actions)for(const n of e._actions)t.addAction(n);if(e._rule&&t.setRule(e._rule),e._relatedInfo)for(const n of e._relatedInfo)t.addRelatedInfo(n.message,n.filePath,n.range);return t}))}t.BackgroundAnalysisRunnerBase=T},15179:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getBackgroundWaiter=t.run=t.createConfigOptionsFrom=t.BackgroundThreadBase=void 0;const a=n(65013),o=n(38213),l=n(14943),c=n(11043),p=r(n(20823)),u=n(6021),d=n(37633);t.BackgroundThreadBase=class{constructor(e){o.setCancellationFolderName(e.cancellationFolderName),global.__rootDirectory=e.rootDirectory,this.fs=new d.PyrightFileSystem(u.createFromRealFileSystem(this.getConsole()))}log(e,t){null===a.parentPort||void 0===a.parentPort||a.parentPort.postMessage({requestType:"log",data:{level:e,message:t}})}getConsole(){return{log:e=>{this.log(c.LogLevel.Log,e)},info:e=>{this.log(c.LogLevel.Info,e)},warn:e=>{this.log(c.LogLevel.Warn,e)},error:e=>{this.log(c.LogLevel.Error,e)},level:c.LogLevel.Log}}},t.createConfigOptionsFrom=function(e){const t=new l.ConfigOptions(e.projectRoot),n=e=>({wildcardRoot:e.wildcardRoot,regExp:new RegExp(e.regExp.source)});return t.pythonPath=e.pythonPath,t.typeshedPath=e.typeshedPath,t.stubPath=e.stubPath,t.autoExcludeVenv=e.autoExcludeVenv,t.verboseOutput=e.verboseOutput,t.checkOnlyOpenFiles=e.checkOnlyOpenFiles,t.useLibraryCodeForTypes=e.useLibraryCodeForTypes,t.internalTestMode=e.internalTestMode,t.venvPath=e.venvPath,t.venv=e.venv,t.defaultPythonVersion=e.defaultPythonVersion,t.defaultPythonPlatform=e.defaultPythonPlatform,t.defaultExtraPaths=e.defaultExtraPaths,t.diagnosticRuleSet=e.diagnosticRuleSet,t.executionEnvironments=e.executionEnvironments,t.autoImportCompletions=e.autoImportCompletions,t.indexing=e.indexing,t.logTypeEvaluationTime=e.logTypeEvaluationTime,t.typeEvaluationTimeThreshold=e.typeEvaluationTimeThreshold,t.include=e.include.map((e=>n(e))),t.exclude=e.exclude.map((e=>n(e))),t.ignore=e.ignore.map((e=>n(e))),t.strict=e.strict.map((e=>n(e))),t},t.run=function(e,t){try{const n=e();t.postMessage({kind:"ok",data:n})}catch(e){if(o.OperationCanceledException.is(e))return void t.postMessage({kind:"cancelled",data:e.message});t.postMessage({kind:"failed",data:`Exception: ${e.message} in ${e.stack}`})}},t.getBackgroundWaiter=function(e){return new Promise(((t,n)=>{e.on("message",(e=>{switch(e.kind){case"ok":t(e.data);break;case"cancelled":n(new o.OperationCanceledException);break;case"failed":n(e.data);break;default:p.fail(`unknown kind ${e.kind}`)}}))}))}},67284:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandController=void 0;const s=n(29335),r=n(62105),a=n(58062),o=n(60675);t.CommandController=class{constructor(e){this._createStub=new r.CreateTypeStubCommand(e),this._restartServer=new o.RestartServerCommand(e),this._quickAction=new a.QuickActionCommand(e)}execute(e,t){return i(this,void 0,void 0,(function*(){switch(e.command){case"pyright.organizeimports":case"pyright.addoptionalforparam":return this._quickAction.execute(e,t);case"pyright.createtypestub":return this._createStub.execute(e,t);case"pyright.restartserver":return this._restartServer.execute(e);default:return new s.ResponseError(1,"Unsupported command")}}))}isLongRunningCommand(e){switch(e){case"pyright.createtypestub":return!0;default:return!1}}}},62105:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CreateTypeStubCommand=void 0;const s=n(44314),r=n(38213),a=n(10219),o=n(94647),l=n(22060);t.CreateTypeStubCommand=class{constructor(e){this._ls=e}execute(e,t){return i(this,void 0,void 0,(function*(){if(e.arguments&&e.arguments.length>=2){const n=e.arguments[0],i=e.arguments[1],s=e.arguments[2],c=yield this._createTypeStubService(s),p={workspaceName:`Create Type Stub ${i}`,rootPath:n,rootUri:o.convertPathToUri(this._ls.fs,n),serviceInstance:c,disableLanguageServices:!0,disableOrganizeImports:!0,isInitialized:a.createDeferred()},u=yield this._ls.getSettings(p);l.AnalyzerServiceExecutor.runWithOptions(this._ls.rootPath,p,u,i,!1);try{yield c.writeTypeStubInBackground(t),c.dispose();const e=`Type stub was successfully created for '${i}'.`;this._ls.window.showInformationMessage(e),this._handlePostCreateTypeStub()}catch(e){if(r.OperationCanceledException.is(e)){const e=`Type stub creation for '${i}' was canceled`;this._ls.console.error(e)}else{let t="";e instanceof Error&&(t=": "+e.message),t=`An error occurred when creating type stub for '${i}'`+t,this._ls.console.error(t),this._ls.window.showErrorMessage(t)}}}}))}_createTypeStubService(e){return i(this,void 0,void 0,(function*(){if(e){return(yield this._ls.getWorkspaceForFile(e)).serviceInstance.clone("Type stub",this._ls.createBackgroundAnalysis())}return new s.AnalyzerService("Type stub",this._ls.fs,this._ls.console)}))}_handlePostCreateTypeStub(){this._ls.reanalyze()}}},58062:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.QuickActionCommand=void 0;const s=n(94647),r=n(34815);t.QuickActionCommand=class{constructor(e){this._ls=e}execute(e,t){return i(this,void 0,void 0,(function*(){if(e.arguments&&e.arguments.length>=1){const n=e.arguments[0],i=e.arguments.slice(1),a=s.convertUriToPath(this._ls.fs,n),o=yield this._ls.getWorkspaceForFile(a);if("pyright.organizeimports"===e.command&&o.disableOrganizeImports)return[];const l=o.serviceInstance.performQuickAction(a,e.command,i,t);return r.convertTextEdits(n,l)}}))}}},60675:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RestartServerCommand=void 0;t.RestartServerCommand=class{constructor(e){this._ls=e}execute(e){return n(this,void 0,void 0,(function*(){this._ls.restart()}))}}},38213:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CancelAfter=t.getCancellationTokenId=t.getCancellationTokenFromId=t.disposeCancellationToken=t.createBackgroundThreadCancellationTokenSource=t.getCancellationStrategyFromArgv=t.setCancellationFolderName=t.getCancellationFolderName=t.throwIfCancellationRequested=t.OperationCanceledException=void 0;const a=r(n(35747)),o=r(n(12087)),l=r(n(85622)),c=n(20947),p=n(29335);class u{static shouldCheck(){const e=Date.now().valueOf();return e-this._lastCheckTimestamp>=5&&(this._lastCheckTimestamp=e,!0)}}u._lastCheckTimestamp=0;class d{constructor(e){this.cancellationFilePath=e,this.isCancelled=!1}cancel(){this.isCancelled||(this.isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._disposeEmitter()))}get isCancellationRequested(){return!!this.isCancelled||(u.shouldCheck()&&this._pipeExists()&&this.cancel(),this.isCancelled)}get onCancellationRequested(){return this._emitter||(this._emitter=new p.Emitter),this._emitter.event}dispose(){this._disposeEmitter()}_disposeEmitter(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}_pipeExists(){try{return a.statSync(this.cancellationFilePath),!0}catch(e){return!1}}}class h extends d{constructor(e){super(e),this._disposed=!1}cancel(){this._disposed||this.isCancelled||(this._createPipe(),super.cancel())}get isCancellationRequested(){return this.isCancelled}dispose(){this._disposed=!0,super.dispose(),this._removePipe()}_createPipe(){try{a.writeFileSync(this.cancellationFilePath,"",{flag:"w"})}catch(e){}}_removePipe(){try{a.unlinkSync(this.cancellationFilePath)}catch(e){}}}class m{constructor(e,t=!1){this._cancellationFilePath=e,this._ownFile=t}get token(){return this._token||(this._token=this._ownFile?new h(this._cancellationFilePath):new d(this._cancellationFilePath)),this._token}cancel(){this._token?this._token.cancel():this._token=p.CancellationToken.Cancelled}dispose(){this._token?this._token instanceof d&&this._token.dispose():this._token=p.CancellationToken.None}}function y(e,t){return l.join(function(e){return l.join(o.tmpdir(),"python-languageserver-cancellation",e)}(e),`cancellation-${String(t)}.tmp`)}class g{constructor(e){this.folderName=e}createCancellationTokenSource(e){return new m(y(this.folderName,e))}}class f extends p.ResponseError{constructor(){super(p.LSPErrorCodes.RequestCancelled,"request cancelled")}static is(e){return e.code===p.LSPErrorCodes.RequestCancelled}}let T;function _(e){T=e}t.OperationCanceledException=f,t.throwIfCancellationRequested=function(e){if(e.isCancellationRequested)throw new f},t.getCancellationFolderName=function(){return T},t.setCancellationFolderName=_,t.getCancellationStrategyFromArgv=function(e){let t;for(let i=0;i<e.length;i++){const s=e[i];if("--cancellationReceive"===s)t=n(e[i+1]);else{const e=s.split("=");"--cancellationReceive"===e[0]&&(t=n(e[1]))}}return t&&!T&&_(t.folderName),t=t||p.CancellationReceiverStrategy.Message,{receiver:t,sender:p.CancellationSenderStrategy.Message};function n(e){const t=function(e){const t=/^file:(.+)$/,n=e.match(t);return n?n[1]:void 0}(e);return t?new g(t):void 0}};let v=0;t.createBackgroundThreadCancellationTokenSource=function(){return T?new m(y(T,`source-${String(v++)}`),!0):new c.CancellationTokenSource},t.disposeCancellationToken=function(e){e instanceof d&&e.dispose()},t.getCancellationTokenFromId=function(e){return e?new d(e):p.CancellationToken.None},t.getCancellationTokenId=function(e){return e instanceof d?e.cancellationFilePath:void 0},t.CancelAfter=function(...e){const t=new c.CancellationTokenSource,n=[];for(const i of e)n.push(i.onCancellationRequested((e=>{t.cancel()})));return n.push(t.token.onCancellationRequested((e=>{n.forEach((e=>e.dispose()))}))),t}},9133:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrAdd=t.getNestedProperty=t.flatten=t.binarySearchKey=t.binarySearch=t.every=t.some=t.map=t.stableSort=t.cloneAndSort=t.insertAt=t.addRange=t.find=t.append=t.contains=t.emptyArray=void 0;const i=n(98173);function s(e,t){return t<0?e.length+t:t}function r(e,t,n,i){if(void 0===t||0===t.length)return e;if(void 0===e)return t.slice(n,i);n=void 0===n?0:s(t,n),i=void 0===i?t.length:s(t,i);for(let s=n;s<i&&s<t.length;s++)void 0!==t[s]&&e.push(t[s]);return e}function a(e,t){return t}function o(e,t){return!!e&&(t?e.some(t):e.length>0)}function l(e,t,n,i,s){if(!o(e))return-1;let r=s||0,a=e.length-1;for(;r<=a;){const s=r+(a-r>>1);switch(i(n(e[s]),t)){case-1:r=s+1;break;case 0:return s;case 1:a=s-1}}return~r}t.emptyArray=[],t.contains=function(e,t,n=i.equateValues){if(e)for(const i of e)if(n(i,t))return!0;return!1},t.append=function(e,t){return void 0===t?e:void 0===e?[t]:(e.push(t),e)},t.find=function(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(t(i,n))return i}},t.addRange=r,t.insertAt=function(e,t,n){if(0===t)e.unshift(n);else if(t===e.length)e.push(n);else{for(let n=e.length;n>t;n--)e[n]=e[n-1];e[t]=n}return e},t.cloneAndSort=function(e,t){return 0===e.length?e:e.slice().sort(t)},t.stableSort=function(e,t){const n=function(e){return e.map(a)}(e);return function(e,t,n){t.sort(((t,s)=>n(e[t],e[s])||i.compareValues(t,s)))}(e,n,t),n.map((t=>e[t]))},t.map=function(e,t){if(e)return e.map(t)},t.some=o,t.every=function(e,t){return!e||e.every(t)},t.binarySearch=function(e,t,n,i,s){return l(e,n(t),n,i,s)},t.binarySearchKey=l,t.flatten=function(e){const t=[];for(const n of e)n&&(i.isArray(n)?r(t,n):t.push(n));return t},t.getNestedProperty=function(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)},t.getOrAdd=function(e,t,n){const i=e.get(t);if(void 0!==i)return i;const s=n();return e.set(t,s),s}},96795:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandLineOptions=t.getDiagnosticSeverityOverrides=void 0,t.getDiagnosticSeverityOverrides=function(){return["error","warning","information","none"]};t.CommandLineOptions=class{constructor(e,t){this.fileSpecs=[],this.logTypeEvaluationTime=!1,this.typeEvaluationTimeThreshold=50,this.executionRoot=e,this.fromVsCodeExtension=t}}},14943:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigOptions=t.getStrictDiagnosticRuleSet=t.getBasicDiagnosticRuleSet=t.getOffDiagnosticRuleSet=t.getStrictModeNotOverriddenRules=t.getDiagLevelDiagnosticRules=t.getBooleanDiagnosticRules=t.cloneDiagnosticRuleSet=t.ExecutionEnvironment=t.PythonPlatform=void 0;const a=r(n(63129)),o=n(85622),l=r(n(97956)),c=n(15741),p=n(94647),u=n(57485);var d;!function(e){e.Darwin="Darwin",e.Windows="Windows",e.Linux="Linux"}(d=t.PythonPlatform||(t.PythonPlatform={}));class h{constructor(e,t,n,i){this.extraPaths=[],this.root=e,this.pythonVersion=t||u.latestStablePythonVersion,this.pythonPlatform=n,this.extraPaths=i||[]}}function m(){return{printUnknownAsAny:!0,omitTypeArgsIfAny:!0,omitUnannotatedParamType:!0,pep604Printing:!0,strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"none",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"warning",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportTypedDictNotRequiredAccess:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportOverlappingOverload:"none",reportInvalidStringEscapeSequence:"none",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"none",reportSelfClsParameterName:"none",reportImplicitStringConcatenation:"none",reportUnboundVariable:"none",reportUndefinedVariable:"warning",reportInvalidStubStatement:"none",reportUnsupportedDunderAll:"none",reportUnusedCallResult:"none",reportUnusedCoroutine:"none"}}function y(){return{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!0,pep604Printing:!0,strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"error",reportFunctionMemberAccess:"none",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"warning",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportOverlappingOverload:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"warning",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"none",reportUnsupportedDunderAll:"warning",reportUnusedCallResult:"none",reportUnusedCoroutine:"error"}}function g(){return{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!1,pep604Printing:!0,strictListInference:!0,strictDictionaryInference:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"error",reportFunctionMemberAccess:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportWildcardImportFromLibrary:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportConstantRedefinition:"error",reportIncompatibleMethodOverride:"error",reportIncompatibleVariableOverride:"error",reportOverlappingOverload:"error",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportMissingTypeArgument:"error",reportInvalidTypeVarUse:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"error",reportUnsupportedDunderAll:"error",reportUnusedCallResult:"none",reportUnusedCoroutine:"error"}}t.ExecutionEnvironment=h,t.cloneDiagnosticRuleSet=function(e){return Object.assign({},e)},t.getBooleanDiagnosticRules=function(){return[c.DiagnosticRule.strictListInference,c.DiagnosticRule.strictDictionaryInference,c.DiagnosticRule.strictParameterNoneValue]},t.getDiagLevelDiagnosticRules=function(){return[c.DiagnosticRule.reportGeneralTypeIssues,c.DiagnosticRule.reportPropertyTypeMismatch,c.DiagnosticRule.reportFunctionMemberAccess,c.DiagnosticRule.reportMissingImports,c.DiagnosticRule.reportMissingModuleSource,c.DiagnosticRule.reportMissingTypeStubs,c.DiagnosticRule.reportImportCycles,c.DiagnosticRule.reportUnusedImport,c.DiagnosticRule.reportUnusedClass,c.DiagnosticRule.reportUnusedFunction,c.DiagnosticRule.reportUnusedVariable,c.DiagnosticRule.reportDuplicateImport,c.DiagnosticRule.reportWildcardImportFromLibrary,c.DiagnosticRule.reportOptionalSubscript,c.DiagnosticRule.reportOptionalMemberAccess,c.DiagnosticRule.reportOptionalCall,c.DiagnosticRule.reportOptionalIterable,c.DiagnosticRule.reportOptionalContextManager,c.DiagnosticRule.reportOptionalOperand,c.DiagnosticRule.reportTypedDictNotRequiredAccess,c.DiagnosticRule.reportUntypedFunctionDecorator,c.DiagnosticRule.reportUntypedClassDecorator,c.DiagnosticRule.reportUntypedBaseClass,c.DiagnosticRule.reportUntypedNamedTuple,c.DiagnosticRule.reportPrivateUsage,c.DiagnosticRule.reportConstantRedefinition,c.DiagnosticRule.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,c.DiagnosticRule.reportOverlappingOverload,c.DiagnosticRule.reportInvalidStringEscapeSequence,c.DiagnosticRule.reportUnknownParameterType,c.DiagnosticRule.reportUnknownArgumentType,c.DiagnosticRule.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownVariableType,c.DiagnosticRule.reportUnknownMemberType,c.DiagnosticRule.reportMissingTypeArgument,c.DiagnosticRule.reportInvalidTypeVarUse,c.DiagnosticRule.reportCallInDefaultInitializer,c.DiagnosticRule.reportUnnecessaryIsInstance,c.DiagnosticRule.reportUnnecessaryCast,c.DiagnosticRule.reportAssertAlwaysTrue,c.DiagnosticRule.reportSelfClsParameterName,c.DiagnosticRule.reportImplicitStringConcatenation,c.DiagnosticRule.reportUndefinedVariable,c.DiagnosticRule.reportUnboundVariable,c.DiagnosticRule.reportInvalidStubStatement,c.DiagnosticRule.reportUnsupportedDunderAll,c.DiagnosticRule.reportUnusedCallResult,c.DiagnosticRule.reportUnusedCoroutine]},t.getStrictModeNotOverriddenRules=function(){return[c.DiagnosticRule.reportMissingModuleSource]},t.getOffDiagnosticRuleSet=m,t.getBasicDiagnosticRuleSet=y,t.getStrictDiagnosticRuleSet=g;class f{constructor(e,t){this.include=[],this.exclude=[],this.ignore=[],this.strict=[],this.autoImportCompletions=!0,this.indexing=!1,this.logTypeEvaluationTime=!1,this.typeEvaluationTimeThreshold=50,this.disableInferenceForPyTypedSources=!0,this.executionEnvironments=[],this.projectRoot=e,this.diagnosticRuleSet=f.getDiagnosticRuleSet(t),"off"===t&&(this.disableInferenceForPyTypedSources=!1)}static getDiagnosticRuleSet(e){return"strict"===e?{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!1,pep604Printing:!0,strictListInference:!0,strictDictionaryInference:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"error",reportFunctionMemberAccess:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportWildcardImportFromLibrary:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportConstantRedefinition:"error",reportIncompatibleMethodOverride:"error",reportIncompatibleVariableOverride:"error",reportOverlappingOverload:"error",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportMissingTypeArgument:"error",reportInvalidTypeVarUse:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"error",reportUnsupportedDunderAll:"error",reportUnusedCallResult:"none",reportUnusedCoroutine:"error"}:"off"===e?{printUnknownAsAny:!0,omitTypeArgsIfAny:!0,omitUnannotatedParamType:!0,pep604Printing:!0,strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"none",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"warning",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportTypedDictNotRequiredAccess:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportOverlappingOverload:"none",reportInvalidStringEscapeSequence:"none",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"none",reportSelfClsParameterName:"none",reportImplicitStringConcatenation:"none",reportUnboundVariable:"none",reportUndefinedVariable:"warning",reportInvalidStubStatement:"none",reportUnsupportedDunderAll:"none",reportUnusedCallResult:"none",reportUnusedCoroutine:"none"}:{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!0,pep604Printing:!0,strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"error",reportFunctionMemberAccess:"none",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"warning",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportOverlappingOverload:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"warning",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"none",reportUnsupportedDunderAll:"warning",reportUnusedCallResult:"none",reportUnusedCoroutine:"error"}}getDefaultExecEnvironment(){return new h(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform,this.defaultExtraPaths)}findExecEnvironment(e){var t;return null!==(t=this.executionEnvironments.find((t=>{const n=p.ensureTrailingDirectorySeparator(p.normalizePath(p.combinePaths(this.projectRoot,t.root)));return e.startsWith(n)})))&&void 0!==t?t:this.getDefaultExecEnvironment()}getExecutionEnvironments(){return this.executionEnvironments.length>0?this.executionEnvironments:[this.getDefaultExecEnvironment()]}initializeFromJson(e,t,n,i,s,r=!1){if(!r&&(this.include=[],void 0!==e.include))if(Array.isArray(e.include)){e.include.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "include" array should be a string.`):o.isAbsolute(e)?n.error(`Ignoring path "${e}" in "include" array because it is not relative.`):this.include.push(p.getFileSpec(this.projectRoot,e))}))}else n.error('Config "include" entry must must contain an array.');if(this.exclude=[],void 0!==e.exclude)if(Array.isArray(e.exclude)){e.exclude.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "exclude" array should be a string.`):o.isAbsolute(e)?n.error(`Ignoring path "${e}" in "exclude" array because it is not relative.`):this.exclude.push(p.getFileSpec(this.projectRoot,e))}))}else n.error('Config "exclude" entry must contain an array.');if(this.ignore=[],void 0!==e.ignore)if(Array.isArray(e.ignore)){e.ignore.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "ignore" array should be a string.`):o.isAbsolute(e)?n.error(`Ignoring path "${e}" in "ignore" array because it is not relative.`):this.ignore.push(p.getFileSpec(this.projectRoot,e))}))}else n.error('Config "ignore" entry must contain an array.');if(this.strict=[],void 0!==e.strict)if(Array.isArray(e.strict)){e.strict.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "strict" array should be a string.`):o.isAbsolute(e)?n.error(`Ignoring path "${e}" in "strict" array because it is not relative.`):this.strict.push(p.getFileSpec(this.projectRoot,e))}))}else n.error('Config "strict" entry must contain an array.');let a;void 0!==e.typeCheckingMode&&("off"===e.typeCheckingMode||"basic"===e.typeCheckingMode||"strict"===e.typeCheckingMode?a=e.typeCheckingMode:n.error('Config "typeCheckingMode" entry must contain "off", "basic", or "strict".')),void 0!==e.useLibraryCodeForTypes&&("boolean"==typeof e.useLibraryCodeForTypes?this.useLibraryCodeForTypes=e.useLibraryCodeForTypes:n.error('Config "useLibraryCodeForTypes" entry must be true or false.'));const l=a||t,d=f.getDiagnosticRuleSet(l);if("off"===l&&(this.disableInferenceForPyTypedSources=!1),this.applyDiagnosticOverrides(i),this.diagnosticRuleSet={printUnknownAsAny:d.printUnknownAsAny,omitTypeArgsIfAny:d.omitTypeArgsIfAny,omitUnannotatedParamType:d.omitUnannotatedParamType,pep604Printing:d.pep604Printing,strictListInference:this._convertBoolean(e.strictListInference,c.DiagnosticRule.strictListInference,d.strictListInference),strictDictionaryInference:this._convertBoolean(e.strictDictionaryInference,c.DiagnosticRule.strictDictionaryInference,d.strictDictionaryInference),strictParameterNoneValue:this._convertBoolean(e.strictParameterNoneValue,c.DiagnosticRule.strictParameterNoneValue,d.strictParameterNoneValue),enableTypeIgnoreComments:this._convertBoolean(e.enableTypeIgnoreComments,c.DiagnosticRule.enableTypeIgnoreComments,d.enableTypeIgnoreComments),reportGeneralTypeIssues:this._convertDiagnosticLevel(e.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,d.reportGeneralTypeIssues),reportPropertyTypeMismatch:this._convertDiagnosticLevel(e.reportPropertyTypeMismatch,c.DiagnosticRule.reportPropertyTypeMismatch,d.reportPropertyTypeMismatch),reportFunctionMemberAccess:this._convertDiagnosticLevel(e.reportFunctionMemberAccess,c.DiagnosticRule.reportFunctionMemberAccess,d.reportFunctionMemberAccess),reportMissingImports:this._convertDiagnosticLevel(e.reportMissingImports,c.DiagnosticRule.reportMissingImports,d.reportMissingImports),reportUnusedImport:this._convertDiagnosticLevel(e.reportUnusedImport,c.DiagnosticRule.reportUnusedImport,d.reportUnusedImport),reportUnusedClass:this._convertDiagnosticLevel(e.reportUnusedClass,c.DiagnosticRule.reportUnusedClass,d.reportUnusedClass),reportUnusedFunction:this._convertDiagnosticLevel(e.reportUnusedFunction,c.DiagnosticRule.reportUnusedFunction,d.reportUnusedFunction),reportUnusedVariable:this._convertDiagnosticLevel(e.reportUnusedVariable,c.DiagnosticRule.reportUnusedVariable,d.reportUnusedVariable),reportDuplicateImport:this._convertDiagnosticLevel(e.reportDuplicateImport,c.DiagnosticRule.reportDuplicateImport,d.reportDuplicateImport),reportWildcardImportFromLibrary:this._convertDiagnosticLevel(e.reportWildcardImportFromLibrary,c.DiagnosticRule.reportWildcardImportFromLibrary,d.reportWildcardImportFromLibrary),reportMissingModuleSource:this._convertDiagnosticLevel(e.reportMissingModuleSource,c.DiagnosticRule.reportMissingModuleSource,d.reportMissingModuleSource),reportMissingTypeStubs:this._convertDiagnosticLevel(e.reportMissingTypeStubs,c.DiagnosticRule.reportMissingTypeStubs,d.reportMissingTypeStubs),reportImportCycles:this._convertDiagnosticLevel(e.reportImportCycles,c.DiagnosticRule.reportImportCycles,d.reportImportCycles),reportOptionalSubscript:this._convertDiagnosticLevel(e.reportOptionalSubscript,c.DiagnosticRule.reportOptionalSubscript,d.reportOptionalSubscript),reportOptionalMemberAccess:this._convertDiagnosticLevel(e.reportOptionalMemberAccess,c.DiagnosticRule.reportOptionalMemberAccess,d.reportOptionalMemberAccess),reportOptionalCall:this._convertDiagnosticLevel(e.reportOptionalCall,c.DiagnosticRule.reportOptionalCall,d.reportOptionalCall),reportOptionalIterable:this._convertDiagnosticLevel(e.reportOptionalIterable,c.DiagnosticRule.reportOptionalIterable,d.reportOptionalIterable),reportOptionalContextManager:this._convertDiagnosticLevel(e.reportOptionalContextManager,c.DiagnosticRule.reportOptionalContextManager,d.reportOptionalContextManager),reportOptionalOperand:this._convertDiagnosticLevel(e.reportOptionalOperand,c.DiagnosticRule.reportOptionalOperand,d.reportOptionalOperand),reportTypedDictNotRequiredAccess:this._convertDiagnosticLevel(e.reportTypedDictNotRequiredAccess,c.DiagnosticRule.reportTypedDictNotRequiredAccess,d.reportTypedDictNotRequiredAccess),reportUntypedFunctionDecorator:this._convertDiagnosticLevel(e.reportUntypedFunctionDecorator,c.DiagnosticRule.reportUntypedFunctionDecorator,d.reportUntypedFunctionDecorator),reportUntypedClassDecorator:this._convertDiagnosticLevel(e.reportUntypedClassDecorator,c.DiagnosticRule.reportUntypedClassDecorator,d.reportUntypedClassDecorator),reportUntypedBaseClass:this._convertDiagnosticLevel(e.reportUntypedBaseClass,c.DiagnosticRule.reportUntypedBaseClass,d.reportUntypedBaseClass),reportUntypedNamedTuple:this._convertDiagnosticLevel(e.reportUntypedNamedTuple,c.DiagnosticRule.reportUntypedNamedTuple,d.reportUntypedNamedTuple),reportPrivateUsage:this._convertDiagnosticLevel(e.reportPrivateUsage,c.DiagnosticRule.reportPrivateUsage,d.reportPrivateUsage),reportConstantRedefinition:this._convertDiagnosticLevel(e.reportConstantRedefinition,c.DiagnosticRule.reportConstantRedefinition,d.reportConstantRedefinition),reportIncompatibleMethodOverride:this._convertDiagnosticLevel(e.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,d.reportIncompatibleMethodOverride),reportIncompatibleVariableOverride:this._convertDiagnosticLevel(e.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,d.reportIncompatibleVariableOverride),reportOverlappingOverload:this._convertDiagnosticLevel(e.reportOverlappingOverload,c.DiagnosticRule.reportOverlappingOverload,d.reportOverlappingOverload),reportInvalidStringEscapeSequence:this._convertDiagnosticLevel(e.reportInvalidStringEscapeSequence,c.DiagnosticRule.reportInvalidStringEscapeSequence,d.reportInvalidStringEscapeSequence),reportUnknownParameterType:this._convertDiagnosticLevel(e.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,d.reportUnknownParameterType),reportUnknownArgumentType:this._convertDiagnosticLevel(e.reportUnknownArgumentType,c.DiagnosticRule.reportUnknownArgumentType,d.reportUnknownArgumentType),reportUnknownLambdaType:this._convertDiagnosticLevel(e.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,d.reportUnknownLambdaType),reportUnknownVariableType:this._convertDiagnosticLevel(e.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,d.reportUnknownVariableType),reportUnknownMemberType:this._convertDiagnosticLevel(e.reportUnknownMemberType,c.DiagnosticRule.reportUnknownMemberType,d.reportUnknownMemberType),reportMissingTypeArgument:this._convertDiagnosticLevel(e.reportMissingTypeArgument,c.DiagnosticRule.reportMissingTypeArgument,d.reportMissingTypeArgument),reportInvalidTypeVarUse:this._convertDiagnosticLevel(e.reportInvalidTypeVarUse,c.DiagnosticRule.reportInvalidTypeVarUse,d.reportInvalidTypeVarUse),reportCallInDefaultInitializer:this._convertDiagnosticLevel(e.reportCallInDefaultInitializer,c.DiagnosticRule.reportCallInDefaultInitializer,d.reportCallInDefaultInitializer),reportUnnecessaryIsInstance:this._convertDiagnosticLevel(e.reportUnnecessaryIsInstance,c.DiagnosticRule.reportUnnecessaryIsInstance,d.reportUnnecessaryIsInstance),reportUnnecessaryCast:this._convertDiagnosticLevel(e.reportUnnecessaryCast,c.DiagnosticRule.reportUnnecessaryCast,d.reportUnnecessaryCast),reportAssertAlwaysTrue:this._convertDiagnosticLevel(e.reportAssertAlwaysTrue,c.DiagnosticRule.reportAssertAlwaysTrue,d.reportAssertAlwaysTrue),reportSelfClsParameterName:this._convertDiagnosticLevel(e.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,d.reportSelfClsParameterName),reportImplicitStringConcatenation:this._convertDiagnosticLevel(e.reportImplicitStringConcatenation,c.DiagnosticRule.reportImplicitStringConcatenation,d.reportImplicitStringConcatenation),reportUndefinedVariable:this._convertDiagnosticLevel(e.reportUndefinedVariable,c.DiagnosticRule.reportUndefinedVariable,d.reportUndefinedVariable),reportUnboundVariable:this._convertDiagnosticLevel(e.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,d.reportUnboundVariable),reportInvalidStubStatement:this._convertDiagnosticLevel(e.reportInvalidStubStatement,c.DiagnosticRule.reportInvalidStubStatement,d.reportInvalidStubStatement),reportUnsupportedDunderAll:this._convertDiagnosticLevel(e.reportUnsupportedDunderAll,c.DiagnosticRule.reportUnsupportedDunderAll,d.reportUnsupportedDunderAll),reportUnusedCallResult:this._convertDiagnosticLevel(e.reportUnusedCallResult,c.DiagnosticRule.reportUnusedCallResult,d.reportUnusedCallResult),reportUnusedCoroutine:this._convertDiagnosticLevel(e.reportUnusedCoroutine,c.DiagnosticRule.reportUnusedCoroutine,d.reportUnusedCoroutine)},this.venvPath=void 0,void 0!==e.venvPath&&("string"!=typeof e.venvPath?n.error('Config "venvPath" field must contain a string.'):this.venvPath=p.normalizePath(p.combinePaths(this.projectRoot,e.venvPath))),this.venv=void 0,void 0!==e.venv&&("string"!=typeof e.venv?n.error('Config "venv" field must contain a string.'):this.venv=e.venv),void 0!==e.extraPaths)if(this.defaultExtraPaths=[],Array.isArray(e.extraPaths)){e.extraPaths.forEach(((e,t)=>{"string"!=typeof e?n.error(`Config "extraPaths" field ${t} must be a string.`):this.defaultExtraPaths.push(p.normalizePath(p.combinePaths(this.projectRoot,e)))}))}else n.error('Config "extraPaths" field must contain an array.');if(void 0!==e.pythonVersion)if("string"==typeof e.pythonVersion){const t=u.versionFromString(e.pythonVersion);t?this.defaultPythonVersion=t:n.error('Config "pythonVersion" field contains unsupported version.')}else n.error('Config "pythonVersion" field must contain a string.');if(this.ensureDefaultPythonVersion(s,n),void 0!==e.pythonPlatform&&("string"!=typeof e.pythonPlatform?n.error('Config "pythonPlatform" field must contain a string.'):this.defaultPythonPlatform=e.pythonPlatform),this.ensureDefaultPythonPlatform(n),this.typeshedPath=void 0,void 0!==e.typeshedPath&&("string"!=typeof e.typeshedPath?n.error('Config "typeshedPath" field must contain a string.'):this.typeshedPath=e.typeshedPath?p.normalizePath(p.combinePaths(this.projectRoot,e.typeshedPath)):""),this.stubPath=void 0,void 0!==e.typingsPath&&("string"!=typeof e.typingsPath?n.error('Config "typingsPath" field must contain a string.'):(n.error('Config "typingsPath" is now deprecated. Please, use stubPath instead.'),this.stubPath=p.normalizePath(p.combinePaths(this.projectRoot,e.typingsPath)))),void 0!==e.stubPath&&("string"!=typeof e.stubPath?n.error('Config "stubPath" field must contain a string.'):this.stubPath=p.normalizePath(p.combinePaths(this.projectRoot,e.stubPath))),void 0!==e.verboseOutput&&("boolean"!=typeof e.verboseOutput?n.error('Config "verboseOutput" field must be true or false.'):this.verboseOutput=e.verboseOutput),void 0!==e.useLibraryCodeForTypes&&("boolean"!=typeof e.useLibraryCodeForTypes?n.error('Config "useLibraryCodeForTypes" field must be true or false.'):this.useLibraryCodeForTypes=e.useLibraryCodeForTypes),this.executionEnvironments=[],void 0!==e.executionEnvironments)if(Array.isArray(e.executionEnvironments)){e.executionEnvironments.forEach(((e,t)=>{const i=this._initExecutionEnvironmentFromJson(e,t,n);i&&this.executionEnvironments.push(i)}))}else n.error('Config "executionEnvironments" field must contain an array.');void 0!==e.autoImportCompletions&&("boolean"!=typeof e.autoImportCompletions?n.error('Config "autoImportCompletions" field must be true or false.'):this.autoImportCompletions=e.autoImportCompletions),void 0!==e.indexing&&("boolean"!=typeof e.indexing?n.error('Config "indexing" field must be true or false.'):this.indexing=e.indexing),void 0!==e.logTypeEvaluationTime&&("boolean"!=typeof e.logTypeEvaluationTime?n.error('Config "logTypeEvaluationTime" field must be true or false.'):this.logTypeEvaluationTime=e.logTypeEvaluationTime),void 0!==e.typeEvaluationTimeThreshold&&("number"!=typeof e.typeEvaluationTimeThreshold?n.error('Config "typeEvaluationTimeThreshold" field must be a number.'):this.typeEvaluationTimeThreshold=e.typeEvaluationTimeThreshold)}ensureDefaultPythonPlatform(e){void 0===this.defaultPythonPlatform&&("darwin"===process.platform?this.defaultPythonPlatform=d.Darwin:"linux"===process.platform?this.defaultPythonPlatform=d.Linux:"win32"===process.platform&&(this.defaultPythonPlatform=d.Windows),void 0!==this.defaultPythonPlatform&&e.info(`Assuming Python platform ${this.defaultPythonPlatform}`))}ensureDefaultPythonVersion(e,t){void 0===this.defaultPythonVersion&&(this.defaultPythonVersion=this._getPythonVersionFromPythonInterpreter(e,t),void 0!==this.defaultPythonVersion&&t.info(`Assuming Python version ${u.versionToString(this.defaultPythonVersion)}`))}ensureDefaultExtraPaths(e,t,n){const i=[];if(t){const t=p.resolvePaths(this.projectRoot,l.src);e.existsSync(t)&&!e.existsSync(p.resolvePaths(t,"__init__.py"))&&i.push(t)}if(n&&n.length>0)for(const e of n)i.push(p.resolvePaths(this.projectRoot,e));i.length>0&&(this.defaultExtraPaths=i)}applyDiagnosticOverrides(e){if(e)for(const[t,n]of Object.entries(e))this.diagnosticRuleSet[t]=n}_convertBoolean(e,t,n){return void 0===e?n:"boolean"==typeof e?!!e:(console.log(`Config "${t}" entry must be true or false.`),n)}_convertDiagnosticLevel(e,t,n){return void 0===e?n:"boolean"==typeof e?e?"error":"none":"string"!=typeof e||"error"!==e&&"warning"!==e&&"information"!==e&&"none"!==e?(console.log(`Config "${t}" entry must be true, false, "error", "warning", "information" or "none".`),n):e}_initExecutionEnvironmentFromJson(e,t,n){try{const i=new h(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform,this.defaultExtraPaths);if(e.root&&"string"==typeof e.root?i.root=p.normalizePath(p.combinePaths(this.projectRoot,e.root)):n.error(`Config executionEnvironments index ${t}: missing root value.`),e.extraPaths)if(Array.isArray(e.extraPaths)){e.extraPaths.forEach(((e,s)=>{"string"!=typeof e?n.error(`Config executionEnvironments index ${t}: extraPaths field ${s} must be a string.`):i.extraPaths.push(p.normalizePath(p.combinePaths(this.projectRoot,e)))}))}else n.error(`Config executionEnvironments index ${t}: extraPaths field must contain an array.`);if(e.pythonVersion)if("string"==typeof e.pythonVersion){const s=u.versionFromString(e.pythonVersion);s?i.pythonVersion=s:n.warn(`Config executionEnvironments index ${t} contains unsupported pythonVersion.`)}else n.error(`Config executionEnvironments index ${t} pythonVersion must be a string.`);return e.pythonPlatform&&("string"==typeof e.pythonPlatform?i.pythonPlatform=e.pythonPlatform:n.error(`Config executionEnvironments index ${t} pythonPlatform must be a string.`)),i}catch(e){n.error(`Config executionEnvironments index ${t} is not accessible.`)}}_getPythonVersionFromPythonInterpreter(e,t){try{const n=["-c","import sys, json; json.dump(dict(major=sys.version_info[0], minor=sys.version_info[1]), sys.stdout)"];let i;i=e?a.execFileSync(e,n,{encoding:"utf8"}):a.execFileSync("python",n,{encoding:"utf8"});const s=JSON.parse(i),r=u.versionFromMajorMinor(s.major,s.minor);return void 0===r?void t.warn(`Python version ${s.major}.${s.minor} from interpreter is unsupported`):r}catch(e){return void t.info("Unable to get Python version from interpreter")}}}t.ConfigOptions=f},11043:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.ConsoleWithLogLevel=t.StandardConsole=t.NullConsole=t.LogLevel=void 0;const a=r(n(20823));var o;!function(e){e.Error="error",e.Warn="warn",e.Info="info",e.Log="log"}(o=t.LogLevel||(t.LogLevel={}));t.NullConsole=class{constructor(){this.logCount=0,this.infoCount=0,this.warnCount=0,this.errorCount=0}log(e){this.logCount++}info(e){this.infoCount++}warn(e){this.warnCount++}error(e){this.errorCount++}};t.StandardConsole=class{log(e){console.info(e)}info(e){console.info(e)}warn(e){console.warn(e)}error(e){console.error(e)}};function l(e,t,n){switch(t){case o.Log:e.log(n);break;case o.Info:e.info(n);break;case o.Warn:e.warn(n);break;case o.Error:e.error(n);break;default:a.fail(`${t} is not expected`)}}t.ConsoleWithLogLevel=class{constructor(e){this._console=e,this._levelMap=new Map([[o.Error,0],[o.Warn,1],[o.Info,2],[o.Log,3]]),this._maxLevel=2}get level(){switch(this._maxLevel){case 0:return o.Error;case 1:return o.Warn;case 2:return o.Info}return o.Log}set level(e){let t=this._levelMap.get(e);void 0===t&&(t=this._levelMap.get(o.Info)),this._maxLevel=t}error(e){this._log(o.Error,e)}warn(e){this._log(o.Warn,e)}info(e){this._log(o.Info,e)}log(e){this._log(o.Log,e)}_log(e,t){this._getNumericalLevel(e)>this._maxLevel||l(this._console,e,t)}_getNumericalLevel(e){const t=this._levelMap.get(e);return a.assert(void 0!==t,"Logger: unknown log level."),void 0!==t?t:2}},t.log=l},98173:(e,t)=>{"use strict";function n(e,t){return e===t?0:void 0===e?-1:void 0===t?1:e<t?-1:1}Object.defineProperty(t,"__esModule",{value:!0}),t.isDefined=t.isThenable=t.isDebugMode=t.toBoolean=t.hasProperty=t.isBoolean=t.isNumber=t.isString=t.isArray=t.compareValues=t.compareComparableValues=t.equateValues=t.toLowerCase=t.identity=t.returnUndefined=t.returnTrue=t.returnFalse=void 0,t.returnFalse=function(){return!1},t.returnTrue=function(){return!0},t.returnUndefined=function(){},t.identity=function(e){return e},t.toLowerCase=function(e){return e.toLowerCase()},t.equateValues=function(e,t){return e===t},t.compareComparableValues=n,t.compareValues=function(e,t){return n(e,t)},t.isArray=function(e){return Array.isArray?Array.isArray(e):e instanceof Array},t.isString=function(e){return"string"==typeof e},t.isNumber=function(e){return"number"==typeof e},t.isBoolean=function(e){return"boolean"==typeof e};const i=Object.prototype.hasOwnProperty;t.hasProperty=function(e,t){return i.call(e,t)},t.toBoolean=function(e){return"TRUE"===(null==e?void 0:e.trim().toUpperCase())},t.isDebugMode=function(){const e=process.execArgv.join();return e.includes("inspect")||e.includes("debug")},t.isThenable=function(e){return"function"==typeof(null==e?void 0:e.then)},t.isDefined=function(e){return void 0!==e}},20823:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSerializableError=t.getErrorString=t.formatEnum=t.getFunctionName=t.assertNever=t.assertEachDefined=t.assertDefined=t.fail=t.assert=void 0;const i=n(9133),s=n(98173);function r(e,t){const n=new Error(e?`Debug Failure. ${e}`:"Debug Failure.");throw Error.captureStackTrace&&Error.captureStackTrace(n,t||r),n}function a(e,t){return null==e?r(t):e}t.assert=function e(t,n,i,s){t||(i&&(n+="\r\nVerbose Debug Information: "+("string"==typeof i?i:i())),r(n?"False expression: "+n:"False expression.",s||e))},t.fail=r,t.assertDefined=a,t.assertEachDefined=function(e,t){for(const n of e)a(n,t);return e},t.assertNever=function e(t,n="Illegal value:",i){return r(`${n} ${JSON.stringify(t)}`,i||e)},t.getFunctionName=function(e){if("function"!=typeof e)return"";if(s.hasProperty(e,"name"))return e.name;{const t=Function.prototype.toString.call(e),n=/^function\s+([\w$]+)\s*\(/.exec(t);return n?n[1]:""}},t.formatEnum=function(e=0,t,n){const r=function(e){const t=[];for(const n of Object.keys(e)){const i=e[n];"number"==typeof i&&t.push([i,n])}return i.stableSort(t,((e,t)=>s.compareValues(e[0],t[0])))}(t);if(0===e)return r.length>0&&0===r[0][0]?r[0][1]:"0";if(n){let t="",n=e;for(const[i,s]of r){if(i>e)break;0!==i&&i&e&&(t=`${t}${t?"|":""}${s}`,n&=~i)}if(0===n)return t}else for(const[t,n]of r)if(t===e)return n;return e.toString()},t.getErrorString=function(e){return(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e)},t.getSerializableError=function(e){if(!e)return;return JSON.stringify(e).length>2?e:{name:e.name&&s.isString(e.name)?e.name:"noname",message:e.message&&s.isString(e.message)?e.message:"nomessage",stack:e.stack&&s.isString(e.stack)?e.stack:void 0}}},10219:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDeferredFromPromise=t.createDeferredFrom=t.createDeferred=void 0;class n{constructor(e=null){this.scope=e,this._resolved=!1,this._rejected=!1,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}resolve(e){this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(e){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}}function i(e=null){return new n(e)}t.createDeferred=i,t.createDeferredFrom=function(...e){const t=i();return Promise.all(e).then(t.resolve.bind(t)).catch(t.reject.bind(t)),t},t.createDeferredFromPromise=function(e){const t=i();return e.then(t.resolve.bind(t)).catch(t.reject.bind(t)),t}},24319:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticAddendum=t.Diagnostic=t.convertLevelToCategory=void 0;t.convertLevelToCategory=function(e){switch(e){case"error":return 0;case"warning":return 1;case"information":return 2;default:throw new Error(`${e} is not expected`)}};t.Diagnostic=class{constructor(e,t,n){this.category=e,this.message=t,this.range=n,this._relatedInfo=[]}addAction(e){void 0===this._actions?this._actions=[e]:this._actions.push(e)}getActions(){return this._actions}setRule(e){this._rule=e}getRule(){return this._rule}addRelatedInfo(e,t,n){this._relatedInfo.push({filePath:t,message:e,range:n})}getRelatedInfo(){return this._relatedInfo}};class n{constructor(){this._messages=[],this._childAddenda=[]}addMessage(e){this._messages.push(e)}createAddendum(){const e=new n;return this.addAddendum(e),e}getString(e=5,t=8){let n=this._getLinesRecursive(e,t);n.length>t&&(n=n.slice(0,t),n.push("  ..."));const i=n.join("\n");return i.length>0?"\n"+i:""}isEmpty(){return 0===this._getMessageCount()}addAddendum(e){this._childAddenda.push(e)}getChildren(){return this._childAddenda}_getMessageCount(e=0){if(e>64)return 0;let t=this._messages.length;for(const n of this._childAddenda)t+=n._getMessageCount(e+1);return t}_getLinesRecursive(e,t,n=0){if(e<=0||n>64)return[];let i=[];for(const s of this._childAddenda){const r=this._messages.length>0?e-1:e;if(i.push(...s._getLinesRecursive(r,t,n+1)),i.length>=t){i=i.slice(0,t);break}}const s=this._messages.length>0?"  ":"";return this._messages.concat(i).map((e=>s+e))}}t.DiagnosticAddendum=n},15741:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticRule=void 0,function(e){e.strictListInference="strictListInference",e.strictDictionaryInference="strictDictionaryInference",e.strictParameterNoneValue="strictParameterNoneValue",e.enableTypeIgnoreComments="enableTypeIgnoreComments",e.reportGeneralTypeIssues="reportGeneralTypeIssues",e.reportPropertyTypeMismatch="reportPropertyTypeMismatch",e.reportFunctionMemberAccess="reportFunctionMemberAccess",e.reportMissingImports="reportMissingImports",e.reportMissingModuleSource="reportMissingModuleSource",e.reportMissingTypeStubs="reportMissingTypeStubs",e.reportImportCycles="reportImportCycles",e.reportUnusedImport="reportUnusedImport",e.reportUnusedClass="reportUnusedClass",e.reportUnusedFunction="reportUnusedFunction",e.reportUnusedVariable="reportUnusedVariable",e.reportDuplicateImport="reportDuplicateImport",e.reportWildcardImportFromLibrary="reportWildcardImportFromLibrary",e.reportOptionalSubscript="reportOptionalSubscript",e.reportOptionalMemberAccess="reportOptionalMemberAccess",e.reportOptionalCall="reportOptionalCall",e.reportOptionalIterable="reportOptionalIterable",e.reportOptionalContextManager="reportOptionalContextManager",e.reportOptionalOperand="reportOptionalOperand",e.reportTypedDictNotRequiredAccess="reportTypedDictNotRequiredAccess",e.reportUntypedFunctionDecorator="reportUntypedFunctionDecorator",e.reportUntypedClassDecorator="reportUntypedClassDecorator",e.reportUntypedBaseClass="reportUntypedBaseClass",e.reportUntypedNamedTuple="reportUntypedNamedTuple",e.reportPrivateUsage="reportPrivateUsage",e.reportConstantRedefinition="reportConstantRedefinition",e.reportIncompatibleMethodOverride="reportIncompatibleMethodOverride",e.reportIncompatibleVariableOverride="reportIncompatibleVariableOverride",e.reportOverlappingOverload="reportOverlappingOverload",e.reportInvalidStringEscapeSequence="reportInvalidStringEscapeSequence",e.reportUnknownParameterType="reportUnknownParameterType",e.reportUnknownArgumentType="reportUnknownArgumentType",e.reportUnknownLambdaType="reportUnknownLambdaType",e.reportUnknownVariableType="reportUnknownVariableType",e.reportUnknownMemberType="reportUnknownMemberType",e.reportMissingTypeArgument="reportMissingTypeArgument",e.reportInvalidTypeVarUse="reportInvalidTypeVarUse",e.reportCallInDefaultInitializer="reportCallInDefaultInitializer",e.reportUnnecessaryIsInstance="reportUnnecessaryIsInstance",e.reportUnnecessaryCast="reportUnnecessaryCast",e.reportAssertAlwaysTrue="reportAssertAlwaysTrue",e.reportSelfClsParameterName="reportSelfClsParameterName",e.reportImplicitStringConcatenation="reportImplicitStringConcatenation",e.reportUndefinedVariable="reportUndefinedVariable",e.reportUnboundVariable="reportUnboundVariable",e.reportInvalidStubStatement="reportInvalidStubStatement",e.reportUnsupportedDunderAll="reportUnsupportedDunderAll",e.reportUnusedCallResult="reportUnusedCallResult",e.reportUnusedCoroutine="reportUnusedCoroutine"}(t.DiagnosticRule||(t.DiagnosticRule={}))},85036:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextRangeDiagnosticSink=t.DiagnosticSink=void 0;const i=n(24319),s=n(28348);class r{constructor(e){this._diagnosticList=e||[],this._diagnosticMap=new Map}fetchAndClear(){const e=this._diagnosticList;return this._diagnosticList=[],this._diagnosticMap.clear(),e}addError(e,t){return this.addDiagnostic(new i.Diagnostic(0,e,t))}addWarning(e,t){return this.addDiagnostic(new i.Diagnostic(1,e,t))}addInformation(e,t){return this.addDiagnostic(new i.Diagnostic(2,e,t))}addUnusedCode(e,t,n){const s=new i.Diagnostic(3,e,t);return n&&s.addAction(n),this.addDiagnostic(s)}addDiagnostic(e){const t=`${e.range.start.line},${e.range.start.character}-${e.range.end.line}-${e.range.end.character}:${e.message.substr(0,25)}}`;return this._diagnosticMap.has(t)||(this._diagnosticList.push(e),this._diagnosticMap.set(t,e)),e}addDiagnostics(e){this._diagnosticList.push(...e)}getErrors(){return this._diagnosticList.filter((e=>0===e.category))}getWarnings(){return this._diagnosticList.filter((e=>1===e.category))}getInformation(){return this._diagnosticList.filter((e=>2===e.category))}getUnusedCode(){return this._diagnosticList.filter((e=>3===e.category))}}t.DiagnosticSink=r;t.TextRangeDiagnosticSink=class extends r{constructor(e,t){super(t),this._lines=e}addDiagnosticWithTextRange(e,t,n){const i=s.convertOffsetsToRange(n.start,n.start+n.length,this._lines);switch(e){case"error":return this.addError(t,i);case"warning":return this.addWarning(t,i);case"information":return this.addInformation(t,i);default:throw new Error(`${e} is not expected value`)}}addUnusedCodeWithTextRange(e,t,n){return this.addUnusedCode(e,s.convertOffsetsToRange(t.start,t.start+t.length,this._lines),n)}}},53117:()=>{"use strict";Promise.prototype.ignoreErrors=function(){this.catch((()=>{}))}},6021:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ignoredWatchEventFunction=t.createFromRealFileSystem=void 0;const a=r(n(89775)),o=r(n(35747)),l=r(n(88554));l.setGracefulCleanup();const c=n(11043),p=n(10219);t.createFromRealFileSystem=function(e,t){return new h(null!=t?t:new m(null!=e?e:new c.NullConsole))},t.ignoredWatchEventFunction=function(e){const t=e.map((e=>e.toLowerCase()));return e=>{if(!e||e.indexOf("__pycache__")>=0)return!0;const n=e.toLowerCase();return t.every((e=>n.indexOf(e)<0))}};const u="darwin"===process.platform,d="linux"===process.platform;class h{constructor(e){this._fileWatcherProvider=e}existsSync(e){return o.existsSync(e)}mkdirSync(e,t){o.mkdirSync(e,t)}chdir(e){process.chdir(e)}readdirSync(e){return o.readdirSync(e)}readdirEntriesSync(e){return o.readdirSync(e,{withFileTypes:!0})}readFileSync(e,t=null){return o.readFileSync(e,{encoding:t})}writeFileSync(e,t,n){o.writeFileSync(e,t,{encoding:n})}statSync(e){return o.statSync(e)}unlinkSync(e){o.unlinkSync(e)}realpathSync(e){return o.realpathSync(e)}getModulePath(){return global.__rootDirectory}createFileSystemWatcher(e,t){return this._fileWatcherProvider.createFileWatcher(e,t)}createReadStream(e){return o.createReadStream(e)}createWriteStream(e){return o.createWriteStream(e)}copyFileSync(e,t){o.copyFileSync(e,t)}readFile(e){const t=p.createDeferred();return o.readFile(e,((e,n)=>{e?t.reject(e):t.resolve(n)})),t.promise}readFileText(e,t){const n=p.createDeferred();return o.readFile(e,{encoding:t},((e,t)=>{e?n.reject(e):n.resolve(t)})),n.promise}tmpdir(){if(!this._tmpdir){const e=l.dirSync({prefix:"pyright"});this._tmpdir=e.name}return this._tmpdir}tmpfile(e){return l.fileSync(Object.assign({dir:this.tmpdir(),discardDescriptor:!0},e)).name}}class m{constructor(e){this._console=e}createFileWatcher(e,t){return this._createFileSystemWatcher(e).on("all",t)}createReadStream(e){return o.createReadStream(e)}createWriteStream(e){return o.createWriteStream(e)}_createFileSystemWatcher(e){const t={ignoreInitial:!0,ignorePermissionErrors:!0,followSymlinks:!0,interval:1e3,binaryInterval:1e3,disableGlobbing:!0,awaitWriteFinish:{stabilityThreshold:1e3,pollInterval:1e3}};u&&(t.usePolling=!1);const n=["**/__pycache__/**"];(u||d)&&e.some((e=>""===e||"/"===e))&&(n.push("/dev/**"),d&&n.push("/proc/**","/sys/**")),t.ignored=n;const i=a.watch(e,t);return i.on("error",(e=>{this._console.error("Error returned from file system watcher.")})),u&&!i.options.useFsEvents&&this._console.info("Watcher could not use native fsevents library. File system watcher disabled."),i}readFile(e){const t=p.createDeferred();return o.readFile(e,((e,n)=>{e?t.reject(e):t.resolve(n)})),t.promise}readFileText(e,t){const n=p.createDeferred();return o.readFile(e,{encoding:t},((e,t)=>{e?n.reject(e):n.resolve(t)})),n.promise}}},77134:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogTracker=void 0;const i=n(11043),s=n(76962);t.LogTracker=class{constructor(e,t){this._console=e,this._prefix=t,this._dummyState=new r,this._indentation="",this._previousTitles=[]}log(e,t,n=-1,s=!1){if(void 0===this._console)return t(this._dummyState);const a=this._console.level;if(void 0===a||a!==i.LogLevel.Log&&a!==i.LogLevel.Info)return t(this._dummyState);const o=this._indentation;this._previousTitles.push(`${o}${e} ...`),this._indentation+="  ";const l=new r;try{return t(l)}finally{const t=l.duration;if(this._indentation=o,this._previousTitles.length>0&&(l.isSuppressed()||t<=n))this._previousTitles.pop();else{this._printPreviousTitles();let n=`[${this._prefix}] ${this._indentation}${e}${l.get()} (${t}ms)`;s&&l.fileReadTotal+l.tokenizeTotal+l.parsingTotal+l.resolveImportsTotal+l.bindingTotal>0&&(n+=` [f:${l.fileReadTotal}, t:${l.tokenizeTotal}, p:${l.parsingTotal}, i:${l.resolveImportsTotal}, b:${l.bindingTotal}]`),this._console.log(n),t>=2e3&&this._console.info(`[${this._prefix}] Long operation: ${e} (${t}ms)`)}}}_printPreviousTitles(){if(this._previousTitles.pop(),!(this._previousTitles.length<=0)){for(const e of this._previousTitles)this._console.log(`[${this._prefix}] ${e}`);this._previousTitles.length=0}}};class r{constructor(){this._start=new s.Duration,this._startFile=s.timingStats.readFileTime.totalTime,this._startToken=s.timingStats.tokenizeFileTime.totalTime,this._startParse=s.timingStats.parseFileTime.totalTime,this._startImport=s.timingStats.resolveImportsTime.totalTime,this._startBind=s.timingStats.bindTime.totalTime}get duration(){return this._start.getDurationInMilliseconds()}get fileReadTotal(){return s.timingStats.readFileTime.totalTime-this._startFile}get tokenizeTotal(){return s.timingStats.tokenizeFileTime.totalTime-this._startToken}get parsingTotal(){return s.timingStats.parseFileTime.totalTime-this._startParse}get resolveImportsTotal(){return s.timingStats.resolveImportsTime.totalTime-this._startImport}get bindingTotal(){return s.timingStats.bindTime.totalTime-this._startBind}add(e){e&&(this._addendum=e)}get(){return this._addendum?` [${this._addendum}]`:""}suppress(){this._suppress=!0}isSuppressed(){return!!this._suppress}}},97956:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stubsSuffix=t.src=t.sitePackages=t.lib64=t.libAlternate=t.lib=t.typeshedFallback=void 0,t.typeshedFallback="typeshed-fallback",t.lib="lib",t.libAlternate="Lib",t.lib64="lib64",t.sitePackages="site-packages",t.src="src",t.stubsSuffix="-stubs"},94647:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getLibraryPathWithoutExtension=t.isFileSystemCaseSensitiveInternal=t.isFileSystemCaseSensitive=t.normalizePathCase=t.convertPathToUri=t.convertUriToPath=t.isDiskPathRoot=t.isRootedDiskPath=t.getRegexEscapedSeparator=t.getFileSpec=t.getWildcardRoot=t.getWildcardRegexPattern=t.getFileSystemEntriesFromDirEntries=t.getFileSystemEntries=t.tryRealpath=t.tryStat=t.isFile=t.isDirectory=t.normalizePath=t.stripFileExtension=t.getFileName=t.getFileExtension=t.stripTrailingDirectorySeparator=t.hasTrailingDirectorySeparator=t.ensureTrailingDirectorySeparator=t.comparePathsCaseInsensitive=t.comparePathsCaseSensitive=t.getRelativePathComponentsFromDirectory=t.getRelativePathFromDirectory=t.getBaseFileName=t.getAnyExtensionFromPath=t.changeAnyExtension=t.containsPath=t.comparePaths=t.combinePaths=t.resolvePaths=t.normalizeSlashes=t.directoryExists=t.fileExists=t.getFileSize=t.makeDirectories=t.getRelativePath=t.combinePathComponents=t.reducePathComponents=t.getPathComponents=t.getRootLength=t.getDirectoryPath=t.forEachAncestorDirectory=t.FileSpec=void 0;const a=n(76417),o=r(n(85622)),l=n(15585),c=n(37633),p=n(9133),u=n(98173),d=r(n(20823)),h=n(14551);let m;function y(e){return e.substr(0,Math.max(g(e),e.lastIndexOf(o.sep)))}function g(e){if(e.charAt(0)===o.sep){if(e.charAt(1)!==o.sep)return 1;const t=e.indexOf(o.sep,2);if(t<0)return 2;const n=e.indexOf(o.sep,t+1);return n<0?t+1:n+1}return":"===e.charAt(1)&&e.charAt(2)===o.sep?3:0}function f(e){const t=v(e),n=g(t),i=t.substring(0,n),s=t.substring(n).split(o.sep);return s.length>0&&!s[s.length-1]&&s.pop(),T([i,...s])}function T(e){if(!p.some(e))return[];const t=[e[0]];for(let n=1;n<e.length;n++){const i=e[n];if(i&&"."!==i){if(".."===i)if(t.length>1){if(".."!==t[t.length-1]){t.pop();continue}}else if(t[0])continue;t.push(i)}}return t}function _(e){if(0===e.length)return"";return v((e[0]&&D(e[0]))+e.slice(1).join(o.sep))}function v(e){return e.replace(/[\\/]/g,o.sep)}function b(e,...t){e&&(e=v(e));for(let n of t)n&&(n=v(n),e=e&&0===g(n)?D(e)+n:n);return e}function S(e,t,n){if(t)return function(e,t,n){if("string"==typeof t)return U(e,t,n)||"";for(const i of t){const t=U(e,i,n);if(t)return t}return""}(k(e),t,n?h.equateStringsCaseInsensitive:h.equateStringsCaseSensitive);const i=C(e),s=i.lastIndexOf(".");return s>=0?i.substring(s):""}function C(e,t,n){if(g(e=v(e))===e.length)return"";const i=(e=k(e)).slice(Math.max(g(e),e.lastIndexOf(o.sep)+1)),s=void 0!==t&&void 0!==n?S(i,t,n):void 0;return s?i.slice(0,i.length-s.length):i}function I(e,t,n){d.assert(g(e)>0==g(t)>0,"Paths must either both be absolute or both be relative");const i="function"==typeof n?n:u.identity;return function(e,t,n,i){const s=f(e),r=f(t);let a;for(a=0;a<s.length&&a<r.length;a++){const e=i(s[a]),t=i(r[a]);if(!(0===a?h.equateStringsCaseInsensitive:n)(e,t))break}if(0===a)return r;const o=r.slice(a),l=[];for(;a<s.length;a++)l.push("..");return["",...l,...o]}(e,t,"boolean"==typeof n&&n?h.equateStringsCaseInsensitive:h.equateStringsCaseSensitive,i)}function D(e){return x(e)?e:e+o.sep}function x(e){if(0===e.length)return!1;const t=e.charCodeAt(e.length-1);return 47===t||92===t}function k(e){return x(e)?e.substr(0,e.length-1):e}function F(e,t=!1){if(!t)return o.extname(e);const n=(e=P(e)).indexOf(".");return e.substr(n)}function P(e){return o.basename(e)}function A(e,t=!1){const n=F(e,t);return e.substr(0,e.length-n.length)}function E(e){return v(o.normalize(e))}function w(e,t){try{return e.statSync(t)}catch(e){return}}function N(e,t,n){const i=e.sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0)),s=[],r=[];for(const e of i)if("."!==e.name&&".."!==e.name)if(e.isFile())s.push(e.name);else if(e.isDirectory())r.push(e.name);else if(e.isSymbolicLink()){const i=w(t,b(n,e.name));(null==i?void 0:i.isFile())?s.push(e.name):(null==i?void 0:i.isDirectory())&&r.push(e.name)}return{files:s,directories:r}}function O(e,t){let n=E(b(e,t));n.endsWith(".py")||n.endsWith(".pyi")||(n=D(n));const i=f(n),s=M(),r=`(${s}[^${s}.][^${s}]*)*?`,a=new RegExp(`[^\\w\\s${s}]`,"g");i.length>0&&(i[0]=k(i[0]));let o="",l=!0;for(let e of i)"**"===e?o+=r:(l||(e=s+e),o+=e.replace(a,(e=>"*"===e?`[^${s}]*`:"?"===e?`[^${s}]`:"\\"+e)),l=!1);return o}function R(e,t){let n=E(b(e,t));n.endsWith(".py")||n.endsWith(".pyi")||(n=D(n));const i=f(n);i.length>0&&(i[0]=k(i[0]));let s="",r=!0;for(let e of i){if("**"===e)break;if(e.match(/[*?]/))break;r||(e=o.sep+e),s+=e,r=!1}return s}function M(){return"/"===o.sep?"/":"\\\\"}function L(e,t,n){if(e===t)return 0;if(void 0===e)return-1;if(void 0===t)return 1;const i=e.substring(0,g(e)),s=t.substring(0,g(t)),r=h.compareStringsCaseInsensitive(i,s);if(0!==r)return r;const a=M(),o=new RegExp(`(^|${a}).{0,2}($|${a})`),l=e.substring(i.length),c=t.substring(s.length);if(!o.test(l)&&!o.test(c))return n(l,c);const p=f(e),d=f(t),m=Math.min(p.length,d.length);for(let e=1;e<m;e++){const t=n(p[e],d[e]);if(0!==t)return t}return u.compareValues(p.length,d.length)}function U(e,t,n){if(t.startsWith(".")||(t="."+t),e.length>=t.length&&46===e.charCodeAt(e.length-t.length)){const i=e.slice(e.length-t.length);if(n(i,t))return i}}function V(e,t,n){try{const i=e.statSync(t);switch(n){case 0:return i.isFile();case 1:return i.isDirectory();default:return!1}}catch(e){return!1}}function z(e){return void 0!==m||(m=j(e)),m}function j(e){let t;try{let n,i;do{n=`${a.randomBytes(21).toString("hex")}-a`,t=o.join(e.tmpdir(),n),i=o.join(e.tmpdir(),n.toUpperCase())}while(e.existsSync(t)||e.existsSync(i));return e.writeFileSync(t,"","utf8"),!e.existsSync(i)}catch(e){return!1}finally{t&&e.unlinkSync(t)}}!function(e){e.is=function(e){const t=e;return t&&!!t.wildcardRoot&&!!t.regExp}}(t.FileSpec||(t.FileSpec={})),t.forEachAncestorDirectory=function(e,t){for(;;){const n=t(e);if(void 0!==n)return n;const i=y(e);if(i===e)return;e=i}},t.getDirectoryPath=y,t.getRootLength=g,t.getPathComponents=f,t.reducePathComponents=T,t.combinePathComponents=_,t.getRelativePath=function(e,t){if(!e.startsWith(D(t)))return;const n=f(e);let i=".";for(let e=f(t).length;e<n.length;e++)i+=o.sep+n[e];return i},t.makeDirectories=function(e,t,n){if(!t.startsWith(n))return;const i=f(t);let s=n;for(let t=f(n).length;t<i.length;t++)s=b(s,i[t]),e.existsSync(s)||e.mkdirSync(s)},t.getFileSize=function(e,t){const n=w(e,t);return(null==n?void 0:n.isFile())?n.size:0},t.fileExists=function(e,t){return V(e,t,0)},t.directoryExists=function(e,t){return V(e,t,1)},t.normalizeSlashes=v,t.resolvePaths=function(e,...t){return E(p.some(t)?b(e,...t):v(e))},t.combinePaths=b,t.comparePaths=function(e,t,n,i){return e=E(e),t=E(t),"string"==typeof n?(e=b(n,e),t=b(n,t)):"boolean"==typeof n&&(i=n),L(e,t,h.getStringComparer(i))},t.containsPath=function(e,t,n,i){if("string"==typeof n?(e=b(n,e),t=b(n,t)):"boolean"==typeof n&&(i=n),void 0===e||void 0===t)return!1;if(e===t)return!0;const s=f(e),r=f(t);if(r.length<s.length)return!1;const a=i?h.equateStringsCaseInsensitive:h.equateStringsCaseSensitive;for(let e=0;e<s.length;e++){if(!(0===e?h.equateStringsCaseInsensitive:a)(s[e],r[e]))return!1}return!0},t.changeAnyExtension=function(e,t,n,i){const s=void 0!==n&&void 0!==i?S(e,n,i):S(e);return s?e.slice(0,e.length-s.length)+(t.startsWith(".")?t:"."+t):e},t.getAnyExtensionFromPath=S,t.getBaseFileName=C,t.getRelativePathFromDirectory=function(e,t,n){return _(I(e,t,n))},t.getRelativePathComponentsFromDirectory=I,t.comparePathsCaseSensitive=function(e,t){return L(e,t,h.compareStringsCaseSensitive)},t.comparePathsCaseInsensitive=function(e,t){return L(e,t,h.compareStringsCaseInsensitive)},t.ensureTrailingDirectorySeparator=D,t.hasTrailingDirectorySeparator=x,t.stripTrailingDirectorySeparator=k,t.getFileExtension=F,t.getFileName=P,t.stripFileExtension=A,t.normalizePath=E,t.isDirectory=function(e,t){var n,i;return null!==(i=null===(n=w(e,t))||void 0===n?void 0:n.isDirectory())&&void 0!==i&&i},t.isFile=function(e,t){var n,i;return null!==(i=null===(n=w(e,t))||void 0===n?void 0:n.isFile())&&void 0!==i&&i},t.tryStat=w,t.tryRealpath=function(e,t){try{return e.realpathSync(t)}catch(e){return}},t.getFileSystemEntries=function(e,t){try{return N(e.readdirEntriesSync(t||"."),e,t)}catch(e){return{files:[],directories:[]}}},t.getFileSystemEntriesFromDirEntries=N,t.getWildcardRegexPattern=O,t.getWildcardRoot=R,t.getFileSpec=function(e,t){let n=O(e,t);n=`^(${n})($|${M()})`;const i=new RegExp(n);return{wildcardRoot:R(e,t),regExp:i}},t.getRegexEscapedSeparator=M,t.isRootedDiskPath=function(e){return g(e)>0},t.isDiskPathRoot=function(e){const t=g(e);return t>0&&t===e.length},t.convertUriToPath=function(e,t){let n=E(l.URI.parse(t).path);return n.match(/^\\[a-zA-Z]:\\/)&&(n=n.substr(1)),e instanceof c.PyrightFileSystem?e.getMappedFilePath(n):n},t.convertPathToUri=function(e,t){return e instanceof c.PyrightFileSystem&&(t=e.getOriginalFilePath(t)),l.URI.file(t).toString()},t.normalizePathCase=function(e,t){return z(e)?t:t.toLowerCase()},t.isFileSystemCaseSensitive=z,t.isFileSystemCaseSensitiveInternal=j,t.getLibraryPathWithoutExtension=function(e){let t=A(e);return t.endsWith("__init__")&&(t=t.substr(0,t.length-9)),t}},28348:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRangeToTextRange=t.convertPositionToOffset=t.convertOffsetsToRange=t.convertOffsetToPosition=void 0;const i=n(20823),s=n(80957);function r(e,t){if(0===t.end)return{line:0,character:0};let n=0;e>=t.end&&(e=t.end-1,n=1);const s=t.getItemContaining(e);i.assert(s>=0&&s<=t.length);const r=t.getItemAt(s);return i.assert(void 0!==r),{line:s,character:e-r.start+n}}function a(e,t){if(!(e.line>=t.count))return t.getItemAt(e.line).start+e.character}t.convertOffsetToPosition=r,t.convertOffsetsToRange=function(e,t,n){return{start:r(e,n),end:r(t,n)}},t.convertPositionToOffset=a,t.convertRangeToTextRange=function(e,t){const n=a(e.start,t);if(void 0===n)return;const i=a(e.end,t);return void 0!==i?s.TextRange.fromBounds(n,i):void 0}},76913:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressReportTracker=void 0;t.ProgressReportTracker=class{constructor(e){this._reporter=e,this._isDisplayingProgress=!1}isEnabled(e){var t;return!!this._isDisplayingProgress||null!==(t=this._reporter.isEnabled(e))&&void 0!==t&&t}begin(){this._isDisplayingProgress||(this._isDisplayingProgress=!0,this._reporter.begin())}report(e){this._isDisplayingProgress&&this._reporter.report(e)}end(){this._isDisplayingProgress&&(this._isDisplayingProgress=!1,this._reporter.end())}}},57485:(e,t)=>{"use strict";var n;function i(e,t){if(isNaN(e)||isNaN(t))return;if(e>255||t>255)return;const i=256*e+t;return void 0!==n[i]&&s(i)?i:void 0}function s(e){return e>>8==3}Object.defineProperty(t,"__esModule",{value:!0}),t.is3x=t.versionFromMajorMinor=t.versionFromString=t.versionToString=t.latestPythonVersion=t.latestStablePythonVersion=t.PythonVersion=void 0,function(e){e[e.V3_0=768]="V3_0",e[e.V3_1=769]="V3_1",e[e.V3_2=770]="V3_2",e[e.V3_3=771]="V3_3",e[e.V3_4=772]="V3_4",e[e.V3_5=773]="V3_5",e[e.V3_6=774]="V3_6",e[e.V3_7=775]="V3_7",e[e.V3_8=776]="V3_8",e[e.V3_9=777]="V3_9",e[e.V3_10=778]="V3_10"}(n=t.PythonVersion||(t.PythonVersion={})),t.latestStablePythonVersion=n.V3_9,t.latestPythonVersion=n.V3_9,t.versionToString=function(e){return`${e>>8&255}.${255&e}`},t.versionFromString=function(e){const t=e.split(".");if(t.length<2)return;return i(parseInt(t[0],10),parseInt(t[1],10))},t.versionFromMajorMinor=i,t.is3x=s},14551:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getCharacterCount=t.equateStringsCaseSensitive=t.equateStringsCaseInsensitive=t.getStringComparer=t.compareStringsCaseSensitive=t.compareStringsCaseInsensitive=t.hashString=t.isPatternInSymbol=t.computeCompletionSimilarity=void 0;const s=i(n(68505)),r=n(98173);function a(e,t){return e===t?0:void 0===e?-1:void 0===t?1:r.compareComparableValues(e.toUpperCase(),t.toUpperCase())}function o(e,t){return r.compareComparableValues(e,t)}t.computeCompletionSimilarity=function(e,t){if(t.startsWith(e))return 1;const n=t.toLocaleLowerCase(),i=e.toLocaleLowerCase();if(n.startsWith(i))return.75;let r=n.length,a=Number.MAX_VALUE;for(;r>0;){const e=s.default(n.substr(0,r),i);e<a&&(a=e),r--}return a>=e.length?0:.5*((e.length-a)/e.length)},t.isPatternInSymbol=function(e,t){const n=e.toLocaleLowerCase(),i=t.toLocaleLowerCase(),s=n.length,r=i.length;let a=0,o=0;for(;a<s&&o<r;)n[a]===i[o]&&(a+=1),o+=1;return a===s},t.hashString=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t},t.compareStringsCaseInsensitive=a,t.compareStringsCaseSensitive=o,t.getStringComparer=function(e){return e?a:o},t.equateStringsCaseInsensitive=function(e,t){return 0===a(e,t)},t.equateStringsCaseSensitive=function(e,t){return 0===o(e,t)},t.getCharacterCount=function(e,t){let n=0;for(let i=0;i<e.length;i++)e[i]===t&&n++;return n}},34815:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertTextEdits=void 0,t.convertTextEdits=function(e,t){if(!t)return{};const n=[];return t.forEach((e=>{n.push({range:e.range,newText:e.replacementText})})),{changes:{[e]:n}}}},80957:(e,t)=>{"use strict";var n,i;function s(e,t){return e.line<t.line?-1:e.line>t.line?1:e.character<t.character?-1:e.character>t.character?1:0}function r(){return{line:0,character:0}}function a(e){return 0===e.character&&0===e.line}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyRange=t.isEmptyPosition=t.getEmptyRange=t.rangesAreEqual=t.doesRangeContain=t.doRangesIntersect=t.doRangesOverlap=t.getEmptyPosition=t.comparePositions=t.TextRange=void 0,function(e){function t(e,t){if(e<0)throw new Error("start must be non-negative");if(t<0)throw new Error("length must be non-negative");return{start:e,length:t}}function n(e){return e.start+e.length}function i(e,t){t&&(Array.isArray(t)?t.forEach((t=>{i(e,t)})):(t.start<e.start&&(e.length+=e.start-t.start,e.start=t.start),n(t)>n(e)&&(e.length+=n(t)-n(e))))}e.create=t,e.fromBounds=function(e,n){if(e<0)throw new Error("start must be non-negative");if(e>n)throw new Error("end must be greater than or equal to start");return t(e,n-e)},e.getEnd=n,e.contains=function(e,t){return t>=e.start&&t<n(e)},e.containsRange=function(e,t){return t.start>=e.start&&n(t)<=n(e)},e.overlaps=function(e,t){return t>=e.start&&t<=n(e)},e.extend=i,e.combine=function(e){if(0===e.length)return;const t=e[0];for(let n=1;n<e.length;n++)i(t,e[n]);return t}}(t.TextRange||(t.TextRange={})),function(e){e.is=function(e){const t=e;return t&&void 0!==t.line&&void 0!==t.character}}(n||(n={})),function(e){e.is=function(e){const t=e;return t&&void 0!==t.start&&void 0!==t.end}}(i||(i={})),t.comparePositions=s,t.getEmptyPosition=r,t.doRangesOverlap=function(e,t){return!(s(t.start,e.end)>=0)&&!(s(e.start,t.end)>=0)},t.doRangesIntersect=function(e,t){return!(s(t.start,e.end)>0)&&!(s(e.start,t.end)>0)},t.doesRangeContain=function e(t,i){return n.is(i)?s(t.start,i)<=0&&s(t.end,i)>=0:e(t,i.start)&&e(t,i.end)},t.rangesAreEqual=function(e,t){return 0===s(e.start,t.start)&&0===s(e.end,t.end)},t.getEmptyRange=function(){return{start:{line:0,character:0},end:{line:0,character:0}}},t.isEmptyPosition=a,t.isEmptyRange=function(e){return a(e.start)&&a(e.end)}},979:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextRangeCollection=void 0;const i=n(80957);t.TextRangeCollection=class{constructor(e){this._items=e}get start(){return this._items.length>0?this._items[0].start:0}get end(){const e=this._items[this._items.length-1];return this._items.length>0?e.start+e.length:0}get length(){return this.end-this.start}get count(){return this._items.length}contains(e){return e>=this.start&&e<this.end}getItemAt(e){if(e<0||e>=this._items.length)throw new Error("index is out of range");return this._items[e]}getItemAtPosition(e){if(0===this.count)return-1;if(e<this.start)return-1;if(e>this.end)return-1;let t=0,n=this.count-1;for(;t<n;){const i=Math.floor(t+(n-t)/2),s=this._items[i];if(e>=s.start&&(i>=this.count-1||e<this._items[i+1].start))return i;e<s.start?n=i-1:t=i+1}return t}getItemContaining(e){if(0===this.count)return-1;if(e<this.start)return-1;if(e>this.end)return-1;let t=0,n=this.count-1;for(;t<=n;){const s=Math.floor(t+(n-t)/2),r=this._items[s];if(i.TextRange.contains(r,e))return s;if(s<this.count-1&&i.TextRange.getEnd(r)<=e&&e<this._items[s+1].start)return-1;e<r.start?n=s-1:t=s+1}return-1}}},76962:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timingStats=t.TimingStats=t.TimingStat=t.Duration=void 0;class n{constructor(){this._startTime=Date.now()}getDurationInMilliseconds(){return Date.now()-this._startTime}getDurationInSeconds(){return this.getDurationInMilliseconds()/1e3}}t.Duration=n;class i{constructor(){this.totalTime=0,this.callCount=0,this.isTiming=!1}timeOperation(e){if(this.callCount++,this.isTiming)return e();{this.isTiming=!0;const t=new n,i=e();return this.totalTime+=t.getDurationInMilliseconds(),this.isTiming=!1,i}}subtractFromTime(e){if(this.isTiming){this.isTiming=!1;const t=new n;e(),this.totalTime-=t.getDurationInMilliseconds(),this.isTiming=!0}else e()}printTime(){const e=this.totalTime/1e3;return(Math.round(100*e)/100).toString()+"sec"}}t.TimingStat=i;class s{constructor(){this.totalDuration=new n,this.findFilesTime=new i,this.readFileTime=new i,this.tokenizeFileTime=new i,this.parseFileTime=new i,this.resolveImportsTime=new i,this.cycleDetectionTime=new i,this.bindTime=new i,this.typeCheckerTime=new i,this.typeEvaluationTime=new i}printSummary(e){e.info(`Completed in ${this.totalDuration.getDurationInSeconds()}sec`)}printDetails(e){e.info(""),e.info("Timing stats"),e.info("Find Source Files:    "+this.findFilesTime.printTime()),e.info("Read Source Files:    "+this.readFileTime.printTime()),e.info("Tokenize:             "+this.tokenizeFileTime.printTime()),e.info("Parse:                "+this.parseFileTime.printTime()),e.info("Resolve Imports:      "+this.resolveImportsTime.printTime()),e.info("Bind:                 "+this.bindTime.printTime()),e.info("Check:                "+this.typeCheckerTime.printTime()),e.info("Detect Cycles:        "+this.cycleDetectionTime.printTime())}getTotalDuration(){return this.totalDuration.getDurationInSeconds()}}t.TimingStats=s,t.timingStats=new s},19728:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertWorkspaceEdits=void 0;const i=n(94647);t.convertWorkspaceEdits=function(e,t){const n={changes:{}};return t.forEach((t=>{const s=i.convertPathToUri(e,t.filePath);n.changes[s]=n.changes[s]||[],n.changes[s].push({range:t.range,newText:t.replacementText})})),n}},52599:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageServerBase=void 0,n(53117);const o=r(n(35747)),l=n(9283),c=n(47041),p=n(67145),u=n(44314),d=n(38213),h=n(9133),m=n(96795),y=n(14943),g=n(11043),f=n(10219),T=n(6021),_=n(94647),v=n(76913),b=n(19728),S=n(22060),C=n(27888),I=n(54989),D=n(8871),x=n(74426),k=n(37633),F=n(64553);t.LanguageServerBase=class{constructor(e){var t,n;this._serverOptions=e,this._connection=l.createConnection(this._GetConnectionOptions()),this.client={hasConfigurationCapability:!1,hasVisualStudioExtensionsCapability:!1,hasWorkspaceFoldersCapability:!1,hasWatchFileCapability:!1,hasActiveParameterCapability:!1,hasSignatureLabelOffsetCapability:!1,hasHierarchicalDocumentSymbolCapability:!1,hasWindowProgressCapability:!1,hasGoToDeclarationCapability:!1,hoverContentFormat:l.MarkupKind.PlainText,completionDocFormat:l.MarkupKind.PlainText,completionSupportsSnippet:!1,signatureDocFormat:l.MarkupKind.PlainText,supportsUnnecessaryDiagnosticTag:!1,completionItemResolveSupportsAdditionalTextEdits:!1},this._fileWatchers=[],this._lastTriggerKind=l.CompletionTriggerKind.Invoked,this.rootPath="",global.__rootDirectory=e.rootDirectory,this.console=new g.ConsoleWithLogLevel(this._connection.console),this.console.info(`${e.productName} language server ${e.version&&e.version+" "}starting`),this.console.info(`Server root directory: ${e.rootDirectory}`),this.fs=new k.PyrightFileSystem(T.createFromRealFileSystem(this.console,this));const i=this.fs.getModulePath();i&&this.fs.chdir(i),this._workspaceMap=new F.WorkspaceMap(this),this.setupConnection(null!==(t=e.supportedCommands)&&void 0!==t?t:[],null!==(n=e.supportedCodeActions)&&void 0!==n?n:[]),this._progressReporter=new v.ProgressReportTracker(this.createProgressReporter()),this._connection.listen()}isLongRunningCommand(e){return!0}getConfiguration(e,t){return a(this,void 0,void 0,(function*(){if(this.client.hasConfigurationCapability){const n={scopeUri:e,section:t};return this._connection.workspace.getConfiguration(n)}if(this._defaultClientConfig)return h.getNestedProperty(this._defaultClientConfig,t)}))}isOpenFilesOnly(e){return"workspace"!==e}getSeverityOverrides(e){const t=e;if(m.getDiagnosticSeverityOverrides().includes(t))return t}getDiagnosticRuleName(e){const t=e;if(y.getDiagLevelDiagnosticRules().includes(t))return t}createImportResolver(e,t){return new p.ImportResolver(e,t)}createBackgroundAnalysisProgram(e,t,n,i,s,r){return new c.BackgroundAnalysisProgram(e,t,n,i,s,r)}setExtension(e){this._serverOptions.extension=e}get window(){return this._connection.window}createAnalyzerService(e){this.console.log(`Starting service instance "${e}"`);const t=new u.AnalyzerService(e,this.fs,this.console,this.createImportResolver.bind(this),void 0,this._serverOptions.extension,this.createBackgroundAnalysis(),this._serverOptions.maxAnalysisTimeInForeground,this.createBackgroundAnalysisProgram.bind(this));return t.setCompletionCallback((e=>this.onAnalysisCompletedHandler(e))),t}getWorkspaceForFile(e){return a(this,void 0,void 0,(function*(){const t=this._workspaceMap.getWorkspaceForFile(e);return yield t.isInitialized.promise,t}))}reanalyze(){this._workspaceMap.forEach((e=>{e.serviceInstance.invalidateAndForceReanalysis()}))}restart(){this._workspaceMap.forEach((e=>{e.serviceInstance.restart()}))}createFileWatcher(e,t){const n=this,i=[],s=[],r=this._workspaceMap.getNonDefaultWorkspaces();let a;e.forEach((e=>{r.some((t=>_.containsPath(t.rootPath,e)))?i.push(e):s.push(e)}));try{a=s.map((e=>o.watch(e,{recursive:!0},((e,n)=>t(e,n)))))}catch(e){this.console.error("Exception received when installing recursive file system watcher"),a=[]}const l={close(){n._fileWatchers=n._fileWatchers.filter((e=>e!==l)),a.forEach((e=>{e.close()}))},workspacePaths:i,eventHandler:t};return this._fileWatchers.push(l),l}setupConnection(e,t){this._connection.onInitialize((n=>this.initialize(n,e,t))),this._connection.onDidChangeConfiguration((e=>{this.console.log("Received updated settings"),(null==e?void 0:e.settings)&&(this._defaultClientConfig=null==e?void 0:e.settings),this.updateSettingsForAllWorkspaces()})),this._connection.onCodeAction(((e,t)=>this.executeCodeAction(e,t)));const n=(e,t,n)=>a(this,void 0,void 0,(function*(){this.recordUserInteractionTime();const i=_.convertUriToPath(this.fs,e.textDocument.uri),s={line:e.position.line,character:e.position.character},r=yield this.getWorkspaceForFile(i);if(r.disableLanguageServices)return;const a=r.serviceInstance.getDefinitionForPosition(i,s,n,t);return a?a.map((e=>l.Location.create(_.convertPathToUri(this.fs,e.path),e.range))):void 0}));this._connection.onDefinition(((e,t)=>n(e,t,this.client.hasGoToDeclarationCapability?C.DefinitionFilter.PreferSource:C.DefinitionFilter.All))),this._connection.onDeclaration(((e,t)=>n(e,t,this.client.hasGoToDeclarationCapability?C.DefinitionFilter.PreferStubs:C.DefinitionFilter.All))),this._connection.onReferences(((e,t,n,i)=>a(this,void 0,void 0,(function*(){this._pendingFindAllRefsCancellationSource&&(this._pendingFindAllRefsCancellationSource.cancel(),this._pendingFindAllRefsCancellationSource=void 0);const s=yield this._getProgressReporter(e.workDoneToken,n,x.Localizer.CodeAction.findingReferences()),r=d.CancelAfter(t,s.token);this._pendingFindAllRefsCancellationSource=r;try{const t=_.convertUriToPath(this.fs,e.textDocument.uri),n={line:e.position.line,character:e.position.character},a=yield this.getWorkspaceForFile(t);if(a.disableLanguageServices)return;const o=e=>e.map((e=>l.Location.create(_.convertPathToUri(this.fs,e.path),e.range))),c=[],p=i?e=>i.report(o(e)):e=>c.push(...o(e));return a.serviceInstance.reportReferencesForPosition(t,n,e.context.includeDeclaration,p,r.token),c}finally{s.reporter.done(),r.dispose()}})))),this._connection.onDocumentSymbol(((e,t)=>a(this,void 0,void 0,(function*(){this.recordUserInteractionTime();const n=_.convertUriToPath(this.fs,e.textDocument.uri),i=yield this.getWorkspaceForFile(n);if(i.disableLanguageServices)return;const s=[];return i.serviceInstance.addSymbolsForDocument(n,s,t),this.client.hasHierarchicalDocumentSymbolCapability?s:I.convertToFlatSymbols(e.textDocument.uri,s)})))),this._connection.onWorkspaceSymbol(((e,t,n,i)=>a(this,void 0,void 0,(function*(){const n=[],s=i?e=>i.report(e):e=>n.push(...e);for(const n of this._workspaceMap.values())yield n.isInitialized.promise,n.disableLanguageServices||n.serviceInstance.reportSymbolsForWorkspace(e.query,s,t);return n})))),this._connection.onHover(((e,t)=>a(this,void 0,void 0,(function*(){const n=_.convertUriToPath(this.fs,e.textDocument.uri),i={line:e.position.line,character:e.position.character},s=(yield this.getWorkspaceForFile(n)).serviceInstance.getHoverForPosition(n,i,this.client.hoverContentFormat,t);return D.convertHoverResults(this.client.hoverContentFormat,s)})))),this._connection.onDocumentHighlight(((e,t)=>a(this,void 0,void 0,(function*(){const n=_.convertUriToPath(this.fs,e.textDocument.uri),i={line:e.position.line,character:e.position.character};return(yield this.getWorkspaceForFile(n)).serviceInstance.getDocumentHighlight(n,i,t)})))),this._connection.onSignatureHelp(((e,t)=>a(this,void 0,void 0,(function*(){var n,i,s,r;const a=_.convertUriToPath(this.fs,e.textDocument.uri),o={line:e.position.line,character:e.position.character},c=yield this.getWorkspaceForFile(a);if(c.disableLanguageServices)return;const p=c.serviceInstance.getSignatureHelpForPosition(a,o,this.client.signatureDocFormat,t);if(!p)return;const u=p.signatures.map((e=>{let t=[];e.parameters&&(t=e.parameters.map((e=>l.ParameterInformation.create(this.client.hasSignatureLabelOffsetCapability?[e.startOffset,e.endOffset]:e.text,e.documentation))));const n=l.SignatureInformation.create(e.label,void 0,...t);return n.documentation=e.documentation,n.activeParameter=e.activeParameter,n})),d=e=>{var t;return void 0!==e.activeParameter||!p.callHasParameters&&!(null===(t=e.parameters)||void 0===t?void 0:t.length)};let h=u.findIndex(d);-1===h&&(h=null);let m=null!==h?u[h].activeParameter:null;if((null===(n=e.context)||void 0===n?void 0:n.isRetrigger)&&e.context.triggerKind!==l.SignatureHelpTriggerKind.Invoked){const t=null!==(s=null===(i=e.context.activeSignatureHelp)||void 0===i?void 0:i.activeSignature)&&void 0!==s?s:null;if(null!==t&&t<u.length){const e=u[t];d(e)&&(h=t,m=null!==(r=e.activeParameter)&&void 0!==r?r:null)}}return(this.client.hasActiveParameterCapability||null===h)&&(m=-1),{signatures:u,activeSignature:h,activeParameter:m}})))),this._connection.onCompletion(((e,t)=>this.onCompletion(e,t))),this._connection.onCompletionResolve(((e,t)=>a(this,void 0,void 0,(function*(){const n=e.data;if(n&&n.filePath){const i=yield this.getWorkspaceForFile(n.workspacePath);this.resolveWorkspaceCompletionItem(i,n.filePath,e,t)}return e})))),this._connection.onRenameRequest(((e,t)=>a(this,void 0,void 0,(function*(){const n=_.convertUriToPath(this.fs,e.textDocument.uri),i={line:e.position.line,character:e.position.character},s=yield this.getWorkspaceForFile(n);if(s.disableLanguageServices)return;const r=s.serviceInstance.renameSymbolAtPosition(n,i,e.newName,t);return r?b.convertWorkspaceEdits(this.fs,r):void 0})))),this._connection.languages.callHierarchy.onPrepare(((e,t)=>a(this,void 0,void 0,(function*(){const n=_.convertUriToPath(this.fs,e.textDocument.uri),i={line:e.position.line,character:e.position.character},s=yield this.getWorkspaceForFile(n);if(s.disableLanguageServices)return null;const r=s.serviceInstance.getCallForPosition(n,i,t)||null;return r?(r.uri=_.convertPathToUri(this.fs,r.uri),[r]):null})))),this._connection.languages.callHierarchy.onIncomingCalls(((e,t)=>a(this,void 0,void 0,(function*(){const n=_.convertUriToPath(this.fs,e.item.uri),i={line:e.item.range.start.line,character:e.item.range.start.character},s=yield this.getWorkspaceForFile(n);if(s.disableLanguageServices)return null;const r=s.serviceInstance.getIncomingCallsForPosition(n,i,t)||null;return r&&0!==r.length?(r.forEach((e=>{e.from.uri=_.convertPathToUri(this.fs,e.from.uri)})),r):null})))),this._connection.languages.callHierarchy.onOutgoingCalls(((e,t)=>a(this,void 0,void 0,(function*(){const n=_.convertUriToPath(this.fs,e.item.uri),i={line:e.item.range.start.line,character:e.item.range.start.character},s=yield this.getWorkspaceForFile(n);if(s.disableLanguageServices)return null;const r=s.serviceInstance.getOutgoingCallsForPosition(n,i,t)||null;return r&&0!==r.length?(r.forEach((e=>{e.to.uri=_.convertPathToUri(this.fs,e.to.uri)})),r):null})))),this._connection.onDidOpenTextDocument((e=>a(this,void 0,void 0,(function*(){const t=_.convertUriToPath(this.fs,e.textDocument.uri);(yield this.getWorkspaceForFile(t)).serviceInstance.setFileOpened(t,e.textDocument.version,e.textDocument.text)})))),this._connection.onDidChangeTextDocument((e=>a(this,void 0,void 0,(function*(){this.recordUserInteractionTime();const t=_.convertUriToPath(this.fs,e.textDocument.uri);(yield this.getWorkspaceForFile(t)).serviceInstance.updateOpenFileContents(t,e.textDocument.version,e.contentChanges)})))),this._connection.onDidCloseTextDocument((e=>a(this,void 0,void 0,(function*(){const t=_.convertUriToPath(this.fs,e.textDocument.uri);(yield this.getWorkspaceForFile(t)).serviceInstance.setFileClosed(t)})))),this._connection.onDidChangeWatchedFiles((e=>{e.changes.forEach((e=>{const t=_.convertUriToPath(this.fs,e.uri),n=1===e.type?"add":"change";this._fileWatchers.forEach((e=>{e.workspacePaths.some((e=>_.containsPath(e,t)))&&e.eventHandler(n,t)}))}))})),this._connection.onInitialized((()=>{this.client.hasWorkspaceFoldersCapability&&this._connection.workspace.onDidChangeWorkspaceFolders((e=>{e.removed.forEach((e=>{const t=_.convertUriToPath(this.fs,e.uri);this._workspaceMap.delete(t)})),e.added.forEach((e=>a(this,void 0,void 0,(function*(){const t=_.convertUriToPath(this.fs,e.uri),n=this.createWorkspaceServiceInstance(e,t);this._workspaceMap.set(t,n),yield this.updateSettingsForWorkspace(n)}))))})),this.client.hasWatchFileCapability&&this._connection.client.register(l.DidChangeWatchedFilesNotification.type,{watchers:[...u.configFileNames.map((e=>({globPattern:`**/${e}`,kind:l.WatchKind.Create|l.WatchKind.Change|l.WatchKind.Delete}))),{globPattern:"**",kind:l.WatchKind.Create|l.WatchKind.Change|l.WatchKind.Delete}]})})),this._connection.onExecuteCommand(((e,t,n)=>a(this,void 0,void 0,(function*(){this._pendingCommandCancellationSource&&(this._pendingCommandCancellationSource.cancel(),this._pendingCommandCancellationSource=void 0);const i=t=>a(this,void 0,void 0,(function*(){const n=yield this.executeCommand(e,t);l.WorkspaceEdit.is(n)&&this._connection.workspace.applyEdit(n)}));if(this.isLongRunningCommand(e.command)){const s=yield this._getProgressReporter(e.workDoneToken,n,x.Localizer.CodeAction.executingCommand()),r=d.CancelAfter(t,s.token);this._pendingCommandCancellationSource=r;try{yield i(r.token)}finally{s.reporter.done(),r.dispose()}}else i(t)}))))}resolveWorkspaceCompletionItem(e,t,n,i){e.serviceInstance.resolveCompletionItem(t,n,this.getCompletionOptions(),void 0,i)}getWorkspaceCompletionsForPosition(e,t,n,i,s){return e.serviceInstance.getCompletionsForPosition(t,n,i,this.getCompletionOptions(),void 0,s)}updateSettingsForAllWorkspaces(){this._workspaceMap.forEach((e=>{this.updateSettingsForWorkspace(e).ignoreErrors()}))}getCompletionOptions(){return{format:this.client.completionDocFormat,snippet:this.client.completionSupportsSnippet,lazyEdit:this.client.completionItemResolveSupportsAdditionalTextEdits}}initialize(e,t,n){var i,s,r,a,o,c,p,u,d,h,m,y,g,f,T,v,b,S,C,I,D,x,k,F,P,A,E,w,N,O,R,M,L;this.rootPath=e.rootPath||"";const U=e.capabilities;this.client.hasConfigurationCapability=!!(null===(i=U.workspace)||void 0===i?void 0:i.configuration),this.client.hasWatchFileCapability=!!(null===(r=null===(s=U.workspace)||void 0===s?void 0:s.didChangeWatchedFiles)||void 0===r?void 0:r.dynamicRegistration),this.client.hasWorkspaceFoldersCapability=!!(null===(a=U.workspace)||void 0===a?void 0:a.workspaceFolders),this.client.hasVisualStudioExtensionsCapability=!!U.supportsVisualStudioExtensions,this.client.hasActiveParameterCapability=!!(null===(p=null===(c=null===(o=U.textDocument)||void 0===o?void 0:o.signatureHelp)||void 0===c?void 0:c.signatureInformation)||void 0===p?void 0:p.activeParameterSupport),this.client.hasSignatureLabelOffsetCapability=!!(null===(m=null===(h=null===(d=null===(u=U.textDocument)||void 0===u?void 0:u.signatureHelp)||void 0===d?void 0:d.signatureInformation)||void 0===h?void 0:h.parameterInformation)||void 0===m?void 0:m.labelOffsetSupport),this.client.hasHierarchicalDocumentSymbolCapability=!!(null===(g=null===(y=U.textDocument)||void 0===y?void 0:y.documentSymbol)||void 0===g?void 0:g.hierarchicalDocumentSymbolSupport),this.client.hoverContentFormat=this._getCompatibleMarkupKind(null===(T=null===(f=U.textDocument)||void 0===f?void 0:f.hover)||void 0===T?void 0:T.contentFormat),this.client.completionDocFormat=this._getCompatibleMarkupKind(null===(S=null===(b=null===(v=U.textDocument)||void 0===v?void 0:v.completion)||void 0===b?void 0:b.completionItem)||void 0===S?void 0:S.documentationFormat),this.client.completionSupportsSnippet=!!(null===(D=null===(I=null===(C=U.textDocument)||void 0===C?void 0:C.completion)||void 0===I?void 0:I.completionItem)||void 0===D?void 0:D.snippetSupport),this.client.signatureDocFormat=this._getCompatibleMarkupKind(null===(F=null===(k=null===(x=U.textDocument)||void 0===x?void 0:x.signatureHelp)||void 0===k?void 0:k.signatureInformation)||void 0===F?void 0:F.documentationFormat);const V=(null===(E=null===(A=null===(P=U.textDocument)||void 0===P?void 0:P.publishDiagnostics)||void 0===A?void 0:A.tagSupport)||void 0===E?void 0:E.valueSet)||[];this.client.supportsUnnecessaryDiagnosticTag=V.some((e=>e===l.DiagnosticTag.Unnecessary)),this.client.hasWindowProgressCapability=!!(null===(w=U.window)||void 0===w?void 0:w.workDoneProgress),this.client.hasGoToDeclarationCapability=!!(null===(N=U.textDocument)||void 0===N?void 0:N.declaration),this.client.completionItemResolveSupportsAdditionalTextEdits=!!(null===(L=null===(M=null===(R=null===(O=U.textDocument)||void 0===O?void 0:O.completion)||void 0===R?void 0:R.completionItem)||void 0===M?void 0:M.resolveSupport)||void 0===L?void 0:L.properties.some((e=>"additionalTextEdits"===e))),e.workspaceFolders?e.workspaceFolders.forEach((e=>{const t=_.convertUriToPath(this.fs,e.uri);this._workspaceMap.set(t,this.createWorkspaceServiceInstance(e,t))})):e.rootPath&&this._workspaceMap.set(e.rootPath,this.createWorkspaceServiceInstance(void 0,e.rootPath));return{capabilities:{textDocumentSync:l.TextDocumentSyncKind.Incremental,definitionProvider:{workDoneProgress:!0},declarationProvider:{workDoneProgress:!0},referencesProvider:{workDoneProgress:!0},documentSymbolProvider:{workDoneProgress:!0},workspaceSymbolProvider:{workDoneProgress:!0},hoverProvider:{workDoneProgress:!0},documentHighlightProvider:{workDoneProgress:!0},renameProvider:{workDoneProgress:!0},completionProvider:{triggerCharacters:[".","["],resolveProvider:!0,workDoneProgress:!0},signatureHelpProvider:{triggerCharacters:["(",",",")"],workDoneProgress:!0},codeActionProvider:{codeActionKinds:n,workDoneProgress:!0},executeCommandProvider:{commands:t,workDoneProgress:!0},callHierarchyProvider:!0}}}createWorkspaceServiceInstance(e,t){var n,i,s;return{workspaceName:null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"",rootPath:t,rootUri:null!==(i=null==e?void 0:e.uri)&&void 0!==i?i:"",serviceInstance:this.createAnalyzerService(null!==(s=null==e?void 0:e.name)&&void 0!==s?s:t),disableLanguageServices:!1,disableOrganizeImports:!1,isInitialized:f.createDeferred()}}onAnalysisCompletedHandler(e){if(e.diagnostics.forEach((e=>{this._connection.sendDiagnostics({uri:_.convertPathToUri(this.fs,e.filePath),diagnostics:this._convertDiagnostics(e.diagnostics)})})),this._progressReporter.isEnabled(e))if(e.filesRequiringAnalysis>0){this._progressReporter.begin();const t=1===e.filesRequiringAnalysis?x.Localizer.CodeAction.filesToAnalyzeOne():x.Localizer.CodeAction.filesToAnalyzeCount().format({count:e.filesRequiringAnalysis});this._progressReporter.report(t)}else this._progressReporter.end();else this._progressReporter.end()}updateSettingsForWorkspace(e,t){var n;return a(this,void 0,void 0,(function*(){t=null!=t?t:yield this.getSettings(e),this.console.level=null!==(n=t.logLevel)&&void 0!==n?n:g.LogLevel.Info,this.updateOptionsAndRestartService(e,t),e.disableLanguageServices=!!t.disableLanguageServices,e.disableOrganizeImports=!!t.disableOrganizeImports,e.isInitialized.resolve(!0)}))}updateOptionsAndRestartService(e,t,n){S.AnalyzerServiceExecutor.runWithOptions(this.rootPath,e,t,n)}onCompletion(e,t){var n,i;return a(this,void 0,void 0,(function*(){const s=this._lastTriggerKind!==l.CompletionTriggerKind.TriggerForIncompleteCompletions||(null===(n=e.context)||void 0===n?void 0:n.triggerKind)!==l.CompletionTriggerKind.TriggerForIncompleteCompletions;this._lastTriggerKind=null===(i=e.context)||void 0===i?void 0:i.triggerKind;const r=_.convertUriToPath(this.fs,e.textDocument.uri),a={line:e.position.line,character:e.position.character},o=yield this.getWorkspaceForFile(r);if(o.disableLanguageServices)return;const c=yield this.getWorkspaceCompletionsForPosition(o,r,a,o.rootPath,t);return c&&c.completionList&&(c.completionList.isIncomplete=s),null==c?void 0:c.completionList}))}convertLogLevel(e){if(!e)return g.LogLevel.Info;switch(e.toLowerCase()){case"error":return g.LogLevel.Error;case"warning":return g.LogLevel.Warn;case"information":return g.LogLevel.Info;case"trace":return g.LogLevel.Log;default:return g.LogLevel.Info}}_getCompatibleMarkupKind(e){const t=[l.MarkupKind.PlainText,l.MarkupKind.Markdown];for(const n of null!=e?e:[])if(t.includes(n))return n;return l.MarkupKind.PlainText}_getProgressReporter(e,t,n){return a(this,void 0,void 0,(function*(){if(e)return{reporter:t,token:l.CancellationToken.None};const i=yield this._connection.window.createWorkDoneProgress();return i.begin(n,void 0,void 0,!0),{reporter:i,token:i.token}}))}_GetConnectionOptions(){return{cancellationStrategy:d.getCancellationStrategyFromArgv(process.argv)}}_convertDiagnostics(e){const t=[];return e.forEach((e=>{const n=function(e){switch(e){case 0:return l.DiagnosticSeverity.Error;case 1:return l.DiagnosticSeverity.Warning;case 2:return l.DiagnosticSeverity.Information;case 3:return l.DiagnosticSeverity.Hint}}(e.category),i=e.getRule(),s=l.Diagnostic.create(e.range,e.message,n,i,this._serverOptions.productName);if(3===e.category&&(s.tags=[l.DiagnosticTag.Unnecessary],s.severity=l.DiagnosticSeverity.Hint,!this.client.supportsUnnecessaryDiagnosticTag))return;if(i){const e=this.getDocumentationUrlForDiagnosticRule(i);e&&(s.codeDescription={href:e})}const r=e.getRelatedInfo();r.length>0&&(s.relatedInformation=r.map((e=>l.DiagnosticRelatedInformation.create(l.Location.create(_.convertPathToUri(this.fs,e.filePath),e.range),e.message)))),t.push(s)})),t}recordUserInteractionTime(){this._workspaceMap.forEach((e=>{e.serviceInstance.recordUserInteractionTime()}))}getDocumentationUrlForDiagnosticRule(e){return"https://github.com/microsoft/pyright/blob/master/docs/configuration.md"}expandPathVariables(e,t){return t.replace(/\$\{(.*?)\}/g,((t,n)=>{const i=n.trim();return"workspaceFolder"===i?e:"env:HOME"===i&&void 0!==process.env.HOME?process.env.HOME:t}))}}},22060:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerServiceExecutor=void 0;const i=n(96453),s=n(96795),r=n(94647);t.AnalyzerServiceExecutor=class{static runWithOptions(e,t,n,a,o=!0){const l=function(e,t,n,a,o){var l,c;const p=new s.CommandLineOptions(t,!0);p.checkOnlyOpenFiles=n.openFilesOnly,p.useLibraryCodeForTypes=n.useLibraryCodeForTypes,p.typeCheckingMode=n.typeCheckingMode,p.autoImportCompletions=n.autoImportCompletions,p.indexing=n.indexing,p.logTypeEvaluationTime=null!==(l=n.logTypeEvaluationTime)&&void 0!==l&&l,p.typeEvaluationTimeThreshold=null!==(c=n.typeEvaluationTimeThreshold)&&void 0!==c?c:50,a?(p.watchForSourceChanges=n.watchForSourceChanges,p.watchForLibraryChanges=n.watchForLibraryChanges):(p.watchForSourceChanges=!1,p.watchForLibraryChanges=!1);n.venvPath&&(p.venvPath=r.combinePaths(t||e,n.venvPath));n.pythonPath&&(i.isPythonBinary(n.pythonPath)||(p.pythonPath=r.combinePaths(t||e,n.pythonPath)));n.typeshedPath&&(p.typeshedPath=n.typeshedPath);n.stubPath&&(p.stubPath=n.stubPath);o&&(p.typeStubTargetImportName=o);return p.autoSearchPaths=n.autoSearchPaths,p.extraPaths=n.extraPaths,p.diagnosticSeverityOverrides=n.diagnosticSeverityOverrides,p}(e,t.rootPath,n,o,a);t.serviceInstance.setOptions(l,o)}}},82615:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.AutoImporter=t.buildModuleSymbolsMap=void 0;const a=n(29335),o=n(45214),l=r(n(91197)),c=n(38213),p=n(94647),u=r(n(14551)),d=n(76962);t.buildModuleSymbolsMap=function(e,t,n){const i=new Map;return e.forEach((e=>{if(c.throwIfCancellationRequested(n),e.shadows.length>0)return;const s=e.sourceFile.getFilePath(),r=e.sourceFile.getModuleSymbolTable();if(r){const e=p.stripFileExtension(p.getFileName(s));if(l.isPrivateOrProtectedName(e))return;return void i.set(s,{forEach(e){r.forEach(((t,n)=>{if(t.isExternallyHidden())return;const i=t.getDeclarations();if(!i||0===i.length)return;const s=i[0];if(!s)return;if(6===s.type)return;const r=1!==s.type||s.isConstant||s.isFinal?void 0:a.SymbolKind.Variable;e({symbol:t,kind:r},n,!1)}))}})}const o=e.sourceFile.getCachedIndexResults();o&&t&&!o.privateOrProtected&&i.set(s,h(o,!1))})),i};function h(e,t){return{forEach(n){e.symbols.forEach((e=>{e.externallyVisible&&n({importAlias:e.alias,kind:e.kind},e.name,t)}))}}}function m(e){switch(e){case a.SymbolKind.File:return a.CompletionItemKind.File;case a.SymbolKind.Module:case a.SymbolKind.Namespace:return a.CompletionItemKind.Module;case a.SymbolKind.Package:return a.CompletionItemKind.Folder;case a.SymbolKind.Class:return a.CompletionItemKind.Class;case a.SymbolKind.Method:return a.CompletionItemKind.Method;case a.SymbolKind.Property:return a.CompletionItemKind.Property;case a.SymbolKind.Field:return a.CompletionItemKind.Field;case a.SymbolKind.Constructor:return a.CompletionItemKind.Constructor;case a.SymbolKind.Enum:return a.CompletionItemKind.Enum;case a.SymbolKind.Interface:return a.CompletionItemKind.Interface;case a.SymbolKind.Function:return a.CompletionItemKind.Function;case a.SymbolKind.Variable:case a.SymbolKind.Array:return a.CompletionItemKind.Variable;case a.SymbolKind.String:return a.CompletionItemKind.Constant;case a.SymbolKind.Number:case a.SymbolKind.Boolean:return a.CompletionItemKind.Value;case a.SymbolKind.Constant:case a.SymbolKind.Null:return a.CompletionItemKind.Constant;case a.SymbolKind.Object:case a.SymbolKind.Key:return a.CompletionItemKind.Value;case a.SymbolKind.EnumMember:return a.CompletionItemKind.EnumMember;case a.SymbolKind.Struct:return a.CompletionItemKind.Struct;case a.SymbolKind.Event:return a.CompletionItemKind.Event;case a.SymbolKind.Operator:return a.CompletionItemKind.Operator;case a.SymbolKind.TypeParameter:return a.CompletionItemKind.TypeParameter;default:return}}t.AutoImporter=class{constructor(e,t,n,i,s,r,a){var l;this._execEnvironment=e,this._importResolver=t,this._parseResults=n,this._invocationPosition=i,this._excludes=s,this._moduleSymbolMap=r,this._options=a,this._stopWatch=new d.Duration,this._perfInfo={indexUsed:!1,totalInMs:0,moduleTimeInMS:0,indexTimeInMS:0,importAliasTimeInMS:0,symbolCount:0,indexCount:0,importAliasCount:0},this._options.patternMatcher=null!==(l=this._options.patternMatcher)&&void 0!==l?l:u.isPatternInSymbol,this._importStatements=o.getTopLevelImports(this._parseResults.parseTree,!0),this._perfInfo.indexUsed=!!this._options.libraryMap}getAutoImportCandidatesForAbbr(e,t,n){const i=this._getCandidates(t.importName,1,e,n).get(t.importName);return i?i.filter((e=>e.source===t.importFrom)):[]}getAutoImportCandidates(e,t,n,i){const s=[];return this._getCandidates(e,t,n,i).forEach((e=>s.push(...e))),s}getPerfInfo(){return this._perfInfo.totalInMs=this._stopWatch.getDurationInMilliseconds(),this._perfInfo}_getCandidates(e,t,n,i){const s=new Map,r=new Map;return this._addImportsFromModuleMap(e,t,n,r,s,i),this._addImportsFromLibraryMap(e,t,n,r,s,i),this._addImportsFromImportAliasMap(r,n,s,i),s}_addImportsFromLibraryMap(e,t,n,i,s,r){var a;const o=this._stopWatch.getDurationInMilliseconds();null===(a=this._options.libraryMap)||void 0===a||a.forEach(((a,o)=>{if(a.privateOrProtected)return;if(this._moduleSymbolMap.has(o))return;const l=this._isStubFileOrHasInit(this._options.libraryMap,o);this._processModuleSymbolTable(h(a,!0),o,e,t,l,n,i,s,r)})),this._perfInfo.indexTimeInMS=this._stopWatch.getDurationInMilliseconds()-o}_addImportsFromModuleMap(e,t,n,i,s,r){const a=this._stopWatch.getDurationInMilliseconds();this._moduleSymbolMap.forEach(((a,o)=>{const l=this._isStubFileOrHasInit(this._moduleSymbolMap,o);this._processModuleSymbolTable(a,o,e,t,l,n,i,s,r)})),this._perfInfo.moduleTimeInMS=this._stopWatch.getDurationInMilliseconds()-a}_isStubFileOrHasInit(e,t){const n=p.getDirectoryPath(t),i=p.combinePaths(n,"__init__.py"),s=i+"i";return{isStub:t.endsWith(".pyi"),hasInit:e.has(i)||e.has(s)}}_processModuleSymbolTable(e,t,n,i,s,r,o,l,p){c.throwIfCancellationRequested(p);const[d,h,y]=this._getImportPartsForSymbols(t);if(!d)return;const g=u.getCharacterCount(d,".");if(e.forEach(((e,a,u)=>{if(c.throwIfCancellationRequested(p),this._perfIndexCount(e,u),!this._shouldIncludeVariable(e,a,s.isStub,u))return;if(!this._isSimilar(n,a,i))return;if(this._containsName(a,d,l))return;if(e.importAlias)return void this._addToImportAliasMap(e.importAlias,{importParts:{symbolName:a,importName:a,importFrom:d,filePath:t,dotCount:g,moduleNameAndType:y},importGroup:h,symbol:e.symbol,kind:e.importAlias.kind},o);const f=this._getTextEditsForAutoImportByFilePath(d,a,r,a,h,t);this._addResult(l,{name:a,alias:r,symbol:e.symbol,source:d,kind:m(e.kind),insertionText:f.insertionText,edits:f.edits})})),!s.isStub&&!s.hasInit)return;const f=this._getImportParts(t);if(!f)return;if(!this._isSimilar(n,f.importName,i))return;this._containsName(f.importName,f.importFrom,l)||this._addToImportAliasMap({modulePath:t,originalName:f.importName,kind:a.SymbolKind.Module},{importParts:f,importGroup:h},o)}_shouldIncludeVariable(e,t,n,i){var s;return!(!n&&e.kind===a.SymbolKind.Variable)||(!(!this._options.allowVariableInAll||i||!(null===(s=e.symbol)||void 0===s?void 0:s.isInDunderAll()))||l.isPublicConstantOrTypeAlias(t))}_addImportsFromImportAliasMap(e,t,n,i){c.throwIfCancellationRequested(i);const s=this._stopWatch.getDurationInMilliseconds();e.forEach((e=>{this._perfInfo.importAliasCount+=e.size,e.forEach((e=>{var s;if(c.throwIfCancellationRequested(i),t){if(this._importStatements.mapByFilePath.has(e.importParts.filePath))return;if(e.importParts.importFrom){const t=this._importStatements.orderedImports.find((t=>t.moduleName===e.importParts.importFrom));if(t&&22===t.node.nodeType&&t.node.imports.some((t=>t.name.value===e.importParts.symbolName)))return}}if(this._containsName(e.importParts.importName,e.importParts.importFrom,n))return;const r=this._getTextEditsForAutoImportByFilePath(null!==(s=e.importParts.importFrom)&&void 0!==s?s:e.importParts.importName,e.importParts.symbolName,t,e.importParts.importName,e.importGroup,e.importParts.filePath);this._addResult(n,{name:e.importParts.importName,alias:t,symbol:e.symbol,kind:m(e.kind),source:e.importParts.importFrom,insertionText:r.insertionText,edits:r.edits})}))})),this._perfInfo.importAliasTimeInMS=this._stopWatch.getDurationInMilliseconds()-s}_addToImportAliasMap(e,t,n){if(!n.has(e.modulePath)){const i=new Map;return i.set(e.originalName,t),void n.set(e.modulePath,i)}const i=n.get(e.modulePath);if(!i.has(e.originalName))return void i.set(e.originalName,t);const s=i.get(e.originalName);this._compareImportAliasData(s,t)<=0||i.set(e.originalName,t)}_compareImportAliasData(e,t){const n=e.importGroup-t.importGroup;if(0!==n)return n;const i=e.importParts.dotCount-t.importParts.dotCount;return 0!==i?i:e.symbol&&!t.symbol?-1:!e.symbol&&t.symbol?1:u.getStringComparer()(e.importParts.importName,t.importParts.importName)}_getImportPartsForSymbols(e){const t=this._importStatements.mapByFilePath.get(e);if(t)return[t.moduleName,o.getImportGroup(t),{importType:2,isLocalTypingsFile:!1,moduleName:t.moduleName}];{const t=this._getModuleNameAndTypeFromFilePath(e);return[t.moduleName,this._getImportGroupFromModuleNameAndType(t),t]}}_getImportParts(e){return t("__init__"===p.stripFileExtension(p.getFileName(e))?this._getModuleNameAndTypeFromFilePath(p.getDirectoryPath(e)):this._getModuleNameAndTypeFromFilePath(e));function t(t){const n=t.moduleName;if(!n)return;const i=n.lastIndexOf("."),s=i>0?n.substring(i+1):void 0,r=i>0?n.substring(0,i):void 0;return{symbolName:s,importName:null!=s?s:n,importFrom:r,filePath:e,dotCount:u.getCharacterCount(n,"."),moduleNameAndType:t}}}_isSimilar(e,t,n){return 1===n?e===t:e.length>0&&this._options.patternMatcher(e,t)}_containsName(e,t,n){if(this._excludes.has(e))return!0;const i=n.get(e);return!!(null==i?void 0:i.some((e=>e.source===t)))}_getModuleNameAndTypeFromFilePath(e){return this._importResolver.getModuleNameForImport(e,this._execEnvironment)}_getImportGroupFromModuleNameAndType(e){let t=2;return e.isLocalTypingsFile||1===e.importType?t=1:0===e.importType&&(t=0),t}_getTextEditsForAutoImportByFilePath(e,t,n,i,s,r){var a,l,c,p,u,d;const h=this._importStatements.mapByFilePath.get(r);if(h){if(20===h.node.nodeType){const e=null===(l=null===(a=h.subnode)||void 0===a?void 0:a.alias)||void 0===l?void 0:l.value;if(t)return{insertionText:`${null!=e?e:h.moduleName}.${t}`,edits:[]};if(e)return{insertionText:`${e}`,edits:[]}}if(t&&22===h.node.nodeType){const s=h.node.imports.find((e=>e.name.value===t));if(s){const e=null===(c=s.alias)||void 0===c?void 0:c.value;return{insertionText:`${null!=e?e:t}`,edits:[]}}if(e===h.moduleName)return{insertionText:null!=n?n:i,edits:this._options.lazyEdit?void 0:o.getTextEditsForAutoImportSymbolAddition(t,h,this._parseResults,n)}}}else if(t){const s=this._importStatements.orderedImports.find((t=>t.moduleName===e));if(s&&22===s.node.nodeType){const e=s.node.imports.find((e=>e.name.value===t));if(!e)return{insertionText:null!=n?n:i,edits:this._options.lazyEdit?void 0:o.getTextEditsForAutoImportSymbolAddition(t,s,this._parseResults,n)};{const t=null===(p=e.alias)||void 0===p?void 0:p.value;if(t)return{insertionText:`${t}`,edits:[]}}}const a=null===(u=this._importStatements.implicitImports)||void 0===u?void 0:u.get(r);if(a){const e=null===(d=a.alias)||void 0===d?void 0:d.value;return{insertionText:`${null!=e?e:a.name.value}.${t}`,edits:[]}}}return{insertionText:null!=n?n:i,edits:this._options.lazyEdit?void 0:o.getTextEditsForAutoImportInsertion(t,this._importStatements,e,s,this._parseResults,this._invocationPosition,n)}}_perfIndexCount(e,t){e.symbol?this._perfInfo.symbolCount++:t&&this._perfInfo.indexCount++}_addResult(e,t){let n=e.get(t.name);n||(n=[],e.set(t.name,n)),n.push(t)}}},30424:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyProvider=void 0;const a=n(29335),o=r(n(88023)),l=r(n(23241)),c=n(22339),p=n(59195),u=n(10425),d=n(38213),h=n(94647),m=n(28348),y=n(80957);t.CallHierarchyProvider=class{static getCallForDeclaration(e,t,n,i){if(d.throwIfCancellationRequested(i),3===t.type||4===t.type){return{name:e,kind:T(t,n),uri:t.path,range:t.range,selectionRange:t.range}}}static getIncomingCallsForDeclaration(e,t,n,i,s,r){d.throwIfCancellationRequested(r);const a=new f(e,t,n,i,s,r).findCalls();return a.length>0?a:void 0}static getOutgoingCallsForDeclaration(e,t,n,i){let s;if(d.throwIfCancellationRequested(i),3===e.type)s=e.node;else if(4===e.type){const t=n.getTypeForDeclaration(e);if(t&&p.isClass(t)){const e=u.lookUpClassMember(t,"__init__",14);if(e){const t=n.getTypeOfMember(e);if(t&&p.isFunction(t)){const t=e.symbol.getDeclarations();if(t&&t.length>0){const e=t[0];3===e.type&&(s=e.node)}}}}}if(!s)return;const r=new g(s,t,n,i).findCalls();return r.length>0?r:void 0}static getTargetDeclaration(e,t){let n=e[0];for(const i of e)if((o.hasTypeForDeclaration(i)||!o.hasTypeForDeclaration(n))&&(3===i.type||4===i.type)&&(n=i,i.node===t))break;return n}};class g extends c.ParseTreeWalker{constructor(e,t,n,i){super(),this._parseRoot=e,this._parseResults=t,this._evaluator=n,this._cancellationToken=i,this._outgoingCalls=[]}findCalls(){return this.walk(this._parseRoot),this._outgoingCalls}visitCall(e){let t;if(d.throwIfCancellationRequested(this._cancellationToken),38===e.leftExpression.nodeType?t=e.leftExpression:35===e.leftExpression.nodeType&&(t=e.leftExpression.memberName),t){const e=this._evaluator.getDeclarationsForNameNode(t);e&&e.forEach((e=>{this._addOutgoingCallForDeclaration(t,e)}))}return!0}visitMemberAccess(e){d.throwIfCancellationRequested(this._cancellationToken);const t=this._evaluator.getType(e.leftExpression);return t&&u.doForEachSubtype(t,(t=>{let n=t;if(n=this._evaluator.makeTopLevelTypeVarsConcrete(n),!p.isObject(n))return;const i=u.lookUpObjectMember(n,e.memberName.value);if(!i)return;const s=this._evaluator.getTypeOfMember(i),r=i.symbol.getDeclarations();s&&p.isObject(s)&&p.ClassType.isPropertyClass(s.classType)&&r.forEach((t=>{this._addOutgoingCallForDeclaration(e.memberName,t)}))})),!0}_addOutgoingCallForDeclaration(e,t){const n=this._evaluator.resolveAliasDeclaration(t,!0);if(!n)return;if(3!==n.type&&4!==n.type)return;const i={name:e.value,kind:T(n,this._evaluator),uri:n.path,range:n.range,selectionRange:n.range};let s=this._outgoingCalls.find((e=>e.to.uri===i.uri&&y.rangesAreEqual(e.to.range,i.range)));s||(s={to:i,fromRanges:[]},this._outgoingCalls.push(s));const r=m.convertOffsetsToRange(e.start,e.start+e.length,this._parseResults.tokenizerOutput.lines);s.fromRanges.push(r)}}class f extends c.ParseTreeWalker{constructor(e,t,n,i,s,r){super(),this._filePath=e,this._symbolName=t,this._declaration=n,this._parseResults=i,this._evaluator=s,this._cancellationToken=r,this._incomingCalls=[]}findCalls(){return this.walk(this._parseResults.parseTree),this._incomingCalls}visitCall(e){let t;if(d.throwIfCancellationRequested(this._cancellationToken),38===e.leftExpression.nodeType?t=e.leftExpression:35===e.leftExpression.nodeType&&(t=e.leftExpression.memberName),t&&t.value===this._symbolName){const e=this._evaluator.getDeclarationsForNameNode(t);if(e){e.map((e=>this._evaluator.resolveAliasDeclaration(e,!0))).filter((e=>void 0!==e)).some((e=>o.areDeclarationsSame(e,this._declaration)))&&this._addIncomingCallForDeclaration(t)}}return!0}visitMemberAccess(e){if(d.throwIfCancellationRequested(this._cancellationToken),e.memberName.value===this._symbolName){const t=this._evaluator.getType(e.leftExpression);t&&u.doForEachSubtype(t,(t=>{let n=t;if(n=this._evaluator.makeTopLevelTypeVarsConcrete(n),!p.isObject(n))return;const i=u.lookUpObjectMember(n,e.memberName.value);if(!i)return;const s=this._evaluator.getTypeOfMember(i),r=i.symbol.getDeclarations();s&&r.some((e=>o.areDeclarationsSame(e,this._declaration)))&&this._addIncomingCallForDeclaration(e.memberName)}))}return!0}_addIncomingCallForDeclaration(e){const t=l.getExecutionScopeNode(e);if(!t)return;let n;if(36===t.nodeType){const e=m.convertOffsetsToRange(0,0,this._parseResults.tokenizerOutput.lines),t=h.getFileName(this._filePath);n={name:`(module) ${t}`,kind:a.SymbolKind.Module,uri:this._filePath,range:e,selectionRange:e}}else if(30===t.nodeType){const e=m.convertOffsetsToRange(t.start,t.start+t.length,this._parseResults.tokenizerOutput.lines);n={name:"(lambda)",kind:a.SymbolKind.Function,uri:this._filePath,range:e,selectionRange:e}}else{const e=m.convertOffsetsToRange(t.name.start,t.name.start+t.name.length,this._parseResults.tokenizerOutput.lines);n={name:t.name.value,kind:a.SymbolKind.Function,uri:this._filePath,range:e,selectionRange:e}}let i=this._incomingCalls.find((e=>e.from.uri===n.uri&&y.rangesAreEqual(e.from.range,n.range)));i||(i={from:n,fromRanges:[]},this._incomingCalls.push(i));const s=m.convertOffsetsToRange(e.start,e.start+e.length,this._parseResults.tokenizerOutput.lines);i.fromRanges.push(s)}}function T(e,t){let n;switch(e.type){case 4:case 5:n=a.SymbolKind.Class;break;case 3:if(e.isMethod){const i=t.getTypeForDeclaration(e);n=i&&u.isProperty(i)?a.SymbolKind.Property:a.SymbolKind.Method}else n=a.SymbolKind.Function;break;default:n=a.SymbolKind.Function}return n}},70926:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeActionProvider=void 0;const s=n(29335),r=n(38213),a=n(74426);t.CodeActionProvider=class{static getCodeActionsForPosition(e,t,n,o){return i(this,void 0,void 0,(function*(){r.throwIfCancellationRequested(o);const i=[];if(!e.disableLanguageServices){const r=yield e.serviceInstance.getDiagnosticsForRange(t,n,o),l=r.find((e=>{const t=e.getActions();return t&&t.find((e=>"pyright.createtypestub"===e.action))}));if(l){const n=l.getActions().find((e=>"pyright.createtypestub"===e.action));if(n){const r=s.CodeAction.create(a.Localizer.CodeAction.createTypeStubFor().format({moduleName:n.moduleName}),s.Command.create(a.Localizer.CodeAction.createTypeStub(),"pyright.createtypestub",e.rootPath,n.moduleName,t),s.CodeActionKind.QuickFix);i.push(r)}}const c=r.find((e=>{const t=e.getActions();return t&&t.find((e=>"pyright.addoptionalforparam"===e.action))}));if(c){const e=c.getActions().find((e=>"pyright.addoptionalforparam"===e.action));if(e){const t=s.CodeAction.create(a.Localizer.CodeAction.addOptionalToAnnotation(),s.Command.create(a.Localizer.CodeAction.addOptionalToAnnotation(),"pyright.addoptionalforparam",e.offsetOfTypeNode),s.CodeActionKind.QuickFix);i.push(t)}}}return i}))}}},80088:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CompletionProvider=t.autoImportDetail=void 0;const a=n(29335),o=r(n(35696)),l=n(16800),c=n(21736),p=r(n(23241)),u=n(23241),d=n(93989),h=r(n(91197)),m=n(15020),y=n(58333),g=n(59195),f=n(10425),T=n(38213),_=r(n(20823)),v=n(20823),b=n(28348),S=r(n(14551)),C=n(80957),I=n(80957),D=n(76962),x=n(55390),k=n(82615),F=n(31807),P=["True","False","None","and","or","await","not","is","lambda","yield","assert","async","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","nonlocal","pass","raise","return","try","while","yield"];var A;!function(e){e[e.LikelyKeyword=0]="LikelyKeyword",e[e.RecentImportModuleName=1]="RecentImportModuleName",e[e.ImportModuleName=2]="ImportModuleName",e[e.LiteralValue=3]="LiteralValue",e[e.NamedParameter=4]="NamedParameter",e[e.RecentKeywordOrSymbol=5]="RecentKeywordOrSymbol",e[e.RecentAutoImport=6]="RecentAutoImport",e[e.Keyword=7]="Keyword",e[e.NormalSymbol=8]="NormalSymbol",e[e.PrivateSymbol=9]="PrivateSymbol",e[e.DunderSymbol=10]="DunderSymbol",e[e.AutoImport=11]="AutoImport"}(A||(A={})),t.autoImportDetail="Auto-import";class E{constructor(e,t,n,i,s,r,a,o,l,c,p,u,d){this._workspacePath=e,this._parseResults=t,this._fileContents=n,this._importResolver=i,this._position=s,this._filePath=r,this._configOptions=a,this._importLookup=o,this._evaluator=l,this._options=c,this._sourceMapper=p,this._autoImportMaps=u,this._cancellationToken=d}getCompletionsForPosition(){const e=b.convertPositionToOffset(this._position,this._parseResults.tokenizerOutput.lines);if(void 0===e)return;let t=p.findNodeByOffset(this._parseResults.parseTree,e);const n=t,i=t?p.getNodeDepth(t):0;if(!n||38!==n.nodeType){let s=e;for(;s>=0;){s--;const e=this._fileContents.substr(s,1);if("("===e||"\n"===e)break;const r=p.findNodeByOffset(this._parseResults.parseTree,s);if(r&&r!==n){p.getNodeDepth(r)>i&&(t=r);break}}}if(void 0===t)return;const s=this._parseResults.tokenizerOutput.lines.getItemAt(this._position.line),r=this._fileContents.substr(s.start,s.length),a=r.substr(0,this._position.character),o=r.substr(this._position.character),l=a.search(/\w+$/),c=l>=0?a.substr(l):"";if(this._isWithinComment(e))return;let u=t;for(;u&&0!==u.nodeType;)u=u.parent;let d=u||t;for(;;){if(T.throwIfCancellationRequested(this._cancellationToken),49===d.nodeType)return this._getStringLiteralCompletions(d,c,a,o);if(48===d.nodeType)return;if(37===d.nodeType)return this._getImportModuleCompletions(d);if(0===d.nodeType)return this._getExpressionErrorCompletions(d,c,a,o);if(35===d.nodeType)return this._getMemberAccessCompletions(d.leftExpression,c);if(38===d.nodeType){const t=this._tryGetNameCompletions(d,e,c);if(t||void 0===t)return t}if(22===d.nodeType)return this._getImportFromCompletions(d,c);if(x.isExpressionNode(d))return this._getExpressionCompletions(d,c,a,o);if(50===d.nodeType){if(d.parent&&25===d.parent.nodeType&&!d.parent.name&&d.parent.typeExpression&&I.TextRange.getEnd(d.parent.typeExpression)<e&&e<=d.parent.exceptSuite.start)return;if(d.parent&&10===d.parent.nodeType&&(!d.parent.name||!d.parent.name.value)&&0===d.parent.arguments.length&&e<=d.parent.suite.start)return;return this._getStatementCompletions(d,c,a,o)}if(36===d.nodeType)return this._getStatementCompletions(d,c,a,o);if(41===d.nodeType&&0===d.length&&d.parent&&30===d.parent.nodeType)return;if(!d.parent)break;d=d.parent}}resolveCompletionItem(e){T.throwIfCancellationRequested(this._cancellationToken);const t=e.data,n=e.label;let i="";t.autoImportText&&(i=t.autoImportText);const s=E._mostRecentCompletions.findIndex((e=>e.label===n&&e.autoImportText===i));if(s>0&&(E._mostRecentCompletions=E._mostRecentCompletions.splice(s,1)),0!==s&&E._mostRecentCompletions.unshift({label:n,autoImportText:i}),E._mostRecentCompletions.length>128&&E._mostRecentCompletions.pop(),t.symbolLabel)if(this._itemToResolve=e,t.autoImportText){if(!e.additionalTextEdits){const e={completionList:a.CompletionList.create()};this._getAutoImportCompletions(t.symbolLabel,1,!1,e)}}else this.getCompletionsForPosition()}_tryGetNameCompletions(e,t,n){var i;if(!e.parent)return!1;if(21!==e.parent.nodeType||e.parent.alias!==e){if(37===e.parent.nodeType){if(e.parent.parent&&21===e.parent.parent.nodeType&&!e.parent.parent.alias&&I.TextRange.getEnd(e.parent.parent)<t)return;return this._getImportModuleCompletions(e.parent)}if(23===e.parent.nodeType){if(e.parent.alias===e)return;const i=e.parent.parent;if(i&&22===i.nodeType){if(!e.parent.alias&&I.TextRange.getEnd(e.parent)<t)return;return e.parent.name===e?this._getImportFromCompletions(i,n):this._getImportFromCompletions(i,"")}return!1}if(35===e.parent.nodeType&&e===e.parent.memberName)return this._getMemberAccessCompletions(e.parent.leftExpression,n);if(25!==e.parent.nodeType||e!==e.parent.name){if(28===e.parent.nodeType&&e===e.parent.name)return(null===(i=e.parent.decorators)||void 0===i?void 0:i.some((e=>this._isOverload(e))))?this._getMethodOverloadsCompletions(n,e):void 0;if(!(41===e.parent.nodeType&&e===e.parent.name||10===e.parent.nodeType&&e===e.parent.name||26===e.parent.nodeType&&I.TextRange.contains(e.parent.targetExpression,e.start)||33===e.parent.nodeType&&I.TextRange.contains(e.parent.targetExpression,e.start)))return!1}}}_isWithinComment(e){var t,n;const i=function(e,t){const n=t.getItemAtPosition(e);if(n<0)return;let i=t.getItemAt(n);if(e>i.start&&e<i.start+i.length)return;for(let e=n-1;e>=0;e--){const n=t.getItemAt(e);if(i.start!==n.start)break;i=n}if(e<=i.start)return i;return _.assert(n+1<t.length),t.getItemAt(n+1)}(e,this._parseResults.tokenizerOutput.tokens);return!!i&&(null!==(n=null===(t=i.comments)||void 0===t?void 0:t.some((t=>I.TextRange.overlaps(t,e))))&&void 0!==n&&n)}_getExpressionErrorCompletions(e,t,n,i){var s;switch(e.category){case 0:return this._createSingleKeywordCompletionList("in");case 1:return this._createSingleKeywordCompletionList("else");case 2:case 4:return this._getExpressionCompletions(e,t,n,i);case 3:{let s=this._getStringLiteralCompletions(e,t,n,i);return s&&s.completionList||(s=this._getExpressionCompletions(e,t,n,i)),s}case 7:if(e.child&&x.isExpressionNode(e.child))return this._getMemberAccessCompletions(e.child,t);break;case 10:if(e.child&&38===e.child.nodeType)return(null===(s=e.decorators)||void 0===s?void 0:s.some((e=>this._isOverload(e))))?this._getMethodOverloadsCompletions(t,e.child):this._getMethodOverrideCompletions(t,e.child,e.decorators)}}_isOverload(e){return this._checkDecorator(e,"overload")}_checkDecorator(e,t){return 38===e.expression.nodeType&&e.expression.value===t}_createSingleKeywordCompletionList(e){const t=a.CompletionItem.create(e);t.kind=a.CompletionItemKind.Keyword,t.sortText=this._makeSortText(A.LikelyKeyword,e);return{completionList:a.CompletionList.create([t])}}_getMethodOverloadsCompletions(e,t){var n;const i=function(e,t){const n=p.getEnclosingClass(t,!1);if(n){const t=e.getTypeOfClass(n);if(!t)return;const i=new Map;for(const e of t.classType.details.mro)g.isClass(e)&&f.getMembersForClass(e,i,!1);return i}const i=p.getEnclosingModule(t);if(i){const e=o.getScope(i);return null==e?void 0:e.symbolTable}return}(this._evaluator,t);if(!i)return;const s=28===(null===(n=t.parent)||void 0===n?void 0:n.nodeType)||void 0,r=a.CompletionList.create(),l=p.getEnclosingFunction(t);return i.forEach(((n,i)=>{const a=m.getLastTypedDeclaredForSymbol(n);if(!a||3!==a.type)return;if(!a.node.decorators.some((e=>this._isOverload(e))))return;const o=n.getDeclarations();if((1!==o.length||!o.some((e=>e.node===l)))&&S.isPatternInSymbol(t.value,i)){const o=this._createReplaceEdits(e,t,a.node.name.value);this._addSymbol(i,n,t.value,r,{funcParensDisabled:s,edits:{textEdit:o}})}})),{completionList:r}}_getMethodOverrideCompletions(e,t,n){var i,s;const r=p.getEnclosingClass(t,!0);if(!r)return;const o=this._evaluator.getTypeOfClass(r);if(!o)return;const l=new Map;for(let e=1;e<o.classType.details.mro.length;e++){const t=o.classType.details.mro[e];g.isClass(t)&&f.getMembersForClass(t,l,!1)}const c=null!==(i=null==n?void 0:n.some((e=>this._checkDecorator(e,"staticmethod"))))&&void 0!==i&&i,u=null!==(s=null==n?void 0:n.some((e=>this._checkDecorator(e,"classmethod"))))&&void 0!==s&&s,y=a.CompletionList.create();return l.forEach(((n,i)=>{let s=m.getLastTypedDeclaredForSymbol(n);if(s&&3===s.type&&S.isPatternInSymbol(t.value,i)){const r=this._evaluator.getTypeForDeclaration(s);if(!r)return;let l=g.isObject(r)&&g.ClassType.isPropertyClass(r.classType);if(h.isDunderName(i)&&(l=!1),!g.isFunction(r)&&!l)return;if(l){const e=n.getTypedDeclarations();e.length>0&&3===e[0].type&&(s=e[0])}const p=g.isFunction(r)&&g.FunctionType.isStaticMethod(r),m=g.isFunction(r)&&g.FunctionType.isClassMethod(r)&&"__init_subclass__"!==i;if(c!==p||u!==m)return;const f=this._printMethodSignature(s.node);let T;if(d.isStubFile(this._filePath))T=`${f}: ...`;else{T=`${f}:\n${this._printOverriddenMethodBody(o.classType,p,l,s)}`}const _=this._createReplaceEdits(e,t,T);this._addSymbol(i,n,t.value,y,{funcParensDisabled:!0,edits:{format:this._options.snippet?a.InsertTextFormat.Snippet:void 0,textEdit:_}})}})),{completionList:y}}_createReplaceEdits(e,t,n){const i=38===(null==t?void 0:t.nodeType)?this._position.character-e.length+t.value.length:this._position.character,s={start:{line:this._position.line,character:this._position.character-e.length},end:{line:this._position.line,character:i}};return a.TextEdit.replace(s,n)}_printMethodSignature(e){const t=e.parameters.map(((t,n)=>{let i="";1===t.category?i+="*":2===t.category&&(i+="**"),t.name&&(i+=t.name.value);const s=this._evaluator.getTypeAnnotationForParameter(e,n);return s&&(i+=": "+p.printExpression(s)),i||t.name||0!==t.category?i:"/"})).join(", ");let n=e.name.value+"("+t+")";return e.returnTypeAnnotation?n+=" -> "+p.printExpression(e.returnTypeAnnotation):e.functionAnnotationComment&&(n+=" -> "+p.printExpression(e.functionAnnotationComment.returnTypeAnnotation)),n}_printOverriddenMethodBody(e,t,n,i){let s="    ";if(1===e.details.baseClasses.length&&7===e.details.baseClasses[0].category&&"builtins.object"===e.details.baseClasses[0].details.fullName)return s+=this._options.snippet?"${0:pass}":"pass",s;if(0===i.node.parameters.length)return s+=this._options.snippet?"${0:pass}":"pass",s;const r=function(){if(t)return i.node.parameters.filter((e=>e.name));return i.node.parameters.slice(1).filter((e=>e.name))}();return"__init__"!==i.node.name.value&&(s+="return "),n?s+`super().${i.node.name.value}`:s+`super().${i.node.name.value}(${r.map((function(e){var t;const n=null===(t=e.name)||void 0===t?void 0:t.value;if(1===e.category)return`*${n}`;if(2===e.category)return`**${n}`;return e.defaultValue?`${n}=${n}`:n})).join(", ")})`}_getMemberAccessCompletions(e,t){const n=new Map,i=a.CompletionList.create();let s={},r=this._evaluator.getType(e);return r&&(r=this._evaluator.makeTopLevelTypeVarsConcrete(r),f.doForEachSubtype(r,(s=>{if(s=this._evaluator.makeTopLevelTypeVarsConcrete(f.transformTypeObjectToClass(s)),g.isObject(s))f.getMembersForClass(s.classType,n,!0);else if(g.isClass(s))f.getMembersForClass(s,n,!1);else if(g.isModule(s))f.getMembersForModule(s,n);else if(g.isFunction(s)||g.isOverloadedFunction(s)){const t=this._evaluator.getBuiltInType(e,"function");t&&g.isClass(t)&&f.getMembersForClass(t,n,!0)}else if(g.isNone(s)){const t=this._evaluator.getBuiltInType(e,"object");t&&g.isClass(t)&&f.getMembersForClass(t,n,g.TypeBase.isInstance(s))}const r=g.isObject(s)?s:void 0;this._addSymbolsForSymbolTable(n,(e=>!0),t,!1,r,i)}))),(!r||g.isUnknown(r)||g.isUnbound(r))&&(s=this._getLastKnownModule(e,r)),{completionList:i,memberAccessInfo:s}}_getLastKnownModule(e,t){var n;let i=e,s=t,r=35===e.nodeType?null==e?void 0:e.memberName.value:void 0;for(;i&&(9===i.nodeType||35===i.nodeType?(i=i.leftExpression,void 0===r&&(r=35===i.nodeType&&null!==(n=null==i?void 0:i.memberName.value)&&void 0!==n?n:"")):i=void 0,!i||(s=this._evaluator.getType(i),void 0===s||g.isUnknown(s)||g.isUnbound(s))););const a={};if(s&&!g.isUnknown(s)&&!g.isUnbound(s)&&i){const e=f.getDeclaringModulesForType(s);a.lastKnownModule=e.find((e=>"typing"!==e)),35===i.nodeType?a.lastKnownMemberName=i.memberName.value:38===i.nodeType&&g.isClass(s)?a.lastKnownMemberName=s.details.name:38===i.nodeType&&g.isObject(s)&&(a.lastKnownMemberName=s.classType.details.name),a.unknownMemberName=r}return a}_getStatementCompletions(e,t,n,i){return this._getExpressionCompletions(e,t,n,i)}_getExpressionCompletions(e,t,n,i){var s,r;if(40===e.nodeType)return;if(59===(null===(s=e.parent)||void 0===s?void 0:s.nodeType)&&e.parent===(null===(r=e.parent.target)||void 0===r?void 0:r.parent))return;const o=a.CompletionList.create(),l={completionList:o};if(this._addCallArgumentCompletions(e,t,n,i,o),this._addSymbols(e,t,o),this._findMatchingKeywords(P,t).map((e=>{const t=a.CompletionItem.create(e);t.kind=a.CompletionItemKind.Keyword,o.items.push(t),t.sortText=this._makeSortText(A.Keyword,e)})),!this._configOptions.autoImportCompletions||t.startsWith("_")||this._itemToResolve||this._getAutoImportCompletions(t,.25,this._options.lazyEdit,l),0===e.nodeType)if(3===e.category)this._getIndexStringLiteral(e,o);else if(2===e.category&&e.parent&&3===e.parent.nodeType){const t=this._evaluator.getDeclaredTypeForExpression(e.parent.leftExpression);t&&this._addLiteralValuesForTargetType(t,n,i,o)}return l}_addCallArgumentCompletions(e,t,n,i,s){const r=b.convertPositionToOffset(this._position,this._parseResults.tokenizerOutput.lines),a=u.getCallNodeAndActiveParameterIndex(e,r,this._parseResults.tokenizerOutput.tokens);if(!a)return;const o=this._evaluator.getCallSignatureInfo(a.callNode,a.activeIndex,a.activeOrFake);if(o){const e=b.convertOffsetToPosition(o.callNode.leftExpression.start+o.callNode.leftExpression.length,this._parseResults.tokenizerOutput.lines);C.comparePositions(this._position,e)>0&&(this._addNamedParameters(o,t,s),this._addLiteralValuesForArgument(o,n,i,s))}}_addLiteralValuesForArgument(e,t,n,i){e.signatures.forEach((e=>{if(!e.activeParam)return;const s=e.type,r=s.details.parameters.indexOf(e.activeParam);if(r<0)return;const a=s.details.parameters[r].type;this._addLiteralValuesForTargetType(a,t,n,i)}))}_addLiteralValuesForTargetType(e,t,n,i){const s=this._getQuoteValueFromPriorText(t);f.doForEachSubtype(e,(e=>{g.isObject(e)&&g.ClassType.isBuiltIn(e.classType,"str")&&void 0!==e.classType.literalValue&&this._addStringLiteralToCompletionList(e.classType.literalValue,s.stringValue,n,s.quoteCharacter,i)}))}_getStringLiteralCompletions(e,t,n,i){var s;let r=e.parent;if(!r)return;if(1!==r.nodeType){if(48!==r.nodeType||r.strings.length>1)return;if(r=r.parent,!r)return}const o=a.CompletionList.create();if(1===r.nodeType&&24===(null===(s=r.parent)||void 0===s?void 0:s.nodeType)){const e=this._evaluator.getType(r.parent.baseExpression);if(!e||!g.isObject(e))return;const t=e.classType;if(!g.ClassType.isTypedDictClass(t))return;const s=this._evaluator.getTypedDictMembersForClass(t,!0),a=this._getQuoteValueFromPriorText(n);s.forEach(((e,t)=>{this._addStringLiteralToCompletionList(t,a.stringValue,i,a.quoteCharacter,o)}))}else if(3===r.nodeType){const e=this._evaluator.getDeclaredTypeForExpression(r.leftExpression);e&&this._addLiteralValuesForTargetType(e,n,i,o)}else{_.assert(49===e.nodeType);const s=b.convertPositionToOffset(this._position,this._parseResults.tokenizerOutput.lines);(s<=r.start||I.TextRange.getEnd(e)<=s)&&this._addCallArgumentCompletions(e,t,n,i,o)}return{completionList:o}}_getQuoteValueFromPriorText(e){const t=e.lastIndexOf("'"),n=e.lastIndexOf('"');let i,s=this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter;return t>n?(s="'",i=e.substr(t+1)):n>t&&(s='"',i=e.substr(n+1)),{stringValue:i,quoteCharacter:s}}_getIndexStringLiteral(e,t){if(!e.parent||24!==e.parent.nodeType)return;const n=this._evaluator.getType(e.parent.baseExpression);if(!n||!g.isObject(n))return;const i=n.classType;if(!g.ClassType.isTypedDictClass(i))return;this._evaluator.getTypedDictMembersForClass(i,!0).forEach(((e,n)=>{this._addStringLiteralToCompletionList(n,void 0,void 0,this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter,t)}))}_addStringLiteralToCompletionList(e,t,n,i,s){if(S.isPatternInSymbol(t||"",e)){const r=`${i}${e}${i}`,o=a.CompletionItem.create(r);o.kind=a.CompletionItemKind.Constant,o.sortText=this._makeSortText(A.LiteralValue,r);let l=this._position.character;void 0!==t&&(l-=t.length+1);let c=this._position.character;void 0!==n&&n.startsWith(i)&&c++;const p={start:{line:this._position.line,character:l},end:{line:this._position.line,character:c}};o.textEdit=a.TextEdit.replace(p,r),s.items.push(o)}}_getAutoImportCompletions(e,t,n,i){var s,r,o;if(!this._autoImportMaps)return;const l=i.completionList;if(!l)return;const c=this._autoImportMaps.getModuleSymbolsMap(),p=new Set(l.items.filter((e=>{var t;return!(null===(t=e.data)||void 0===t?void 0:t.autoImport)})).map((e=>e.label))),u=new k.AutoImporter(this._configOptions.findExecEnvironment(this._filePath),this._importResolver,this._parseResults,this._position,p,c,{libraryMap:this._autoImportMaps.libraryMap,lazyEdit:n}),d=[],h=null===(s=this._autoImportMaps.nameMap)||void 0===s?void 0:s.get(e);h&&e.length>1&&!p.has(e)&&d.push(...u.getAutoImportCandidatesForAbbr(e,h,this._cancellationToken)),d.push(...u.getAutoImportCandidates(e,t,void 0,this._cancellationToken));const m=u.getPerfInfo(),y=new D.Duration;for(const t of d)t.symbol?this._addSymbol(t.name,t.symbol,e,l,{autoImportSource:t.source,autoImportAlias:t.alias,edits:{textEdit:this._createReplaceEdits(e,void 0,t.insertionText),additionalTextEdits:t.edits}}):this._addNameToCompletionList(null!==(r=t.alias)&&void 0!==r?r:t.name,null!==(o=t.kind)&&void 0!==o?o:a.CompletionItemKind.Module,e,l,{autoImportText:this._getAutoImportText(t.name,t.source,t.alias),edits:{textEdit:this._createReplaceEdits(e,void 0,t.insertionText),additionalTextEdits:t.edits}});i.autoImportInfo={indexUsed:m.indexUsed,totalTimeInMS:m.totalInMs,moduleTimeInMS:m.moduleTimeInMS,indexTimeInMS:m.indexTimeInMS,importAliasTimeInMS:m.importAliasTimeInMS,itemCount:d.length,symbolCount:m.symbolCount,indexCount:m.indexCount,importAliasCount:m.importAliasCount,additionTimeInMS:y.getDurationInMilliseconds()}}_getImportFromCompletions(e,t){if(e.isWildcardImport)return;const n=o.getImportInfo(e.module);if(!n)return;const i=a.CompletionList.create(),s=n.resolvedPaths.length>0?n.resolvedPaths[n.resolvedPaths.length-1]:"",r=this._importLookup(s);return r&&this._addSymbolsForSymbolTable(r.symbolTable,(t=>!e.imports.find((e=>e.name.value===t))),t,!0,void 0,i),n.implicitImports.forEach((n=>{e.imports.find((e=>e.name.value===n.name))||this._addNameToCompletionList(n.name,a.CompletionItemKind.Module,t,i)})),{completionList:i}}_findMatchingKeywords(e,t){return e.filter((e=>!t||S.isPatternInSymbol(t,e)))}_addNamedParameters(e,t,n){const i=new Map;e.signatures.forEach((e=>{this._addNamedParametersToMap(e.type,i)})),e.callNode.arguments.forEach((e=>{e.name&&i.delete(e.name.value)})),i.forEach((e=>{if(S.isPatternInSymbol(t,e)){const t=a.CompletionItem.create(e+"=");t.kind=a.CompletionItemKind.Variable;const i={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};t.data=i,t.sortText=this._makeSortText(A.NamedParameter,e),n.items.push(t)}}))}_addNamedParametersToMap(e,t){e.details.parameters.forEach((e=>{e.name&&!e.isNameSynthesized&&(h.isPrivateOrProtectedName(e.name)||t.set(e.name,e.name))}))}_addSymbols(e,t,n){let i=e;for(;i;){let e=o.getScope(i);if(e){for(;e;)this._addSymbolsForSymbolTable(e.symbolTable,(()=>!0),t,!1,void 0,n),e=e.parent;if(10===i.nodeType){const e=this._evaluator.getTypeOfClass(i);e&&g.isClass(e.classType)&&e.classType.details.mro.forEach(((e,i)=>{g.isClass(e)&&this._addSymbolsForSymbolTable(e.details.fields,(t=>{const n=e.details.fields.get(t);return!(!n||!n.isClassMember())&&n.getDeclarations().some((e=>1===e.type))}),t,!1,void 0,n)}))}break}i=i.parent}}_addSymbolsForSymbolTable(e,t,n,i,s,r){e.forEach(((e,a)=>{!(e.isExternallyHidden()&&!e.getDeclarations().some((e=>this._definedInCurrentFile(e))))&&t(a)&&(r.items.some((e=>e.label===a))||this._addSymbol(a,e,n,r,{boundObject:s,funcParensDisabled:i}))}))}_definedInCurrentFile(e){var t;return l.isAliasDeclaration(e)?(null===(t=function(e){for(;e&&36!==e.nodeType;)e=e.parent;return e?o.getFileInfo(e):void 0}(e.node))||void 0===t?void 0:t.filePath)===this._filePath:e.path===this._filePath}_addSymbol(e,t,n,i,s){var r;let o=m.getLastTypedDeclaredForSymbol(t);if(!o){const e=t.getDeclarations();e.length>0&&(o=e[e.length-1])}if(o){let u=a.CompletionItemKind.Variable;if(o=this._evaluator.resolveAliasDeclaration(o,!0),o&&(u=this._convertDeclarationTypeToItemKind(o),this._itemToResolve)){const n=this._itemToResolve.data;if(n.symbolLabel===e&&!n.autoImportText){const n=this._evaluator.getEffectiveTypeOfSymbol(t);if(n){let t,i;switch(o.type){case 0:case 1:case 2:{let i=!1;if(n&&g.TypeBase.isInstantiable(n)){const t=g.getTypeAliasInfo(n);t&&t.name===e&&(i=!0)}t=e+": "+this._evaluator.printType(n,i);break}case 3:{const i=s.boundObject&&(g.isFunction(n)||g.isOverloadedFunction(n))?this._evaluator.bindFunctionToClassOrObject(s.boundObject,n):n;if(i)if(f.isProperty(i)&&s.boundObject){const n=this._evaluator.getGetterTypeFromProperty(i.classType,!0)||g.UnknownType.create();t=e+": "+this._evaluator.printType(n,!1)+" (property)"}else t=g.isOverloadedFunction(i)?F.getOverloadedFunctionTooltip(i,this._evaluator,35):e+": "+this._evaluator.printType(i,!1);break}case 4:case 5:t="class "+e+"()";break;case 6:if(t=e,o.path){const e=this._importLookup(o.path);e&&(i=e.docString)}break;default:t=e}if(g.isModule(n))i=y.getModuleDocString(n,o,this._sourceMapper);else if(g.isClass(n))i=y.getClassDocString(n,o,this._sourceMapper);else if(g.isFunction(n))i=F.getFunctionDocStringFromType(n,this._sourceMapper,this._evaluator);else if(g.isOverloadedFunction(n)){const e=l.isFunctionDeclaration(o)?p.getEnclosingClass(o.node.name,!1):void 0,t=e?this._evaluator.getTypeOfClass(e):void 0;i=y.getOverloadedFunctionDocStringsInherited(n,o,this._sourceMapper,this._evaluator,null==t?void 0:t.classType).find((e=>e))}else if(3===(null==o?void 0:o.type)){const e=l.isFunctionDeclaration(o)?p.getEnclosingClass(o.node.name,!1):void 0,t=e?this._evaluator.getTypeOfClass(e):void 0;t&&(i=y.getPropertyDocStringInherited(o,this._sourceMapper,this._evaluator,null==t?void 0:t.classType))}if(this._options.format===a.MarkupKind.Markdown){let e="```python\n"+t+"\n```\n";i&&(e+="---\n",e+=c.convertDocStringToMarkdown(i)),this._itemToResolve.documentation={kind:a.MarkupKind.Markdown,value:e}}else if(this._options.format===a.MarkupKind.PlainText){let e=t+"\n";i&&(e+="\n",e+=c.convertDocStringToPlainText(i)),this._itemToResolve.documentation={kind:a.MarkupKind.PlainText,value:e}}else v.fail(`Unsupported markup type: ${this._options.format}`)}}}const d=s.autoImportSource?this._getAutoImportText(e,s.autoImportSource,s.autoImportAlias):void 0;this._addNameToCompletionList(null!==(r=s.autoImportAlias)&&void 0!==r?r:e,u,n,i,{autoImportText:d,funcParensDisabled:s.funcParensDisabled,edits:s.edits})}else{if(t.getSynthesizedType()){const t=a.CompletionItemKind.Variable;this._addNameToCompletionList(e,t,n,i,{funcParensDisabled:s.funcParensDisabled,edits:s.edits})}}}_getAutoImportText(e,t,n){let i;return i=t?`from ${t} import ${e}`:`import ${e}`,n&&(i=`${i} as ${n}`),this._options.format===a.MarkupKind.Markdown?`\`\`\`\n${i}\n\`\`\``:this._options.format===a.MarkupKind.PlainText?i:void v.fail(`Unsupported markup type: ${this._options.format}`)}_addNameToCompletionList(e,n,i,s,r){var o,l,p;if(!(!!(null==r?void 0:r.autoImportText)||S.isPatternInSymbol(i,e)))return;const u=a.CompletionItem.create(e);u.kind=n;const d={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};if((null==r?void 0:r.funcParensDisabled)&&(d.funcParensDisabled=!0),u.data=d,(null==r?void 0:r.autoImportText)?(u.sortText=this._makeSortText(A.AutoImport,e,r.autoImportText),d.autoImportText=r.autoImportText,u.detail=t.autoImportDetail):h.isDunderName(e)?u.sortText=this._makeSortText(A.DunderSymbol,e):""===i&&h.isPrivateOrProtectedName(e)?u.sortText=this._makeSortText(A.PrivateSymbol,e):u.sortText=this._makeSortText(A.NormalSymbol,e),d.symbolLabel=e,this._options.format===a.MarkupKind.Markdown){let e="";(null==r?void 0:r.autoImportText)&&(e+=r.autoImportText+"\n\n"),(null==r?void 0:r.typeDetail)&&(e+="```python\n"+r.typeDetail+"\n```\n"),(null==r?void 0:r.documentation)&&(e+="---\n",e+=c.convertDocStringToMarkdown(r.documentation)),e=e.trimEnd(),e&&(u.documentation={kind:a.MarkupKind.Markdown,value:e})}else if(this._options.format===a.MarkupKind.PlainText){let e="";(null==r?void 0:r.autoImportText)&&(e+=r.autoImportText+"\n\n"),(null==r?void 0:r.typeDetail)&&(e+=r.typeDetail+"\n"),(null==r?void 0:r.documentation)&&(e+="\n"+c.convertDocStringToPlainText(r.documentation)),e=e.trimEnd(),e&&(u.documentation={kind:a.MarkupKind.PlainText,value:e})}else v.fail(`Unsupported markup type: ${this._options.format}`);if((null===(o=null==r?void 0:r.edits)||void 0===o?void 0:o.format)&&(u.insertTextFormat=r.edits.format),(null===(l=null==r?void 0:r.edits)||void 0===l?void 0:l.textEdit)&&(u.textEdit=r.edits.textEdit),(null===(p=null==r?void 0:r.edits)||void 0===p?void 0:p.additionalTextEdits)&&(u.additionalTextEdits=r.edits.additionalTextEdits.map((e=>({range:{start:{line:e.range.start.line,character:e.range.start.character},end:{line:e.range.end.line,character:e.range.end.character}},newText:e.replacementText}))),this._itemToResolve)){this._itemToResolve.data.autoImportText===d.autoImportText&&(this._itemToResolve.additionalTextEdits=u.additionalTextEdits)}s.items.push(u)}_getRecentListIndex(e,t){return E._mostRecentCompletions.findIndex((n=>n.label===e&&n.autoImportText===t))}_makeSortText(e,t,n=""){const i=this._getRecentListIndex(t,n);return i>=0&&(e===A.AutoImport?e=A.RecentAutoImport:e===A.ImportModuleName?e=A.RecentImportModuleName:e!==A.Keyword&&e!==A.NormalSymbol&&e!==A.PrivateSymbol&&e!==A.DunderSymbol||(e=A.RecentKeywordOrSymbol)),this._formatInteger(e,2)+"."+this._formatInteger(i,4)+"."+t}_formatInteger(e,t){const n="0".charCodeAt(0);let i="";for(let s=0;s<t;s++){let t=Math.floor(e%10);t<0&&(t=9),i=String.fromCharCode(t+n)+i,e=Math.floor(e/10)}return i}_convertDeclarationTypeToItemKind(e){const t=this._evaluator.resolveAliasDeclaration(e,!0);if(!t)return a.CompletionItemKind.Variable;switch(t.type){case 0:return"class"===t.intrinsicType?a.CompletionItemKind.Class:a.CompletionItemKind.Variable;case 2:return a.CompletionItemKind.Variable;case 1:return t.isConstant||t.isFinal?a.CompletionItemKind.Constant:a.CompletionItemKind.Variable;case 3:if(this._isPossiblePropertyDeclaration(t)){const e=this._evaluator.getTypeOfFunction(t.node);if(e&&f.isProperty(e.decoratedType))return a.CompletionItemKind.Property}return t.isMethod?a.CompletionItemKind.Method:a.CompletionItemKind.Function;case 4:case 5:return a.CompletionItemKind.Class;case 6:return a.CompletionItemKind.Module}}_getImportModuleCompletions(e){const t=this._configOptions.findExecEnvironment(this._filePath),n={leadingDots:e.leadingDots,hasTrailingDot:e.hasTrailingDot,nameParts:e.nameParts.map((e=>e.value)),importedSymbols:[]},i=this._importResolver.getCompletionSuggestions(this._filePath,t,n,.25),s=a.CompletionList.create();if(!e.hasTrailingDot&&e.parent&&22===e.parent.nodeType&&e.parent.missingImportKeyword){const e="import",t=a.CompletionItem.create(e);t.kind=a.CompletionItemKind.Keyword,s.items.push(t),t.sortText=this._makeSortText(A.Keyword,e)}return i.forEach((e=>{const t=a.CompletionItem.create(e);t.kind=a.CompletionItemKind.Module,s.items.push(t),t.sortText=this._makeSortText(A.ImportModuleName,e)})),{completionList:s}}_isPossiblePropertyDeclaration(e){return e.isMethod&&e.node.decorators.length>0}}t.CompletionProvider=E,E._mostRecentCompletions=[]},27888:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DefinitionProvider=t.DefinitionFilter=void 0;const a=n(35696),o=n(16800),l=r(n(23241)),c=n(93989),p=n(59195),u=n(38213),d=n(98173),h=n(28348),m=n(80957);var y;!function(e){e.All="all",e.PreferSource="preferSource",e.PreferStubs="preferStubs"}(y=t.DefinitionFilter||(t.DefinitionFilter={}));t.DefinitionProvider=class{static getDefinitionsForPosition(e,t,n,i,s,r){u.throwIfCancellationRequested(r);const m=h.convertPositionToOffset(n,t.tokenizerOutput.lines);if(void 0===m)return;const g=l.findNodeByOffset(t.parseTree,m);if(void 0===g)return;const f=[];if(38===g.nodeType){const t=s.getDeclarationsForNameNode(g);t&&t.forEach((t=>{let n=s.resolveAliasDeclaration(t,!0);if(n&&n.path){if(6===n.type&&n.isUnresolved)return;if(6===n.type&&n.symbolName&&n.submoduleFallback&&n.submoduleFallback.path&&(n=n.submoduleFallback),this._addIfUnique(f,{path:n.path,range:n.range}),o.isFunctionDeclaration(n)){const e=s.getTypeForDeclaration(n);if(e&&p.isOverloadedFunction(e))for(const t of e.overloads.map((e=>e.details.declaration)).filter(d.isDefined))this._addIfUnique(f,{path:t.path,range:t.range})}if(c.isStubFile(n.path))if(6===n.type)e.findModules(n.path).map((e=>{var t;return null===(t=a.getFileInfo(e))||void 0===t?void 0:t.filePath})).filter(d.isDefined).forEach((e=>this._addIfUnique(f,this._createModuleEntry(e))));else{const t=e.findDeclarations(n);for(const e of t)e&&e.path&&this._addIfUnique(f,{path:e.path,range:e.range})}}}))}if(0===f.length)return;if(i===y.All)return f;const T=i===y.PreferStubs,_=e=>T===c.isStubFile(e.path);return f.find(_)?f.filter(_):f}static _createModuleEntry(e){return{path:e,range:{start:{line:0,character:0},end:{line:0,character:0}}}}static _addIfUnique(e,t){for(const n of e)if(n.path===t.path&&m.rangesAreEqual(n.range,t.range))return;e.push(t)}}},70234:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentHighlightProvider=void 0;const a=n(29335),o=n(35696),l=n(88023),c=r(n(23241)),p=n(22339),u=n(38213),d=n(28348),h=n(80957);class m extends p.ParseTreeWalker{constructor(e,t,n,i,s,r){super(),this._symbolName=e,this._declarations=t,this._parseResults=n,this._highlightResults=i,this._evaluator=s,this._cancellationToken=r}findHighlights(){this.walk(this._parseResults.parseTree)}walk(e){o.isCodeUnreachable(e)||super.walk(e)}visitModuleName(e){return!1}visitName(e){if(u.throwIfCancellationRequested(this._cancellationToken),e.value!==this._symbolName)return!1;if(this._declarations.length>0){const t=this._evaluator.getDeclarationsForNameNode(e);t&&t.length>0&&t.some((e=>this._resultsContainsDeclaration(e)))&&this._addResult(e)}else this._addResult(e);return!0}_addResult(e){this._highlightResults.push({kind:this._isWriteAccess(e)?a.DocumentHighlightKind.Write:a.DocumentHighlightKind.Read,range:{start:d.convertOffsetToPosition(e.start,this._parseResults.tokenizerOutput.lines),end:d.convertOffsetToPosition(h.TextRange.getEnd(e),this._parseResults.tokenizerOutput.lines)}})}_isWriteAccess(e){let t=e,n=t.parent;for(;n;){switch(n.nodeType){case 3:case 5:return t===n.leftExpression;case 4:return t===n.name;case 14:return!0;case 26:return t===n.targetExpression;case 21:return t===n.alias||n.module.nameParts.length>0&&t===n.module.nameParts[0];case 23:return t===n.alias||!n.alias&&t===n.name;case 35:if(t!==n.memberName)return!1;break;case 25:return t===n.name;case 58:return n.withItems.some((e=>e===t));case 33:return t===n.targetExpression;case 54:if(t===n.typeAnnotation)return!1;break;case 28:case 10:case 36:return!1}t=n,n=n.parent}return!1}_resultsContainsDeclaration(e){const t=this._evaluator.resolveAliasDeclaration(e,!1);if(!t)return!1;if(this._declarations.some((e=>l.areDeclarationsSame(e,t))))return!0;const n=this._evaluator.resolveAliasDeclaration(t,!0);return!(!n||n===t)&&this._declarations.some((e=>l.areDeclarationsSame(e,n)))}}t.DocumentHighlightProvider=class{static getDocumentHighlight(e,t,n,i){u.throwIfCancellationRequested(i);const s=d.convertPositionToOffset(t,e.tokenizerOutput.lines);if(void 0===s)return;const r=c.findNodeByOffset(e.parseTree,s);if(void 0===r)return;const a=[];if(38===r.nodeType){const t=n.getDeclarationsForNameNode(r)||[],s=[];t.forEach((e=>{const t=n.resolveAliasDeclaration(e,!0);t&&s.push(t)}));new m(r.value,s,e,a,n,i).findHighlights()}return a.length>0?a:void 0}}},54989:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentSymbolProvider=t.convertToFlatSymbols=t.getIndexAliasData=void 0;const a=n(29335),o=n(15585),l=n(82048),c=r(n(35696)),p=n(88023),u=n(15020),d=n(10425),h=n(38213),m=n(28348),y=r(n(14551));function g(e,t){var n;if(!t.symbolName)return;const i=l.resolveAliasDeclaration(e,t,!0),s=i?p.getNameFromDeclaration(i):void 0;return!s||i.path.length<=0?void 0:{originalName:s,modulePath:i.path,kind:null!==(n=T(s,i))&&void 0!==n?n:a.SymbolKind.Module}}t.getIndexAliasData=g,t.convertToFlatSymbols=function(e,t){const n=[];for(const i of t)S(n,e,i);return n};class f{static getSymbolsForDocument(e,t,n,i,s,r){var a;const o=[];if(!t&&!n)return o;return _(null!==(a=null==t?void 0:t.symbols)&&void 0!==a?a:f.indexSymbols(e,n,{indexingForAutoImportMode:!1},r),i,s,"",o,r),o}static addHierarchicalSymbolsForDocument(e,t,n,i,s){var r;if(!t&&!n)return;v(null!==(r=null==t?void 0:t.symbols)&&void 0!==r?r:f.indexSymbols(e,n,{indexingForAutoImportMode:!1},s),i,s)}static indexSymbols(e,t,n,i){const s=[];return b(e,t,t.parseTree,n,s,i),s}}function T(e,t,n){let i;switch(t.type){case 4:case 5:i=a.SymbolKind.Class;break;case 3:if(t.isMethod){const e=null==n?void 0:n.getTypeForDeclaration(t);i=e&&d.isProperty(e)?a.SymbolKind.Property:a.SymbolKind.Method}else i=a.SymbolKind.Function;break;case 6:i=a.SymbolKind.Module;break;case 2:if("self"===e||"cls"===e||"_"===e)return;i=a.SymbolKind.Variable;break;case 1:if("_"===e)return;i=t.isConstant||t.isFinal?a.SymbolKind.Constant:a.SymbolKind.Variable;break;default:i=a.SymbolKind.Variable}return i}function _(e,t,n,i,s,r){if(h.throwIfCancellationRequested(r),e)for(const l of e)if(!l.alias){if(y.isPatternInSymbol(n,l.name)){const e={uri:o.URI.file(t).toString(),range:l.selectionRange},n={name:l.name,kind:l.kind,containerName:i.length>0?i:void 0,location:e};s.push(n)}_(l.children,t,n,a(i,l.name),s,r)}function a(e,t){return e.length>0?`${e}.${t}`:t}}function v(e,t,n){if(h.throwIfCancellationRequested(n),e)for(const i of e){if(i.alias)continue;const e=[];v(i.children,e,n);const s={name:i.name,kind:i.kind,range:i.range,selectionRange:i.selectionRange,children:e};t.push(s)}}function b(e,t,n,i,s,r){h.throwIfCancellationRequested(r);const a=c.getScope(n);if(!a)return;a.symbolTable.forEach(((n,a)=>{if(n.isIgnoredForProtocolMatch())return;if(i.indexingForAutoImportMode&&!e.isStubFile&&!e.isInPyTypedPackage&&!n.isInDunderAll())return;let o=u.getLastTypedDeclaredForSymbol(n);if(!o&&n.hasDeclarations()&&(o=n.getDeclarations()[0]),o){if(6===o.type){if(!i.indexingForAutoImportMode)return;if(o.path.length<=0)return}!function(e,t,n,i,s,r,a,o){if(i.indexingForAutoImportMode&&!s)return;const l=T(r,n);if(void 0===l)return;const p=n.range;let u=p;const d=[];4!==n.type&&3!==n.type||(i.indexingForAutoImportMode||b(e,t,n.node,i,d,o),u=m.convertOffsetsToRange(n.node.start,n.node.start+n.node.length,t.tokenizerOutput.lines));const h={name:r,externallyVisible:s,kind:l,alias:6===n.type?g(c.getFileInfo(t.parseTree).importLookup,n):void 0,range:i.indexingForAutoImportMode?void 0:u,selectionRange:i.indexingForAutoImportMode?void 0:p,children:i.indexingForAutoImportMode?void 0:d};a.push(h)}(e,t,o,i,!n.isExternallyHidden(),a,s,r)}}))}function S(e,t,n,i){const s={name:n.name,kind:n.kind,location:a.Location.create(t,n.range),tags:n.tags,containerName:null==i?void 0:i.name};if(e.push(s),n.children)for(const i of n.children)S(e,t,i,n)}t.DocumentSymbolProvider=f},8871:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.convertHoverResults=t.HoverProvider=void 0;const a=n(29335),o=n(21736),l=r(n(23241)),c=n(58333),p=n(59195),u=n(10425),d=n(38213),h=n(20823),m=n(28348),y=n(80957),g=n(31807);t.HoverProvider=class{static getHoverForPosition(e,t,n,i,s,r){d.throwIfCancellationRequested(r);const a=m.convertPositionToOffset(n,t.tokenizerOutput.lines);if(void 0===a)return;const o=l.findNodeByOffset(t.parseTree,a);if(void 0===o)return;const c={parts:[],range:{start:m.convertOffsetToPosition(o.start,t.tokenizerOutput.lines),end:m.convertOffsetToPosition(y.TextRange.getEnd(o),t.tokenizerOutput.lines)}};if(38===o.nodeType){const t=s.getDeclarationsForNameNode(o);if(t&&t.length>0){let n=t[0];6===n.type&&t.length>1&&(n=t[1]),this._addResultsForDeclaration(i,e,c.parts,n,o,s)}else if((!o.parent||37!==o.parent.nodeType)&&0===c.parts.length){const t=s.getType(o)||p.UnknownType.create();let n="";n=p.isModule(t)?"(module) "+o.value:o.value+": "+s.printType(t,!1),this._addResultsPart(c.parts,n,!0),this._addDocumentationPart(i,e,c.parts,o,s,void 0)}}return c.parts.length>0?c:void 0}static _addResultsForDeclaration(e,t,n,i,s,r){var a;const o=r.resolveAliasDeclaration(i,!0);if(o)switch(o.type){case 0:this._addResultsPart(n,s.value+this._getTypeText(s,r),!0),this._addDocumentationPart(e,t,n,s,r,o);break;case 1:{let l=o.isConstant||o.isFinal?"constant":"variable",c=s;21===i.node.nodeType||23===i.node.nodeType?i.node.alias&&s!==i.node.alias&&38===o.node.nodeType&&(c=o.node):1===(null===(a=s.parent)||void 0===a?void 0:a.nodeType)&&s.parent.name===s&&38===i.node.nodeType&&(c=i.node);const u=r.getType(c);let d=!1;if(u&&p.TypeBase.isInstantiable(u)){const e=p.getTypeAliasInfo(u);e&&(e.name===c.value&&(d=!0),l="type alias")}this._addResultsPart(n,`(${l}) `+s.value+this._getTypeText(c,r,d),!0),this._addDocumentationPart(e,t,n,s,r,o);break}case 2:this._addResultsPart(n,"(parameter) "+s.value+this._getTypeText(s,r),!0),this._addDocumentationPart(e,t,n,s,r,o);break;case 4:case 5:if(this._addInitMethodInsteadIfCallNode(e,s,r,n,t,o))return;this._addResultsPart(n,"(class) "+s.value,!0),this._addDocumentationPart(e,t,n,s,r,o);break;case 3:{let i="function";if(o.isMethod){const e=r.getTypeForDeclaration(o);i=e&&u.isProperty(e)?"property":"method"}const a=r.getType(s);a&&p.isOverloadedFunction(a)?this._addResultsPart(n,`(${i})\n${g.getOverloadedFunctionTooltip(a,r)}`,!0):this._addResultsPart(n,`(${i}) `+s.value+this._getTypeText(s,r),!0),this._addDocumentationPart(e,t,n,s,r,o);break}case 6:this._addResultsPart(n,"(module) "+s.value,!0),this._addDocumentationPart(e,t,n,s,r,o)}else this._addResultsPart(n,"(import) "+s.value+this._getTypeText(s,r),!0)}static _addInitMethodInsteadIfCallNode(e,t,n,i,s,r){let a=t;if(a.parent&&35===a.parent.nodeType&&t===a.parent.memberName&&(a=t.parent),!a||!a.parent||9!==a.parent.nodeType||a.parent.leftExpression!==a)return!1;const o=n.getType(t);if(!o||!p.isClass(o))return!1;const l=u.lookUpClassMember(o,"__init__",12);if(!l)return!1;const c=n.getType(a.parent),d=n.getTypeOfMember(l);if(!(c&&d&&p.isObject(c)&&p.isFunction(d)))return!1;const h=n.bindFunctionToClassOrObject(c,d);if(!h||!p.isFunction(h))return!1;const m=n.printFunctionParts(h),y=`${t.value}(${m[0].join(", ")})`;this._addResultsPart(i,"(class) "+y,!0);return this._addDocumentationPartForType(e,s,i,h,r,n)||this._addDocumentationPartForType(e,s,i,o,r,n),!0}static _getTypeText(e,t,n=!1){const i=t.getType(e)||p.UnknownType.create();return": "+t.printType(i,n)}static _addDocumentationPart(e,t,n,i,s,r){const a=s.getType(i);a&&this._addDocumentationPartForType(e,t,n,a,r,s)}static _addDocumentationPartForType(e,t,n,i,s,r){const a=[];if(p.isModule(i))a.push(c.getModuleDocString(i,s,t));else if(p.isClass(i))a.push(c.getClassDocString(i,s,t));else if(p.isFunction(i))3!==(null==s?void 0:s.type)&&4!==(null==s?void 0:s.type)||a.push(g.getFunctionDocStringFromType(i,t,r));else if(p.isOverloadedFunction(i)){const e=s?l.getEnclosingClass(s.node):void 0,n=e?r.getTypeOfClass(e):void 0;a.push(...c.getOverloadedFunctionDocStringsInherited(i,s,t,r,null==n?void 0:n.classType))}else if(3===(null==s?void 0:s.type)){const e=3===(null==s?void 0:s.type)?l.getEnclosingClass(s.node.name,!1):void 0,n=e?r.getTypeOfClass(e):void 0;n&&a.push(c.getPropertyDocStringInherited(s,t,r,n.classType))}let o=!1;for(const t of a)t&&(o=!0,this._addDocumentationResultsPart(e,n,t));return o}static _addDocumentationResultsPart(e,t,n){if(n)if(e===a.MarkupKind.Markdown){const e=o.convertDocStringToMarkdown(n);t.length>0&&e.length>0&&t.push({text:"---\n"}),this._addResultsPart(t,e)}else e===a.MarkupKind.PlainText?this._addResultsPart(t,o.convertDocStringToPlainText(n)):h.fail(`Unsupported markup type: ${e}`)}static _addResultsPart(e,t,n=!1){e.push({python:n,text:t})}},t.convertHoverResults=function(e,t){if(!t)return;const n=t.parts.map((t=>{if(t.python){if(e===a.MarkupKind.Markdown)return"```python\n"+t.text+"\n```\n";if(e===a.MarkupKind.PlainText)return t.text+"\n\n";h.fail(`Unsupported markup type: ${e}`)}return t.text})).join("");return{contents:{kind:e,value:n},range:t.range}}},64677:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImportSorter=void 0;const i=n(45214),s=n(38213),r=n(28348),a=n(80957);t.ImportSorter=class{constructor(e,t){this._parseResults=e,this._cancellationToken=t}sort(){s.throwIfCancellationRequested(this._cancellationToken);const e=[],t=i.getTopLevelImports(this._parseResults.parseTree),n=t.orderedImports.map((e=>e)).sort(((e,t)=>i.compareImportStatements(e,t)));if(0===n.length)return[];const r=this._getPrimaryReplacementRange(t.orderedImports);return e.push({range:r,replacementText:this._generateSortedImportText(n)}),this._addSecondaryReplacementRanges(t.orderedImports,e),e}_getPrimaryReplacementRange(e){let t=e.findIndex((e=>e.followsNonImportStatement));t<0&&(t=e.length);const n=e[t-1].node;return{start:r.convertOffsetToPosition(e[0].node.start,this._parseResults.tokenizerOutput.lines),end:r.convertOffsetToPosition(a.TextRange.getEnd(n),this._parseResults.tokenizerOutput.lines)}}_addSecondaryReplacementRanges(e,t){let n=e.findIndex((e=>e.followsNonImportStatement));if(!(n<0))for(;;){let i=e.findIndex(((e,t)=>t>n&&e.followsNonImportStatement));if(i<0&&(i=e.length),t.push({range:{start:r.convertOffsetToPosition(e[n].node.start,this._parseResults.tokenizerOutput.lines),end:r.convertOffsetToPosition(a.TextRange.getEnd(e[i-1].node),this._parseResults.tokenizerOutput.lines)},replacementText:""}),n=i,n>=e.length)break}}_generateSortedImportText(e){let t="",n=i.getImportGroup(e[0]);for(const s of e){const r=i.getImportGroup(s);let a;n!==r&&(t+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence,n=r),a=20===s.node.nodeType?this._formatImportNode(s.subnode,s.moduleName):this._formatImportFromNode(s.node,s.moduleName),s!==e[e.length-1]&&(a+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence),t+=a}return t}_formatImportNode(e,t){let n=`import ${t}`;return e.alias&&(n+=` as ${e.alias.value}`),n}_formatImportFromNode(e,t){const n=e.imports.sort(((e,t)=>this._compareSymbols(e,t))).map((e=>{let t=e.name.value;return e.alias&&(t+=` as ${e.alias.value}`),t}));let i=`from ${t} import `;if(e.isWildcardImport)return i+"*";const s=n.join(", ");if(i.length+s.length<=88)return i+s;i+="("+this._parseResults.tokenizerOutput.predominantEndOfLineSequence;for(const e of n)i+=this._parseResults.tokenizerOutput.predominantTabSequence+e+","+this._parseResults.tokenizerOutput.predominantEndOfLineSequence;return i+=")",i}_compareSymbols(e,t){return e.name.value<t.name.value?-1:1}}},47458:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.performQuickAction=void 0;const a=n(45214),o=r(n(23241)),l=n(38213),c=n(28348),p=n(80957),u=n(64677);t.performQuickAction=function(e,t,n,i){if("pyright.organizeimports"===e){return new u.ImportSorter(n,i).sort()}if("pyright.addoptionalforparam"===e&&t.length>=1){return function(e,t,n){l.throwIfCancellationRequested(n);let i=o.findNodeByOffset(e.parseTree,t);for(;i&&41!==i.nodeType;)i=i.parent;if(!i)return[];const s=i.typeAnnotation||i.typeAnnotationComment;if(!s)return[];const r=[],u=c.convertOffsetToPosition(s.start,e.tokenizerOutput.lines),d=c.convertOffsetToPosition(p.TextRange.getEnd(s),e.tokenizerOutput.lines);r.push({range:{start:u,end:u},replacementText:"Optional["}),r.push({range:{start:d,end:d},replacementText:"]"});const h=a.getTopLevelImports(e.parseTree),m=h.orderedImports.find((e=>"typing"===e.moduleName));if(m&&22===m.node.nodeType){const t=a.getTextEditsForAutoImportSymbolAddition("Optional",m,e);r.push(...t)}else{const t=a.getTextEditsForAutoImportInsertion("Optional",h,"typing",0,e,u);r.push(...t)}return r}(n,parseInt(t[0],10),i)}return[]}},5165:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReferencesProvider=t.FindReferencesTreeWalker=t.ReferencesResult=void 0;const a=r(n(35696)),o=r(n(88023)),l=r(n(23241)),c=n(22339),p=n(93989),u=n(38213),d=n(28348),h=n(80957);class m{constructor(e,t,n,i,s){this.requiresGlobalSearch=e,this.nodeAtOffset=t,this.symbolName=n,this.declarations=i,this._reporter=s,this._locations=[]}get locations(){return this._locations}addLocations(...e){0!==e.length&&(this._reporter&&this._reporter(e),this._locations.push(...e))}}t.ReferencesResult=m;class y extends c.ParseTreeWalker{constructor(e,t,n,i,s,r){super(),this._parseResults=e,this._filePath=t,this._referencesResult=n,this._includeDeclaration=i,this._evaluator=s,this._cancellationToken=r,this._locationsFound=[]}findReferences(e=this._parseResults.parseTree){return this.walk(e),this._locationsFound}walk(e){a.isCodeUnreachable(e)||super.walk(e)}visitModuleName(e){return!1}visitName(e){if(u.throwIfCancellationRequested(this._cancellationToken),e.value!==this._referencesResult.symbolName)return!1;const t=this._evaluator.getDeclarationsForNameNode(e);return t&&t.length>0&&t.some((e=>this._resultsContainsDeclaration(e)))&&(this._includeDeclaration||e!==this._referencesResult.nodeAtOffset)&&this._locationsFound.push({path:this._filePath,range:{start:d.convertOffsetToPosition(e.start,this._parseResults.tokenizerOutput.lines),end:d.convertOffsetToPosition(h.TextRange.getEnd(e),this._parseResults.tokenizerOutput.lines)}}),!0}_resultsContainsDeclaration(e){const t=this._evaluator.resolveAliasDeclaration(e,!1);if(!t)return!1;if(this._referencesResult.declarations.some((e=>o.areDeclarationsSame(e,t))))return!0;const n=this._evaluator.resolveAliasDeclaration(t,!0);return!(!n||n===t)&&this._referencesResult.declarations.some((e=>o.areDeclarationsSame(e,n)))}}t.FindReferencesTreeWalker=y;t.ReferencesProvider=class{static getDeclarationForPosition(e,t,n,i,s,r,a){var o;u.throwIfCancellationRequested(a);const c=d.convertPositionToOffset(i,t.tokenizerOutput.lines);if(void 0===c)return;const h=l.findNodeByOffset(t.parseTree,c);if(void 0===h)return;if(38!==h.nodeType)return;if(37===(null===(o=h.parent)||void 0===o?void 0:o.nodeType))return;const y=s.getDeclarationsForNameNode(h);if(!y)return;const g=[];if(y.forEach((t=>{const n=s.resolveAliasDeclaration(t,!1);if(n&&(g.push(n),p.isStubFile(n.path))){const t=e.findDeclarations(n);for(const e of t)e&&e.path&&this._addIfUnique(g,e)}})),0===g.length)return;const f=g.some((e=>{var t,i;if(e.path!==n)return!0;const s=l.getEvaluationScopeNode(e.node);return 36===s.nodeType||10===s.nodeType||35===(null===(i=null===(t=e.node)||void 0===t?void 0:t.parent)||void 0===i?void 0:i.nodeType)&&e.node===e.node.parent.memberName}));return new m(f,h,h.value,g,r)}static _addIfUnique(e,t){for(const n of e)if(o.areDeclarationsSame(n,t))return;e.push(t)}static addReferences(e,t,n,i,s,r){const a=new y(e,t,n,i,s,r);n.addLocations(...a.findReferences())}}},75659:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SignatureHelpProvider=void 0;const a=n(29335),o=n(21736),l=n(20822),c=r(n(23241)),p=n(23241),u=n(38213),d=n(28348),h=n(31807);t.SignatureHelpProvider=class{static getSignatureHelpForPosition(e,t,n,i,s,r){var a;u.throwIfCancellationRequested(r);const o=d.convertPositionToOffset(t,e.tokenizerOutput.lines);if(void 0===o)return;let l=c.findNodeByOffset(e.parseTree,o);const h=l,m=l?c.getNodeDepth(l):0;let y=o;for(;y>=0;){y--;const t=c.findNodeByOffset(e.parseTree,y);if(t&&t!==h){c.getNodeDepth(t)>m&&(l=t);break}}if(void 0===l)return;const g=p.getCallNodeAndActiveParameterIndex(l,o,e.tokenizerOutput.tokens);if(!g)return;const f=i.getCallSignatureInfo(g.callNode,g.activeIndex,g.activeOrFake);if(!f)return;return{signatures:f.signatures.map((e=>this._makeSignature(e,n,i,s))),callHasParameters:!!(null===(a=f.callNode.arguments)||void 0===a?void 0:a.length)}}static _makeSignature(e,t,n,i){const s=e.type,r=n.printFunctionParts(s),c=[],p=h.getFunctionDocStringFromType(s,t,n);let u="(";const d=s.details.parameters;let m;r[0].forEach(((e,t)=>{let n="";t<d.length?n=d[t].name||"":d.length>0&&(n=d[d.length-1].name||""),c.push({startOffset:u.length,endOffset:u.length+e.length,text:e,documentation:l.extractParameterDocumentation(p||"",n)}),u+=e,t<r[0].length-1&&(u+=", ")})),u+=") -> "+r[1],e.activeParam&&(m=d.indexOf(e.activeParam),-1===m&&(m=void 0));const y={label:u,parameters:c,activeParameter:m};return p&&(i===a.MarkupKind.Markdown?y.documentation={kind:a.MarkupKind.Markdown,value:o.convertDocStringToMarkdown(p)}:y.documentation={kind:a.MarkupKind.PlainText,value:o.convertDocStringToPlainText(p)}),y}}},31807:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctionDocStringFromType=t.getOverloadedFunctionTooltip=void 0;const a=r(n(23241)),o=n(58333);t.getOverloadedFunctionTooltip=function(e,t,n=70){let i="";const s=e.overloads.map((e=>e.details.name+t.printType(e,!1)));for(let e=0;e<s.length;e++)0!==e&&s[e].length>n&&s[e-1].length<=n&&(i+="\n"),i+=s[e],e<s.length-1&&(i+="\n",s[e].length>n&&(i+="\n"));return i},t.getFunctionDocStringFromType=function(e,t,n){const i=e.details.declaration,s=i?a.getEnclosingClass(i.node):void 0,r=s?n.getTypeOfClass(s):void 0;return o.getFunctionDocStringInherited(e,i,t,null==r?void 0:r.classType)}},74426:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Localizer=t.ParameterizedString=void 0;const i=n(20823),s=n(4397),r=n(27646),a=n(3608),o=n(36181),l=n(22811),c=n(66483),p=n(37568),u=n(61162);class d{constructor(e){this._formatString=e}format(e){let t=this._formatString;return Object.keys(e).forEach((n=>{t=t.replace(`{${n}}`,e[n].toString())})),t}getFormatString(){return this._formatString}}t.ParameterizedString=d;const h="en-us",m={de:r,"en-us":s,es:a,fr:o,ja:l,ru:c,"zh-cn":p,"zh-tw":u};let y,g={};function f(e){void 0===y&&(y=function(){g=function(){const e=_(h);if(e)return e;return console.error("Could not load default strings"),{}}();return function(e){if(e===h)return{};let t=_(e);if(void 0!==t)return t;const n=e.split("-");if(n.length>0&&n[0]&&(t=_(n[0]),void 0!==t))return t;return{}}(function(){const e=process.env,t=e.VSCODE_NLS_CONFIG;if(t)try{return JSON.parse(t).locale}catch(e){}const n=e.LC_ALL||e.LC_MESSAGES||e.LANG||e.LANGUAGE;if(n){const e=n.split(".");if(e.length>0&&e[0])return e[0]}return h}())}());const t=e.split("."),n=T(y,t)||T(g,t);if(n)return n;i.fail(`Missing localized string for key "${e}"`)}function T(e,t){let n=e;for(const e of t){if(!n[e])return;n=n[e]}return n}function _(e){return m[e]}!function(e){let t,n,i;!function(e){e.annotatedParamCountMismatch=()=>new d(f("Diagnostic.annotatedParamCountMismatch")),e.annotatedTypeArgMissing=()=>f("Diagnostic.annotatedTypeArgMissing"),e.annotationFormatString=()=>f("Diagnostic.annotationFormatString"),e.annotationNotSupported=()=>f("Diagnostic.annotationNotSupported"),e.annotationSpansStrings=()=>f("Diagnostic.annotationSpansStrings"),e.annotationStringEscape=()=>f("Diagnostic.annotationStringEscape"),e.annotationTripleQuote=()=>f("Diagnostic.annotationTripleQuote"),e.argAssignment=()=>new d(f("Diagnostic.argAssignment")),e.argAssignmentFunction=()=>new d(f("Diagnostic.argAssignmentFunction")),e.argAssignmentParam=()=>new d(f("Diagnostic.argAssignmentParam")),e.argAssignmentParamFunction=()=>new d(f("Diagnostic.argAssignmentParamFunction")),e.argMissingForParam=()=>new d(f("Diagnostic.argMissingForParam")),e.argMissingForParams=()=>new d(f("Diagnostic.argMissingForParams")),e.argMorePositionalExpectedCount=()=>new d(f("Diagnostic.argMorePositionalExpectedCount")),e.argMorePositionalExpectedOne=()=>f("Diagnostic.argMorePositionalExpectedOne"),e.argPositional=()=>f("Diagnostic.argPositional"),e.argPositionalExpectedCount=()=>new d(f("Diagnostic.argPositionalExpectedCount")),e.argPositionalExpectedOne=()=>f("Diagnostic.argPositionalExpectedOne"),e.argTypePartiallyUnknown=()=>f("Diagnostic.argTypePartiallyUnknown"),e.argTypeUnknown=()=>f("Diagnostic.argTypeUnknown"),e.assertAlwaysTrue=()=>f("Diagnostic.assertAlwaysTrue"),e.assignmentExprContext=()=>f("Diagnostic.assignmentExprContext"),e.assignmentExprComprehension=()=>new d(f("Diagnostic.assignmentExprComprehension")),e.assignmentInProtocol=()=>f("Diagnostic.assignmentInProtocol"),e.assignmentTargetExpr=()=>f("Diagnostic.assignmentTargetExpr"),e.awaitIllegal=()=>f("Diagnostic.awaitIllegal"),e.awaitNotInAsync=()=>f("Diagnostic.awaitNotInAsync"),e.backticksIllegal=()=>f("Diagnostic.backticksIllegal"),e.baseClassCircular=()=>f("Diagnostic.baseClassCircular"),e.baseClassInvalid=()=>f("Diagnostic.baseClassInvalid"),e.baseClassFinal=()=>new d(f("Diagnostic.baseClassFinal")),e.baseClassUnknown=()=>f("Diagnostic.baseClassUnknown"),e.bindTypeMismatch=()=>new d(f("Diagnostic.bindTypeMismatch")),e.breakOutsideLoop=()=>f("Diagnostic.breakOutsideLoop"),e.callableExtraArgs=()=>f("Diagnostic.callableExtraArgs"),e.callableFirstArg=()=>f("Diagnostic.callableFirstArg"),e.callableSecondArg=()=>f("Diagnostic.callableSecondArg"),e.casePatternIsIrrefutable=()=>f("Diagnostic.casePatternIsIrrefutable"),e.classMethodClsParam=()=>f("Diagnostic.classMethodClsParam"),e.classNotRuntimeSubscriptable=()=>new d(f("Diagnostic.classNotRuntimeSubscriptable")),e.classDecoratorTypeUnknown=()=>f("Diagnostic.classDecoratorTypeUnknown"),e.classDefinitionCycle=()=>new d(f("Diagnostic.classDefinitionCycle")),e.classGetItemClsParam=()=>f("Diagnostic.classGetItemClsParam"),e.classVarFirstArgMissing=()=>f("Diagnostic.classVarFirstArgMissing"),e.classVarTooManyArgs=()=>f("Diagnostic.classVarTooManyArgs"),e.clsSelfParamTypeMismatch=()=>new d(f("Diagnostic.clsSelfParamTypeMismatch")),e.comparisonAlwaysFalse=()=>new d(f("Diagnostic.comparisonAlwaysFalse")),e.comprehensionInDict=()=>f("Diagnostic.comprehensionInDict"),e.comprehensionInSet=()=>f("Diagnostic.comprehensionInSet"),e.concatenateParamSpecMissing=()=>f("Diagnostic.concatenateParamSpecMissing"),e.concatenateTypeArgsMissing=()=>f("Diagnostic.concatenateTypeArgsMissing"),e.constantRedefinition=()=>new d(f("Diagnostic.constantRedefinition")),e.constructorNoArgs=()=>new d(f("Diagnostic.constructorNoArgs")),e.continueInFinally=()=>f("Diagnostic.continueInFinally"),e.continueOutsideLoop=()=>f("Diagnostic.continueOutsideLoop"),e.dataClassBaseClassNotFrozen=()=>f("Diagnostic.dataClassBaseClassNotFrozen"),e.dataClassFieldWithDefault=()=>f("Diagnostic.dataClassFieldWithDefault"),e.declaredReturnTypePartiallyUnknown=()=>new d(f("Diagnostic.declaredReturnTypePartiallyUnknown")),e.declaredReturnTypeUnknown=()=>f("Diagnostic.declaredReturnTypeUnknown"),e.defaultValueContainsCall=()=>f("Diagnostic.defaultValueContainsCall"),e.defaultValueNotAllowed=()=>f("Diagnostic.defaultValueNotAllowed"),e.defaultValueNotEllipsis=()=>f("Diagnostic.defaultValueNotEllipsis"),e.dictInAnnotation=()=>f("Diagnostic.dictInAnnotation"),e.dictKeyValuePairs=()=>f("Diagnostic.dictKeyValuePairs"),e.dictUnpackIsNotMapping=()=>f("Diagnostic.dictUnpackIsNotMapping"),e.delTargetExpr=()=>f("Diagnostic.delTargetExpr"),e.dictExpandIllegalInComprehension=()=>f("Diagnostic.dictExpandIllegalInComprehension"),e.duplicateArgsParam=()=>f("Diagnostic.duplicateArgsParam"),e.duplicateBaseClass=()=>f("Diagnostic.duplicateBaseClass"),e.duplicateCatchAll=()=>f("Diagnostic.duplicateCatchAll"),e.duplicateImport=()=>new d(f("Diagnostic.duplicateImport")),e.duplicateKwargsParam=()=>f("Diagnostic.duplicateKwargsParam"),e.duplicateNameOnly=()=>f("Diagnostic.duplicateNameOnly"),e.duplicateParam=()=>new d(f("Diagnostic.duplicateParam")),e.duplicateCapturePatternTarget=()=>new d(f("Diagnostic.duplicateCapturePatternTarget")),e.duplicateStarPattern=()=>f("Diagnostic.duplicateStarPattern"),e.duplicateStarStarPattern=()=>f("Diagnostic.duplicateStarStarPattern"),e.duplicatePositionOnly=()=>f("Diagnostic.duplicatePositionOnly"),e.duplicateUnpack=()=>f("Diagnostic.duplicateUnpack"),e.ellipsisContext=()=>f("Diagnostic.ellipsisContext"),e.ellipsisSecondArg=()=>f("Diagnostic.ellipsisSecondArg"),e.exceptionTypeIncorrect=()=>new d(f("Diagnostic.exceptionTypeIncorrect")),e.exceptionTypeNotClass=()=>new d(f("Diagnostic.exceptionTypeNotClass")),e.exceptionTypeNotInstantiable=()=>new d(f("Diagnostic.exceptionTypeNotInstantiable")),e.expectedAfterDecorator=()=>f("Diagnostic.expectedAfterDecorator"),e.expectedArrow=()=>f("Diagnostic.expectedArrow"),e.expectedAsAfterException=()=>f("Diagnostic.expectedAsAfterException"),e.expectedAssignRightHandExpr=()=>f("Diagnostic.expectedAssignRightHandExpr"),e.expectedBinaryRightHandExpr=()=>f("Diagnostic.expectedBinaryRightHandExpr"),e.expectedBoolLiteral=()=>f("Diagnostic.expectedBoolLiteral"),e.expectedCase=()=>f("Diagnostic.expectedCase"),e.expectedClassName=()=>f("Diagnostic.expectedClassName"),e.expectedCloseBracket=()=>f("Diagnostic.expectedCloseBracket"),e.expectedCloseBrace=()=>f("Diagnostic.expectedCloseBrace"),e.expectedCloseParen=()=>f("Diagnostic.expectedCloseParen"),e.expectedColon=()=>f("Diagnostic.expectedColon"),e.expectedComplexNumberLiteral=()=>f("Diagnostic.expectedComplexNumberLiteral"),e.expectedDecoratorExpr=()=>f("Diagnostic.expectedDecoratorExpr"),e.expectedDecoratorName=()=>f("Diagnostic.expectedDecoratorName"),e.expectedDecoratorNewline=()=>f("Diagnostic.expectedDecoratorNewline"),e.expectedDelExpr=()=>f("Diagnostic.expectedDelExpr"),e.expectedElse=()=>f("Diagnostic.expectedElse"),e.expectedExceptionClass=()=>f("Diagnostic.expectedExceptionClass"),e.expectedExceptionObj=()=>f("Diagnostic.expectedExceptionObj"),e.expectedExpr=()=>f("Diagnostic.expectedExpr"),e.expectedImport=()=>f("Diagnostic.expectedImport"),e.expectedImportAlias=()=>f("Diagnostic.expectedImportAlias"),e.expectedImportSymbols=()=>f("Diagnostic.expectedImportSymbols"),e.expectedIdentifier=()=>f("Diagnostic.expectedIdentifier"),e.expectedIndentedBlock=()=>f("Diagnostic.expectedIndentedBlock"),e.expectedIn=()=>f("Diagnostic.expectedIn"),e.expectedInExpr=()=>f("Diagnostic.expectedInExpr"),e.expectedFunctionAfterAsync=()=>f("Diagnostic.expectedFunctionAfterAsync"),e.expectedFunctionName=()=>f("Diagnostic.expectedFunctionName"),e.expectedMemberName=()=>f("Diagnostic.expectedMemberName"),e.expectedModuleName=()=>f("Diagnostic.expectedModuleName"),e.expectedNameAfterAs=()=>f("Diagnostic.expectedNameAfterAs"),e.expectedNamedParameter=()=>f("Diagnostic.expectedNamedParameter"),e.expectedNewline=()=>f("Diagnostic.expectedNewline"),e.expectedNewlineOrSemicolon=()=>f("Diagnostic.expectedNewlineOrSemicolon"),e.expectedOpenParen=()=>f("Diagnostic.expectedOpenParen"),e.expectedParamName=()=>f("Diagnostic.expectedParamName"),e.expectedPatternExpr=()=>f("Diagnostic.expectedPatternExpr"),e.expectedPatternSubjectExpr=()=>f("Diagnostic.expectedPatternSubjectExpr"),e.expectedPatternValue=()=>f("Diagnostic.expectedPatternValue"),e.expectedReturnExpr=()=>f("Diagnostic.expectedReturnExpr"),e.expectedSliceIndex=()=>f("Diagnostic.expectedSliceIndex"),e.expectedTypeNotString=()=>f("Diagnostic.expectedTypeNotString"),e.expectedYieldExpr=()=>f("Diagnostic.expectedYieldExpr"),e.finalContext=()=>f("Diagnostic.finalContext"),e.finalMethodOverride=()=>new d(f("Diagnostic.finalMethodOverride")),e.finalReassigned=()=>new d(f("Diagnostic.finalReassigned")),e.finalRedeclaration=()=>new d(f("Diagnostic.finalRedeclaration")),e.finalRedeclarationBySubclass=()=>new d(f("Diagnostic.finalRedeclarationBySubclass")),e.finalTooManyArgs=()=>f("Diagnostic.finalTooManyArgs"),e.finalUnassigned=()=>new d(f("Diagnostic.finalUnassigned")),e.formatStringBrace=()=>f("Diagnostic.formatStringBrace"),e.formatStringBytes=()=>f("Diagnostic.formatStringBytes"),e.formatStringEscape=()=>f("Diagnostic.formatStringEscape"),e.formatStringInPattern=()=>f("Diagnostic.formatStringInPattern"),e.formatStringIllegal=()=>f("Diagnostic.formatStringIllegal"),e.formatStringUnicode=()=>f("Diagnostic.formatStringUnicode"),e.formatStringUnterminated=()=>f("Diagnostic.formatStringUnterminated"),e.functionDecoratorTypeUnknown=()=>f("Diagnostic.functionDecoratorTypeUnknown"),e.generatorAsyncReturnType=()=>f("Diagnostic.generatorAsyncReturnType"),e.generatorSyncReturnType=()=>f("Diagnostic.generatorSyncReturnType"),e.genericClassAssigned=()=>f("Diagnostic.genericClassAssigned"),e.genericClassDeleted=()=>f("Diagnostic.genericClassDeleted"),e.genericNotAllowed=()=>f("Diagnostic.genericNotAllowed"),e.genericTypeArgMissing=()=>f("Diagnostic.genericTypeArgMissing"),e.genericTypeArgTypeVar=()=>f("Diagnostic.genericTypeArgTypeVar"),e.genericTypeArgUnique=()=>f("Diagnostic.genericTypeArgUnique"),e.globalReassignment=()=>new d(f("Diagnostic.globalReassignment")),e.globalRedefinition=()=>new d(f("Diagnostic.globalRedefinition")),e.implicitStringConcat=()=>f("Diagnostic.implicitStringConcat"),e.importCycleDetected=()=>f("Diagnostic.importCycleDetected"),e.importDepthExceeded=()=>new d(f("Diagnostic.importDepthExceeded")),e.importResolveFailure=()=>new d(f("Diagnostic.importResolveFailure")),e.importSourceResolveFailure=()=>new d(f("Diagnostic.importSourceResolveFailure")),e.importSymbolUnknown=()=>new d(f("Diagnostic.importSymbolUnknown")),e.incompatibleMethodOverride=()=>new d(f("Diagnostic.incompatibleMethodOverride")),e.inconsistentIndent=()=>f("Diagnostic.inconsistentIndent"),e.inconsistentTabs=()=>f("Diagnostic.inconsistentTabs"),e.initSubclassClsParam=()=>f("Diagnostic.initSubclassClsParam"),e.instanceMethodSelfParam=()=>f("Diagnostic.instanceMethodSelfParam"),e.internalBindError=()=>new d(f("Diagnostic.internalBindError")),e.internalParseError=()=>new d(f("Diagnostic.internalParseError")),e.internalTypeCheckingError=()=>new d(f("Diagnostic.internalTypeCheckingError")),e.invalidIdentifierChar=()=>f("Diagnostic.invalidIdentifierChar"),e.invalidStubStatement=()=>f("Diagnostic.invalidStubStatement"),e.invalidTokenChars=()=>new d(f("Diagnostic.invalidTokenChars")),e.isInstanceInvalidType=()=>new d(f("Diagnostic.isInstanceInvalidType")),e.isSubclassInvalidType=()=>new d(f("Diagnostic.isSubclassInvalidType")),e.keyValueInSet=()=>f("Diagnostic.keyValueInSet"),e.keywordArgInTypeArgument=()=>f("Diagnostic.keywordArgInTypeArgument"),e.keywordSubscriptIllegal=()=>f("Diagnostic.keywordSubscriptIllegal"),e.lambdaReturnTypeUnknown=()=>f("Diagnostic.lambdaReturnTypeUnknown"),e.lambdaReturnTypePartiallyUnknown=()=>new d(f("Diagnostic.lambdaReturnTypePartiallyUnknown")),e.listInAnnotation=()=>f("Diagnostic.listInAnnotation"),e.literalUnsupportedType=()=>f("Diagnostic.literalUnsupportedType"),e.literalEmptyArgs=()=>f("Diagnostic.literalEmptyArgs"),e.literalNotCallable=()=>f("Diagnostic.literalNotCallable"),e.matchIncompatible=()=>f("Diagnostic.matchIncompatible"),e.memberAccess=()=>new d(f("Diagnostic.memberAccess")),e.memberDelete=()=>new d(f("Diagnostic.memberDelete")),e.memberSet=()=>new d(f("Diagnostic.memberSet")),e.metaclassConflict=()=>f("Diagnostic.metaclassConflict"),e.metaclassDuplicate=()=>f("Diagnostic.metaclassDuplicate"),e.methodNotDefined=()=>new d(f("Diagnostic.methodNotDefined")),e.methodNotDefinedOnType=()=>new d(f("Diagnostic.methodNotDefinedOnType")),e.methodOrdering=()=>f("Diagnostic.methodOrdering"),e.methodOverridden=()=>new d(f("Diagnostic.methodOverridden")),e.methodReturnsNonObject=()=>new d(f("Diagnostic.methodReturnsNonObject")),e.moduleContext=()=>f("Diagnostic.moduleContext"),e.moduleUnknownMember=()=>new d(f("Diagnostic.moduleUnknownMember")),e.namedExceptAfterCatchAll=()=>f("Diagnostic.namedExceptAfterCatchAll"),e.namedParamAfterParamSpecArgs=()=>new d(f("Diagnostic.namedParamAfterParamSpecArgs")),e.namedTupleEmptyName=()=>f("Diagnostic.namedTupleEmptyName"),e.namedTupleFirstArg=()=>f("Diagnostic.namedTupleFirstArg"),e.namedTupleMultipleInheritance=()=>f("Diagnostic.namedTupleMultipleInheritance"),e.namedTupleNameString=()=>f("Diagnostic.namedTupleNameString"),e.namedTupleNameType=()=>f("Diagnostic.namedTupleNameType"),e.namedTupleNameUnique=()=>f("Diagnostic.namedTupleNameUnique"),e.namedTupleNoTypes=()=>f("Diagnostic.namedTupleNoTypes"),e.namedTupleSecondArg=()=>f("Diagnostic.namedTupleSecondArg"),e.newClsParam=()=>f("Diagnostic.newClsParam"),e.newTypeLiteral=()=>f("Diagnostic.newTypeLiteral"),e.newTypeNotAClass=()=>f("Diagnostic.newTypeNotAClass"),e.newTypeProtocolClass=()=>f("Diagnostic.newTypeProtocolClass"),e.nonDefaultAfterDefault=()=>f("Diagnostic.nonDefaultAfterDefault"),e.noneNotCallable=()=>f("Diagnostic.noneNotCallable"),e.noneNotIterable=()=>f("Diagnostic.noneNotIterable"),e.noneNotSubscriptable=()=>f("Diagnostic.noneNotSubscriptable"),e.noneNotUsableWith=()=>f("Diagnostic.noneNotUsableWith"),e.noneOperator=()=>new d(f("Diagnostic.noneOperator")),e.noneUnknownMember=()=>new d(f("Diagnostic.noneUnknownMember")),e.nonLocalNoBinding=()=>new d(f("Diagnostic.nonLocalNoBinding")),e.nonLocalReassignment=()=>new d(f("Diagnostic.nonLocalReassignment")),e.nonLocalRedefinition=()=>new d(f("Diagnostic.nonLocalRedefinition")),e.nonLocalInModule=()=>f("Diagnostic.nonLocalInModule"),e.noOverload=()=>new d(f("Diagnostic.noOverload")),e.noReturnContainsReturn=()=>f("Diagnostic.noReturnContainsReturn"),e.noReturnContainsYield=()=>f("Diagnostic.noReturnContainsYield"),e.noReturnReturnsNone=()=>f("Diagnostic.noReturnReturnsNone"),e.notRequiredArgCount=()=>f("Diagnostic.notRequiredArgCount"),e.notRequiredNotInTypedDict=()=>f("Diagnostic.notRequiredNotInTypedDict"),e.objectNotCallable=()=>new d(f("Diagnostic.objectNotCallable")),e.obscuredClassDeclaration=()=>new d(f("Diagnostic.obscuredClassDeclaration")),e.obscuredFunctionDeclaration=()=>new d(f("Diagnostic.obscuredFunctionDeclaration")),e.obscuredMethodDeclaration=()=>new d(f("Diagnostic.obscuredMethodDeclaration")),e.obscuredParameterDeclaration=()=>new d(f("Diagnostic.obscuredParameterDeclaration")),e.obscuredVariableDeclaration=()=>new d(f("Diagnostic.obscuredVariableDeclaration")),e.operatorLessOrGreaterDeprecated=()=>f("Diagnostic.operatorLessOrGreaterDeprecated"),e.optionalExtraArgs=()=>f("Diagnostic.optionalExtraArgs"),e.orPatternIrrefutable=()=>f("Diagnostic.orPatternIrrefutable"),e.orPatternMissingName=()=>f("Diagnostic.orPatternMissingName"),e.overlappingOverload=()=>new d(f("Diagnostic.overlappingOverload")),e.overloadAbstractMismatch=()=>new d(f("Diagnostic.overloadAbstractMismatch")),e.overloadImplementationMismatch=()=>new d(f("Diagnostic.overloadImplementationMismatch")),e.overloadReturnTypeMismatch=()=>new d(f("Diagnostic.overloadReturnTypeMismatch")),e.overloadWithoutImplementation=()=>new d(f("Diagnostic.overloadWithoutImplementation")),e.paramAfterKwargsParam=()=>f("Diagnostic.paramAfterKwargsParam"),e.paramAlreadyAssigned=()=>new d(f("Diagnostic.paramAlreadyAssigned")),e.paramNameMissing=()=>new d(f("Diagnostic.paramNameMissing")),e.paramSpecArgsKwargsUsage=()=>f("Diagnostic.paramSpecArgsKwargsUsage"),e.paramSpecArgsUsage=()=>f("Diagnostic.paramSpecArgsUsage"),e.paramSpecAssignedName=()=>new d(f("Diagnostic.paramSpecAssignedName")),e.paramSpecContext=()=>f("Diagnostic.paramSpecContext"),e.paramSpecIllegal=()=>f("Diagnostic.paramSpecIllegal"),e.paramSpecFirstArg=()=>f("Diagnostic.paramSpecFirstArg"),e.paramSpecKwargsUsage=()=>f("Diagnostic.paramSpecKwargsUsage"),e.paramSpecNotBound=()=>new d(f("Diagnostic.paramSpecNotBound")),e.paramSpecNotUsedByOuterScope=()=>new d(f("Diagnostic.paramSpecNotUsedByOuterScope")),e.paramSpecUnknownArg=()=>f("Diagnostic.paramSpecUnknownArg"),e.paramSpecUnknownMember=()=>new d(f("Diagnostic.paramSpecUnknownMember")),e.paramSpecUnknownParam=()=>new d(f("Diagnostic.paramSpecUnknownParam")),e.paramTypeCovariant=()=>f("Diagnostic.paramTypeCovariant"),e.paramTypeUnknown=()=>new d(f("Diagnostic.paramTypeUnknown")),e.paramAssignmentMismatch=()=>new d(f("Diagnostic.paramAssignmentMismatch")),e.paramTypePartiallyUnknown=()=>new d(f("Diagnostic.paramTypePartiallyUnknown")),e.parenthesizedContextManagerIllegal=()=>f("Diagnostic.parenthesizedContextManagerIllegal"),e.positionArgAfterNamedArg=()=>f("Diagnostic.positionArgAfterNamedArg"),e.positionOnlyAfterNameOnly=()=>f("Diagnostic.positionOnlyAfterNameOnly"),e.positionOnlyIncompatible=()=>f("Diagnostic.positionOnlyIncompatible"),e.positionOnlyFirstParam=()=>f("Diagnostic.positionOnlyFirstParam"),e.privateUsedOutsideOfClass=()=>new d(f("Diagnostic.privateUsedOutsideOfClass")),e.privateUsedOutsideOfModule=()=>new d(f("Diagnostic.privateUsedOutsideOfModule")),e.propertyOverridden=()=>new d(f("Diagnostic.propertyOverridden")),e.propertyStaticMethod=()=>f("Diagnostic.propertyStaticMethod"),e.protectedUsedOutsideOfClass=()=>new d(f("Diagnostic.protectedUsedOutsideOfClass")),e.protocolBaseClass=()=>new d(f("Diagnostic.protocolBaseClass")),e.protocolIllegal=()=>f("Diagnostic.protocolIllegal"),e.protocolUsedInCall=()=>new d(f("Diagnostic.protocolUsedInCall")),e.protocolVarianceContravariant=()=>new d(f("Diagnostic.protocolVarianceContravariant")),e.protocolVarianceCovariant=()=>new d(f("Diagnostic.protocolVarianceCovariant")),e.protocolVarianceInvariant=()=>new d(f("Diagnostic.protocolVarianceInvariant")),e.raiseParams=()=>f("Diagnostic.raiseParams"),e.recursiveDefinition=()=>new d(f("Diagnostic.recursiveDefinition")),e.relativeImportNotAllowed=()=>f("Diagnostic.relativeImportNotAllowed"),e.requiredArgCount=()=>f("Diagnostic.requiredArgCount"),e.requiredNotInTypedDict=()=>f("Diagnostic.requiredNotInTypedDict"),e.returnMissing=()=>new d(f("Diagnostic.returnMissing")),e.returnOutsideFunction=()=>f("Diagnostic.returnOutsideFunction"),e.returnTypeContravariant=()=>f("Diagnostic.returnTypeContravariant"),e.returnTypeMismatch=()=>new d(f("Diagnostic.returnTypeMismatch")),e.returnTypeUnknown=()=>f("Diagnostic.returnTypeUnknown"),e.returnTypePartiallyUnknown=()=>new d(f("Diagnostic.returnTypePartiallyUnknown")),e.revealLocalsArgs=()=>f("Diagnostic.revealLocalsArgs"),e.revealLocalsNone=()=>f("Diagnostic.revealLocalsNone"),e.revealTypeArgs=()=>f("Diagnostic.revealTypeArgs"),e.setterGetterTypeMismatch=()=>f("Diagnostic.setterGetterTypeMismatch"),e.starPatternInAsPattern=()=>f("Diagnostic.starPatternInAsPattern"),e.starPatternInOrPattern=()=>f("Diagnostic.starPatternInOrPattern"),e.singleOverload=()=>new d(f("Diagnostic.singleOverload")),e.starStarWildcardNotAllowed=()=>f("Diagnostic.starStarWildcardNotAllowed"),e.staticClsSelfParam=()=>f("Diagnostic.staticClsSelfParam"),e.stringNonAsciiBytes=()=>f("Diagnostic.stringNonAsciiBytes"),e.stringNotSubscriptable=()=>f("Diagnostic.stringNotSubscriptable"),e.stringUnsupportedEscape=()=>f("Diagnostic.stringUnsupportedEscape"),e.stringUnterminated=()=>f("Diagnostic.stringUnterminated"),e.stubFileMissing=()=>new d(f("Diagnostic.stubFileMissing")),e.stubUsesGetAttr=()=>f("Diagnostic.stubUsesGetAttr"),e.sublistParamsIncompatible=()=>f("Diagnostic.sublistParamsIncompatible"),e.superCallArgCount=()=>f("Diagnostic.superCallArgCount"),e.superCallFirstArg=()=>new d(f("Diagnostic.superCallFirstArg")),e.superCallSecondArg=()=>new d(f("Diagnostic.superCallSecondArg")),e.superCallZeroArgForm=()=>f("Diagnostic.superCallZeroArgForm"),e.symbolIsUnbound=()=>new d(f("Diagnostic.symbolIsUnbound")),e.symbolIsUndefined=()=>new d(f("Diagnostic.symbolIsUndefined")),e.symbolIsPossiblyUnbound=()=>new d(f("Diagnostic.symbolIsPossiblyUnbound")),e.symbolOverridden=()=>new d(f("Diagnostic.symbolOverridden")),e.tryWithoutExcept=()=>f("Diagnostic.tryWithoutExcept"),e.tupleInAnnotation=()=>f("Diagnostic.tupleInAnnotation"),e.tupleIndexOutOfRange=()=>new d(f("Diagnostic.tupleIndexOutOfRange")),e.tupleSizeMismatch=()=>new d(f("Diagnostic.tupleSizeMismatch")),e.typeAbstract=()=>new d(f("Diagnostic.typeAbstract")),e.typeAliasIsRecursive=()=>new d(f("Diagnostic.typeAliasIsRecursive")),e.typeAliasNotInModule=()=>f("Diagnostic.typeAliasNotInModule"),e.typeAliasRedeclared=()=>new d(f("Diagnostic.typeAliasRedeclared")),e.typeAnnotationCall=()=>f("Diagnostic.typeAnnotationCall"),e.typeAnnotationVariable=()=>f("Diagnostic.typeAnnotationVariable"),e.typeArgListNotAllowed=()=>f("Diagnostic.typeArgListNotAllowed"),e.typeArgsExpectingNone=()=>f("Diagnostic.typeArgsExpectingNone"),e.typeArgsMismatchOne=()=>new d(f("Diagnostic.typeArgsMismatchOne")),e.typeArgsMissingForAlias=()=>new d(f("Diagnostic.typeArgsMissingForAlias")),e.typeArgsMissingForClass=()=>new d(f("Diagnostic.typeArgsMissingForClass")),e.typeArgsTooFew=()=>new d(f("Diagnostic.typeArgsTooFew")),e.typeArgsTooMany=()=>new d(f("Diagnostic.typeArgsTooMany")),e.typeAssignmentMismatch=()=>new d(f("Diagnostic.typeAssignmentMismatch")),e.typeCallNotAllowed=()=>f("Diagnostic.typeCallNotAllowed"),e.typedDictAccess=()=>f("Diagnostic.typedDictAccess"),e.typedDictBadVar=()=>f("Diagnostic.typedDictBadVar"),e.typedDictBaseClass=()=>f("Diagnostic.typedDictBaseClass"),e.typedDictDelete=()=>f("Diagnostic.typedDictDelete"),e.typedDictEmptyName=()=>f("Diagnostic.typedDictEmptyName"),e.typedDictEntryName=()=>f("Diagnostic.typedDictEntryName"),e.typedDictEntryUnique=()=>f("Diagnostic.typedDictEntryUnique"),e.typedDictExtraArgs=()=>f("Diagnostic.typedDictExtraArgs"),e.typedDictFieldRedefinition=()=>new d(f("Diagnostic.typedDictFieldRedefinition")),e.typedDictFirstArg=()=>f("Diagnostic.typedDictFirstArg"),e.typedDictSecondArgDict=()=>f("Diagnostic.typedDictSecondArgDict"),e.typedDictSecondArgDictEntry=()=>f("Diagnostic.typedDictSecondArgDictEntry"),e.typedDictSet=()=>f("Diagnostic.typedDictSet"),e.typedDictTotalParam=()=>f("Diagnostic.typedDictTotalParam"),e.typeExpectedClass=()=>new d(f("Diagnostic.typeExpectedClass")),e.typeGuardArgCount=()=>f("Diagnostic.typeGuardArgCount"),e.typeNotAwaitable=()=>new d(f("Diagnostic.typeNotAwaitable")),e.typeNotCallable=()=>new d(f("Diagnostic.typeNotCallable")),e.typeNotIntantiable=()=>new d(f("Diagnostic.typeNotIntantiable")),e.typeNotIterable=()=>new d(f("Diagnostic.typeNotIterable")),e.typeNotSpecializable=()=>new d(f("Diagnostic.typeNotSpecializable")),e.typeNotSubscriptable=()=>new d(f("Diagnostic.typeNotSubscriptable")),e.typeNotUsableWith=()=>new d(f("Diagnostic.typeNotUsableWith")),e.typeNotSupportBinaryOperator=()=>new d(f("Diagnostic.typeNotSupportBinaryOperator")),e.typeNotSupportUnaryOperator=()=>new d(f("Diagnostic.typeNotSupportUnaryOperator")),e.typePartiallyUnknown=()=>new d(f("Diagnostic.typePartiallyUnknown")),e.typeUnknown=()=>new d(f("Diagnostic.typeUnknown")),e.typeVarAssignedName=()=>new d(f("Diagnostic.typeVarAssignedName")),e.typeVarAssignmentMismatch=()=>new d(f("Diagnostic.typeVarAssignmentMismatch")),e.typeVarBoundAndConstrained=()=>f("Diagnostic.typeVarBoundAndConstrained"),e.typeVarFirstArg=()=>f("Diagnostic.typeVarFirstArg"),e.typeVarGeneric=()=>f("Diagnostic.typeVarGeneric"),e.typeVarNoMember=()=>new d(f("Diagnostic.typeVarNoMember")),e.typeVarNotSubscriptable=()=>new d(f("Diagnostic.typeVarNotSubscriptable")),e.typeVarNotUsedByOuterScope=()=>new d(f("Diagnostic.typeVarNotUsedByOuterScope")),e.typeVarSingleConstraint=()=>f("Diagnostic.typeVarSingleConstraint"),e.typeVarTupleContext=()=>f("Diagnostic.typeVarTupleContext"),e.typeVarUnknownParam=()=>new d(f("Diagnostic.typeVarUnknownParam")),e.typeVarUsedByOuterScope=()=>new d(f("Diagnostic.typeVarUsedByOuterScope")),e.typeVarUsedOnlyOnce=()=>new d(f("Diagnostic.typeVarUsedOnlyOnce")),e.typeVarVariance=()=>f("Diagnostic.typeVarVariance"),e.unaccessedClass=()=>new d(f("Diagnostic.unaccessedClass")),e.unaccessedFunction=()=>new d(f("Diagnostic.unaccessedFunction")),e.unaccessedImport=()=>new d(f("Diagnostic.unaccessedImport")),e.unaccessedSymbol=()=>new d(f("Diagnostic.unaccessedSymbol")),e.unaccessedVariable=()=>new d(f("Diagnostic.unaccessedVariable")),e.unexpectedAsyncToken=()=>f("Diagnostic.unexpectedAsyncToken"),e.unexpectedExprToken=()=>f("Diagnostic.unexpectedExprToken"),e.unexpectedIndent=()=>f("Diagnostic.unexpectedIndent"),e.unexpectedUnindent=()=>f("Diagnostic.unexpectedUnindent"),e.unionSyntaxIllegal=()=>f("Diagnostic.unionSyntaxIllegal"),e.unnecessaryCast=()=>new d(f("Diagnostic.unnecessaryCast")),e.unnecessaryIsInstanceNever=()=>new d(f("Diagnostic.unnecessaryIsInstanceNever")),e.unnecessaryIsInstanceAlways=()=>new d(f("Diagnostic.unnecessaryIsInstanceAlways")),e.unnecessaryIsSubclassAlways=()=>new d(f("Diagnostic.unnecessaryIsSubclassAlways")),e.unnecessaryIsSubclassNever=()=>new d(f("Diagnostic.unnecessaryIsSubclassNever")),e.unpackArgCount=()=>f("Diagnostic.unpackArgCount"),e.unpackedArgInTypeArgument=()=>f("Diagnostic.unpackedArgInTypeArgument"),e.unpackedArgWithVariadicParam=()=>f("Diagnostic.unpackedArgWithVariadicParam"),e.unpackedDictArgumentNotMapping=()=>f("Diagnostic.unpackedDictArgumentNotMapping"),e.unpackedSubscriptIllegal=()=>f("Diagnostic.unpackedSubscriptIllegal"),e.unpackedTypeVarTupleExpected=()=>new d(f("Diagnostic.unpackedTypeVarTupleExpected")),e.unpackExpectedTypeVarTuple=()=>f("Diagnostic.unpackExpectedTypeVarTuple"),e.unpackIllegalInComprehension=()=>f("Diagnostic.unpackIllegalInComprehension"),e.unpackInDict=()=>f("Diagnostic.unpackInDict"),e.unpackInSet=()=>f("Diagnostic.unpackInSet"),e.unpackNotAllowed=()=>f("Diagnostic.unpackNotAllowed"),e.unpackTuplesIllegal=()=>f("Diagnostic.unpackTuplesIllegal"),e.unreachableCode=()=>f("Diagnostic.unreachableCode"),e.unsupportedDunderAllOperation=()=>f("Diagnostic.unsupportedDunderAllOperation"),e.unusedCallResult=()=>new d(f("Diagnostic.unusedCallResult")),e.unusedCoroutine=()=>f("Diagnostic.unusedCoroutine"),e.varAnnotationIllegal=()=>f("Diagnostic.varAnnotationIllegal"),e.variadicTypeArgsTooMany=()=>f("Diagnostic.variadicTypeArgsTooMany"),e.variadicTypeParamTooManyAlias=()=>new d(f("Diagnostic.variadicTypeParamTooManyAlias")),e.variadicTypeParamTooManyClass=()=>new d(f("Diagnostic.variadicTypeParamTooManyClass")),e.walrusIllegal=()=>f("Diagnostic.walrusIllegal"),e.walrusNotAllowed=()=>f("Diagnostic.walrusNotAllowed"),e.wildcardInFunction=()=>f("Diagnostic.wildcardInFunction"),e.wildcardLibraryImport=()=>f("Diagnostic.wildcardLibraryImport"),e.yieldFromIllegal=()=>f("Diagnostic.yieldFromIllegal"),e.yieldFromOutsideAsync=()=>f("Diagnostic.yieldFromOutsideAsync"),e.yieldOutsideFunction=()=>f("Diagnostic.yieldOutsideFunction"),e.yieldTypeMismatch=()=>new d(f("Diagnostic.yieldTypeMismatch")),e.yieldWithinListCompr=()=>f("Diagnostic.yieldWithinListCompr"),e.zeroCaseStatementsFound=()=>f("Diagnostic.zeroCaseStatementsFound"),e.zeroLengthTupleNotAllowed=()=>f("Diagnostic.zeroLengthTupleNotAllowed")}(t=e.Diagnostic||(e.Diagnostic={})),function(e){e.argParam=()=>new d(f("DiagnosticAddendum.argParam")),e.argParamFunction=()=>new d(f("DiagnosticAddendum.argParamFunction")),e.argsParamMissing=()=>new d(f("DiagnosticAddendum.argsParamMissing")),e.argsParamWithVariadic=()=>new d(f("DiagnosticAddendum.argsParamWithVariadic")),e.argumentType=()=>new d(f("DiagnosticAddendum.argumentType")),e.argumentTypes=()=>new d(f("DiagnosticAddendum.argumentTypes")),e.assignToNone=()=>f("DiagnosticAddendum.assignToNone"),e.asyncHelp=()=>f("DiagnosticAddendum.asyncHelp"),e.dataclassFrozen=()=>new d(f("DiagnosticAddendum.dataclassFrozen")),e.finalMethod=()=>f("DiagnosticAddendum.finalMethod"),e.functionParamName=()=>new d(f("DiagnosticAddendum.functionParamName")),e.functionReturnTypeMismatch=()=>new d(f("DiagnosticAddendum.functionReturnTypeMismatch")),e.functionTooFewParams=()=>new d(f("DiagnosticAddendum.functionTooFewParams")),e.incompatibleGetter=()=>f("DiagnosticAddendum.incompatibleGetter"),e.incompatibleSetter=()=>f("DiagnosticAddendum.incompatibleSetter"),e.incompatibleDeleter=()=>f("DiagnosticAddendum.incompatibleDeleter"),e.functionTooManyParams=()=>new d(f("DiagnosticAddendum.functionTooManyParams")),e.keyNotRequired=()=>new d(f("DiagnosticAddendum.keyNotRequired")),e.keyRequiredDeleted=()=>new d(f("DiagnosticAddendum.keyRequiredDeleted")),e.keyUndefined=()=>new d(f("DiagnosticAddendum.keyUndefined")),e.literalAssignmentMismatch=()=>new d(f("DiagnosticAddendum.literalAssignmentMismatch")),e.memberAssignment=()=>new d(f("DiagnosticAddendum.memberAssignment")),e.memberIsAbstract=()=>new d(f("DiagnosticAddendum.memberIsAbstract")),e.memberIsAbstractMore=()=>new d(f("DiagnosticAddendum.memberIsAbstractMore")),e.memberSetClassVar=()=>new d(f("DiagnosticAddendum.memberSetClassVar")),e.memberTypeMismatch=()=>new d(f("DiagnosticAddendum.memberTypeMismatch")),e.memberUnknown=()=>new d(f("DiagnosticAddendum.memberUnknown")),e.missingGetter=()=>f("DiagnosticAddendum.missingGetter"),e.missingSetter=()=>f("DiagnosticAddendum.missingSetter"),e.missingDeleter=()=>f("DiagnosticAddendum.missingDeleter"),e.namedParamMissingInDest=()=>new d(f("DiagnosticAddendum.namedParamMissingInDest")),e.namedParamMissingInSource=()=>new d(f("DiagnosticAddendum.namedParamMissingInSource")),e.namedParamTypeMismatch=()=>new d(f("DiagnosticAddendum.namedParamTypeMismatch")),e.noOverloadAssignable=()=>new d(f("DiagnosticAddendum.noOverloadAssignable")),e.orPatternMissingName=()=>new d(f("DiagnosticAddendum.orPatternMissingName")),e.overloadMethod=()=>f("DiagnosticAddendum.overloadMethod"),e.overloadNotAssignable=()=>new d(f("DiagnosticAddendum.overloadNotAssignable")),e.overriddenMethod=()=>f("DiagnosticAddendum.overriddenMethod"),e.overriddenSymbol=()=>f("DiagnosticAddendum.overriddenSymbol"),e.overrideParamCount=()=>new d(f("DiagnosticAddendum.overrideParamCount")),e.overrideParamName=()=>new d(f("DiagnosticAddendum.overrideParamName")),e.overrideParamType=()=>new d(f("DiagnosticAddendum.overrideParamType")),e.overrideReturnType=()=>new d(f("DiagnosticAddendum.overrideReturnType")),e.overrideType=()=>new d(f("DiagnosticAddendum.overrideType")),e.paramAssignment=()=>new d(f("DiagnosticAddendum.paramAssignment")),e.paramSpecOverload=()=>f("DiagnosticAddendum.paramSpecOverload"),e.paramType=()=>new d(f("DiagnosticAddendum.paramType")),e.propertyMethodIncompatible=()=>new d(f("DiagnosticAddendum.propertyMethodIncompatible")),e.propertyMethodMissing=()=>new d(f("DiagnosticAddendum.propertyMethodMissing")),e.propertyMissingDeleter=()=>new d(f("DiagnosticAddendum.propertyMissingDeleter")),e.propertyMissingSetter=()=>new d(f("DiagnosticAddendum.propertyMissingSetter")),e.protocolMemberClassVar=()=>new d(f("DiagnosticAddendum.protocolMemberClassVar")),e.protocolMemberMissing=()=>new d(f("DiagnosticAddendum.protocolMemberMissing")),e.seeDeclaration=()=>f("DiagnosticAddendum.seeDeclaration"),e.seeClassDeclaration=()=>f("DiagnosticAddendum.seeClassDeclaration"),e.seeFunctionDeclaration=()=>f("DiagnosticAddendum.seeFunctionDeclaration"),e.seeMethodDeclaration=()=>f("DiagnosticAddendum.seeMethodDeclaration"),e.seeParameterDeclaration=()=>f("DiagnosticAddendum.seeParameterDeclaration"),e.seeVariableDeclaration=()=>f("DiagnosticAddendum.seeVariableDeclaration"),e.tupleEntryTypeMismatch=()=>new d(f("DiagnosticAddendum.tupleEntryTypeMismatch")),e.tupleSizeMismatch=()=>new d(f("DiagnosticAddendum.tupleSizeMismatch")),e.tupleSizeMismatchIndeterminate=()=>new d(f("DiagnosticAddendum.tupleSizeMismatchIndeterminate")),e.typeAssignmentMismatch=()=>new d(f("DiagnosticAddendum.typeAssignmentMismatch")),e.typeBound=()=>new d(f("DiagnosticAddendum.typeBound")),e.typeConstrainedTypeVar=()=>new d(f("DiagnosticAddendum.typeConstrainedTypeVar")),e.typedDictFieldMissing=()=>new d(f("DiagnosticAddendum.typedDictFieldMissing")),e.typedDictFieldNotRequired=()=>new d(f("DiagnosticAddendum.typedDictFieldNotRequired")),e.typedDictFieldRedefinition=()=>new d(f("DiagnosticAddendum.typedDictFieldRedefinition")),e.typedDictFieldRequired=()=>new d(f("DiagnosticAddendum.typedDictFieldRequired")),e.typedDictFieldTypeMismatch=()=>new d(f("DiagnosticAddendum.typedDictFieldTypeMismatch")),e.typedDictFieldUndefined=()=>new d(f("DiagnosticAddendum.typedDictFieldUndefined")),e.typeIncompatible=()=>new d(f("DiagnosticAddendum.typeIncompatible")),e.typeNotCallable=()=>new d(f("DiagnosticAddendum.typeNotCallable")),e.typeNotClass=()=>new d(f("DiagnosticAddendum.typeNotClass")),e.typeParamSpec=()=>new d(f("DiagnosticAddendum.typeParamSpec")),e.typeNotStringLiteral=()=>new d(f("DiagnosticAddendum.typeNotStringLiteral")),e.typeOfSymbol=()=>new d(f("DiagnosticAddendum.typeOfSymbol")),e.typeUnsupported=()=>new d(f("DiagnosticAddendum.typeUnsupported")),e.typeVarIsContravariant=()=>new d(f("DiagnosticAddendum.typeVarIsContravariant")),e.typeVarIsCovariant=()=>new d(f("DiagnosticAddendum.typeVarIsCovariant")),e.typeVarIsInvariant=()=>new d(f("DiagnosticAddendum.typeVarIsInvariant")),e.typeVarTupleRequiresKnownLength=()=>f("DiagnosticAddendum.typeVarTupleRequiresKnownLength"),e.typeVarNotAllowed=()=>f("DiagnosticAddendum.typeVarNotAllowed"),e.useDictInstead=()=>f("DiagnosticAddendum.useDictInstead"),e.useListInstead=()=>f("DiagnosticAddendum.useListInstead"),e.useTupleInstead=()=>f("DiagnosticAddendum.useTupleInstead"),e.useTypeInstead=()=>f("DiagnosticAddendum.useTypeInstead")}(n=e.DiagnosticAddendum||(e.DiagnosticAddendum={})),function(e){e.addOptionalToAnnotation=()=>f("CodeAction.addOptionalToAnnotation"),e.createTypeStub=()=>f("CodeAction.createTypeStub"),e.createTypeStubFor=()=>new d(f("CodeAction.createTypeStubFor")),e.executingCommand=()=>f("CodeAction.executingCommand"),e.filesToAnalyzeOne=()=>f("CodeAction.filesToAnalyzeOne"),e.filesToAnalyzeCount=()=>new d(f("CodeAction.filesToAnalyzeCount")),e.findingReferences=()=>f("CodeAction.findingReferences"),e.organizeImports=()=>f("CodeAction.organizeImports")}(i=e.CodeAction||(e.CodeAction={}))}(t.Localizer||(t.Localizer={}))},19794:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterStream=void 0;const i=n(49900);t.CharacterStream=class{constructor(e){this._text=e,this._position=0,this._currentChar=e.length>0?e.charCodeAt(0):0,this._isEndOfStream=0===e.length}getText(){return this._text}get position(){return this._position}set position(e){this._position=e,this._checkBounds()}get currentChar(){return this._currentChar}getCurrentChar(){return this._currentChar}get nextChar(){return this.position+1<this._text.length?this._text.charCodeAt(this.position+1):0}get prevChar(){return this.position-1>=0?this._text.charCodeAt(this.position-1):0}isEndOfStream(){return this._isEndOfStream}lookAhead(e){const t=this._position+e;return t<0||t>=this._text.length?0:this._text.charCodeAt(t)}advance(e){this.position+=e}moveNext(){return this._position<this._text.length-1?(this._position+=1,this._currentChar=this._text.charCodeAt(this._position),!0):(this.advance(1),!this.isEndOfStream())}isAtWhiteSpace(){return i.isWhiteSpace(this.currentChar)}isAtLineBreak(){return i.isLineBreak(this.currentChar)}skipLineBreak(){13===this._currentChar?(this.moveNext(),10===this.currentChar&&this.moveNext()):10===this._currentChar&&this.moveNext()}skipWhitespace(){for(;!this.isEndOfStream()&&this.isAtWhiteSpace();)this.moveNext()}skipToEol(){for(;!this.isEndOfStream()&&!this.isAtLineBreak();)this.moveNext()}skipToWhitespace(){for(;!this.isEndOfStream()&&!this.isAtWhiteSpace();)this.moveNext()}charCodeAt(e){return this._text.charCodeAt(e)}get length(){return this._text.length}_checkBounds(){this._position<0&&(this._position=0),this._isEndOfStream=this._position>=this._text.length,this._isEndOfStream&&(this._position=this._text.length),this._currentChar=this._isEndOfStream?0:this._text.charCodeAt(this._position)}}},49900:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isBinary=t.isOctal=t.isHex=t.isDecimal=t.isNumber=t.isLineBreak=t.isWhiteSpace=t.isIdentifierChar=t.isIdentifierStartChar=void 0;const a=r(n(52846));var o;!function(e){e[e.NotIdentifierChar=0]="NotIdentifierChar",e[e.StartIdentifierChar=1]="StartIdentifierChar",e[e.IdentifierChar=2]="IdentifierChar"}(o||(o={}));const l=256,c=new Array(l),p={};let u=!1;function d(e){return e>=48&&e<=57||95===e}t.isIdentifierStartChar=function(e){return e<l?c[e]===o.StartIdentifierChar:(u||(g(!1),u=!0),p[e]===o.StartIdentifierChar)},t.isIdentifierChar=function(e){return e<l?c[e]===o.StartIdentifierChar||c[e]===o.IdentifierChar:(u||(g(!1),u=!0),p[e]===o.StartIdentifierChar||p[e]===o.IdentifierChar)},t.isWhiteSpace=function(e){return 32===e||9===e||12===e},t.isLineBreak=function(e){return 13===e||10===e},t.isNumber=function(e){return e>=48&&e<=57||95===e},t.isDecimal=d,t.isHex=function(e){return d(e)||e>=97&&e<=102||e>=65&&e<=70||95===e},t.isOctal=function(e){return e>=48&&e<=55||95===e},t.isBinary=function(e){return 48===e||49===e||95===e};const h=[[95,6277,6278,8472,8494,12443,12444],a.unicodeLu,a.unicodeLl,a.unicodeLt,a.unicodeLo,a.unicodeLm,a.unicodeNl],m=[[183,903,4969,4970,4971,4972,4973,4974,4975,4976,4977,6618],a.unicodeMn,a.unicodeMc,a.unicodeNd,a.unicodePc];function y(e,t,n){for(let i=0;i<e.length;i++){const s=e[i];let r,a;Array.isArray(s)?(r=s[0],a=s[1]):r=a=s;for(let e=r;e<=a;e++)e<l?c[e]=t:p[e]=t;if(n&&r>=l)break}}function g(e){c.fill(o.NotIdentifierChar),m.forEach((t=>{y(t,o.IdentifierChar,e)})),h.forEach((t=>{y(t,o.StartIdentifierChar,e)}))}g(!0)},55390:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetNode=t.DictionaryExpandEntryNode=t.DictionaryKeyEntryNode=t.DictionaryNode=t.StringListNode=t.FormatStringNode=t.StringNode=t.NumberNode=t.EllipsisNode=t.ConstantNode=t.NameNode=t.LambdaNode=t.MemberAccessNode=t.YieldFromNode=t.YieldNode=t.SliceNode=t.IndexNode=t.ListComprehensionNode=t.CallNode=t.TupleNode=t.UnpackNode=t.TernaryNode=t.AwaitNode=t.AugmentedAssignmentNode=t.FunctionAnnotationNode=t.TypeAnnotationNode=t.AssignmentNode=t.AssignmentExpressionNode=t.BinaryOperationNode=t.UnaryOperationNode=t.ErrorNode=t.isExpressionNode=t.StatementListNode=t.DecoratorNode=t.WithItemNode=t.WithNode=t.ClassNode=t.ParameterNode=t.FunctionNode=t.ExceptNode=t.TryNode=t.ListComprehensionIfNode=t.ListComprehensionForNode=t.ForNode=t.WhileNode=t.IfNode=t.SuiteNode=t.ModuleNode=t.extendRange=t.getNextNodeId=void 0,t.PatternValueNode=t.PatternMappingExpandEntryNode=t.PatternMappingKeyEntryNode=t.PatternMappingNode=t.PatternCaptureNode=t.PatternClassArgumentNode=t.PatternClassNode=t.PatternLiteralNode=t.PatternAsNode=t.PatternSequenceNode=t.CaseNode=t.MatchNode=t.RaiseNode=t.ReturnNode=t.ContinueNode=t.BreakNode=t.AssertNode=t.NonlocalNode=t.GlobalNode=t.ImportFromAsNode=t.ImportFromNode=t.ImportAsNode=t.ModuleNameNode=t.ImportNode=t.PassNode=t.DelNode=t.ArgumentNode=t.ListNode=void 0;const i=n(80957);let s=1;function r(e,t){t.start<e.start&&(e.length+=e.start-t.start,e.start=t.start),i.TextRange.getEnd(t)>i.TextRange.getEnd(e)&&(e.length=i.TextRange.getEnd(t)-e.start)}t.getNextNodeId=function(){return s++},t.extendRange=r,function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:36,id:s++,statements:[]}}}(t.ModuleNode||(t.ModuleNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:50,id:s++,statements:[]}}}(t.SuiteNode||(t.SuiteNode={})),function(e){e.create=function(e,t,n,i){const a={start:e.start,length:e.length,nodeType:19,id:s++,testExpression:t,ifSuite:n,elseSuite:i};return t.parent=a,n.parent=a,r(a,t),r(a,n),i&&(r(a,i),i.parent=a),a}}(t.IfNode||(t.IfNode={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:57,id:s++,testExpression:t,whileSuite:n};return t.parent=i,n.parent=i,r(i,n),i}}(t.WhileNode||(t.WhileNode={})),function(e){e.create=function(e,t,n,i){const a={start:e.start,length:e.length,nodeType:26,id:s++,targetExpression:t,iterableExpression:n,forSuite:i};return t.parent=a,n.parent=a,i.parent=a,r(a,i),a}}(t.ForNode||(t.ForNode={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:33,id:s++,targetExpression:t,iterableExpression:n};return t.parent=i,n.parent=i,r(i,t),r(i,n),i}}(t.ListComprehensionForNode||(t.ListComprehensionForNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:34,id:s++,testExpression:t};return t.parent=n,r(n,t),n}}(t.ListComprehensionIfNode||(t.ListComprehensionIfNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:53,id:s++,trySuite:t,exceptClauses:[]};return t.parent=n,r(n,t),n}}(t.TryNode||(t.TryNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:25,id:s++,exceptSuite:t};return t.parent=n,r(n,t),n}}(t.ExceptNode||(t.ExceptNode={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:28,id:s++,decorators:[],name:t,parameters:[],suite:n};return t.parent=i,n.parent=i,r(i,n),i}}(t.FunctionNode||(t.FunctionNode={})),function(e){e.create=function(e,t){return{start:e.start,length:e.length,nodeType:41,id:s++,category:t}}}(t.ParameterNode||(t.ParameterNode={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:10,id:s++,decorators:[],name:t,arguments:[],suite:n};return t.parent=i,n.parent=i,r(i,n),i},e.createDummyForDecorators=function(e){const t={start:0,length:0,nodeType:10,id:s++,decorators:e,name:{start:0,length:0,id:0,nodeType:38,token:{type:7,start:0,length:0,comments:[],value:""},value:""},arguments:[],suite:{start:0,length:0,id:0,nodeType:50,statements:[]}};return e.forEach((e=>{e.parent=t,r(t,e)})),t.name.parent=t,t.suite.parent=t,t}}(t.ClassNode||(t.ClassNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:58,id:s++,withItems:[],suite:t};return t.parent=n,r(n,t),n}}(t.WithNode||(t.WithNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:59,id:s++,expression:e};return e.parent=t,t}}(t.WithItemNode||(t.WithItemNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:13,id:s++,expression:t};return t.parent=n,r(n,t),n}}(t.DecoratorNode||(t.DecoratorNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:47,id:s++,statements:[]}}}(t.StatementListNode||(t.StatementListNode={})),t.isExpressionNode=function(e){switch(e.nodeType){case 0:case 55:case 7:case 4:case 54:case 6:case 51:case 56:case 52:case 9:case 32:case 24:case 46:case 60:case 61:case 35:case 30:case 38:case 11:case 18:case 40:case 49:case 27:case 48:case 15:case 16:case 31:case 45:return!0;default:return!1}},function(e){e.create=function(e,t,n,i){const a={start:e.start,length:e.length,nodeType:0,id:s++,category:t,child:n,decorators:i};return n&&(n.parent=a,r(a,n)),i&&(i.forEach((e=>{e.parent=a})),i.length>0&&r(a,i[0])),a}}(t.ErrorNode||(t.ErrorNode={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:55,id:s++,operator:n,operatorToken:e,expression:t};return t.parent=i,r(i,t),i}}(t.UnaryOperationNode||(t.UnaryOperationNode={})),function(e){e.create=function(e,t,n,i){const a={start:e.start,length:e.length,nodeType:7,id:s++,leftExpression:e,operatorToken:n,operator:i,rightExpression:t};return e.parent=a,t.parent=a,r(a,t),a}}(t.BinaryOperationNode||(t.BinaryOperationNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:4,id:s++,name:e,rightExpression:t};return e.parent=n,t.parent=n,r(n,t),n}}(t.AssignmentExpressionNode||(t.AssignmentExpressionNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:3,id:s++,leftExpression:e,rightExpression:t};return e.parent=n,t.parent=n,r(n,t),n}}(t.AssignmentNode||(t.AssignmentNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:54,id:s++,valueExpression:e,typeAnnotation:t};return e.parent=n,t.parent=n,r(n,t),n}}(t.TypeAnnotationNode||(t.TypeAnnotationNode={})),function(e){e.create=function(e,t,n,i){const a={start:e.start,length:e.length,nodeType:62,id:s++,isParamListEllipsis:t,paramTypeAnnotations:n,returnTypeAnnotation:i};return n.forEach((e=>{e.parent=a})),i.parent=a,r(a,i),a}}(t.FunctionAnnotationNode||(t.FunctionAnnotationNode={})),function(e){e.create=function(e,t,n,i){const a={start:e.start,length:e.length,nodeType:5,id:s++,leftExpression:e,operator:n,rightExpression:t,destExpression:i};return e.parent=a,t.parent=a,i.parent=a,r(a,t),a}}(t.AugmentedAssignmentNode||(t.AugmentedAssignmentNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:6,id:s++,expression:t};return t.parent=n,r(n,t),n}}(t.AwaitNode||(t.AwaitNode={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:51,id:s++,ifExpression:e,testExpression:t,elseExpression:n};return e.parent=i,t.parent=i,n.parent=i,r(i,n),i}}(t.TernaryNode||(t.TernaryNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:56,id:s++,expression:t};return t.parent=n,r(n,t),n}}(t.UnpackNode||(t.UnpackNode={})),function(e){e.create=function(e,t){return{start:e.start,length:e.length,nodeType:52,id:s++,expressions:[],enclosedInParens:t}}}(t.TupleNode||(t.TupleNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:9,id:s++,leftExpression:e,arguments:[]};return e.parent=t,t}}(t.CallNode||(t.CallNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:32,id:s++,expression:e,comprehensions:[]};return e.parent=t,t}}(t.ListComprehensionNode||(t.ListComprehensionNode={})),function(e){e.create=function(e,t,n,i){const a={start:e.start,length:e.length,nodeType:24,id:s++,baseExpression:e,items:t,trailingComma:n};return e.parent=a,t.forEach((e=>{e.parent=a})),r(a,i),a}}(t.IndexNode||(t.IndexNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:46,id:s++}}}(t.SliceNode||(t.SliceNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:60,id:s++,expression:t};return t&&(t.parent=n,r(n,t)),n}}(t.YieldNode||(t.YieldNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:61,id:s++,expression:t};return t.parent=n,r(n,t),n}}(t.YieldFromNode||(t.YieldFromNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:35,id:s++,leftExpression:e,memberName:t};return e.parent=n,t.parent=n,r(n,t),n}}(t.MemberAccessNode||(t.MemberAccessNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:30,id:s++,parameters:[],expression:t};return t.parent=n,r(n,t),n}}(t.LambdaNode||(t.LambdaNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:38,id:s++,token:e,value:e.value}}}(t.NameNode||(t.NameNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:11,id:s++,constType:e.keywordType}}}(t.ConstantNode||(t.ConstantNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:18,id:s++}}}(t.EllipsisNode||(t.EllipsisNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:40,id:s++,value:e.value,isInteger:e.isInteger,isImaginary:e.isImaginary}}}(t.NumberNode||(t.NumberNode={})),function(e){e.create=function(e,t,n){return{start:e.start,length:e.length,nodeType:49,id:s++,token:e,value:t,hasUnescapeErrors:n}}}(t.StringNode||(t.StringNode={})),function(e){e.create=function(e,t,n,i){const r={start:e.start,length:e.length,nodeType:27,id:s++,token:e,value:t,hasUnescapeErrors:n,expressions:i};return i.forEach((e=>{e.parent=r})),r}}(t.FormatStringNode||(t.FormatStringNode={})),function(e){e.create=function(e){const t={start:e[0].start,length:e[0].length,nodeType:48,id:s++,strings:e};return e.length>0&&(e.forEach((e=>{e.parent=t})),r(t,e[e.length-1])),t}}(t.StringListNode||(t.StringListNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:15,id:s++,entries:[]}}}(t.DictionaryNode||(t.DictionaryNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:17,id:s++,keyExpression:e,valueExpression:t};return e.parent=n,t.parent=n,r(n,t),n}}(t.DictionaryKeyEntryNode||(t.DictionaryKeyEntryNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:16,id:s++,expandExpression:e};return e.parent=t,t}}(t.DictionaryExpandEntryNode||(t.DictionaryExpandEntryNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:45,id:s++,entries:[]}}}(t.SetNode||(t.SetNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:31,id:s++,entries:[]}}}(t.ListNode||(t.ListNode={})),function(e){e.create=function(e,t,n){const i={start:e?e.start:t.start,length:e?e.length:t.length,nodeType:1,id:s++,valueExpression:t,argumentCategory:n};return t.parent=i,r(i,t),i}}(t.ArgumentNode||(t.ArgumentNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:14,id:s++,expressions:[]}}}(t.DelNode||(t.DelNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:42,id:s++}}}(t.PassNode||(t.PassNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:20,id:s++,list:[]}}}(t.ImportNode||(t.ImportNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:37,id:s++,leadingDots:0,nameParts:[]}}}(t.ModuleNameNode||(t.ModuleNameNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:21,id:s++,module:e};return e.parent=t,t}}(t.ImportAsNode||(t.ImportAsNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:22,id:s++,module:t,imports:[],isWildcardImport:!1,usesParens:!1};return t.parent=n,r(n,t),n}}(t.ImportFromNode||(t.ImportFromNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:23,id:s++,name:e};return e.parent=t,t}}(t.ImportFromAsNode||(t.ImportFromAsNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:29,id:s++,nameList:[]}}}(t.GlobalNode||(t.GlobalNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:39,id:s++,nameList:[]}}}(t.NonlocalNode||(t.NonlocalNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:2,id:s++,testExpression:t};return t.parent=n,r(n,t),n}}(t.AssertNode||(t.AssertNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:8,id:s++}}}(t.BreakNode||(t.BreakNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:12,id:s++}}}(t.ContinueNode||(t.ContinueNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:44,id:s++}}}(t.ReturnNode||(t.ReturnNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:43,id:s++}}}(t.RaiseNode||(t.RaiseNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:63,id:s++,subjectExpression:t,cases:[]};return t.parent=n,r(n,t),n}}(t.MatchNode||(t.MatchNode={})),function(e){e.create=function(e,t,n,i){const a={start:e.start,length:e.length,nodeType:64,id:s++,pattern:t,guardExpression:n,suite:i};return r(a,i),t.parent=a,i.parent=a,n&&(n.parent=a),a}}(t.CaseNode||(t.CaseNode={})),function(e){e.create=function(e,t){const n=t.findIndex((e=>1===e.orPatterns.length&&69===e.orPatterns[0].nodeType&&e.orPatterns[0].isStar)),i={start:e.start,length:e.length,nodeType:65,id:s++,entries:t,starEntryIndex:n>=0?n:void 0};return t.length>0&&r(i,t[t.length-1]),t.forEach((e=>{e.parent=i})),i}}(t.PatternSequenceNode||(t.PatternSequenceNode={})),function(e){e.create=function(e,t){const n={start:e[0].start,length:e[0].length,nodeType:66,id:s++,orPatterns:e,target:t};return e.length>1&&r(n,e[e.length-1]),e.forEach((e=>{e.parent=n})),t&&(r(n,t),t.parent=n),n}}(t.PatternAsNode||(t.PatternAsNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:67,id:s++,expression:e};return e.parent=t,t}}(t.PatternLiteralNode||(t.PatternLiteralNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:68,id:s++,className:e,arguments:t};return e.parent=n,t.forEach((e=>{e.parent=n})),t.length>0&&r(n,t[t.length-1]),n}}(t.PatternClassNode||(t.PatternClassNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:74,id:s++,pattern:e,name:t};return e.parent=n,t&&(r(n,t),t.parent=n),n}}(t.PatternClassArgumentNode||(t.PatternClassArgumentNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:69,id:s++,target:e,isStar:void 0!==t,isWildcard:"_"===e.value};return e.parent=n,t&&r(n,t),n}}(t.PatternCaptureNode||(t.PatternCaptureNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:70,id:s++,entries:t};return t.length>0&&r(n,t[t.length-1]),t.forEach((e=>{e.parent=n})),n}}(t.PatternMappingNode||(t.PatternMappingNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:71,id:s++,keyPattern:e,valuePattern:t};return e.parent=n,t.parent=n,r(n,t),n}}(t.PatternMappingKeyEntryNode||(t.PatternMappingKeyEntryNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:72,id:s++,target:t};return t.parent=n,r(n,t),n}}(t.PatternMappingExpandEntryNode||(t.PatternMappingExpandEntryNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:73,id:s++,expression:e};return e.parent=t,t}}(t.PatternValueNode||(t.PatternValueNode={}))},14014:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=t.ParseOptions=void 0;const a=n(20823),o=n(24319),l=n(85036),c=n(28348),p=n(57485),u=n(76962),d=n(74426),h=n(55390),m=r(n(78722)),y=n(7280),g=n(66945);class f{constructor(){this.isStubFile=!1,this.pythonVersion=p.latestStablePythonVersion,this.reportInvalidStringEscapeSequence=!1}}t.ParseOptions=f;class T{constructor(){this._tokenIndex=0,this._areErrorsSuppressed=!1,this._parseOptions=new f,this._diagSink=new l.DiagnosticSink,this._isInLoop=!1,this._isInFunction=!1,this._isInFinally=!1,this._isParsingTypeAnnotation=!1,this._isParsingIndexTrailer=!1,this._futureImportMap=new Map,this._importedModules=[],this._containsWildcardImport=!1,this._assignmentExpressionsAllowed=!0,this._typingImportAliases=[],this._typingSymbolAliases=new Map}parseSourceFile(e,t,n){u.timingStats.tokenizeFileTime.timeOperation((()=>{this._startNewParse(e,0,e.length,t,n)}));const i=h.ModuleNode.create({start:0,length:e.length});return u.timingStats.parseFileTime.timeOperation((()=>{for(;!this._atEof();)if(!this._consumeTokenIfType(2)){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(d.Localizer.Diagnostic.inconsistentTabs(),t):this._addError(d.Localizer.Diagnostic.unexpectedIndent(),e)}const t=this._parseStatement();t?(t.parent=i,i.statements.push(t)):this._consumeTokensUntilType([2])}})),a.assert(void 0!==this._tokenizerOutput),{text:e,parseTree:i,importedModules:this._importedModules,futureImports:this._futureImportMap,tokenizerOutput:this._tokenizerOutput,containsWildcardImport:this._containsWildcardImport}}parseTextExpression(e,t,n,i,s=0,r=0){const a=new l.DiagnosticSink;let o;if(this._startNewParse(e,t,n,i,a,r),1===s)o=this._parseTypeAnnotation();else if(2===s)o=this._parseFunctionTypeAnnotation();else{const e=this._parseTestOrStarExpressionList(!1);e.parseError?o=e.parseError:(0===e.list.length&&this._addError(d.Localizer.Diagnostic.expectedExpr(),this._peekToken()),o=this._makeExpressionOrTuple(e,!1))}return 2===this._peekTokenType()&&this._getNextToken(),this._atEof()||this._addError(d.Localizer.Diagnostic.unexpectedExprToken(),this._peekToken()),{parseTree:o,lines:this._tokenizerOutput.lines,diagnostics:a.fetchAndClear()}}_startNewParse(e,t,n,i,s,r=0){this._fileContents=e,this._parseOptions=i,this._diagSink=s;const a=new y.Tokenizer;this._tokenizerOutput=a.tokenize(e,t,n,r),this._tokenIndex=0}_parseStatement(){switch(this._consumeTokenIfType(4)&&this._addError(d.Localizer.Diagnostic.unexpectedUnindent(),this._peekToken()),this._peekKeywordType()){case 20:return this._parseIfStatement();case 35:return this._parseWhileStatement();case 17:return this._parseForStatement();case 34:return this._parseTryStatement();case 36:return this._parseWithStatement();case 10:return this._parseFunctionDef();case 7:return this._parseClassDef();case 3:return this._parseAsyncStatement();case 25:{const e=this._peekToken(1);let t=!1;if(10===e.type||11===e.type||12===e.type||20===e.type||2===e.type||1===e.type)t=!0;else if(9===e.type){const n=e;26!==n.operatorType&&33!==n.operatorType&&(t=!0)}if(!t){const e=this._parseMatchStatement();if(e)return e}}}return 22===this._peekOperatorType()?this._parseDecorated():this._parseSimpleStatement()}_parseAsyncStatement(){const e=this._getKeywordToken(3);switch(this._peekKeywordType()){case 10:return this._parseFunctionDef(e);case 36:return this._parseWithStatement(e);case 17:return this._parseForStatement(e)}this._addError(d.Localizer.Diagnostic.unexpectedAsyncToken(),e)}_parseMatchStatement(){const e=this._getKeywordToken(25);let t=!1;if(this._suppressErrors((()=>{const e=this._tokenIndex;this._parseTestOrStarListAsExpression(!0,12,d.Localizer.Diagnostic.expectedReturnExpr()),t=10===this._peekToken().type,this._tokenIndex=e})),!t)return;const n=this._parseTestOrStarListAsExpression(!0,12,d.Localizer.Diagnostic.expectedReturnExpr()),i=h.MatchNode.create(e,n),s=this._peekToken();if(this._consumeTokenIfType(10))if(this._consumeTokenIfType(2)){const t=this._peekToken();if(this._consumeTokenIfType(3)){const e=t;e.isIndentAmbiguous&&this._addError(d.Localizer.Diagnostic.inconsistentTabs(),e)}else this._addError(d.Localizer.Diagnostic.expectedIndentedBlock(),this._peekToken());for(;;){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(d.Localizer.Diagnostic.inconsistentTabs(),t):this._addError(d.Localizer.Diagnostic.unexpectedIndent(),e)}const t=this._parseCaseStatement();t?(t.parent=i,i.cases.push(t)):this._consumeTokensUntilType([2,10])&&this._getNextToken();const n=this._peekToken();if(this._consumeTokenIfType(4)){n.matchesIndent||this._addError(d.Localizer.Diagnostic.inconsistentIndent(),n);break}if(1===this._peekTokenType())break}i.cases.length>0?h.extendRange(i,i.cases[i.cases.length-1]):this._addError(d.Localizer.Diagnostic.zeroCaseStatementsFound(),e)}else this._addError(d.Localizer.Diagnostic.expectedNewline(),s);else this._addError(d.Localizer.Diagnostic.expectedColon(),s),this._consumeTokensUntilType([2,10])&&this._getNextToken();this._getLanguageVersion()<p.PythonVersion.V3_10&&this._addError(d.Localizer.Diagnostic.matchIncompatible(),e);for(let e=0;e<i.cases.length-1;e++){const t=i.cases[e];!t.guardExpression&&this._isPatternIrrefutable(t.pattern)&&this._addError(d.Localizer.Diagnostic.casePatternIsIrrefutable(),t.pattern)}return i}_parseCaseStatement(){const e=this._peekToken();if(!this._consumeTokenIfKeyword(6))return void this._addError(d.Localizer.Diagnostic.expectedCase(),e);const t=this._parsePatternSequence();let n,i;if(t.parseError)n=t.parseError;else if(0===t.list.length)this._addError(d.Localizer.Diagnostic.expectedPatternExpr(),this._peekToken()),n=h.ErrorNode.create(e,11);else if(1!==t.list.length||t.trailingComma)n=h.PatternSequenceNode.create(t.list[0],t.list);else{const e=t.list[0].orPatterns[0];n=69===e.nodeType&&e.isStar?h.PatternSequenceNode.create(t.list[0],t.list):t.list[0]}this._consumeTokenIfKeyword(20)&&(i=this._parseTestExpression(!0));const s=this._parseSuite(this._isInFunction);return h.CaseNode.create(e,n,i,s)}_isPatternIrrefutable(e){return 69===e.nodeType||66===e.nodeType&&e.orPatterns.some((e=>this._isPatternIrrefutable(e)))}_getPatternTargetNames(e,t){switch(e.nodeType){case 65:e.entries.forEach((e=>{this._getPatternTargetNames(e,t)}));break;case 68:e.arguments.forEach((e=>{this._getPatternTargetNames(e.pattern,t)}));break;case 66:e.target&&t.set(e.target.value,!0),e.orPatterns.forEach((e=>{this._getPatternTargetNames(e,t)}));break;case 69:e.isWildcard||t.set(e.target.value,!0);break;case 70:e.entries.forEach((e=>{72===e.nodeType?t.set(e.target.value,!0):(this._getPatternTargetNames(e.keyPattern,t),this._getPatternTargetNames(e.valuePattern,t))}))}}_parsePatternSequence(){const e=this._parseExpressionListGeneric((()=>this._parsePatternAs())),t=e.list.filter((e=>1===e.orPatterns.length&&69===e.orPatterns[0].nodeType&&e.orPatterns[0].isStar));t.length>1&&this._addError(d.Localizer.Diagnostic.duplicateStarPattern(),t[1].orPatterns[0]);const n=new Map;return e.list.forEach((e=>{e.orPatterns.forEach((e=>{69!==e.nodeType||e.isStar||e.isWildcard||(n.has(e.target.value)?this._addError(d.Localizer.Diagnostic.duplicateCapturePatternTarget().format({name:e.target.value}),e):n.set(e.target.value,e))}))})),e}_parsePatternAs(){const e=[];for(;;){const t=this._parsePatternAtom();if(e.push(t),!this._consumeTokenIfOperator(6))break}let t;if(e.length>1&&e.forEach((e=>{69===e.nodeType&&e.isStar&&this._addError(d.Localizer.Diagnostic.starPatternInOrPattern(),e)})),this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?t=h.NameNode.create(e):this._addError(d.Localizer.Diagnostic.expectedNameAfterAs(),this._peekToken())}t&&1===e.length&&69===e[0].nodeType&&e[0].isStar&&this._addError(d.Localizer.Diagnostic.starPatternInAsPattern(),e[0]),e.forEach(((t,n)=>{n<e.length-1&&this._isPatternIrrefutable(t)&&this._addError(d.Localizer.Diagnostic.orPatternIrrefutable(),t)}));const n=new Map;return e.forEach((e=>{this._getPatternTargetNames(e,n)})),e.forEach((e=>{const t=new Map;if(this._getPatternTargetNames(e,t),t.size<n.size){const i=Array.from(n.keys()).filter((e=>!t.has(e))),s=new o.DiagnosticAddendum;s.addMessage(d.Localizer.DiagnosticAddendum.orPatternMissingName().format({name:i.map((e=>`"${e}"`)).join(", ")})),this._addError(d.Localizer.Diagnostic.orPatternMissingName()+s.getString(),e)}})),h.PatternAsNode.create(e,t)}_parsePatternAtom(){const e=this._parsePatternLiteral();if(e)return e;const t=this._parsePatternCaptureOrValue();if(t){if(0===t.nodeType||!this._consumeTokenIfType(13))return t;const e=this._parseClassPatternArgList(),n=69===t.nodeType?t.target:t.expression,i=h.PatternClassNode.create(n,e);return this._consumeTokenIfType(14)||(this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()),this._consumeTokensUntilType([2]),h.extendRange(i,this._peekToken())),i}const n=this._peekToken();if(26===this._peekOperatorType()){const e=this._getNextToken(),t=this._getTokenIfIdentifier();return t?h.PatternCaptureNode.create(h.NameNode.create(t),e):(this._addError(d.Localizer.Diagnostic.expectedIdentifier(),this._peekToken()),h.ErrorNode.create(e,2))}if(13===n.type||15===n.type){const e=this._getNextToken(),t=this._parsePatternSequence();let i;if(t.parseError)i=t.parseError;else if(1!==t.list.length||t.trailingComma||13!==e.type)i=h.PatternSequenceNode.create(e,t.list);else{const s=t.list[0].orPatterns[0];i=69===s.nodeType&&s.isStar?h.PatternSequenceNode.create(e,t.list):t.list[0],h.extendRange(i,n)}const s=this._peekToken();return this._consumeTokenIfType(13===n.type?14:16)?h.extendRange(i,s):(this._addError(13===n.type?d.Localizer.Diagnostic.expectedCloseParen():d.Localizer.Diagnostic.expectedCloseBracket(),this._peekToken()),this._consumeTokensUntilType([10,13===n.type?14:16])),i}if(17===n.type){const e=this._getNextToken(),t=this._parsePatternMapping(e),n=this._peekToken();return this._consumeTokenIfType(18)?h.extendRange(t,n):(this._addError(d.Localizer.Diagnostic.expectedCloseBrace(),this._peekToken()),this._consumeTokensUntilType([10,18])),t}return this._handleExpressionParseError(11,d.Localizer.Diagnostic.expectedPatternExpr())}_parseClassPatternArgList(){const e=[];let t=!1;for(;;){const n=this._peekTokenType();if(14===n||2===n||1===n)break;const i=this._parseClassPatternArgument();if(i.name?t=!0:t&&!i.name&&this._addError(d.Localizer.Diagnostic.positionArgAfterNamedArg(),i),e.push(i),!this._consumeTokenIfType(12))break}return e}_parseClassPatternArgument(){const e=this._peekToken(),t=this._peekToken(1);let n;7!==e.type&&8!==e.type||9!==t.type||2!==t.operatorType||(this._getNextToken(),n=h.NameNode.create(e),this._getNextToken());const i=this._parsePatternAs();return h.PatternClassArgumentNode.create(i,n)}_parsePatternLiteral(){const e=this._peekToken(),t=this._peekOperatorType();if(6===e.type||33===t)return this._parsePatternLiteralNumber();if(5===e.type){const e=this._parseAtom();return a.assert(48===e.nodeType),e.strings.forEach((e=>{64&e.token.flags&&this._addError(d.Localizer.Diagnostic.formatStringInPattern(),e)})),h.PatternLiteralNode.create(e)}if(8===e.type){const t=e;if(15===t.keywordType||33===t.keywordType||26===t.keywordType)return h.PatternLiteralNode.create(this._parseAtom())}}_parsePatternLiteralNumber(){const e=this._parseArithmeticExpression();let t,n;return 7===e.nodeType?33!==e.operator&&0!==e.operator||(t=e.leftExpression,n=e.rightExpression):t=e,t&&(55===t.nodeType&&33===t.operator&&(t=t.expression),(40!==t.nodeType||void 0!==n&&t.isImaginary)&&(this._addError(d.Localizer.Diagnostic.expectedComplexNumberLiteral(),e),n=void 0)),n&&(55===n.nodeType&&33===n.operator&&(n=n.expression),40===n.nodeType&&n.isImaginary||this._addError(d.Localizer.Diagnostic.expectedComplexNumberLiteral(),e)),h.PatternLiteralNode.create(e)}_parsePatternMapping(e){const t=this._parseExpressionListGeneric((()=>this._parsePatternMappingItem()));if(t.list.length>0){const n=t.list.filter((e=>72===e.nodeType));return n.length>1&&this._addError(d.Localizer.Diagnostic.duplicateStarStarPattern(),n[1]),h.PatternMappingNode.create(e,t.list)}return t.parseError||h.ErrorNode.create(this._peekToken(),11)}_parsePatternMappingItem(){let e;const t=this._peekToken();if(this._consumeTokenIfOperator(29)){const e=this._getTokenIfIdentifier();if(!e)return this._addError(d.Localizer.Diagnostic.expectedIdentifier(),this._peekToken()),h.ErrorNode.create(this._peekToken(),11);const n=h.NameNode.create(e);return"_"===e.value&&this._addError(d.Localizer.Diagnostic.starStarWildcardNotAllowed(),n),h.PatternMappingExpandEntryNode.create(t,n)}const n=this._parsePatternLiteral();if(n)e=n;else{const t=this._parsePatternCaptureOrValue();t&&(73===t.nodeType?e=t:(this._addError(d.Localizer.Diagnostic.expectedPatternValue(),t),e=h.ErrorNode.create(this._peekToken(),11)))}let i;return e||(this._addError(d.Localizer.Diagnostic.expectedPatternExpr(),this._peekToken()),e=h.ErrorNode.create(this._peekToken(),11)),this._consumeTokenIfType(10)?i=this._parsePatternAs():(this._addError(d.Localizer.Diagnostic.expectedColon(),this._peekToken()),i=h.ErrorNode.create(this._peekToken(),11)),h.PatternMappingKeyEntryNode.create(e,i)}_parsePatternCaptureOrValue(){const e=this._peekToken();if(7===e.type||8===e.type){let e;for(;;){const t=this._getTokenIfIdentifier();if(!t){this._addError(d.Localizer.Diagnostic.expectedIdentifier(),this._peekToken());break}{const n=h.NameNode.create(t);e=e?h.MemberAccessNode.create(e,n):n}if(!this._consumeTokenIfType(20))break}return e?35===e.nodeType?h.PatternValueNode.create(e):h.PatternCaptureNode.create(e):(this._addError(d.Localizer.Diagnostic.expectedIdentifier(),this._peekToken()),h.ErrorNode.create(this._peekToken(),11))}}_parseIfStatement(e=20){const t=this._getKeywordToken(e),n=this._parseTestExpression(!0),i=this._parseSuite(this._isInFunction),s=h.IfNode.create(t,n,i);return this._consumeTokenIfKeyword(13)?(s.elseSuite=this._parseSuite(this._isInFunction),s.elseSuite.parent=s,h.extendRange(s,s.elseSuite)):12===this._peekKeywordType()&&(s.elseSuite=this._parseIfStatement(12),s.elseSuite.parent=s,h.extendRange(s,s.elseSuite)),s}_parseLoopSuite(){const e=this._isInLoop,t=this._isInFinally;this._isInLoop=!0,this._isInFinally=!1;const n=this._parseSuite(this._isInFunction);return this._isInLoop=e,this._isInFinally=t,n}_parseSuite(e=!1,t){const n=this._peekToken(),i=h.SuiteNode.create(n);this._consumeTokenIfType(10)||(this._addError(d.Localizer.Diagnostic.expectedColon(),n),this._consumeTokensUntilType([2,10])&&this._getNextToken()),t&&t();const s=this._isInFunction;if(this._isInFunction=e,this._consumeTokenIfType(2)){t&&t();const e=this._peekToken();if(this._consumeTokenIfType(3)){const t=e;t.isIndentAmbiguous&&this._addError(d.Localizer.Diagnostic.inconsistentTabs(),t)}else this._addError(d.Localizer.Diagnostic.expectedIndentedBlock(),this._peekToken());for(;;){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(d.Localizer.Diagnostic.inconsistentTabs(),t):this._addError(d.Localizer.Diagnostic.unexpectedIndent(),e)}const t=this._parseStatement();t?(t.parent=i,i.statements.push(t)):this._consumeTokensUntilType([2]);const n=this._peekToken();if(this._consumeTokenIfType(4)){n.matchesIndent||this._addError(d.Localizer.Diagnostic.inconsistentIndent(),n);break}if(1===this._peekTokenType())break}}else{const e=this._parseSimpleStatement();i.statements.push(e),e.parent=i}return i.statements.length>0&&h.extendRange(i,i.statements[i.statements.length-1]),this._isInFunction=s,i}_parseForStatement(e){const t=this._getKeywordToken(17),n=this._parseExpressionList(!0),i=this._makeExpressionOrTuple(n,!1);let s,r,a;this._consumeTokenIfKeyword(22)?(s=this._parseTestListAsExpression(2,d.Localizer.Diagnostic.expectedInExpr()),r=this._parseLoopSuite(),this._consumeTokenIfKeyword(13)&&(a=this._parseSuite(this._isInFunction))):(s=this._handleExpressionParseError(0,d.Localizer.Diagnostic.expectedIn()),r=h.SuiteNode.create(this._peekToken()));const o=h.ForNode.create(t,i,s,r);return o.elseSuite=a,a&&(h.extendRange(o,a),a.parent=o),e&&(o.isAsync=!0,h.extendRange(o,e)),o}_tryParseListComprehension(e){const t=this._tryParseCompForStatement();if(!t)return;56===e.nodeType?this._addError(d.Localizer.Diagnostic.unpackIllegalInComprehension(),e):16===e.nodeType&&this._addError(d.Localizer.Diagnostic.dictExpandIllegalInComprehension(),e);const n=h.ListComprehensionNode.create(e),i=[t];for(;;){const e=this._tryParseCompForStatement()||this._tryParseCompIfStatement();if(!e)break;e.parent=n,i.push(e)}return n.comprehensions=i,i.length>0&&(i.forEach((e=>{e.parent=n})),h.extendRange(n,i[i.length-1])),n}_tryParseCompForStatement(){const e=this._peekKeywordType();if(3===e){const e=this._peekToken(1);if(8!==e.type||17!==e.keywordType)return}else if(17!==e)return;let t;3===this._peekKeywordType()&&(t=this._getKeywordToken(3));const n=this._getKeywordToken(17),i=this._parseExpressionList(!0),s=this._makeExpressionOrTuple(i,!1);let r;this._consumeTokenIfKeyword(22)?this._disallowAssignmentExpression((()=>{r=this._parseOrTest()})):r=this._handleExpressionParseError(0,d.Localizer.Diagnostic.expectedIn());const a=h.ListComprehensionForNode.create(t||n,s,r);return t&&(a.isAsync=!0),a}_tryParseCompIfStatement(){if(20!==this._peekKeywordType())return;const e=this._getKeywordToken(20),t=this._tryParseLambdaExpression()||this._parseAssignmentExpression();return h.ListComprehensionIfNode.create(e,t)}_parseWhileStatement(){const e=this._getKeywordToken(35),t=h.WhileNode.create(e,this._parseTestExpression(!0),this._parseLoopSuite());return this._consumeTokenIfKeyword(13)&&(t.elseSuite=this._parseSuite(this._isInFunction),t.elseSuite.parent=t,h.extendRange(t,t.elseSuite)),t}_parseTryStatement(){const e=this._getKeywordToken(34),t=this._parseSuite(this._isInFunction),n=h.TryNode.create(e,t);let i=!1;for(;;){const e=this._peekToken();if(!this._consumeTokenIfKeyword(14))break;let t,s;if(10!==this._peekTokenType())if(t=this._parseTestExpression(!0),this._consumeTokenIfKeyword(1))s=this._getTokenIfIdentifier(),s||this._addError(d.Localizer.Diagnostic.expectedNameAfterAs(),this._peekToken());else{const e=this._peekToken();this._consumeTokenIfType(12)&&(this._addError(d.Localizer.Diagnostic.expectedAsAfterException(),e),this._parseTestExpression(!1))}t?i&&this._addError(d.Localizer.Diagnostic.namedExceptAfterCatchAll(),t):(i&&this._addError(d.Localizer.Diagnostic.duplicateCatchAll(),e),i=!0);const r=this._parseSuite(this._isInFunction),a=h.ExceptNode.create(e,r);t&&(a.typeExpression=t,a.typeExpression.parent=a),s&&(a.name=h.NameNode.create(s),a.name.parent=a),n.exceptClauses.push(a),a.parent=n}return n.exceptClauses.length>0&&(h.extendRange(n,n.exceptClauses[n.exceptClauses.length-1]),this._consumeTokenIfKeyword(13)&&(n.elseSuite=this._parseSuite(this._isInFunction),n.elseSuite.parent=n,h.extendRange(n,n.elseSuite))),this._consumeTokenIfKeyword(16)&&(n.finallySuite=this._parseSuite(this._isInFunction),n.finallySuite.parent=n,h.extendRange(n,n.finallySuite)),n.finallySuite||0!==n.exceptClauses.length||this._addError(d.Localizer.Diagnostic.tryWithoutExcept(),e),n}_parseFunctionDef(e,t){const n=this._getKeywordToken(10),i=this._getTokenIfIdentifier();if(!i)return this._addError(d.Localizer.Diagnostic.expectedFunctionName(),n),h.ErrorNode.create(n,10,void 0,t);if(!this._consumeTokenIfType(13))return this._addError(d.Localizer.Diagnostic.expectedOpenParen(),this._peekToken()),h.ErrorNode.create(i,10,h.NameNode.create(i),t);const s=this._parseVarArgsList(14,!0);let r,a;this._consumeTokenIfType(14)||(this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()),this._consumeTokensUntilType([10])),this._consumeTokenIfType(21)&&(r=this._parseTypeAnnotation());const o=this._parseSuite(!0,(()=>{a||(a=this._getTypeAnnotationCommentText())})),l=h.FunctionNode.create(n,h.NameNode.create(i),o);return e&&(l.isAsync=!0,h.extendRange(l,e)),l.parameters=s,s.forEach((e=>{e.parent=l})),t&&(l.decorators=t,t.forEach((e=>{e.parent=l})),t.length>0&&h.extendRange(l,t[0])),r&&(l.returnTypeAnnotation=r,l.returnTypeAnnotation.parent=l,h.extendRange(l,r)),a&&this._parseFunctionTypeAnnotationComment(a,l),l}_parseVarArgsList(e,t){const n=new Map,i=[];let s=!1,r=!1,a=!1,o=!1,l=!1,c=!1;for(;this._peekTokenType()!==e;){const p=this._parseParameter(t);if(!p){this._consumeTokensUntilType([e]);break}if(p.name){const e=p.name.value;n.has(e)?this._addError(d.Localizer.Diagnostic.duplicateParam().format({name:e}),p.name):n.set(e,e)}else 0===p.category&&0===i.length&&this._addError(d.Localizer.Diagnostic.positionOnlyFirstParam(),p);0===p.category&&(p.name?p.defaultValue?s=!0:!s||a||l||r||(this._addError(d.Localizer.Diagnostic.nonDefaultAfterDefault(),p),r=!0):(o?this._addError(d.Localizer.Diagnostic.duplicatePositionOnly(),p):a&&this._addError(d.Localizer.Diagnostic.positionOnlyAfterNameOnly(),p),o=!0)),i.push(p),1===p.category&&(p.name?(l&&this._addError(d.Localizer.Diagnostic.duplicateArgsParam(),p),l=!0):(a&&this._addError(d.Localizer.Diagnostic.duplicateNameOnly(),p),a=!0)),2===p.category?(c&&this._addError(d.Localizer.Diagnostic.duplicateKwargsParam(),p),c=!0):c&&this._addError(d.Localizer.Diagnostic.paramAfterKwargsParam(),p);const u=this._consumeTokenIfType(12);if(t&&!p.typeAnnotation){const e=this._parseVariableTypeAnnotationComment();e&&(p.typeAnnotationComment=e,p.typeAnnotationComment.parent=p,h.extendRange(p,p.typeAnnotationComment))}if(!u)break}if(i.length>0){const e=i[i.length-1];1!==e.category||e.name||this._addError(d.Localizer.Diagnostic.expectedNamedParameter(),e)}return i}_parseParameter(e){let t=0,n=0;const i=this._peekToken();this._consumeTokenIfOperator(26)?t=1:this._consumeTokenIfOperator(29)?t=2:this._consumeTokenIfOperator(10)&&(this._getLanguageVersion()<p.PythonVersion.V3_8&&this._addError(d.Localizer.Diagnostic.positionOnlyIncompatible(),i),n=1);const s=this._getTokenIfIdentifier();if(!s){if(1===t){return h.ParameterNode.create(i,1)}if(1===n){return h.ParameterNode.create(i,0)}if(13===this._peekTokenType()){const e=this._getNextToken();this._consumeTokensUntilType([14])&&this._getNextToken(),this._addError(d.Localizer.Diagnostic.sublistParamsIncompatible(),e)}else this._addError(d.Localizer.Diagnostic.expectedParamName(),this._peekToken())}let r=0;1===t?r=1:2===t&&(r=2);const a=h.ParameterNode.create(i,r);return s&&(a.name=h.NameNode.create(s),a.name.parent=a,h.extendRange(a,s)),e&&this._consumeTokenIfType(10)&&(a.typeAnnotation=this._parseTypeAnnotation(),a.typeAnnotation.parent=a,h.extendRange(a,a.typeAnnotation)),this._consumeTokenIfOperator(2)&&(a.defaultValue=this._parseTestExpression(!1),a.defaultValue.parent=a,h.extendRange(a,a.defaultValue),t>0&&this._addError(d.Localizer.Diagnostic.defaultValueNotAllowed(),a.defaultValue)),a}_parseWithStatement(e){const t=this._getKeywordToken(36),n=[],i=this._peekToken();let s=!1;if(13===i.type){const e=this._tokenIndex;this._suppressErrors((()=>{for(this._getNextToken();this._parseWithItem(),this._consumeTokenIfType(12););14===this._peekToken().type&&10===this._peekToken(1).type&&(s=!0),this._tokenIndex=e}))}for(s&&(this._consumeTokenIfType(13),this._getLanguageVersion()<p.PythonVersion.V3_10&&this._addError(d.Localizer.Diagnostic.parenthesizedContextManagerIllegal(),i));n.push(this._parseWithItem()),this._consumeTokenIfType(12););s&&(this._consumeTokenIfType(14)||this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()));const r=this._parseSuite(this._isInFunction),a=h.WithNode.create(t,r);return e&&(a.isAsync=!0,h.extendRange(a,e)),a.withItems=n,n.forEach((e=>{e.parent=a})),a}_parseWithItem(){const e=this._parseTestExpression(!0),t=h.WithItemNode.create(e);return this._consumeTokenIfKeyword(1)&&(t.target=this._parseExpression(!1),t.target.parent=t,h.extendRange(t,t.target)),t}_parseDecorated(){const e=[];for(;22===this._peekOperatorType();)e.push(this._parseDecorator());const t=this._peekToken();if(8===t.type)if(3===t.keywordType){if(this._getNextToken(),10===this._peekKeywordType())return this._parseFunctionDef(t,e);this._addError(d.Localizer.Diagnostic.expectedFunctionAfterAsync(),this._peekToken())}else{if(10===t.keywordType)return this._parseFunctionDef(void 0,e);if(7===t.keywordType)return this._parseClassDef(e)}return this._addError(d.Localizer.Diagnostic.expectedAfterDecorator(),this._peekToken()),h.ClassNode.createDummyForDecorators(e)}_parseDecorator(){const e=this._getNextToken();a.assert(22===e.operatorType);const t=this._parseTestExpression(!0);if(this._getLanguageVersion()<p.PythonVersion.V3_9){let e=!1;(this._isNameOrMemberAccessExpression(t)||9===t.nodeType&&this._isNameOrMemberAccessExpression(t.leftExpression))&&(e=!0),e||this._addError(d.Localizer.Diagnostic.expectedDecoratorExpr(),t)}const n=h.DecoratorNode.create(e,t);return this._consumeTokenIfType(2)||(this._addError(d.Localizer.Diagnostic.expectedDecoratorNewline(),this._peekToken()),this._consumeTokensUntilType([2])),n}_isNameOrMemberAccessExpression(e){return 38===e.nodeType||35===e.nodeType&&this._isNameOrMemberAccessExpression(e.leftExpression)}_parseClassDef(e){const t=this._getKeywordToken(7);let n=this._getTokenIfIdentifier();n||(this._addError(d.Localizer.Diagnostic.expectedClassName(),this._peekToken()),n=g.IdentifierToken.create(0,0,"",void 0));let i=[];this._consumeTokenIfType(13)&&(i=this._parseArgList(),this._consumeTokenIfType(14)||this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()));const s=this._parseSuite(!1),r=h.ClassNode.create(t,h.NameNode.create(n),s);return r.arguments=i,i.forEach((e=>{e.parent=r})),e&&(r.decorators=e,e.length>0&&(e.forEach((e=>{e.parent=r})),h.extendRange(r,e[0]))),r}_parsePassStatement(){return h.PassNode.create(this._getKeywordToken(30))}_parseBreakStatement(){const e=this._getKeywordToken(5);return this._isInLoop||this._addError(d.Localizer.Diagnostic.breakOutsideLoop(),e),h.BreakNode.create(e)}_parseContinueStatement(){const e=this._getKeywordToken(8);return this._isInLoop?this._isInFinally&&this._addError(d.Localizer.Diagnostic.continueInFinally(),e):this._addError(d.Localizer.Diagnostic.continueOutsideLoop(),e),h.ContinueNode.create(e)}_parseReturnStatement(){const e=this._getKeywordToken(32),t=h.ReturnNode.create(e);if(this._isInFunction||this._addError(d.Localizer.Diagnostic.returnOutsideFunction(),e),!this._isNextTokenNeverExpression()){const e=this._parseTestOrStarListAsExpression(!0,2,d.Localizer.Diagnostic.expectedReturnExpr());this._reportConditionalErrorForStarTupleElement(e),t.returnExpression=e,t.returnExpression.parent=t,h.extendRange(t,e)}return t}_parseFromStatement(){const e=this._getKeywordToken(18),t=this._parseDottedModuleName(!0),n=h.ImportFromNode.create(e,t),i=0===t.leadingDots&&1===t.nameParts.length&&"__future__"===t.nameParts[0].value,s=this._peekToken();if(this._consumeTokenIfKeyword(21)){h.extendRange(n,s);const e=this._peekToken();if(this._consumeTokenIfOperator(26))h.extendRange(n,e),n.isWildcardImport=!0,n.wildcardToken=e,this._containsWildcardImport=!0;else{const e=this._consumeTokenIfType(13);for(;;){const e=this._getTokenIfIdentifier();if(!e)break;const t=h.ImportFromAsNode.create(h.NameNode.create(e));if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(t.alias=h.NameNode.create(e),t.alias.parent=t,h.extendRange(t,e)):this._addError(d.Localizer.Diagnostic.expectedImportAlias(),this._peekToken())}if(n.imports.push(t),t.parent=n,h.extendRange(n,t),i&&this._futureImportMap.set(e.value,!0),!this._consumeTokenIfType(12))break}if(0===n.imports.length&&this._addError(d.Localizer.Diagnostic.expectedImportSymbols(),this._peekToken()),e){n.usesParens=!0;const e=this._peekToken();this._consumeTokenIfType(14)?h.extendRange(n,e):this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken())}}}else this._addError(d.Localizer.Diagnostic.expectedImport(),this._peekToken()),t.hasTrailingDot||(n.missingImportKeyword=!0);this._importedModules.push({nameNode:n.module,leadingDots:n.module.leadingDots,nameParts:n.module.nameParts.map((e=>e.value)),importedSymbols:n.imports.map((e=>e.name.value))});let r=!1;if(1===n.module.nameParts.length){const e=n.module.nameParts[0].value;"typing"!==e&&"typing_extensions"!==e||(r=!0)}if(r){const e=["Literal","TypeAlias","Annotated"];n.isWildcardImport?e.forEach((e=>{this._typingSymbolAliases.set(e,e)})):n.imports.forEach((t=>{var n;e.some((e=>e===t.name.value))&&this._typingSymbolAliases.set((null===(n=t.alias)||void 0===n?void 0:n.value)||t.name.value,t.name.value)}))}return n}_parseImportStatement(){var e;const t=this._getKeywordToken(21),n=h.ImportNode.create(t);for(;;){const t=this._parseDottedModuleName(),i=h.ImportAsNode.create(t);if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(i.alias=h.NameNode.create(e),i.alias.parent=i,h.extendRange(i,i.alias)):this._addError(d.Localizer.Diagnostic.expectedImportAlias(),this._peekToken())}if(i.module.leadingDots>0&&this._addError(d.Localizer.Diagnostic.relativeImportNotAllowed(),i.module),n.list.push(i),i.parent=n,this._importedModules.push({nameNode:i.module,leadingDots:i.module.leadingDots,nameParts:i.module.nameParts.map((e=>e.value)),importedSymbols:void 0}),1===t.nameParts.length){const n=t.nameParts[0].value;"typing"!==n&&"typing_extensions"!==n||this._typingImportAliases.push((null===(e=i.alias)||void 0===e?void 0:e.value)||n)}if(!this._consumeTokenIfType(12))break}return n.list.length>0&&h.extendRange(n,n.list[n.list.length-1]),n}_parseDottedModuleName(e=!1){const t=h.ModuleNameNode.create(this._peekToken());for(;;)if(this._consumeTokenIfType(19))t.leadingDots+=3;else{if(!this._consumeTokenIfType(20))break;t.leadingDots++}for(;;){const n=this._getTokenIfIdentifier([21]);if(!n){e&&0!==t.leadingDots||(this._addError(d.Localizer.Diagnostic.expectedModuleName(),this._peekToken()),t.hasTrailingDot=!0);break}const i=h.NameNode.create(n);t.nameParts.push(i),i.parent=t,h.extendRange(t,i);const s=this._peekToken();if(!this._consumeTokenIfType(20))break;h.extendRange(t,s)}return t}_parseGlobalStatement(){const e=this._getKeywordToken(19),t=h.GlobalNode.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach((e=>{e.parent=t})),h.extendRange(t,t.nameList[t.nameList.length-1])),t}_parseNonlocalStatement(){const e=this._getKeywordToken(27),t=h.NonlocalNode.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach((e=>{e.parent=t})),h.extendRange(t,t.nameList[t.nameList.length-1])),t}_parseNameList(){const e=[];for(;;){const t=this._getTokenIfIdentifier();if(!t){this._addError(d.Localizer.Diagnostic.expectedIdentifier(),this._peekToken());break}if(e.push(h.NameNode.create(t)),!this._consumeTokenIfType(12))break}return e}_parseRaiseStatement(){const e=this._getKeywordToken(31),t=h.RaiseNode.create(e);return this._isNextTokenNeverExpression()||(t.typeExpression=this._parseTestExpression(!0),t.typeExpression.parent=t,h.extendRange(t,t.typeExpression),this._consumeTokenIfKeyword(18)?(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,h.extendRange(t,t.valueExpression)):this._consumeTokenIfType(12)&&(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,h.extendRange(t,t.valueExpression),this._consumeTokenIfType(12)&&(t.tracebackExpression=this._parseTestExpression(!0),t.tracebackExpression.parent=t,h.extendRange(t,t.tracebackExpression)))),t}_parseAssertStatement(){const e=this._getKeywordToken(2),t=this._parseTestExpression(!0),n=h.AssertNode.create(e,t);if(this._consumeTokenIfType(12)){const e=this._parseTestExpression(!0);n.exceptionExpression=e,n.exceptionExpression.parent=n,h.extendRange(n,e)}return n}_parseDelStatement(){const e=this._getKeywordToken(11),t=this._parseExpressionList(!0);t.parseError||0!==t.list.length||this._addError(d.Localizer.Diagnostic.expectedDelExpr(),this._peekToken());const n=h.DelNode.create(e);return n.expressions=t.list,n.expressions.length>0&&(n.expressions.forEach((e=>{e.parent=n})),h.extendRange(n,n.expressions[n.expressions.length-1])),n}_parseYieldExpression(){const e=this._getKeywordToken(37),t=this._peekToken();if(this._consumeTokenIfKeyword(18))return this._getLanguageVersion()<p.PythonVersion.V3_3&&this._addError(d.Localizer.Diagnostic.yieldFromIllegal(),t),h.YieldFromNode.create(e,this._parseTestExpression(!0));let n;return this._isNextTokenNeverExpression()||(n=this._parseTestOrStarListAsExpression(!0,2,d.Localizer.Diagnostic.expectedYieldExpr()),this._reportConditionalErrorForStarTupleElement(n)),h.YieldNode.create(e,n)}_tryParseYieldExpression(){if(37===this._peekKeywordType())return this._parseYieldExpression()}_parseSimpleStatement(){const e=h.StatementListNode.create(this._peekToken());for(;;){if(0===this._peekTokenType()){const e=this._getNextToken(),t=this._fileContents.substr(e.start,e.length).replace(/[\S\W]/g,"");this._addError(d.Localizer.Diagnostic.invalidTokenChars().format({text:t}),e),this._consumeTokensUntilType([2]);break}const t=this._parseSmallStatement();if(e.statements.push(t),t.parent=e,h.extendRange(e,t),0===t.nodeType)break;if(!this._consumeTokenIfType(11))break;const n=this._peekTokenType();if(2===n||1===n)break}return this._consumeTokenIfType(2)||this._addError(d.Localizer.Diagnostic.expectedNewlineOrSemicolon(),this._peekToken()),e}_parseSmallStatement(){switch(this._peekKeywordType()){case 30:return this._parsePassStatement();case 5:return this._parseBreakStatement();case 8:return this._parseContinueStatement();case 32:return this._parseReturnStatement();case 18:return this._parseFromStatement();case 21:return this._parseImportStatement();case 19:return this._parseGlobalStatement();case 27:return this._parseNonlocalStatement();case 31:return this._parseRaiseStatement();case 2:return this._parseAssertStatement();case 11:return this._parseDelStatement();case 37:return this._parseYieldExpression()}return this._parseExpressionStatement()}_makeExpressionOrTuple(e,t){if(1===e.list.length&&!e.trailingComma)return 56===e.list[0].nodeType&&this._addError(d.Localizer.Diagnostic.unpackNotAllowed(),e.list[0]),e.list[0];const n=e.list.length>0?e.list[0]:this._peekToken(-1),i=h.TupleNode.create(n,t);return i.expressions=e.list,e.list.length>0&&(e.list.forEach((e=>{e.parent=i})),h.extendRange(i,e.list[e.list.length-1])),i}_parseTestListAsExpression(e,t){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(e,t);const n=this._parseTestExpressionList();return n.parseError?n.parseError:this._makeExpressionOrTuple(n,!1)}_parseTestOrStarListAsExpression(e,t,n){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(t,n);const i=this._parseTestOrStarExpressionList(e);return i.parseError?i.parseError:this._makeExpressionOrTuple(i,!1)}_parseExpressionList(e){return this._parseExpressionListGeneric((()=>this._parseExpression(e)))}_parseTestExpressionList(){return this._parseExpressionListGeneric((()=>this._parseTestExpression(!1)))}_parseTestOrStarExpressionList(e){const t=this._parseExpressionListGeneric((()=>this._parseTestOrStarExpression(e)));if(!t.parseError){let e=!1;for(const n of t.list)if(56===n.nodeType){if(e){this._addError(d.Localizer.Diagnostic.duplicateUnpack(),n);break}e=!0}}return t}_parseExpression(e){const t=this._peekToken();return e&&this._consumeTokenIfOperator(26)?h.UnpackNode.create(t,this._parseExpression(!1)):this._parseBitwiseOrExpression()}_parseTestOrStarExpression(e){return 26===this._peekOperatorType()?this._parseExpression(!0):this._parseTestExpression(e)}_parseTestExpression(e){if(24===this._peekKeywordType())return this._parseLambdaExpression();const t=e?this._parseAssignmentExpression():this._parseOrTest();if(0===t.nodeType)return t;if(!this._consumeTokenIfKeyword(20))return t;const n=this._parseAssignmentExpression();if(0===n.nodeType)return n;if(!this._consumeTokenIfKeyword(13))return this._handleExpressionParseError(1,d.Localizer.Diagnostic.expectedElse());const i=this._parseTestExpression(!0);return 0===i.nodeType?i:h.TernaryNode.create(t,n,i)}_parseAssignmentExpression(){const e=this._parseOrTest();if(0===e.nodeType)return e;if(38!==e.nodeType)return e;const t=this._peekToken();if(!this._consumeTokenIfOperator(35))return e;this._assignmentExpressionsAllowed||this._addError(d.Localizer.Diagnostic.walrusNotAllowed(),t),this._getLanguageVersion()<p.PythonVersion.V3_8&&this._addError(d.Localizer.Diagnostic.walrusIllegal(),t);const n=this._parseTestExpression(!1);return h.AssignmentExpressionNode.create(e,n)}_parseOrTest(){let e=this._parseAndTest();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfKeyword(29))break;const n=this._parseAndTest();e=h.BinaryOperationNode.create(e,n,t,37)}return e}_parseAndTest(){let e=this._parseNotTest();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfKeyword(0))break;const n=this._parseNotTest();e=h.BinaryOperationNode.create(e,n,t,36)}return e}_parseNotTest(){const e=this._peekToken();if(this._consumeTokenIfKeyword(28)){const t=this._parseNotTest();return h.UnaryOperationNode.create(e,t,38)}return this._parseComparison()}_parseComparison(){let e=this._parseBitwiseOrExpression();if(0===e.nodeType)return e;for(;;){let t;const n=this._peekToken();if(y.Tokenizer.isOperatorComparison(this._peekOperatorType()))t=this._peekOperatorType(),19===t&&(this._addError(d.Localizer.Diagnostic.operatorLessOrGreaterDeprecated(),n),t=28),this._getNextToken();else if(this._consumeTokenIfKeyword(22))t=41;else if(this._consumeTokenIfKeyword(23))t=this._consumeTokenIfKeyword(28)?40:39;else if(28===this._peekKeywordType()){const e=this._peekToken(1);8===e.type&&22===e.keywordType&&(this._getNextToken(),this._getNextToken(),t=42)}if(void 0===t)break;const i=this._parseComparison();e=h.BinaryOperationNode.create(e,i,n,t)}return e}_parseBitwiseOrExpression(){let e=this._parseBitwiseXorExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(6))break;const n=this._parseBitwiseXorExpression();e=h.BinaryOperationNode.create(e,n,t,6)}return e}_parseBitwiseXorExpression(){let e=this._parseBitwiseAndExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(8))break;const n=this._parseBitwiseAndExpression();e=h.BinaryOperationNode.create(e,n,t,8)}return e}_parseBitwiseAndExpression(){let e=this._parseShiftExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(3))break;const n=this._parseShiftExpression();e=h.BinaryOperationNode.create(e,n,t,3)}return e}_parseShiftExpression(){let e=this._parseArithmeticExpression();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;17===n||31===n;){this._getNextToken();const i=this._parseArithmeticExpression();e=h.BinaryOperationNode.create(e,i,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticExpression(){let e=this._parseArithmeticTerm();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;0===n||33===n;){this._getNextToken();const i=this._parseArithmeticTerm();if(0===i.nodeType)return i;e=h.BinaryOperationNode.create(e,i,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticTerm(){let e=this._parseArithmeticFactor();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;26===n||22===n||10===n||24===n||13===n;){this._getNextToken();const i=this._parseArithmeticFactor();e=h.BinaryOperationNode.create(e,i,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticFactor(){const e=this._peekToken(),t=this._peekOperatorType();if(0===t||33===t||5===t){this._getNextToken();const n=this._parseArithmeticFactor();return h.UnaryOperationNode.create(e,n,t)}const n=this._parseAtomExpression();if(0===n.nodeType)return n;const i=this._peekToken();if(this._consumeTokenIfOperator(29)){const e=this._parseArithmeticFactor();return h.BinaryOperationNode.create(n,e,i,29)}return n}_isTypingAnnotation(e,t){if(38===e.nodeType){if(this._typingSymbolAliases.get(e.value)===t)return!0}else if(35===e.nodeType&&38===e.leftExpression.nodeType&&e.memberName.value===t){const t=e.leftExpression.value;return this._typingImportAliases.some((e=>e===t))}return!1}_parseAtomExpression(){let e;4!==this._peekKeywordType()||this._isParsingTypeAnnotation||(e=this._getKeywordToken(4),this._getLanguageVersion()<p.PythonVersion.V3_5&&this._addError(d.Localizer.Diagnostic.awaitIllegal(),e));let t=this._parseAtom();if(0===t.nodeType)return t;for(;;)if(this._consumeTokenIfType(13)){const e=this._isParsingTypeAnnotation;this._isParsingTypeAnnotation=!1;const n=this._parseArgList(),i=h.CallNode.create(t);i.arguments=n,n.length>0&&(n.forEach((e=>{e.parent=i})),h.extendRange(i,n[n.length-1]));const s=this._peekToken();let r=!1;if(this._consumeTokenIfType(14)?(h.extendRange(i,s),r=!0):(this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()),this._consumeTokensUntilType([2]),h.extendRange(i,this._peekToken())),this._isParsingTypeAnnotation=e,this._isParsingTypeAnnotation){const e=new o.DiagnosticAddendum;38===t.nodeType&&"type"===t.value&&(e.addMessage(d.Localizer.DiagnosticAddendum.useTypeInstead()),this._addError(d.Localizer.Diagnostic.typeCallNotAllowed()+e.getString(),i))}if(t=i,!r)break}else if(this._consumeTokenIfType(15)){const e=this._isParsingIndexTrailer,n=this._isParsingTypeAnnotation;(this._isTypingAnnotation(t,"Literal")||this._isTypingAnnotation(t,"Annotated"))&&(this._isParsingTypeAnnotation=!1),this._isParsingIndexTrailer=!0;const i=this._parseSubscriptList();this._isParsingTypeAnnotation=n,this._isParsingIndexTrailer=e;const s=this._peekToken(),r=h.IndexNode.create(t,i.list,i.trailingComma,s);h.extendRange(r,r),this._consumeTokenIfType(16)||this._handleExpressionParseError(6,d.Localizer.Diagnostic.expectedCloseBracket(),r),t=r}else{if(!this._consumeTokenIfType(20))break;{const e=this._getTokenIfIdentifier();if(!e)return this._handleExpressionParseError(7,d.Localizer.Diagnostic.expectedMemberName(),t);t=h.MemberAccessNode.create(t,h.NameNode.create(e))}}return e?h.AwaitNode.create(e,t):t}_parseSubscriptList(){const e=[];let t=!1,n=!1;for(;;){const i=this._peekToken();if(10!==i.type&&this._isNextTokenNeverExpression())break;let s=0;this._consumeTokenIfOperator(26)?s=1:this._consumeTokenIfOperator(29)&&(s=2);let r,a=this._parsePossibleSlice();if(0===s&&this._consumeTokenIfOperator(2)){const e=a;a=this._parsePossibleSlice(),38===e.nodeType?r=e.token:this._addError(d.Localizer.Diagnostic.expectedParamName(),e)}const o=h.ArgumentNode.create(i,a,s);if(r&&(o.name=h.NameNode.create(r),o.name.parent=o),o.name?t=!0:t&&0===o.argumentCategory&&this._addError(d.Localizer.Diagnostic.positionArgAfterNamedArg(),o),e.push(o),!this._parseOptions.isStubFile&&this._getLanguageVersion()<p.PythonVersion.V3_10&&(o.name&&this._addError(d.Localizer.Diagnostic.keywordSubscriptIllegal(),o.name),0!==s&&this._addError(d.Localizer.Diagnostic.unpackedSubscriptIllegal(),o)),!this._consumeTokenIfType(12)){n=!1;break}n=!0}if(0===e.length){const t=this._handleExpressionParseError(3,d.Localizer.Diagnostic.expectedSliceIndex(),void 0,[16]);e.push(h.ArgumentNode.create(this._peekToken(),t,0))}return{list:e,trailingComma:n}}_parsePossibleSlice(){const e=this._peekToken(),t=[void 0,void 0,void 0];let n=0,i=!1;for(;;){const e=this._peekTokenType();if(16===e||12===e)break;if(10!==e&&(t[n]=this._parseTestExpression(!1)),n++,n>=3||!this._consumeTokenIfType(10))break;i=!0}if(!i)return t[0]?t[0]:h.ErrorNode.create(this._peekToken(),3);const s=h.SliceNode.create(e);s.startValue=t[0],s.startValue&&(s.startValue.parent=s),s.endValue=t[1],s.endValue&&(s.endValue.parent=s),s.stepValue=t[2],s.stepValue&&(s.stepValue.parent=s);const r=t[2]||t[1]||t[0];return r&&h.extendRange(s,r),s}_parseArgList(){const e=[];let t=!1;for(;;){const n=this._peekTokenType();if(14===n||2===n||1===n)break;const i=this._parseArgument();if(i.name?t=!0:t&&0===i.argumentCategory&&this._addError(d.Localizer.Diagnostic.positionArgAfterNamedArg(),i),e.push(i),!this._consumeTokenIfType(12))break}return e}_parseArgument(){const e=this._peekToken();let t=0;this._consumeTokenIfOperator(26)?t=1:this._consumeTokenIfOperator(29)&&(t=2);let n,i=this._parseTestExpression(!0);if(0===t)if(this._consumeTokenIfOperator(2)){const e=i;i=this._parseTestExpression(!1),38===e.nodeType?n=e.token:this._addError(d.Localizer.Diagnostic.expectedParamName(),e)}else{const e=this._tryParseListComprehension(i);e&&(i=e)}const s=h.ArgumentNode.create(e,i,t);return n&&(s.name=h.NameNode.create(n),s.name.parent=s),s}_parseAtom(){const e=this._peekToken();if(19===e.type)return h.EllipsisNode.create(this._getNextToken());if(6===e.type)return h.NumberNode.create(this._getNextToken());if(7===e.type)return h.NameNode.create(this._getNextToken());if(5===e.type)return this._parseStringList();if(22===e.type){this._getNextToken(),this._addError(d.Localizer.Diagnostic.backticksIllegal(),e);const t=this._parseTestListAsExpression(2,d.Localizer.Diagnostic.expectedExpr());return this._consumeTokenIfType(22),t}if(13===e.type){const e=this._parseTupleAtom();if(52===e.nodeType&&this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new o.DiagnosticAddendum;t.addMessage(d.Localizer.DiagnosticAddendum.useTupleInstead()),this._addError(d.Localizer.Diagnostic.tupleInAnnotation()+t.getString(),e)}return 7===e.nodeType&&(e.parenthesized=!0),e}if(15===e.type){const e=this._parseListAtom();if(this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new o.DiagnosticAddendum;t.addMessage(d.Localizer.DiagnosticAddendum.useListInstead()),this._addError(d.Localizer.Diagnostic.listInAnnotation()+t.getString(),e)}return e}if(17===e.type){const e=this._parseDictionaryOrSetAtom();if(this._isParsingTypeAnnotation){const t=new o.DiagnosticAddendum;t.addMessage(d.Localizer.DiagnosticAddendum.useDictInstead()),this._addError(d.Localizer.Diagnostic.dictInAnnotation()+t.getString(),e)}return e}if(8===e.type){const t=e;if(15===t.keywordType||33===t.keywordType||9===t.keywordType||26===t.keywordType)return h.ConstantNode.create(this._getNextToken());const n=this._getTokenIfIdentifier();if(n)return h.NameNode.create(n)}return this._handleExpressionParseError(2,d.Localizer.Diagnostic.expectedExpr())}_handleExpressionParseError(e,t,n,i){this._addError(t,this._peekToken());const s=h.ErrorNode.create(this._peekToken(),e,n),r=[2];return i&&r.push(...i),this._consumeTokensUntilType(r),s}_parseLambdaExpression(e=!0){const t=this._getKeywordToken(24),n=this._parseVarArgsList(10,!1);let i;this._consumeTokenIfType(10)||this._addError(d.Localizer.Diagnostic.expectedColon(),this._peekToken()),i=e?this._parseTestExpression(!1):this._tryParseLambdaExpression(!1)||this._parseOrTest();const s=h.LambdaNode.create(t,i);return s.parameters=n,n.forEach((e=>{e.parent=s})),s}_tryParseLambdaExpression(e=!0){if(24===this._peekKeywordType())return this._parseLambdaExpression(e)}_parseTupleAtom(){const e=this._getNextToken();a.assert(13===e.type);const t=this._tryParseYieldExpression();if(t)return 14!==this._peekTokenType()?this._handleExpressionParseError(8,d.Localizer.Diagnostic.expectedCloseParen()):(h.extendRange(t,this._getNextToken()),t);const n=this._parseTestListWithComprehension(),i=this._makeExpressionOrTuple(n,!0);return h.extendRange(i,e),14!==this._peekTokenType()?this._handleExpressionParseError(8,d.Localizer.Diagnostic.expectedCloseParen()):(h.extendRange(i,this._getNextToken()),i)}_parseListAtom(){const e=this._getNextToken();a.assert(15===e.type);const t=this._parseTestListWithComprehension(),n=this._peekToken();if(!this._consumeTokenIfType(16))return this._handleExpressionParseError(9,d.Localizer.Diagnostic.expectedCloseBracket());const i=h.ListNode.create(e);return h.extendRange(i,n),t.list.length>0&&(t.list.forEach((e=>{e.parent=i})),h.extendRange(i,t.list[t.list.length-1])),i.entries=t.list,i}_parseTestListWithComprehension(){let e=!1;return this._parseExpressionListGeneric((()=>{let t=this._parseTestOrStarExpression(!0);const n=this._tryParseListComprehension(t);return n&&(t=n,e=!0),t}),(()=>this._isNextTokenNeverExpression()),(()=>e))}_parseDictionaryOrSetAtom(){const e=this._getNextToken();a.assert(17===e.type);const t=[],n=[];let i=!1,s=!1,r=!1,o=!0;for(;18!==this._peekTokenType();){let e,l,c;const p=this._peekToken();if(this._consumeTokenIfOperator(29)?e=this._parseExpression(!1):(l=this._parseTestOrStarExpression(!0),this._consumeTokenIfType(10)&&(c=this._parseTestExpression(!1))),l&&c)if(56===l.nodeType&&this._addError(d.Localizer.Diagnostic.unpackInDict(),l),s)this._addError(d.Localizer.Diagnostic.keyValueInSet(),c);else{const e=h.DictionaryKeyEntryNode.create(l,c);let n=e;const s=this._tryParseListComprehension(e);s&&(n=s,r=!0,o||this._addError(d.Localizer.Diagnostic.comprehensionInDict(),n)),t.push(n),i=!0}else if(e)if(s)this._addError(d.Localizer.Diagnostic.unpackInSet(),e);else{const n=h.DictionaryExpandEntryNode.create(e);h.extendRange(n,p);let s=n;const a=this._tryParseListComprehension(n);a&&(s=a,r=!0,o||this._addError(d.Localizer.Diagnostic.comprehensionInDict(),e)),t.push(s),i=!0}else if(a.assert(void 0!==l),l)if(i)this._addError(d.Localizer.Diagnostic.dictKeyValuePairs(),l);else{const e=this._tryParseListComprehension(l);e&&(l=e,r=!0,o||this._addError(d.Localizer.Diagnostic.comprehensionInSet(),l)),n.push(l),s=!0}if(r)break;if(!this._consumeTokenIfType(12))break;o=!1}let l=this._peekToken();if(this._consumeTokenIfType(18)||(this._addError(d.Localizer.Diagnostic.expectedCloseBrace(),this._peekToken()),l=void 0),s){const t=h.SetNode.create(e);return l&&h.extendRange(t,l),n.length>0&&h.extendRange(t,n[n.length-1]),n.forEach((e=>{e.parent=t})),t.entries=n,t}const c=h.DictionaryNode.create(e);return l&&h.extendRange(c,l),t.length>0&&(t.forEach((e=>{e.parent=c})),h.extendRange(c,t[t.length-1])),c.entries=t,c}_parseExpressionListGeneric(e,t=(()=>this._isNextTokenNeverExpression()),n=(()=>!1)){let i=!1;const s=[];let r;for(;!t();){const t=e();if(0===t.nodeType){r=t;break}if(s.push(t),n())break;if(!this._consumeTokenIfType(12)){i=!1;break}i=!0}return{trailingComma:i,list:s,parseError:r}}_parseExpressionStatement(){let e,t=this._parseTestOrStarListAsExpression(!1,2,d.Localizer.Diagnostic.expectedExpr());if(0===t.nodeType)return t;if(this._consumeTokenIfType(10)){if(e=this._parseTypeAnnotation(),t=h.TypeAnnotationNode.create(t,e),!this._parseOptions.isStubFile&&this._getLanguageVersion()<p.PythonVersion.V3_6&&this._addError(d.Localizer.Diagnostic.varAnnotationIllegal(),e),!this._consumeTokenIfOperator(2))return t;const n=this._isTypingAnnotation(e,"TypeAlias"),i=this._isParsingTypeAnnotation;n&&(this._isParsingTypeAnnotation=!0);const s=this._tryParseYieldExpression()||this._parseTestOrStarListAsExpression(!1,2,d.Localizer.Diagnostic.expectedAssignRightHandExpr());return this._isParsingTypeAnnotation=i,h.AssignmentNode.create(t,s)}if(this._consumeTokenIfOperator(2))return this._parseChainAssignments(t);if(y.Tokenizer.isOperatorAssignment(this._peekOperatorType())){const e=this._getNextToken(),n=this._tryParseYieldExpression()||this._parseTestListAsExpression(2,d.Localizer.Diagnostic.expectedBinaryRightHandExpr()),i=Object.assign({},t);return i.id=h.getNextNodeId(),h.AugmentedAssignmentNode.create(t,n,e.operatorType,i)}return t}_parseChainAssignments(e){let t=this._tryParseYieldExpression()||this._parseTestOrStarListAsExpression(!1,2,d.Localizer.Diagnostic.expectedAssignRightHandExpr());if(0===t.nodeType)return h.AssignmentNode.create(e,t);if(this._consumeTokenIfOperator(2)&&(t=this._parseChainAssignments(t),0===t.nodeType))return t;const n=h.AssignmentNode.create(e,t),i=this._parseVariableTypeAnnotationComment();return i&&(n.typeAnnotationComment=i,n.typeAnnotationComment.parent=n,h.extendRange(n,n.typeAnnotationComment)),n}_parseFunctionTypeAnnotation(){const e=this._peekToken();if(!this._consumeTokenIfType(13))return void this._addError(d.Localizer.Diagnostic.expectedOpenParen(),this._peekToken());let t=[];for(;;){const e=this._peekTokenType();if(14===e||2===e||1===e)break;const n=this._parseTypeAnnotation();if(t.push(n),!this._consumeTokenIfType(12))break}if(this._consumeTokenIfType(14)||(this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()),this._consumeTokensUntilType([10])),!this._consumeTokenIfType(21))return void this._addError(d.Localizer.Diagnostic.expectedArrow(),this._peekToken());const n=this._parseTypeAnnotation();let i=!1;return 1===t.length&&18===t[0].nodeType&&(t=[],i=!0),h.FunctionAnnotationNode.create(e,i,t,n)}_parseTypeAnnotation(){const e=this._isParsingTypeAnnotation;this._isParsingTypeAnnotation=!0;const t=this._peekToken(),n=this._consumeTokenIfOperator(26);let i=this._parseTestExpression(!1);return n&&(i=h.UnpackNode.create(t,i)),this._isParsingTypeAnnotation=e,i}_reportStringTokenErrors(e,t){65536&e.flags&&this._addError(d.Localizer.Diagnostic.stringUnterminated(),e),t.nonAsciiInBytes&&this._addError(d.Localizer.Diagnostic.stringNonAsciiBytes(),e),64&e.flags&&(this._getLanguageVersion()<p.PythonVersion.V3_6&&this._addError(d.Localizer.Diagnostic.formatStringIllegal(),e),32&e.flags&&this._addError(d.Localizer.Diagnostic.formatStringBytes(),e),16&e.flags&&this._addError(d.Localizer.Diagnostic.formatStringUnicode(),e))}_makeStringNode(e){const t=m.getUnescapedString(e);return this._reportStringTokenErrors(e,t),h.StringNode.create(e,t.value,t.unescapeErrors.length>0)}_getTypeAnnotationCommentText(){if(0===this._tokenIndex)return;const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex-1),t=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);if(e.start+e.length===t.start)return;const n=this._fileContents.substring(e.start+e.length,t.start).match(/^(\s*#\s*type:\s*)([^\r\n]*)/);if(!n)return;const i=n[2];if(i.trim().match(/^ignore(\s|\[|$)/))return;const s=e.start+e.length+n[1].length;return g.StringToken.create(s,i.length,0,i,0,void 0)}_parseVariableTypeAnnotationComment(){const e=this._getTypeAnnotationCommentText();if(!e)return;const t=this._makeStringNode(e),n=h.StringListNode.create([t]),i=(new T).parseTextExpression(this._fileContents,e.start,e.length,this._parseOptions,1);return i.diagnostics.forEach((e=>{this._addError(e.message,n)})),i.parseTree?i.parseTree:void 0}_parseFunctionTypeAnnotationComment(e,t){const n=this._makeStringNode(e),i=h.StringListNode.create([n]),s=(new T).parseTextExpression(this._fileContents,e.start,e.length,this._parseOptions,2);if(s.diagnostics.forEach((e=>{this._addError(e.message,i)})),!s.parseTree||62!==s.parseTree.nodeType)return;const r=s.parseTree;t.functionAnnotationComment=r,r.parent=t,h.extendRange(t,r)}_parseFormatStringSegment(e,t,n,i){a.assert(t.isExpression);const s=(new T).parseTextExpression(this._fileContents,e.start+e.prefixLength+e.quoteMarkLength+t.offset+n,i,this._parseOptions,0,1);return s.diagnostics.forEach((t=>{const n=(t.range?c.convertPositionToOffset(t.range.start,s.lines):e.start)||e.start,i={start:n,length:((t.range?(c.convertPositionToOffset(t.range.end,s.lines)||0)+1:e.start+e.length)||e.start+e.length)-n};this._addError(t.message,i)})),s.parseTree}_parseFormatString(e){const t=m.getUnescapedString(e);this._reportStringTokenErrors(e,t);const n=[];for(const i of t.formatStringSegments)if(i.isExpression){const t=this._getFormatStringExpressionLength(i.value.trimEnd()),s=this._parseFormatStringSegment(e,i,0,t);s&&n.push(s);const r=i.value.substr(t);let a=0,o=0;for(let s=0;s<r.length;s++)if(123===r.charCodeAt(s))0===a&&(o=s+1),a++;else if(125===r.charCodeAt(s)&&a>0&&(a--,0===a)){const r=this._parseFormatStringSegment(e,i,t+o,s-o);r&&n.push(r)}}return h.FormatStringNode.create(e,t.value,t.unescapeErrors.length>0,n)}_getFormatStringExpressionLength(e){let t=0;const n=[];let i,s=0,r=0,a=0;for(;t<e.length;){const o=e[t],l=n.length>0||s>0||r>0||a>0,c=n.length>0;if("="===o)i=t;else{if(":"===o){if(!l)break}else if("!"===o){if(!l&&(t===e.length-1||"="!==e[t+1]))break}else if("'"===o||'"'===o){let i=o;t+2<e.length&&e[t+1]===o&&e[t+2]===o&&(i=o+o+o,t+=2),n.length>0&&n[n.length-1]===i?n.pop():n.push(i)}else"("===o?c||r++:")"===o?!c&&r>0&&r--:"{"===o?c||s++:"}"===o?!c&&s>0&&s--:"["===o?c||a++:"]"===o&&!c&&a>0&&a--;" "!==o&&(i=void 0)}t++}return this._parseOptions.pythonVersion>=p.PythonVersion.V3_8&&void 0!==i&&(t=i),t}_parseStringList(){const e=[];for(;5===this._peekTokenType();){const t=this._getNextToken();64&t.flags?e.push(this._parseFormatString(t)):e.push(this._makeStringNode(t))}const t=h.StringListNode.create(e);if(this._isParsingTypeAnnotation)if(t.strings.length>1)this._addError(d.Localizer.Diagnostic.annotationSpansStrings(),t);else if(4&t.strings[0].token.flags)this._addError(d.Localizer.Diagnostic.annotationTripleQuote(),t);else if(64&t.strings[0].token.flags)this._addError(d.Localizer.Diagnostic.annotationFormatString(),t);else{const e=t.strings[0].token,n=m.getUnescapedString(t.strings[0].token).value,i=e.start,s=e.prefixLength+e.quoteMarkLength;if(n.length!==e.length-s-e.quoteMarkLength)this._addError(d.Localizer.Diagnostic.annotationStringEscape(),t);else{const e=(new T).parseTextExpression(this._fileContents,i+s,n.length,this._parseOptions,1);e.diagnostics.forEach((e=>{this._addError(e.message,t)})),e.parseTree&&(t.typeAnnotation=e.parseTree,t.typeAnnotation.parent=t)}}return t}_reportConditionalErrorForStarTupleElement(e){if(52===e.nodeType&&!(e.enclosedInParens||this._parseOptions.pythonVersion>=p.PythonVersion.V3_8))for(const t of e.expressions)if(56===t.nodeType)return void this._addError(d.Localizer.Diagnostic.unpackTuplesIllegal(),t)}_isNextTokenNeverExpression(){switch(this._peekToken().type){case 8:switch(this._peekKeywordType()){case 17:case 22:case 20:return!0}break;case 9:switch(this._peekOperatorType()){case 1:case 34:case 27:case 11:case 25:case 4:case 7:case 9:case 18:case 32:case 30:case 14:case 2:return!0}break;case 3:case 4:case 2:case 1:case 11:case 14:case 16:case 18:case 12:case 10:return!0}return!1}_disallowAssignmentExpression(e){const t=this._assignmentExpressionsAllowed;this._assignmentExpressionsAllowed=!1,e(),this._assignmentExpressionsAllowed=t}_getNextToken(){const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);return this._atEof()||this._tokenIndex++,e}_atEof(){return this._tokenIndex>=this._tokenizerOutput.tokens.count-1}_peekToken(e=0){return this._tokenIndex+e<0?this._tokenizerOutput.tokens.getItemAt(0):this._tokenIndex+e>=this._tokenizerOutput.tokens.count?this._tokenizerOutput.tokens.getItemAt(this._tokenizerOutput.tokens.count-1):this._tokenizerOutput.tokens.getItemAt(this._tokenIndex+e)}_peekTokenType(){return this._peekToken().type}_peekKeywordType(){const e=this._peekToken();if(8===e.type)return e.keywordType}_peekOperatorType(){const e=this._peekToken();if(9===e.type)return e.operatorType}_getTokenIfIdentifier(e=[]){const t=this._peekToken();if(7===t.type)return this._getNextToken();if(0===t.type)return this._getNextToken(),this._addError(d.Localizer.Diagnostic.invalidIdentifierChar(),t),g.IdentifierToken.create(t.start,t.length,"",t.comments);if(8===t.type){const n=this._peekKeywordType();if(!e.find((e=>e===n))){const e=this._fileContents.substr(t.start,t.length);return this._getNextToken(),g.IdentifierToken.create(t.start,t.length,e,t.comments)}}}_consumeTokensUntilType(e){for(;;){const t=this._peekToken();if(e.some((e=>e===t.type)))return!0;if(1===t.type)return!1;this._getNextToken()}}_consumeTokenIfType(e){return this._peekTokenType()===e&&(this._getNextToken(),!0)}_consumeTokenIfKeyword(e){return this._peekKeywordType()===e&&(this._getNextToken(),!0)}_consumeTokenIfOperator(e){return this._peekOperatorType()===e&&(this._getNextToken(),!0)}_getKeywordToken(e){const t=this._getNextToken();return a.assert(8===t.type),a.assert(t.keywordType===e),t}_getLanguageVersion(){return this._parseOptions.pythonVersion}_suppressErrors(e){try{this._areErrorsSuppressed=!0,e()}finally{this._areErrorsSuppressed=!1}}_addError(e,t){a.assert(void 0!==t),this._areErrorsSuppressed||this._diagSink.addError(e,c.convertOffsetsToRange(t.start,t.start+t.length,this._tokenizerOutput.lines))}}t.Parser=T},78722:(e,t)=>{"use strict";function n(e){return e>=48&&e<=57||(e>=97&&e<=122||e>=65&&e<=90)}function i(e){return e>=48&&e<=55}function s(e){return e>=48&&e<=57||(e>=97&&e<=102||e>=65&&e<=70)}function r(e){return e>=48&&e<=57?e-48:e>=97&&e<=102?e-97+10:e>=65&&e<=70?e-65+10:0}Object.defineProperty(t,"__esModule",{value:!0}),t.getUnescapedString=void 0,t.getUnescapedString=function(e){const t=e.escapedValue,a=0!=(8&e.flags),o=0!=(32&e.flags),l=0!=(64&e.flags);let c=0,p={offset:0,length:0,value:"",isExpression:!1},u=0;const d={value:"",unescapeErrors:[],nonAsciiInBytes:!1,formatStringSegments:[]},h=()=>{a||d.unescapeErrors.push({offset:u-1,length:2,errorType:0})},m=(e=0)=>u+e>=t.length?3:t.charCodeAt(u+e),y=e=>{let t=!1,n=0,i="";for(let i=0;i<e;i++){const e=m(1+i);if(!s(e)){t=!0;break}n=16*n+r(e)}return t?(h(),i="\\"+String.fromCharCode(m()),u++):(i=String.fromCharCode(n),u+=1+e),i},g=e=>{const t=String.fromCharCode(e);d.value+=t,p.value+=t};for(;;){let e=m();if(3===e)return l&&(p.isExpression&&d.unescapeErrors.push({offset:p.offset,length:u-p.offset,errorType:3}),u!==p.offset&&(p.length=u-p.offset,d.formatStringSegments.push(p))),d;if(92===e){if(l&&p.isExpression&&d.unescapeErrors.push({offset:u,length:1,errorType:1}),u++,a){g(e);continue}e=m();let t="";if(13===e||10===e)13===e&&10===m(1)&&(a&&(t+=String.fromCharCode(e)),u++,e=m()),a&&(t="\\"+t+String.fromCharCode(e)),u++;else if(a)t="\\"+String.fromCharCode(e),u++;else switch(e){case 92:case 39:case 34:t=String.fromCharCode(e),u++;break;case 97:t="",u++;break;case 98:t="\b",u++;break;case 102:t="\f",u++;break;case 110:t="\n",u++;break;case 114:t="\r",u++;break;case 116:t="\t",u++;break;case 118:t="\v",u++;break;case 120:t=y(2);break;case 78:{let i=!1,s=1;if(123!==m(s))i=!0;else for(s++;;){const e=m(s);if(125===e)break;if(!n(e)&&45!==e&&32!==(f=e)&&9!==f){i=!0;break}s++}i?(h(),t="\\"+String.fromCharCode(e),u++):(t="-",u+=1+s);break}case 117:t=y(4);break;case 85:t=y(8);break;default:if(i(e)){let n=e-48;u++,e=m(),i(e)&&(n=8*n+e-48,u++,e=m(),i(e)&&(n=8*n+e-48,u++)),t=String.fromCharCode(n)}else t="\\",h()}d.value+=t,p.value+=t}else if(10===e||13===e)13===e&&10===m(1)&&(g(e),u++,e=m()),g(e),u++;else if(l&&123===e)p.isExpression||123!==m(1)?(0===c?(p.length=u-p.offset,p.length>0&&d.formatStringSegments.push(p),u++,p={offset:u,length:0,value:"",isExpression:!0}):(g(e),u++),c++):(g(e),u+=2);else if(l&&125===e)p.isExpression||125!==m(1)?0===c?(d.unescapeErrors.push({offset:u,length:1,errorType:2}),u++):(c--,0===c?(p.length=u-p.offset,d.formatStringSegments.push(p),u++,p={offset:u,length:0,value:"",isExpression:!1}):(g(e),u++)):(g(e),u+=2);else if(!p.isExpression||39!==e&&34!==e)o&&e>=128&&(d.nonAsciiInBytes=!0),g(e),u++;else{const t=e;g(e);const n=m(1)===t&&m(2)===t;for(n&&(u+=2,g(e),g(e),d.value+=String.fromCharCode(e),d.value+=String.fromCharCode(e));;){u++;let e=m();if(3===e)break;if(92!==e){if(10===e||13===e)break;if(e===t){if(!n){u++,g(e);break}if(m(1)===t&&m(2)===t){u+=3,g(e),g(e),g(e);break}}g(e)}else g(e),u++,e=m(),g(e)}}}var f}},7280:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tokenizer=void 0;const i=n(979),s=n(49900),r=n(19794),a=n(66945),o={and:0,as:1,assert:2,async:3,await:4,break:5,case:6,class:7,continue:8,__debug__:9,def:10,del:11,elif:12,else:13,except:14,finally:16,for:17,from:18,global:19,if:20,import:21,in:22,is:23,lambda:24,match:25,nonlocal:27,not:28,or:29,pass:30,raise:31,return:32,try:34,while:35,with:36,yield:37,False:15,None:26,True:33},l={0:3,1:4,2:4,3:2,4:4,5:1,6:2,7:4,8:2,9:4,10:2,11:4,12:10,13:2,14:4,15:10,16:10,17:2,18:4,19:26,20:10,21:10,22:2,23:4,24:2,25:4,26:2,27:4,28:10,29:2,30:4,31:2,32:4,33:2,34:4,36:2,37:2,38:1,39:2,40:2,41:2,42:2};t.Tokenizer=class{constructor(){this._cs=new r.CharacterStream(""),this._tokens=[],this._prevLineStart=0,this._parenDepth=0,this._lineRanges=[],this._indentAmounts=[],this._typeIgnoreAll=!1,this._typeIgnoreLines={},this._crCount=0,this._crLfCount=0,this._lfCount=0,this._indentCount=0,this._indentTabCount=0,this._indentSpacesTotal=0,this._singleQuoteCount=0,this._doubleQuoteCount=0}tokenize(e,t,n,s=0){if(void 0===t)t=0;else if(t<0||t>e.length)throw new Error("Invalid range start");if(void 0===n)n=e.length;else{if(n<0||t+n>e.length)throw new Error("Invalid range length");t+n<e.length&&(e=e.substr(0,t+n))}this._cs=new r.CharacterStream(e),this._cs.position=t,this._tokens=[],this._prevLineStart=0,this._parenDepth=s,this._lineRanges=[],this._indentAmounts=[];const o=t+n;for(;!(this._cs.isEndOfStream()||(this._addNextToken(),this._cs.position>=o)););0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(a.NewLineToken.create(this._cs.position,0,3,this._getComments())),this._setIndent(0,0,!0,!1),this._tokens.push(a.Token.create(1,this._cs.position,0,this._getComments())),this._addLineRange();let l="\n";this._crCount>this._crLfCount&&this._crCount>this._lfCount?l="\r":this._crLfCount>this._crCount&&this._crLfCount>this._lfCount&&(l="\r\n");let c="    ";if(this._indentTabCount>this._indentCount/2)c="\t";else if(this._indentCount>0){let e=Math.round(this._indentSpacesTotal/this._indentCount);e<1?e=1:e>8&&(e=8),c="";for(let t=0;t<e;t++)c+=" "}return{tokens:new i.TextRangeCollection(this._tokens),lines:new i.TextRangeCollection(this._lineRanges),typeIgnoreLines:this._typeIgnoreLines,typeIgnoreAll:this._typeIgnoreAll,predominantEndOfLineSequence:l,predominantTabSequence:c,predominantSingleQuoteCharacter:this._singleQuoteCount>=this._doubleQuoteCount?"'":'"'}}static getOperatorInfo(e){return l[e]}static isOperatorAssignment(e){return void 0!==e&&void 0!==l[e]&&0!=(4&l[e])}static isOperatorComparison(e){return void 0!==e&&void 0!==l[e]&&0!=(8&l[e])}_addNextToken(){this._cs.skipWhitespace(),this._cs.isEndOfStream()||this._handleCharacter()||this._cs.moveNext()}_handleCharacter(){const e=this._getStringPrefixLength();if(e>=0){let t="";e>0&&(t=this._cs.getText().substr(this._cs.position,e),this._cs.advance(e));const n=this._getQuoteTypeFlags(t);if(0!==n)return this._handleString(n,e),!0}if(35===this._cs.currentChar)return this._handleComment(),!0;switch(this._cs.currentChar){case 65279:return 0!==this._cs.position&&this._handleInvalid();case 13:{const e=10===this._cs.nextChar?2:1,t=2===e?2:0;return this._handleNewLine(e,t),!0}case 10:return this._handleNewLine(1,1),!0;case 92:return 13===this._cs.nextChar?(10===this._cs.lookAhead(2)?this._cs.advance(3):this._cs.advance(2),this._addLineRange(),!0):10===this._cs.nextChar?(this._cs.advance(2),this._addLineRange(),!0):this._handleInvalid();case 40:this._parenDepth++,this._tokens.push(a.Token.create(13,this._cs.position,1,this._getComments()));break;case 41:this._parenDepth>0&&this._parenDepth--,this._tokens.push(a.Token.create(14,this._cs.position,1,this._getComments()));break;case 91:this._parenDepth++,this._tokens.push(a.Token.create(15,this._cs.position,1,this._getComments()));break;case 93:this._parenDepth>0&&this._parenDepth--,this._tokens.push(a.Token.create(16,this._cs.position,1,this._getComments()));break;case 123:this._parenDepth++,this._tokens.push(a.Token.create(17,this._cs.position,1,this._getComments()));break;case 125:this._parenDepth>0&&this._parenDepth--,this._tokens.push(a.Token.create(18,this._cs.position,1,this._getComments()));break;case 44:this._tokens.push(a.Token.create(12,this._cs.position,1,this._getComments()));break;case 96:this._tokens.push(a.Token.create(22,this._cs.position,1,this._getComments()));break;case 59:this._tokens.push(a.Token.create(11,this._cs.position,1,this._getComments()));break;case 58:if(61===this._cs.nextChar){this._tokens.push(a.OperatorToken.create(this._cs.position,2,35,this._getComments())),this._cs.advance(1);break}this._tokens.push(a.Token.create(10,this._cs.position,1,this._getComments()));break;default:if(this._isPossibleNumber()&&this._tryNumber())return!0;if(46===this._cs.currentChar){if(46===this._cs.nextChar&&46===this._cs.lookAhead(2))return this._tokens.push(a.Token.create(19,this._cs.position,3,this._getComments())),this._cs.advance(3),!0;this._tokens.push(a.Token.create(20,this._cs.position,1,this._getComments()));break}return!(!this._tryIdentifier()&&!this._tryOperator())||this._handleInvalid()}return!1}_addLineRange(){const e=this._cs.position-this._prevLineStart;e>0&&this._lineRanges.push({start:this._prevLineStart,length:e}),this._prevLineStart=this._cs.position}_handleNewLine(e,t){0===this._parenDepth&&3!==t&&(0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(a.NewLineToken.create(this._cs.position,e,t,this._getComments()))),0===t?this._crCount++:2===t?this._crLfCount++:this._lfCount++,this._cs.advance(e),this._addLineRange(),this._readIndentationAfterNewLine()}_readIndentationAfterNewLine(){let e=0,t=0,n=!1,i=!1;for(;!this._cs.isEndOfStream();)switch(this._cs.currentChar){case 32:e++,t++,i=!0,this._cs.moveNext();break;case 9:e++,t+=8-t%8,n=!0,this._cs.moveNext();break;case 12:e=0,t=0,n=!1,i=!1,this._cs.moveNext();break;default:return void this._setIndent(e,t,i,n);case 35:case 10:case 13:return}}_setIndent(e,t,n,i){if(!(this._parenDepth>0))if(0===this._indentAmounts.length)t>0&&(this._indentCount++,i&&this._indentTabCount++,this._indentSpacesTotal+=t,this._indentAmounts.push({tab1Spaces:e,tab8Spaces:t,isSpacePresent:n,isTabPresent:i}),this._tokens.push(a.IndentToken.create(this._cs.position,0,t,!1,this._getComments())));else{const s=this._indentAmounts[this._indentAmounts.length-1];if(s.tab8Spaces<t){const r=(s.isSpacePresent&&i||s.isTabPresent&&n)&&s.tab1Spaces>=e;this._indentCount++,i&&this._indentTabCount++,this._indentSpacesTotal+=t-this._indentAmounts[this._indentAmounts.length-1].tab8Spaces,this._indentAmounts.push({tab1Spaces:e,tab8Spaces:t,isSpacePresent:n,isTabPresent:i}),this._tokens.push(a.IndentToken.create(this._cs.position,0,t,r,this._getComments()))}else{const e=[];for(;this._indentAmounts.length>0&&this._indentAmounts[this._indentAmounts.length-1].tab8Spaces>t;)e.push(this._indentAmounts.length>1?this._indentAmounts[this._indentAmounts.length-2].tab8Spaces:0),this._indentAmounts.pop();e.forEach(((n,i)=>{const s=i<e.length-1||n===t,r=i<e.length-1?n:t;this._tokens.push(a.DedentToken.create(this._cs.position,0,r,s,this._getComments()))}))}}}_tryIdentifier(){const e=this._cs.position;if(s.isIdentifierStartChar(this._cs.currentChar))for(this._cs.moveNext();s.isIdentifierChar(this._cs.currentChar);)this._cs.moveNext();if(this._cs.position>e){const t=this._cs.getText().substr(e,this._cs.position-e);return void 0!==o[t]?this._tokens.push(a.KeywordToken.create(e,this._cs.position-e,o[t],this._getComments())):this._tokens.push(a.IdentifierToken.create(e,this._cs.position-e,t,this._getComments())),!0}return!1}_isPossibleNumber(){return!!s.isDecimal(this._cs.currentChar)||!(46!==this._cs.currentChar||!s.isDecimal(this._cs.nextChar))}_tryNumber(){const e=this._cs.position;if(48===this._cs.currentChar){let t=0,n=0;if((120===this._cs.nextChar||88===this._cs.nextChar)&&s.isHex(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;s.isHex(this._cs.currentChar);)this._cs.moveNext();t=16}if((98===this._cs.nextChar||66===this._cs.nextChar)&&s.isBinary(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;s.isBinary(this._cs.currentChar);)this._cs.moveNext();t=2}if((111===this._cs.nextChar||79===this._cs.nextChar)&&s.isOctal(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;s.isOctal(this._cs.currentChar);)this._cs.moveNext();t=8}if(t>0){const i=this._cs.getText().substr(e,this._cs.position-e),s=parseInt(i.substr(n).replace(/_/g,""),t);if(!isNaN(s))return this._tokens.push(a.NumberToken.create(e,i.length,s,!0,!1,this._getComments())),!0}}let t=!1,n=!1;if(this._cs.currentChar>=49&&this._cs.currentChar<=57){for(;s.isDecimal(this._cs.currentChar);)n=!0,this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar}if(48===this._cs.currentChar){for(n=!0;48===this._cs.currentChar||95===this._cs.currentChar;)this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar}if(t){let t=this._cs.getText().substr(e,this._cs.position-e);const n=parseInt(t.replace(/_/g,""),10);if(!isNaN(n)){let i=!1;return 106!==this._cs.currentChar&&74!==this._cs.currentChar||(i=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(a.NumberToken.create(e,t.length,n,!0,i,this._getComments())),!0}}if(this._cs.position=e,(n||46===this._cs.currentChar&&this._cs.nextChar>=48&&this._cs.nextChar<=57)&&this._skipFloatingPointCandidate()){let t=this._cs.getText().substr(e,this._cs.position-e);const n=parseFloat(t);if(!isNaN(n)){let i=!1;return 106!==this._cs.currentChar&&74!==this._cs.currentChar||(i=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(a.NumberToken.create(e,this._cs.position-e,n,!1,i,this._getComments())),!0}}return this._cs.position=e,!1}_tryOperator(){let e=0;const t=this._cs.nextChar;let n;switch(this._cs.currentChar){case 43:e=61===t?2:1,n=2===e?1:0;break;case 38:e=61===t?2:1,n=2===e?4:3;break;case 124:e=61===t?2:1,n=2===e?7:6;break;case 94:e=61===t?2:1,n=2===e?9:8;break;case 61:e=61===t?2:1,n=2===e?12:2;break;case 33:if(61!==t)return!1;e=2,n=28;break;case 37:e=61===t?2:1,n=2===e?25:24;break;case 126:e=1,n=5;break;case 45:if(62===t)return this._tokens.push(a.Token.create(21,this._cs.position,2,this._getComments())),this._cs.advance(2),!0;e=61===t?2:1,n=2===e?34:33;break;case 42:42===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?30:29):(e=61===t?2:1,n=2===e?27:26);break;case 47:47===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?14:13):(e=61===t?2:1,n=2===e?11:10);break;case 60:60===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?18:17):62===t?(e=2,n=19):(e=61===t?2:1,n=2===e?21:20);break;case 62:62===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?32:31):(e=61===t?2:1,n=2===e?16:15);break;case 64:e=61===t?2:1,n=2===e?23:22;break;default:return!1}return this._tokens.push(a.OperatorToken.create(this._cs.position,e,n,this._getComments())),this._cs.advance(e),e>0}_handleInvalid(){const e=this._cs.position;for(;10!==this._cs.currentChar&&13!==this._cs.currentChar&&!this._cs.isAtWhiteSpace()&&!this._cs.isEndOfStream();)this._cs.moveNext();const t=this._cs.position-e;return t>0&&(this._tokens.push(a.Token.create(0,e,t,this._getComments())),!0)}_getComments(){const e=this._comments;return this._comments=void 0,e}_handleComment(){const e=this._cs.position+1;this._cs.skipToEol();const t=this._cs.position-e,n=this._cs.getText().substr(e,t),i=a.Comment.create(e,t,n);n.match(/^\s*type:\s*ignore(\s|\[|$)/)&&(this._tokens.findIndex((e=>2!==e.type&&e&&3!==e.type))<0?this._typeIgnoreAll=!0:this._typeIgnoreLines[this._lineRanges.length]=!0),this._comments?this._comments.push(i):this._comments=[i]}_getStringPrefixLength(){if(39===this._cs.currentChar||34===this._cs.currentChar)return 0;if(39===this._cs.nextChar||34===this._cs.nextChar)switch(this._cs.currentChar){case 102:case 70:case 114:case 82:case 98:case 66:case 117:case 85:return 1}if(39===this._cs.lookAhead(2)||34===this._cs.lookAhead(2)){switch(this._cs.getText().substr(this._cs.position,2).toLowerCase()){case"rf":case"fr":case"ur":case"ru":case"br":case"rb":return 2}}return-1}_getQuoteTypeFlags(e){let t=0;e=e.toLowerCase();for(let n=0;n<e.length;n++)switch(e[n]){case"u":t|=16;break;case"b":t|=32;break;case"r":t|=8;break;case"f":t|=64}return 39===this._cs.currentChar?(t|=1,39===this._cs.nextChar&&39===this._cs.lookAhead(2)&&(t|=4)):34===this._cs.currentChar&&(t|=2,34===this._cs.nextChar&&34===this._cs.lookAhead(2)&&(t|=4)),t}_handleString(e,t){const n=this._cs.position-t;4&e?this._cs.advance(3):(this._cs.moveNext(),1&e?this._singleQuoteCount++:this._doubleQuoteCount++);const i=this._skipToEndOfStringLiteral(e),s=this._cs.position;this._tokens.push(a.StringToken.create(n,s-n,i.flags,i.escapedValue,t,this._getComments()))}_skipToEndOfStringLiteral(e){const t=1&e?39:34,n=0!=(4&e);let i="";for(;;){if(this._cs.isEndOfStream())return{escapedValue:i,flags:e|=65536};if(92===this._cs.currentChar)i+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext(),13===this._cs.getCurrentChar()||10===this._cs.getCurrentChar()?(13===this._cs.getCurrentChar()&&10===this._cs.nextChar&&(i+=String.fromCharCode(this._cs.getCurrentChar()),this._cs.moveNext()),i+=String.fromCharCode(this._cs.getCurrentChar()),this._cs.moveNext(),this._addLineRange()):(i+=String.fromCharCode(this._cs.getCurrentChar()),this._cs.moveNext());else if(10===this._cs.currentChar||13===this._cs.currentChar){if(!n)return{escapedValue:i,flags:e|=65536};13===this._cs.currentChar&&10===this._cs.nextChar&&(i+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),i+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext(),this._addLineRange()}else{if(!n&&this._cs.currentChar===t){this._cs.moveNext();break}if(n&&this._cs.currentChar===t&&this._cs.nextChar===t&&this._cs.lookAhead(2)===t){this._cs.advance(3);break}i+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()}}return{escapedValue:i,flags:e}}_skipFloatingPointCandidate(){const e=this._cs.position;return this._skipFractionalNumber(),this._cs.position>e&&(101!==this._cs.currentChar&&69!==this._cs.currentChar||(this._cs.moveNext(),this._skipDecimalNumber(!0))),this._cs.position>e}_skipFractionalNumber(){this._skipDecimalNumber(!1),46===this._cs.currentChar&&this._cs.moveNext(),this._skipDecimalNumber(!1)}_skipDecimalNumber(e){for(!e||45!==this._cs.currentChar&&43!==this._cs.currentChar||this._cs.moveNext();s.isDecimal(this._cs.currentChar);)this._cs.moveNext()}}},66945:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentifierToken=t.OperatorToken=t.NumberToken=t.StringToken=t.KeywordToken=t.NewLineToken=t.DedentToken=t.IndentToken=t.Token=t.Comment=void 0,function(e){e.create=function(e,t,n){return{start:e,length:t,value:n}}}(t.Comment||(t.Comment={})),function(e){e.create=function(e,t,n,i){return{start:t,length:n,type:e,comments:i}}}(t.Token||(t.Token={})),function(e){e.create=function(e,t,n,i,s){return{start:e,length:t,type:3,isIndentAmbiguous:i,comments:s,indentAmount:n}}}(t.IndentToken||(t.IndentToken={})),function(e){e.create=function(e,t,n,i,s){return{start:e,length:t,type:4,comments:s,indentAmount:n,matchesIndent:i}}}(t.DedentToken||(t.DedentToken={})),function(e){e.create=function(e,t,n,i){return{start:e,length:t,type:2,comments:i,newLineType:n}}}(t.NewLineToken||(t.NewLineToken={})),function(e){e.create=function(e,t,n,i){return{start:e,length:t,type:8,comments:i,keywordType:n}}}(t.KeywordToken||(t.KeywordToken={})),function(e){e.create=function(e,t,n,i,s,r){return{start:e,length:t,type:5,flags:n,escapedValue:i,prefixLength:s,quoteMarkLength:4&n?3:1,comments:r}}}(t.StringToken||(t.StringToken={})),function(e){e.create=function(e,t,n,i,s,r){return{start:e,length:t,type:6,isInteger:i,isImaginary:s,value:n,comments:r}}}(t.NumberToken||(t.NumberToken={})),function(e){e.create=function(e,t,n,i){return{start:e,length:t,type:9,operatorType:n,comments:i}}}(t.OperatorToken||(t.OperatorToken={})),function(e){e.create=function(e,t,n,i){return{start:e,length:t,type:7,value:n,comments:i}}}(t.IdentifierToken||(t.IdentifierToken={}))},52846:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unicodePc=t.unicodeNd=t.unicodeMc=t.unicodeMn=t.unicodeNl=t.unicodeLm=t.unicodeLo=t.unicodeLt=t.unicodeLl=t.unicodeLu=void 0,t.unicodeLu=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,8579,[11264,11310],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,[65313,65338],[66560,66599],[66736,66771],[68736,68786],[71840,71871],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217]],t.unicodeLl=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,687],881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[5112,5117],[7296,7304],[7424,7467],[7531,7543],[7545,7578],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,8580,[11312,11358],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11387],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,2581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,[42865,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,43002,[43824,43866],[43872,43877],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[68800,68850],[71872,71903],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[125218,125251]],t.unicodeLt=[453,456,459,498,[8072,8079],[8088,8095],[8104,8111],8124,8140,8188],t.unicodeLo=[170,186,443,[448,451],660,[1488,1514],[1520,1522],[1568,1599],[1601,1610],[1646,1647],[1649,1747],1749,[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2048,2069],[2112,2136],[2144,2154],[2208,2228],[2230,2237],[2308,2361],2365,2384,[2392,2401],[2418,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,3294,[3296,3297],[3313,3314],[3333,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3653],[3713,3714],3716,[3719,3720],3722,3725,[3732,3735],[3737,3743],[3745,3747],3749,3751,[3754,3755],[3757,3760],[3762,3763],3773,[3776,3780],[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4304,4346],[4349,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5900],[5902,5905],[5920,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6108,[6176,6210],[6212,6263],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],[6917,6963],[6981,6987],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7287],[7401,7404],[7406,7409],[7413,7414],[8501,8504],[11568,11623],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],12294,12348,[12353,12438],12447,[12449,12538],12543,[12549,12590],[12593,12686],[12704,12730],[12784,12799],[13312,19893],[19968,40938],[40960,40980],[40982,42124],[42192,42231],[42240,42507],[42512,42527],[42538,42539],42606,[42656,42725],42895,42999,[43003,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,43261,[43274,43301],[43312,43334],[43360,43388],[43396,43442],[43488,43492],[43495,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43631],[43633,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43740],[43744,43754],43762,[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43968,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65382,65391],[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66640,66717],[66816,66855],[66864,66915],[67072,67382],[67392,67413],[67424,67431],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68147],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[69635,69687],[69763,69807],[69840,69864],[69891,69926],[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],[71424,71449],71935,72192,[72203,72242],72250,72272,[72284,72323],[72326,72329],[72384,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73728,74649],[74880,75075],[77824,78894],[82944,83526],[92160,92728],[92736,92766],[92880,92909],[92928,92975],[93027,93047],[93053,93071],[93952,94020],94032,[94208,100332],[100352,101106],[110592,110878],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[124928,125124],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173782],[173824,177972],[177984,178205],[178208,183969],[183984,191456],[194560,195101]],t.unicodeLm=[[688,705],[710,721],[736,740],748,750,884,890,1369,1600,[1765,1766],[2036,2037],2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,7293],[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[11388,11389],11631,11823,12293,[12337,12341],12347,[12445,12446],[12540,12542],40981,[42232,42237],42508,42623,[42652,42653],[42775,42783],42864,42888,[43e3,43001],43471,43494,43632,43741,[43763,43764],[43868,43871],65392,[65438,65439],[92992,92995],[94099,94111],[94176,94177]],t.unicodeNl=[[5870,5872],[8544,8578],[8581,8584],12295,[12321,12329],[12344,12346],[42726,42735],[65856,65908],66369,66378,[66513,66517],[74752,74862]],t.unicodeMn=[[768,879],[1155,1159],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2260,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,2902,[2914,2915],2946,3008,3021,3072,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3769],[3771,3772],[3784,3789],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6845],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7673],[7675,7679],[8400,8412],8417,[8421,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],42607,[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],[43204,43205],[43232,43249],[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],43452,43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],69633,[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70090,70092],[70191,70193],70196,[70198,70199],70206,70367,[70371,70378],[70400,70401],70460,70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[72193,72198],[72201,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[92912,92916],[92976,92982],[94095,94098],[113821,113822],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[125136,125142],[125252,125258],[917760,917999]],t.unicodeMc=[2307,2363,[2366,2368],[2377,2380],[2382,2383],[2434,2435],[2494,2496],[2503,2504],[2507,2508],2519,2563,[2622,2624],2691,[2750,2752],2761,[2763,2764],[2818,2819],2878,2880,[2887,2888],[2891,2892],2903,[3006,3007],[3009,3010],[3014,3016],[3018,3020],3031,[3073,3075],[3137,3140],[3202,3203],3262,[3264,3268],[3271,3272],[3274,3275],[3285,3286],[3330,3331],[3390,3392],[3398,3400],[3402,3404],3415,[3458,3459],[3535,3537],[3544,3551],[3570,3571],[3902,3903],3967,[4139,4140],4145,4152,[4155,4156],[4182,4183],[4194,4196],[4199,4205],[4227,4228],[4231,4236],4239,[4250,4252],6070,[6078,6085],[6087,6088],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6681,6682],6741,6743,6753,[6755,6756],[6765,6770],6916,6965,6971,[6973,6977],[6979,6980],7042,7073,[7078,7079],7082,7143,[7146,7148],7150,[7154,7155],[7204,7211],[7220,7221],7393,[7410,7411],7415,[12334,12335],[43043,43044],43047,[43136,43137],[43188,43203],[43346,43347],43395,[43444,43445],[43450,43451],[43453,43456],[43567,43568],[43571,43572],43597,43643,43645,43755,[43758,43759],43765,[44003,44004],[44006,44007],[44009,44010],44012,69632,69634,69762,[69808,69810],[69815,69816],69932,70018,[70067,70069],[70079,70080],[70188,70190],[70194,70195],70197,[70368,70370],[70402,70403],[70462,70463],[70465,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70709,70711],[70720,70721],70725,[70832,70834],70841,[70843,70846],70849,[71087,71089],[71096,71099],71102,[71216,71218],[71227,71228],71230,71340,[71342,71343],71350,[71456,71457],71462,[72199,72200],72249,[72279,72280],72343,72751,72766,72873,72881,72884,[94033,94078],[119141,119142],[119149,119154]],t.unicodeNd=[[48,57],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72784,72793],[73040,73049],[92768,92777],[93008,93017],[120782,120831],[125264,125273]],t.unicodePc=[95,[8255,8256],8276,[65075,65076],[65101,65103],65343]},37633:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PyrightFileSystem=void 0;const a=r(n(35747)),o=n(26477),l=n(97956),c=n(94647);t.PyrightFileSystem=class{constructor(e){this._realFS=e,this._fileMap=new Map,this._reverseFileMap=new Map,this._folderMap=new Map,this._rootSearched=new Set,this._partialStubPackagePaths=new Set,this._conflictMap=new Map}existsSync(e){return!this._isVirtualEntry(e)&&this._realFS.existsSync(this.getOriginalFilePath(e))}mkdirSync(e,t){this._realFS.mkdirSync(e,t)}chdir(e){this._realFS.chdir(e)}readdirEntriesSync(e){const t=this._realFS.readdirEntriesSync(e).filter((t=>!this._isVirtualEntry(c.combinePaths(e,t.name)))),n=this._folderMap.get(c.ensureTrailingDirectorySeparator(e));return n?t.concat(n.map((e=>new p(e)))):t}readdirSync(e){const t=this._realFS.readdirSync(e).filter((t=>!this._isVirtualEntry(c.combinePaths(e,t)))),n=this._folderMap.get(c.ensureTrailingDirectorySeparator(e));return n?t.concat(n):t}readFileSync(e,t){return this._realFS.readFileSync(this.getOriginalFilePath(e),t)}writeFileSync(e,t,n){this._realFS.writeFileSync(this.getOriginalFilePath(e),t,n)}statSync(e){return this._realFS.statSync(this.getOriginalFilePath(e))}unlinkSync(e){this._realFS.unlinkSync(this.getOriginalFilePath(e))}realpathSync(e){return this._realFS.realpathSync(e)}getModulePath(){return this._realFS.getModulePath()}createFileSystemWatcher(e,t){return this._realFS.createFileSystemWatcher(e,t)}createReadStream(e){return this._realFS.createReadStream(this.getOriginalFilePath(e))}createWriteStream(e){return this._realFS.createWriteStream(this.getOriginalFilePath(e))}copyFileSync(e,t){this._realFS.copyFileSync(this.getOriginalFilePath(e),this.getOriginalFilePath(t))}readFile(e){return this._realFS.readFile(this.getOriginalFilePath(e))}readFileText(e,t){return this._realFS.readFileText(this.getOriginalFilePath(e),t)}tmpdir(){return this._realFS.tmpdir()}tmpfile(e){return this._realFS.tmpfile(e)}isPartialStubPackagesScanned(e){return this.isPathScanned(e.root)}isPathScanned(e){return this._rootSearched.has(e)}processPartialStubPackages(e,t){var n;for(const i of e)if(this._rootSearched.add(i),this._realFS.existsSync(i)&&c.isDirectory(this._realFS,i))for(const e of this._realFS.readdirEntriesSync(i)){const s=c.combinePaths(i,e.name);if(!(e.isSymbolicLink()?!!(null===(n=c.tryStat(this._realFS,s))||void 0===n?void 0:n.isDirectory()):e.isDirectory())||!e.name.endsWith(l.stubsSuffix))continue;const r=o.getPyTypedInfo(this._realFS,s);if(!r||!r.isPartiallyTyped)continue;let a;this._partialStubPackagePaths.add(s);const p=e.name.substr(0,e.name.length-l.stubsSuffix.length);for(const e of t){const t=c.combinePaths(e,p);try{const e=c.tryStat(this._realFS,t);if(!(null==e?void 0:e.isDirectory()))continue;const n=o.getPyTypedInfo(this._realFS,t);if(n&&!n.isPartiallyTyped)continue;a=null!=a?a:this._getRelativePathPartialStubs(s);for(const e of a){const n=c.combinePaths(s,e),i=c.combinePaths(t,e);if(this.existsSync(i)){const t=c.changeAnyExtension(i,"py"),s=c.changeAnyExtension(c.combinePaths(this.tmpdir(),"conflictFiles",p,e),"py");this._conflictMap.has(i)||this.existsSync(t)||this.existsSync(s)||(this._recordVirtualFile(s,n,!1),this._conflictMap.set(i,s))}else this._recordVirtualFile(i,n)}}catch(e){}}}}clearPartialStubs(){this._fileMap.clear(),this._folderMap.clear(),this._rootSearched.clear(),this._partialStubPackagePaths.clear(),this._conflictMap.clear()}isMappedFilePath(e){return this._fileMap.has(e)}getOriginalFilePath(e){var t;return null!==(t=this._fileMap.get(e))&&void 0!==t?t:e}getMappedFilePath(e){var t;return null!==(t=this._reverseFileMap.get(e))&&void 0!==t?t:e}getConflictedFile(e){return this._conflictMap.get(e)}_recordVirtualFile(e,t,n=!0){this._fileMap.set(e,t),n&&this._reverseFileMap.set(t,e);const i=c.ensureTrailingDirectorySeparator(c.getDirectoryPath(e));let s=this._folderMap.get(i);s||(s=[],this._folderMap.set(i,s));const r=c.getFileName(e);s.some((e=>e===r))||s.push(r)}_getRelativePathPartialStubs(e){const t=[],n=c.ensureTrailingDirectorySeparator(e).length,i=e=>{for(const s of this._realFS.readdirEntriesSync(e)){const r=c.combinePaths(e,s.name);let a=s.isDirectory(),o=s.isFile();if(s.isSymbolicLink()){const e=c.tryStat(this._realFS,r);e&&(a=e.isDirectory(),o=e.isFile())}if(a&&i(r),o&&s.name.endsWith(".pyi")){const e=r.substring(n);e&&t.push(e)}}};return i(e),t}_isVirtualEntry(e){return this._partialStubPackagePaths.has(e)||this._reverseFileMap.has(e)}};class p extends a.Dirent{constructor(e){super(),this.name=e}isFile(){return!0}isDirectory(){return!1}isBlockDevice(){return!1}isCharacterDevice(){return!1}isSymbolicLink(){return!1}isFIFO(){return!1}isSocket(){return!1}}},64553:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceMap=void 0;const i=n(10219);class s extends Map{constructor(e){super(),this._ls=e,this._defaultWorkspacePath="<default>"}getNonDefaultWorkspaces(){const e=[];return this.forEach((t=>{t.rootPath&&e.push(t)})),e}getWorkspaceForFile(e){let t,n;if(this.forEach((i=>{i.rootPath&&e.startsWith(i.rootPath)&&(void 0===t||i.rootPath.startsWith(t))&&(t=i.rootPath,n=i)})),void 0===n){let e=this.get(this._defaultWorkspacePath);if(!e){const t=[...this.keys()];if(1===t.length)return this.get(t[0]);e={workspaceName:"",rootPath:"",rootUri:"",serviceInstance:this._ls.createAnalyzerService(this._defaultWorkspacePath),disableLanguageServices:!1,disableOrganizeImports:!1,isInitialized:i.createDeferred()},this.set(this._defaultWorkspacePath,e),this._ls.updateSettingsForWorkspace(e).ignoreErrors()}return e}return n}}t.WorkspaceMap=s}};
//# sourceMappingURL=pyright.bundle.js.map